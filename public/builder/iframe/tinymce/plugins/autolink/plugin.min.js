!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),n=function(e,t){if(t<0&&(t=0),3===e.nodeType){var n=e.data.length;n<t&&(t=n)}return t},i=function(e,t,i){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,n(t,i)):e.setStartBefore(t)},o=function(e,t,i){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,n(t,i)):e.setEndAfter(t)},r=function(e,t,n){var r,a,f,s,d,l,c,u,g,h,C=function(e){return e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i)}(e),m=function(e){return e.getParam("default_link_target",!1)}(e);if("A"!==e.selection.getNode().tagName){if((r=e.selection.getRng(!0).cloneRange()).startOffset<5){if(!(u=r.endContainer.previousSibling)){if(!r.endContainer.firstChild||!r.endContainer.firstChild.nextSibling)return;u=r.endContainer.firstChild.nextSibling}if(g=u.length,i(r,u,g),o(r,u,g),r.endOffset<5)return;a=r.endOffset,s=u}else{if(3!==(s=r.endContainer).nodeType&&s.firstChild){for(;3!==s.nodeType&&s.firstChild;)s=s.firstChild;3===s.nodeType&&(i(r,s,0),o(r,s,s.nodeValue.length))}a=1===r.endOffset?2:r.endOffset-1-t}for(f=a;i(r,s,2<=a?a-2:0),o(r,s,1<=a?a-1:0),a-=1," "!==(h=r.toString())&&""!==h&&160!==h.charCodeAt(0)&&0<=a-2&&h!==n;);var y;(y=r.toString())===n||" "===y||160===y.charCodeAt(0)?(i(r,s,a),o(r,s,f),a+=1):(0===r.startOffset?i(r,s,0):i(r,s,a),o(r,s,f)),"."===(l=r.toString()).charAt(l.length-1)&&o(r,s,f-1),(c=(l=r.toString().trim()).match(C))&&("www."===c[1]?c[1]="http://www.":/@$/.test(c[1])&&!/^mailto:/.test(c[1])&&(c[1]="mailto:"+c[1]),d=e.selection.getBookmark(),e.selection.setRng(r),e.execCommand("createlink",!1,c[1]+c[2]),!1!==m&&e.dom.setAttrib(e.selection.getNode(),"target",m),e.selection.moveToBookmark(d),e.nodeChanged())}};e.add("autolink",(function(e){var n,i;(n=e).on("keydown",(function(e){13!==e.keyCode||r(n,-1,"")})),t.ie&&t.ie<=11?n.on("focus",(function(){if(!i){i=!0;try{n.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}})):(n.on("keypress",(function(e){41!==e.keyCode||r(n,-1,"(")})),n.on("keyup",(function(e){32!==e.keyCode||r(n,0,"")})))}))}();