!function(){"use strict";var t,e,n,r,o=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),c=tinymce.util.Tools.resolve("tinymce.EditorManager"),u=tinymce.util.Tools.resolve("tinymce.Env"),s=tinymce.util.Tools.resolve("tinymce.util.Tools"),a=function(t){return t.getParam("importcss_selector_converter")},l=function(t){return t.getParam("importcss_append")},f=function(t){return function(){return t}},m=f(!1),p=f(!0),g=function(){return y},y=(r={fold:function(t,e){return t()},is:m,isSome:m,isNone:p,getOr:n=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:n,orThunk:e,map:g,ap:g,each:function(){},bind:g,flatten:g,exists:m,forall:p,filter:g,equals:t=function(t){return t.isNone()},equals_:t,toArray:function(){return[]},toString:f("none()")},Object.freeze&&Object.freeze(r),r),v=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}},h=v("array"),d=v("function"),_=(Array.prototype.slice,Array.prototype.push),x=(d(Array.from)&&Array.from,function(t){return"string"==typeof t?function(e){return-1!==e.indexOf(t)}:t instanceof RegExp?function(e){return t.test(e)}:t}),O=function(t,e,n){var r=[],o={};function i(e,o){var a,l,f,m=e.href;if(l=m,f=u.cacheSuffix,"string"==typeof l&&(l=l.replace("?"+f,"").replace("&"+f,"")),(m=l)&&n(m,o)&&!function(t,e){var n=t.settings,r=!1!==n.skin&&(n.skin||"oxide");if(r){var o=n.skin_url?t.documentBaseURI.toAbsolute(n.skin_url):c.baseURL+"/skins/ui/"+r,i=c.baseURL+"/skins/content/";return e===o+"/content"+(t.inline?".inline":"")+".min.css"||-1!==e.indexOf(i)}return!1}(t,m)){s.each(e.imports,(function(t){i(t,!0)}));try{a=e.cssRules||e.rules}catch(t){}s.each(a,(function(t){t.styleSheet?i(t.styleSheet,!0):t.selectorText&&s.each(t.selectorText.split(","),(function(t){r.push(s.trim(t))}))}))}}s.each(t.contentCSS,(function(t){o[t]=!0})),n||(n=function(t,e){return e||o[t]});try{s.each(e.styleSheets,(function(t){i(t)}))}catch(t){}return r},T=function(t,e){var n,r=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(e);if(r){var o=r[1],i=r[2].substr(1).split(".").join(" "),c=s.makeMap("a,img");return r[1]?(n={title:e},t.schema.getTextBlockElements()[o]?n.block=o:t.schema.getBlockElements()[o]||c[o.toLowerCase()]?n.selector=o:n.inline=o):r[2]&&(n={inline:"span",title:e.substr(1),classes:i}),!1!==function(t){return t.getParam("importcss_merge_classes")}(t)?n.classes=i:n.attributes={class:i},n}},b=function(t,e){return null===e||!1!==function(t){return t.getParam("importcss_exclusive")}(t)},k=T,S=function(t){t.on("init",(function(e){var n,r,o,c,u=(n=[],r=[],o={},{addItemToGroup:function(t,e){o[t]?o[t].push(e):(r.push(t),o[t]=[e])},addItem:function(t){n.push(t)},toFormats:function(){return function(t){return function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!h(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);_.apply(e,t[n])}return e}(function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r}(t,(function(t){var e=o[t];return 0===e.length?[]:[{title:t,items:e}]})))}(r).concat(n)}}),f={},m=x(function(t){return t.getParam("importcss_selector_filter")}(t)),p=(c=function(t){return t.getParam("importcss_groups")}(t),s.map(c,(function(t){return s.extend({},t,{original:t,selectors:{},filter:x(t.filter),item:{text:t.title,menu:[]}})}))),g=function(e,n){if(v=e,d=f,!(b(t,h=n)?v in d:v in h.selectors)){p=e,y=f,b(t,g=n)?y[p]=!0:g.selectors[p]=!0;var r=(u=(c=t).plugins.importcss,l=e,((m=n)&&m.selector_converter?m.selector_converter:a(c)?a(c):function(){return T(c,l)}).call(u,l,m));if(r){var o=r.name||i.DOM.uniqueId();return t.formatter.register(o,r),s.extend({},{title:r.title,format:o})}}var c,u,l,m,p,g,y,v,h,d;return null};s.each(O(t,t.getDoc(),x(function(t){return t.getParam("importcss_file_filter")}(t))),(function(t){if(-1===t.indexOf(".mce-")&&(!m||m(t))){var e=(r=p,o=t,s.grep(r,(function(t){return!t.filter||t.filter(o)})));if(0<e.length)s.each(e,(function(e){var n=g(t,e);n&&u.addItemToGroup(e.title,n)}));else{var n=g(t,null);n&&u.addItem(n)}}var r,o}));var y=u.toFormats();t.fire("addStyleModifications",{items:y,replace:!l(t)})}))};o.add("importcss",(function(t){return S(t),function(t){return{convertSelectorToFormat:function(e){return k(t,e)}}}(t)}))}();