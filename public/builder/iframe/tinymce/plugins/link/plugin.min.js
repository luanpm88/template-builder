!function(n){"use strict";var t,e,r,o,i,u,c,a=tinymce.util.Tools.resolve("tinymce.PluginManager"),l=tinymce.util.Tools.resolve("tinymce.util.VK"),f=function(n){return function(t){return function(n){if(null===n)return"null";var t=typeof n;return"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}},s=f("string"),m=f("array"),d=f("boolean"),h=f("function"),p=function(n){var t=n.getParam("link_assume_external_targets",!1);return d(t)&&t?1:!s(t)||"http"!==t&&"https"!==t?0:t},v=function(n){return n.getParam("default_link_target")},g=function(n){return n.getParam("rel_list",[],"array")},y=function(n){return n.getParam("link_title",!0,"boolean")},w=function(n){return n.getParam("allow_unsafe_link_target",!1,"boolean")},x=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),k=tinymce.util.Tools.resolve("tinymce.Env"),b=function(){},_=function(n){return function(){return n}},T=_(!1),O=_(!0),A=T,C=O,P=function(){return N},N=(o={fold:function(n,t){return n()},is:A,isSome:A,isNone:C,getOr:r=function(n){return n},getOrThunk:e=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:r,orThunk:e,map:P,ap:P,each:function(){},bind:P,flatten:P,exists:A,forall:C,filter:P,equals:t=function(n){return n.isNone()},equals_:t,toArray:function(){return[]},toString:_("none()")},Object.freeze&&Object.freeze(o),o),E=function(n){var t=function(){return n},e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:C,isNone:A,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return E(t(n))},ap:function(t){return t.fold(P,(function(t){return E(t(n))}))},each:function(t){t(n)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(n)?o:N},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(A,(function(t){return e(n,t)}))},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},I={some:E,none:P,from:function(n){return null==n?N:E(n)}},j=(Array.prototype.slice,void 0===(i=Array.prototype.indexOf)?function(n,t){return F(n,t)}:function(n,t){return i.call(n,t)}),S=function(n,t){for(var e=0,r=n.length;e<r;e++)t(n[e],e,n)},F=function(n,t){for(var e=0,r=n.length;e<r;++e)if(n[e]===t)return e;return-1},L=Array.prototype.push,R=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!m(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);L.apply(t,n[e])}return t},D=(h(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),M=function(n){return/^\w+:/i.test(n)},U=function(n,t){var e,r,o=["noopener"],i=n?n.split(/\s+/):[],u=function(n){return n.filter((function(n){return-1===D.inArray(o,n)}))},c=t?0<(e=u(e=i)).length?e.concat(o):o:u(i);return 0<c.length?(r=c,D.trim(r.sort().join(" "))):""},q=function(n,t){return t=t||n.selection.getNode(),B(t)?n.dom.select("a[href]",t)[0]:n.dom.getParent(t,"a[href]")},K=function(n){return n&&"A"===n.nodeName&&!!n.href},B=function(n){return n&&"FIGURE"===n.nodeName&&/\bimage\b/i.test(n.className)},z=function(n,t,e){n.undoManager.transact((function(){var r,o,i,u,c,a,l,f,s,m=n.selection.getNode(),d=q(n,m),h=function(n){return t=["title","rel","class","target"],e=function(t,e){return n[e].each((function(n){t[e]=0<n.length?n:null})),t},r={href:n.href},S(t,(function(n){r=e(r,n)})),r;var t,e,r}(e);if(!(0<g(n).length)&&!1===w(n)){var y=U(h.rel,"_blank"===h.target);h.rel=y||null}I.from(h.target).isNone()&&(h.target=v(n)),h.href=(r=h.href,"http"!==(o=p(n))&&"https"!==o||M(r)?r:o+"://"+r),e.href===t.href&&t.attach(),d?(n.focus(),l=n,f=d,s=h,e.text.each((function(n){f.hasOwnProperty("innerText")?f.innerText=n:f.textContent=n})),l.dom.setAttribs(f,s),l.selection.select(f)):(i=n,u=m,c=e.text,a=h,B(u)?function(n,t,e){var r=n.dom.select("img",t)[0];if(r){var o=n.dom.create("a",e);r.parentNode.insertBefore(o,r),o.appendChild(r)}}(i,u,a):c.fold((function(){i.execCommand("mceInsertLink",!1,a)}),(function(n){i.insertContent(i.dom.createHTML("a",a,i.dom.encode(n)))})))}))},V=function(n){n.undoManager.transact((function(){var t=n.selection.getNode();if(B(t))!function(n,t){var e=n.dom.select("img",t)[0];if(e){var r=n.dom.getParents(e,"a[href]",t)[0];r&&(r.parentNode.insertBefore(e,r),n.dom.remove(r))}}(n,t);else{var e=n.dom.getParent(t,"a[href]",n.getBody());e&&n.dom.remove(e,!0)}n.focus()}))},H=function(n){return 0<D.grep(n,K).length},$=function(n){return n.getAttribute("data-mce-href")||n.getAttribute("href")},G=function(n){return!(/</.test(n)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(n)||-1===n.indexOf("href=")))},J=q,W=function(n,t){return(t?t.innerText||t.textContent:n.getContent({format:"text"})).replace(/\uFEFF/g,"")},X=U,Q=M,Y=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return I.none()},Z=function(n){return s(n.value)?n.value:""},nn=function(n){return void 0===n&&(n=Z),function(t){return I.from(t).map((function(t){return e=t,r=n,o=[],D.each(e,(function(n){var t=s(n.text)?n.text:s(n.title)?n.title:"";if(void 0!==n.menu);else{var e=r(n);o.push({text:t,value:e})}})),o;var e,r,o}))}},tn=function(n){return nn(Z)(n)},en=nn,rn=function(n,t){return function(e){return{name:n,type:"selectbox",label:t,items:e}}},on=Z,un=function(n){var t=n,e=function(){return t};return{get:e,set:function(n){t=n},clone:function(){return un(e())}}},cn=function(n,t){var e=un(n.text);return{onChange:function(n,r){return"url"===r.name?function(n){if(e.get().length<=0){var t=void 0!==n.url.meta.text?n.url.meta.text:n.url.value;return I.some({text:t})}return I.none()}(n()):(o=["anchor","link"],i=r.name,-1<j(o,i)?function(n,r){var o,i,u=(o=t,i=r.name,"link"===i?o.catalogs.link:"anchor"===i?o.catalogs.anchor:I.none()).getOr([]);return function(n,t,e,r){var o,i,u=r[t],c=0<n.length;return void 0!==u?(o=u,i=e,Y(i,(function(n){return I.some(n).filter((function(n){return n.value===o}))}))).map((function(t){return{url:{value:t.value,meta:{text:c?n:t.text,attach:b}},text:c?n:t.text}})):I.none()}(e.get(),r.name,u,n)}(n(),r):("text"===r.name&&e.set(n().text),I.none()));var o,i}}},an=function(){return(an=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}).apply(this,arguments)},ln={},fn={exports:ln};u=ln,c=fn,function(n){"object"==typeof u&&void 0!==c?c.exports=n():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}((function(){return function n(t,e,r){function o(u,c){if(!e[u]){if(!t[u]){if(i)return i(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var l=e[u]={exports:{}};t[u][0].call(l.exports,(function(n){return o(t[u][1][n]||n)}),l,l.exports,n,t,e,r)}return e[u].exports}for(var i=!1,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,t,e){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var l,f=[],s=!1,m=-1;function d(){s&&l&&(s=!1,l.length?f=l.concat(f):m=-1,f.length&&h())}function h(){if(!s){var n=a(d);s=!0;for(var t=f.length;t;){for(l=f,f=[];++m<t;)l&&l[m].run();m=-1,t=f.length}l=null,s=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{return o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function v(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];f.push(new p(n,t)),1!==f.length||s||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){!function(e){var r=setTimeout;function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function u(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(n){return void a(t.promise,n)}c(t.promise,r)}else(1===n._state?c:a)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof i)return n._state=3,n._value=t,void l(n);if("function"==typeof e)return void s(function(n,t){return function(){n.apply(t,arguments)}}(e,t),n)}n._state=1,n._value=t,l(n)}catch(t){a(n,t)}}function a(n,t){n._state=2,n._value=t,l(n)}function l(n){2===n._state&&0===n._deferreds.length&&i._immediateFn((function(){n._handled||i._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)u(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function s(n,t){var e=!1;try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,a(t,n))}))}catch(n){if(e)return;e=!0,a(t,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,t){var e=new this.constructor(o);return u(this,new f(n,t,e)),e},i.all=function(n){var t=Array.prototype.slice.call(n);return new i((function(n,e){if(0===t.length)return n([]);var r=t.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),e)}t[i]=u,0==--r&&n(t)}catch(n){e(n)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i((function(t){t(n)}))},i.reject=function(n){return new i((function(t,e){e(n)}))},i.race=function(n){return new i((function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)}))},i._immediateFn="function"==typeof n?function(t){n(t)}:function(n){r(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function l(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new l(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new l(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;0<=t&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[t]=!0,o((function(){c[t]&&(r?n.apply(null,r):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}));var sn=fn.exports.boltExport,mn=function(t){var e=I.none(),r=[],o=function(n){i()?u(n):r.push(n)},i=function(){return e.isSome()},u=function(t){e.each((function(e){n.setTimeout((function(){t(e)}),0)}))};return t((function(n){e=I.some(n),function(n){S(n,u)}(r),r=[]})),{get:o,map:function(n){return mn((function(t){o((function(e){t(n(e))}))}))},isReady:i}},dn={nu:mn,pure:function(n){return mn((function(t){t(n)}))}},hn=function(t){n.setTimeout((function(){throw t}),0)},pn=function(n){var t=function(t){n().then(t,hn)};return{map:function(t){return pn((function(){return n().then(t)}))},bind:function(t){return pn((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return pn((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return dn.nu(t)},toCached:function(){var t=null;return pn((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},vn=function(n){return pn((function(){return new sn(n)}))},gn=tinymce.util.Tools.resolve("tinymce.util.Delay"),yn=function(n){var t=n.href;return 0<t.indexOf("@")&&-1===t.indexOf("//")&&-1===t.indexOf("mailto:")?I.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(n){return an({},n,{href:"mailto:"+t})}}):I.none()},wn=function(n){var t=function(n){var t=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o,n)}return r}(n,(function(n){var t=n.name||n.id;return t?[{text:t,value:"#"+t}]:[]}));return R(t)}(n.dom.select("a:not([href])"));return 0<t.length?I.some([{text:"None",value:""}].concat(t)):I.none()},xn=function(n){var t=function(n){return n.getParam("link_class_list",[],"array")}(n);return 0<t.length?tn(t):I.none()},kn=tinymce.util.Tools.resolve("tinymce.util.XHR"),bn=function(n,t){var e=g(n);if(0<e.length){var r=t.is("_blank");return(!1===w(n)?en((function(n){return X(on(n),r)})):tn)(e)}return I.none()},_n=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Tn=function(n){var t=function(n){return n.getParam("target_list",!0)}(n);return m(t)?tn(t).orThunk((function(){return I.some(_n)})):!1===t?I.none():I.some(_n)},On=function(n,t,e){var r=n.getAttrib(t,e);return null!==r&&0<r.length?I.some(r):I.none()},An=function(n,t){return function(n){var t=function(t){return n.convertURL(t.value||t.url,"href")},e=function(n){return n.getParam("link_list")}(n);return vn((function(n){s(e)?kn.send({url:e,success:function(t){return n(function(n){try{return I.some(JSON.parse(n))}catch(n){return I.none()}}(t))},error:function(t){return n(I.none())}}):h(e)?e((function(t){return n(I.some(t))})):n(I.from(e))})).map((function(n){return n.bind(en(t)).map((function(n){return 0<n.length?[{text:"None",value:""}].concat(n):n}))}))}(n).map((function(e){var r,o,i,u,c,a,l,f,s=(o=t,i=(r=n).dom,u=G(r.selection.getContent())?I.some(W(r.selection,o)):I.none(),c=o?I.some(i.getAttrib(o,"href")):I.none(),a=o?I.from(i.getAttrib(o,"target")):I.none(),l=On(i,o,"rel"),f=On(i,o,"class"),{url:c,text:u,title:On(i,o,"title"),target:a,rel:l,linkClass:f});return{anchor:s,catalogs:{targets:Tn(n),rels:bn(n,s.target),classes:xn(n),anchor:wn(n),link:e},optNode:I.from(t),flags:{titleEnabled:y(n)}}}))},Cn=function(n,t){return n.dom.getParent(t,"a[href]")},Pn=function(n){return Cn(n,n.selection.getStart())},Nn=function(t,e){if(e){var r=$(e);if(/^#/.test(r)){var o=t.$(r);o.length&&t.selection.scrollIntoView(o[0],!0)}else!function(t){if(!k.ie||10<k.ie){var e=n.document.createElement("a");e.target="_blank",e.href=t,e.rel="noreferrer noopener";var r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null),u=e,c=r,n.document.body.appendChild(u),u.dispatchEvent(c),n.document.body.removeChild(u)}else{var o=n.window.open("","_blank");if(o){o.opener=null;var i=o.document;i.open(),i.write('<meta http-equiv="refresh" content="0; url='+x.DOM.encode(t)+'">'),i.close()}}var u,c}(e.href)}},En=function(n){return function(){!function(n){var t,e;(e=J(t=n),An(t,e)).map((function(t){var e,r,o,i,u,c,a,l,f,s,m,d,h,g=(r=t,o=p(e=n),function(n){var t=n.getData();if(!t.url.value)return V(e),void n.close();var i=function(n){return I.from(t[n]).filter((function(t){return!r.anchor[n].is(t)}))},u={href:t.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},c={href:t.url.value,attach:void 0!==t.url.meta&&t.url.meta.attach?t.url.meta.attach:function(){}};(function(n,t,e){return Y([yn,(r=t,function(n){var t=n.href;return 1===r&&!Q(t)||0===r&&/^\s*www[\.|\d\.]/i.test(t)?I.some({message:"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",preprocess:function(n){return an({},n,{href:"http://"+t})}}):I.none()})],(function(n){return n(e)})).fold((function(){return function(n){return pn((function(){return sn.resolve(n)}))}(e)}),(function(t){return vn((function(r){var o,i,u,c;o=n,i=t.message,u=function(n){r(n?t.preprocess(e):e)},c=o.selection.getRng(),gn.setEditorTimeout(o,(function(){o.windowManager.confirm(i,(function(n){o.selection.setRng(c),u(n)}))}))}))}));var r})(e,o,u).get((function(n){z(e,c,n)})),n.close()});return u=g,c=n,f=(i=t).anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),s=i.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],l=I.from(v(c)),m={url:{value:(a=i).anchor.url.getOr(""),meta:{attach:function(){},text:a.anchor.url.fold((function(){return""}),(function(){return a.anchor.text.getOr("")})),original:{value:a.anchor.url.getOr("")}}},text:a.anchor.text.getOr(""),title:a.anchor.title.getOr(""),anchor:a.anchor.url.getOr(""),link:a.anchor.url.getOr(""),rel:a.anchor.rel.getOr(""),target:a.anchor.target.or(l).getOr(""),linkClass:a.anchor.linkClass.getOr("")},d=cn(m,i),h=i.catalogs,{title:"Insert/Edit Link",size:"normal",body:{type:"panel",items:R([[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],f,s,function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t}([h.anchor.map(rn("anchor","Anchors")),h.rels.map(rn("rel","Rel")),h.targets.map(rn("target","Open link in...")),h.link.map(rn("link","Link list")),h.classes.map(rn("linkClass","Class"))])])},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:m,onChange:function(n,t){var e=t.name;d.onChange(n.getData,{name:e}).each((function(t){n.setData(t)}))},onSubmit:u}})).get((function(t){n.windowManager.open(t)}))}(n)}},In=function(n){return function(){Nn(n,Pn(n))}},jn=function(n){return function(t){var e=function(e){return t.setActive(!n.readonly&&!!J(n,e.element))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}},Sn=function(n){return function(t){t.setDisabled(!H(n.dom.getParents(n.selection.getStart())));var e=function(n){return t.setDisabled(!H(n.parents))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}};a.add("link",(function(n){(function(n){n.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:En(n),onSetup:jn(n)}),n.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return V(n)},onSetup:Sn(n)})})(n),function(n){n.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:In(n),onSetup:Sn(n)}),n.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:En(n)}),n.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return V(n)},onSetup:Sn(n)})}(n),function(n){n.ui.registry.addContextMenu("link",{update:function(t){return H(n.dom.getParents(t,"a"))?"link unlink openlink":"link"}})}(n),function(n){var t=function(t){var e=n.selection.getNode();return t.setDisabled(!J(n,e)),function(){}};n.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:jn(n)},label:"Link",predicate:function(t){return!!J(n,t)&&function(n){return n.getParam("link_context_toolbar",!1,"boolean")}(n)},initValue:function(){var t=J(n);return t?$(t):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(t){var e=n.selection.getNode();return t.setActive(!!J(n,e)),jn(n)(t)},onAction:function(t){var e=J(n),r=t.getValue();if(e)n.dom.setAttrib(e,"href",r),n.selection.collapse(!1),t.hide();else{var o={href:r,attach:function(){}},i=G(n.selection.getContent())?I.some(W(n.selection,e)).filter((function(n){return 0<n.length})).or(I.from(r)):I.none();z(n,o,{href:r,text:i,title:I.none(),rel:I.none(),target:I.none(),class:I.none()}),t.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:t,onAction:function(t){V(n),t.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:t,onAction:function(t){In(n)(),t.hide()}}]})}(n),function(n){n.on("click",(function(t){var e=Cn(n,t.target);e&&l.metaKeyPressed(t)&&(t.preventDefault(),Nn(n,e))})),n.on("keydown",(function(t){var e,r=Pn(n);r&&13===t.keyCode&&!0===(e=t).altKey&&!1===e.shiftKey&&!1===e.ctrlKey&&!1===e.metaKey&&(t.preventDefault(),Nn(n,r))}))}(n),function(n){n.addCommand("mceLink",(function(){!function(n){return n.getParam("link_quicklink",!1,"boolean")}(n)?En(n)():n.fire("contexttoolbar-show",{toolbarKey:"quicklink"})}))}(n),function(n){n.addShortcut("Meta+K","",(function(){n.execCommand("mceLink")}))}(n)}))}(window);