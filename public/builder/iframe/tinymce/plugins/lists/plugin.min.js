!function(e){"use strict";var t,n,r,o,i,u,a,s,c=tinymce.util.Tools.resolve("tinymce.PluginManager"),f=function(e){return function(){return e}},l=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}},d=f(!1),m=f(!0),g=d,p=m,v=function(){return h},h=(o={fold:function(e,t){return e()},is:g,isSome:g,isNone:p,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:r,orThunk:n,map:v,ap:v,each:function(){},bind:v,flatten:v,exists:g,forall:p,filter:v,equals:t=function(e){return e.isNone()},equals_:t,toArray:function(){return[]},toString:f("none()")},Object.freeze&&Object.freeze(o),o),y=function(e){var t=function(){return e},n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:p,isNone:g,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return y(t(e))},ap:function(t){return t.fold(v,(function(t){return y(t(e))}))},each:function(t){t(e)},bind:r,flatten:t,exists:r,forall:r,filter:function(t){return t(e)?o:h},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(g,(function(t){return n(e,t)}))},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},N={some:y,none:v,from:function(e){return null==e?h:y(e)}},S=function(e){return function(t){return function(e){if(null===e)return"null";var t=typeof e;return"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t}(t)===e}},O=S("string"),C=S("array"),b=S("boolean"),L=S("function"),T=S("number"),E=Array.prototype.slice,D=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o,e)}return r},A=function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n,e)},k=function(e,t){for(var n=[],r=0,o=e.length;r<o;r++){var i=e[r];t(i,r,e)&&n.push(i)}return n},w=function(e,t,n){return A(e,(function(e){n=t(n,e)})),n},x=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];if(t(o,n,e))return N.some(o)}return N.none()},R=Array.prototype.push,I=function(e,t){return function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!C(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);R.apply(t,e[n])}return t}(D(e,t))},_=function(e){return 0===e.length?N.none():N.some(e[0])},B=function(e){return 0===e.length?N.none():N.some(e[e.length-1])},P=(L(Array.from)&&Array.from,function(e,t,n){return!!(e.compareDocumentPosition(t)&n)}),M=function(){return U(0,0)},U=function(e,t){return{major:e,minor:t}},F=function(e,t){var n=String(t).toLowerCase();return 0===e.length?M():function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.test(t))return r}}(e,t);if(!n)return{major:0,minor:0};var r=function(e){return Number(t.replace(n,"$"+e))};return U(r(1),r(2))}(e,n)},j=M,$="Edge",q="Chrome",H="Opera",V="Firefox",z="Safari",K=function(e,t){return function(){return t===e}},W=function(e){var t=e.current;return{current:t,version:e.version,isEdge:K($,t),isChrome:K(q,t),isIE:K("IE",t),isOpera:K(H,t),isFirefox:K(V,t),isSafari:K(z,t)}},X=function(){return W({current:void 0,version:j()})},Q=W,Y=(f($),f(q),f("IE"),f(H),f(V),f(z),"Windows"),G="Android",J="Solaris",Z="FreeBSD",ee=function(e,t){return function(){return t===e}},te=function(e){var t=e.current;return{current:t,version:e.version,isWindows:ee(Y,t),isiOS:ee("iOS",t),isAndroid:ee(G,t),isOSX:ee("OSX",t),isLinux:ee("Linux",t),isSolaris:ee(J,t),isFreeBSD:ee(Z,t)}},ne=function(){return te({current:void 0,version:j()})},re=te,oe=(f(Y),f("iOS"),f(G),f("Linux"),f("OSX"),f(J),f(Z),function(e,t){var n=String(t).toLowerCase();return x(e,(function(e){return e.search(n)}))}),ie=function(e,t){return-1!==e.indexOf(t)},ue=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ae=function(e){return function(t){return ie(t,e)}},se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return ie(e,"edge/")&&ie(e,"chrome")&&ie(e,"safari")&&ie(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ue],search:function(e){return ie(e,"chrome")&&!ie(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return ie(e,"msie")||ie(e,"trident")}},{name:"Opera",versionRegexes:[ue,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ae("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ae("firefox")},{name:"Safari",versionRegexes:[ue,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(ie(e,"safari")||ie(e,"mobile/"))&&ie(e,"applewebkit")}}],ce=[{name:"Windows",search:ae("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return ie(e,"iphone")||ie(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ae("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ae("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ae("linux"),versionRegexes:[]},{name:"Solaris",search:ae("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ae("freebsd"),versionRegexes:[]}],fe={browsers:f(se),oses:f(ce)},le={detect:(a=!(i=function(){return function(e){var t,n,r,o,i,u,a,s,c,l,d,m=fe.browsers(),g=fe.oses(),p=function(e,t){return oe(e,t).map((function(e){var n=F(e.versionRegexes,t);return{current:e.name,version:n}}))}(m,e).fold(X,Q),v=function(e,t){return oe(e,t).map((function(e){var n=F(e.versionRegexes,t);return{current:e.name,version:n}}))}(g,e).fold(ne,re);return{browser:p,os:v,deviceType:(n=p,r=e,o=(t=v).isiOS()&&!0===/ipad/i.test(r),i=t.isiOS()&&!o,u=t.isAndroid()&&3===t.version.major,a=t.isAndroid()&&4===t.version.major,s=o||u||a&&!0===/mobile/i.test(r),c=t.isiOS()||t.isAndroid(),l=c&&!s,d=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),{isiPad:f(o),isiPhone:f(i),isTablet:f(s),isPhone:f(l),isTouch:f(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:f(d)})}}(e.navigator.userAgent)}),function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a||(a=!0,u=i.apply(null,e)),u})},de=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:f(e)}},me=function(t,n){var r=(n||e.document).createElement(t);return de(r)},ge=de,pe=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE,e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),ve=(e.Node.TEXT_NODE,e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,pe),he=function(e,t){return e.dom()===t.dom()},ye=le.detect().browser.isIE()?function(t,n){return function(t,n){return P(t,n,e.Node.DOCUMENT_POSITION_CONTAINED_BY)}(t.dom(),n.dom())}:function(e,t){var n=e.dom(),r=t.dom();return n!==r&&n.contains(r)},Ne=function(e,t){var n=e.dom();if(n.nodeType!==ve)return!1;if(void 0!==n.matches)return n.matches(t);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(t);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Se=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Oe=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Ce=tinymce.util.Tools.resolve("tinymce.util.VK"),be=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(!o.isSome())return N.none();n.push(o.getOrDie())}return N.some(t.apply(null,n))},Le=Object.keys,Te=function(e){var t=e.dom();return N.from(t.parentNode).map(ge)},Ee=function(e){var t=e.dom();return D(t.childNodes,ge)},De=function(e,t){var n=e.dom().childNodes;return N.from(n[t]).map(ge)},Ae=function(e){return De(e,0)},ke=function(e){return De(e,e.dom().childNodes.length-1)},we=(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}("element","offset"),function(e,t){Te(e).each((function(n){n.dom().insertBefore(t.dom(),e.dom())}))}),xe=function(e,t){e.dom().appendChild(t.dom())},Re=function(e,t){A(t,(function(t){xe(e,t)}))},Ie=function(e){var t=e.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},_e=function(e,t,n){return e.fire("ListMutation",{action:t,element:n})},Be=void 0!==e.window?e.window:Function("return this;")(),Pe=function(e,t){return function(e,t){for(var n=null!=t?t:Be,r=0;r<e.length&&null!=n;++r)n=n[e[r]];return n}(e.split("."),t)},Me=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Ue=tinymce.util.Tools.resolve("tinymce.util.Tools"),Fe=function(e){return e&&"BR"===e.nodeName},je=function(e){return e&&3===e.nodeType},$e=function(e){return e&&/^(OL|UL|DL)$/.test(e.nodeName)},qe=function(e){return e&&/^(OL|UL)$/.test(e.nodeName)},He=function(e){return e&&/^(DT|DD)$/.test(e.nodeName)},Ve=function(e){return e&&/^(TH|TD)$/.test(e.nodeName)},ze=Fe,Ke=function(e,t){return t&&!!e.schema.getTextBlockElements()[t.nodeName]},We=function(e,t){return e&&e.nodeName in t},Xe=function(e,t,n){var r=e.isEmpty(t);return!(n&&0<e.select("span[data-mce-type=bookmark]",t).length)&&r},Qe=function(e,t){return e.isChildOf(t,e.getRoot())},Ye=function(e){var t=e.selection.getStart(!0);return e.dom.getParent(t,"OL,UL,DL",Je(e,t))},Ge=function(e){var t,n,r,o=e.selection.getSelectedBlocks();return Ue.grep((t=e,n=o,r=Ue.map(n,(function(e){return t.dom.getParent(e,"li,dd,dt",Je(t,e))||e})),Me.unique(r)),(function(e){return function(e){return e&&/^(LI|DT|DD)$/.test(e.nodeName)}(e)}))},Je=function(e,t){var n=e.dom.getParents(t,"TD,TH");return 0<n.length?n[0]:e.getBody()},Ze=function(e,t){var n=e.dom.getParents(t,"ol,ul",Je(e,t));return B(n)},et={isList:function(e){return function(e){var t;return(t=Pe("ownerDocument.defaultView",e),function(e,t){var n=Pe(e,t);if(null==n)throw new Error(e+" not available on this browser");return n}("HTMLElement",t)).prototype.isPrototypeOf(e)}(Ye(e))},getParentList:Ye,getSelectedSubLists:function(e){var t,n,r,o=Ye(e),i=e.selection.getSelectedBlocks();return r=i,(n=o)&&1===r.length&&r[0]===n?(t=o,Ue.grep(t.querySelectorAll("ol,ul,dl"),(function(e){return $e(e)}))):Ue.grep(i,(function(e){return $e(e)&&o!==e}))},getSelectedListItems:Ge,getClosestListRootElm:Je,getSelectedDlItems:function(e){return k(Ge(e),He)},getSelectedListRoots:function(e){var t,n,r;return function(e,t){var n=D(t,(function(t){return Ze(e,t).getOr(t)}));return Me.unique(n)}(e,(n=Ze(t=e,t.selection.getStart()),r=k(t.selection.getSelectedBlocks(),qe),n.toArray().concat(r)))}},tt=tinymce.util.Tools.resolve("tinymce.Env"),nt=function(e,t){var n,r,o,i,u=e.dom,a=e.schema.getBlockElements(),s=u.createFragment();if(e.settings.forced_root_block&&(o=e.settings.forced_root_block),o&&((r=u.create(o)).tagName===e.settings.forced_root_block&&u.setAttribs(r,e.settings.forced_root_block_attrs),We(t.firstChild,a)||s.appendChild(r)),t)for(;n=t.firstChild;){var c=n.nodeName;i||"SPAN"===c&&"bookmark"===n.getAttribute("data-mce-type")||(i=!0),We(n,a)?(s.appendChild(n),r=null):o?(r||(r=u.create(o),s.appendChild(r)),r.appendChild(n)):s.appendChild(n)}return e.settings.forced_root_block?i||tt.ie&&!(10<tt.ie)||r.appendChild(u.create("br",{"data-mce-bogus":"1"})):s.appendChild(u.create("br")),s},rt=function(e){return e.dom().nodeName.toLowerCase()},ot=function(t,n){var r=t.dom();!function(e,t){for(var n=Le(e),r=0,o=n.length;r<o;r++){var i=n[r];t(e[i],i)}}(n,(function(t,n){!function(t,n,r){if(!(O(r)||b(r)||T(r)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,r+"")}(r,n,t)}))},it=function(e){return w(e.dom().attributes,(function(e,t){return e[t.name]=t.value,e}),{})},ut=function(t,n,r){if(!O(r))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);var o;void 0!==(o=t).style&&L(o.style.getPropertyValue)&&t.style.setProperty(n,r)},at=function(e){return ge(e.dom().cloneNode(!0))},st=function(e,t){var n,r,o,i=(n=e,r=me(t),o=it(n),ot(r,o),r);we(e,i);var u=Ee(e);return Re(i,u),Ie(e),i},ct=function(e,t){xe(e.item,t.list)},ft=function(e){return Ne(e,"OL,UL")},lt=function(e){return Ae(e).map(ft).getOr(!1)},dt=function(e){return 0<e.depth},mt=function(e){return e.isSelected},gt=function(e){var t=Ee(e),n=ke(e).map(ft).getOr(!1)?t.slice(0,-1):t;return D(n,at)},pt=Object.prototype.hasOwnProperty,vt=(s=function(e,t){return t},function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<e.length;r++){var o=e[r];for(var i in o)pt.call(o,i)&&(n[i]=s(n[i],o[i]))}return n}),ht=function(e){var t=e,n=function(){return t};return{get:n,set:function(e){t=e},clone:function(){return ht(n())}}},yt=function(e,t,n,r){return Ae(r).filter(ft).fold((function(){t.each((function(e){he(e.start,r)&&n.set(!0)}));var o,i,u,a=(o=r,i=e,u=n.get(),Te(o).map((function(e){return{depth:i,isSelected:u,content:gt(o),itemAttributes:it(o),listAttributes:it(e),listType:rt(e)}})));t.each((function(e){he(e.end,r)&&n.set(!1)}));var s=ke(r).filter(ft).map((function(r){return Nt(e,t,n,r)})).getOr([]);return a.toArray().concat(s)}),(function(r){return Nt(e,t,n,r)}))},Nt=function(e,t,n,r){return I(Ee(r),(function(r){return(ft(r)?Nt:yt)(e+1,t,n,r)}))},St=function(t,n){return D(n,(function(n){var r,o,i=(r=n.content,o=e.document.createDocumentFragment(),A(r,(function(e){o.appendChild(e.dom())})),ge(o));return ge(nt(t,i.dom()))}))},Ot=function(e,t,n){var r,o,i,u=(r=t,o=function(e){var t,n,r=D(et.getSelectedListItems(e),ge);return be([x(r,l(lt)),x((t=r,n=E.call(t,0),n.reverse(),n),l(lt))],(function(e,t){return{start:e,end:t}}))}(e),i=ht(!1),D(r,(function(e){return{sourceList:e,entries:Nt(0,o,i,e)}})));A(u,(function(t){var r,o;r=t.entries,o=n,A(k(r,mt),(function(e){return function(e,t){switch(e){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}}(o,e)}));var i,u,a,s=(i=e,u=t.entries,I(function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,u=e.length;i<u;i++){var a=e[i],s=t(a);s!==n&&(r.push(o),o=[]),n=s,o.push(a)}return 0!==o.length&&r.push(o),r}(u,dt),(function(e){return _(e).map(dt).getOr(!1)?function(e,t){return function(e){A(e,(function(t,n){(function(e,t){for(var n=e[t].depth,r=t-1;0<=r;r--){if(e[r].depth===n)return N.some(e[r]);if(e[r].depth<n)break}return N.none()})(e,n).each((function(e){var n,r;r=e,(n=t).listType=r.listType,n.listAttributes=vt({},r.listAttributes)}))}))}(t),(n=e.contentDocument,r=t,o=w(r,(function(e,t){return t.depth>e.length?function(e,t,n){var r,o=function(e,t,n){for(var r,o,i,u=[],a=0;a<n;a++)u.push((r=e,o=t.listType,i={list:me(o,r),item:me("li",r)},xe(i.list,i.item),i));return u}(e,n,n.depth-t.length);return function(e){for(var t=1;t<e.length;t++)ct(e[t-1],e[t])}(o),function(e,t){for(var n=0;n<e.length-1;n++)r=e[n].item.dom(),ut(r,"list-style-type","none");var r;B(e).each((function(e){ot(e.list,t.listAttributes),ot(e.item,t.itemAttributes),Re(e.item,t.content)}))}(o,n),r=o,be([B(t),_(r)],ct),t.concat(o)}(n,e,t):function(e,t,n){var r=t.slice(0,n.depth);return B(r).each((function(t){var r,o,i,u,a,s,c,f;r=e,o=n.itemAttributes,i=n.content,u=me("li",r),ot(u,o),Re(u,i),s=u,xe((a=t).list,s),a.item=s,f=n,rt((c=t).list)!==f.listType&&(c.list=st(c.list,f.listType)),ot(c.list,f.listAttributes)})),r}(n,e,t)}),[]),_(o).map((function(e){return e.list}))).toArray();var n,r,o}(i,e):St(i,e)})));A(s,(function(t){_e(e,"Indent"===n?"IndentList":"OutdentList",t.dom())})),a=t.sourceList,A(s,(function(e){we(a,e)})),Ie(t.sourceList)}))},Ct=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),bt=Ct.DOM,Lt=function(e){Ne(e,"DT")&&st(e,"DD")},Tt=function(e,t){if(je(e))return{container:e,offset:t};var n=Se.getNode(e,t);return je(n)?{container:n,offset:t>=e.childNodes.length?n.data.length:0}:n.previousSibling&&je(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&je(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:e,offset:t}},Et=function(e){var t=e.cloneRange(),n=Tt(e.startContainer,e.startOffset);t.setStart(n.container,n.offset);var r=Tt(e.endContainer,e.endOffset);return t.setEnd(r.container,r.offset),t},Dt=function(e,t){var n=D(et.getSelectedListRoots(e),ge),r=D(et.getSelectedDlItems(e),ge),o=!1;if(n.length||r.length){var i=e.selection.getBookmark();Ot(e,n,t),function(e,t,n){A(n,"Indent"===t?Lt:function(t){return n=e,void(Ne(r=t,"DD")?st(r,"DT"):Ne(r,"DT")&&Te(r).each((function(e){return function(e,t,n){var r,o,i,u,a,s;for(i=bt.select('span[data-mce-type="bookmark"]',t),a=nt(e,n),(r=bt.createRng()).setStartAfter(n),r.setEndAfter(t),u=(o=r.extractContents()).firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&e.dom.isEmpty(u)){bt.remove(u);break}e.dom.isEmpty(o)||bt.insertAfter(o,t),bt.insertAfter(a,t),Xe(e.dom,n.parentNode)&&(s=n.parentNode,Ue.each(i,(function(e){s.parentNode.insertBefore(e,n.parentNode)})),bt.remove(s)),bt.remove(n),Xe(e.dom,t)&&bt.remove(t)}(n,e.dom(),r.dom())})));var n,r})}(e,t,r),e.selection.moveToBookmark(i),e.selection.setRng(Et(e.selection.getRng())),e.nodeChanged(),o=!0}return o},At=function(e){return Dt(e,"Indent")},kt=function(e){return Dt(e,"Outdent")},wt=function(e){return Dt(e,"Flatten")},xt=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),Rt=Ct.DOM,It=function(e){var t={},n=function(n){var r,o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(r=Rt.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):Rt.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),t[n?"startContainer":"endContainer"]=o,t[n?"startOffset":"endOffset"]=i};return n(!0),e.collapsed||n(),t},_t=function(e){function t(t){var n,r,o;n=o=e[t?"startContainer":"endContainer"],r=e[t?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=function(e){for(var t=e.parentNode.firstChild,n=0;t;){if(t===e)return n;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||n++,t=t.nextSibling}return-1}(n),n=n.parentNode,Rt.remove(o),!n.hasChildNodes()&&Rt.isBlock(n)&&n.appendChild(Rt.create("br"))),e[t?"startContainer":"endContainer"]=n,e[t?"startOffset":"endOffset"]=r)}t(!0),t();var n=Rt.createRng();return n.setStart(e.startContainer,e.startOffset),e.endContainer&&n.setEnd(e.endContainer,e.endOffset),Et(n)},Bt=function(e){return/\btox\-/.test(e.className)},Pt=function(e){switch(e){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},Mt=function(e,t){Ue.each(t,(function(t,n){e.setAttribute(n,t)}))},Ut=function(e,t,n){var r,o,i,u,a,s,c;r=e,o=t,u=(i=n)["list-style-type"]?i["list-style-type"]:null,r.setStyle(o,"list-style-type",u),a=e,Mt(s=t,(c=n)["list-attributes"]),Ue.each(a.select("li",s),(function(e){Mt(e,c["list-item-attributes"])}))},Ft=function(e,t,n,r){var o,i;for(o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&ze(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(Ke(e,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},jt=function(e,t,n){return s=n,(a=t)&&s&&$e(a)&&a.nodeName===s.nodeName&&(i=t,u=n,(o=e).getStyle(i,"list-style-type",!0)===o.getStyle(u,"list-style-type",!0))&&(r=n,t.className===r.className);var r,o,i,u,a,s},$t=function(e,t){var n,r;if(n=t.nextSibling,jt(e,t,n)){for(;r=n.firstChild;)t.appendChild(r);e.remove(n)}if(n=t.previousSibling,jt(e,t,n)){for(;r=n.lastChild;)t.insertBefore(r,t.firstChild);e.remove(n)}},qt=function(e){return"list-style-type"in e},Ht=function(e,t,n){var r=et.getParentList(e),o=et.getSelectedSubLists(e);n=n||{},r&&0<o.length?function(e,t,n,r,o){if(t.nodeName!==r||qt(o)){var i=It(e.selection.getRng(!0));Ue.each([t].concat(n),(function(t){!function(e,t,n,r){if(t.nodeName!==n){var o=e.dom.rename(t,n);Ut(e.dom,o,r),_e(e,Pt(n),o)}else Ut(e.dom,t,r),_e(e,Pt(n),t)}(e,t,r,o)})),e.selection.setRng(_t(i))}else wt(e)}(e,r,o,t,n):function(e,t,n,r){if(t!==e.getBody())if(t)if(t.nodeName!==n||qt(r)||Bt(t)){var o=It(e.selection.getRng(!0));Ut(e.dom,t,r);var i=e.dom.rename(t,n);$t(e.dom,i),e.selection.setRng(_t(o)),_e(e,Pt(n),i)}else wt(e);else(function(e,t,n){void 0===n&&(n={});var r,o=e.selection.getRng(!0),i="LI",u=et.getClosestListRootElm(e,e.selection.getStart(!0)),a=e.dom;"false"!==a.getContentEditable(e.selection.getNode())&&("DL"===(t=t.toUpperCase())&&(i="DT"),r=It(o),Ue.each(function(e,t,n){for(var r,o=[],i=e.dom,u=Ft(e,t,!0,n),a=Ft(e,t,!1,n),s=[],c=u;c&&(s.push(c),c!==a);c=c.nextSibling);return Ue.each(s,(function(t){if(Ke(e,t))return o.push(t),void(r=null);if(i.isBlock(t)||ze(t))return ze(t)&&i.remove(t),void(r=null);var u=t.nextSibling;xt.isBookmarkNode(t)&&(Ke(e,u)||!u&&t.parentNode===n)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))})),o}(e,o,u),(function(r){var o,u,s,c,f,l,d,m;(u=r.previousSibling)&&$e(u)&&u.nodeName===t&&(s=u,c=n,a.getStyle(s,"list-style-type")===(f=null===(f=c?c["list-style-type"]:"")?"":f))?(o=u,r=a.rename(r,i),u.appendChild(r)):(o=a.create(t),r.parentNode.insertBefore(o,r),o.appendChild(r),r=a.rename(r,i)),l=a,d=r,m=["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"],Ue.each(m,(function(e){var t;return l.setStyle(d,((t={})[e]="",t))})),Ut(a,o,n),$t(e.dom,o)})),e.selection.setRng(_t(r)))})(e,n,r),_e(e,Pt(n),t)}(e,r,t,n)},Vt=$t,zt=Ct.DOM,Kt=function(e,t,n,r){var o=t.startContainer,i=t.startOffset;if(je(o)&&(n?i<o.data.length:0<i))return o;var u=e.schema.getNonEmptyElements();1===o.nodeType&&(o=Se.getNode(o,i));var a=new Oe(o,r);for(n&&function(e,t){return!!Fe(t)&&!(!e.isBlock(t.nextSibling)||Fe(t.previousSibling))}(e.dom,o)&&a.next();o=a[n?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(je(o)&&0<o.data.length)return o}},Wt=function(e,t){var n=t.childNodes;return 1===n.length&&!$e(n[0])&&e.isBlock(n[0])},Xt=function(e,t,n){var r,o,i=t.parentNode;if(Qe(e,t)&&Qe(e,n)){$e(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&ze(i.previousSibling)&&e.remove(i.previousSibling),(r=n.lastChild)&&ze(r)&&t.hasChildNodes()&&e.remove(r),Xe(e,n,!0)&&e.$(n).empty(),function(e,t,n){var r,o,i,u;if(o=Wt(e,n)?n.firstChild:n,Wt(i=e,u=t)&&i.remove(u.firstChild,!0),!Xe(e,t,!0))for(;r=t.firstChild;)o.appendChild(r)}(e,t,n),o&&n.appendChild(o);var u=ye(ge(n),ge(t))?e.getParents(t,$e,n):[];e.remove(t),A(u,(function(t){Xe(e,t)&&t!==e.getRoot()&&e.remove(t)}))}},Qt=function(e,t){return e.selection.isCollapsed()?function(e,t){return function(e,t){var n=e.dom,r=e.selection,o=r.getStart(),i=et.getClosestListRootElm(e,o),u=n.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===e.getBody()&&Xe(n,a))return!0;var s=Et(r.getRng()),c=n.getParent(Kt(e,s,t,i),"LI",i);if(c&&c!==u)return e.undoManager.transact((function(){t?function(e,t,n,r){var o,i,u,a=e.dom;if(a.isEmpty(r))i=n,u=r,(o=e).dom.$(u).empty(),Xt(o.dom,i,u),o.selection.setCursorLocation(u);else{var s=It(t);Xt(a,n,r),e.selection.setRng(_t(s))}}(e,s,c,u):function(e){return e.parentNode.firstChild===e}(u)?kt(e):function(e,t,n,r){var o=It(t);Xt(e.dom,n,r);var i=_t(o);e.selection.setRng(i)}(e,s,u,c)})),!0;if(!c&&!t&&0===s.startOffset&&0===s.endOffset)return e.undoManager.transact((function(){wt(e)})),!0}return!1}(e,t)||function(e,t){var n=e.dom,r=e.selection.getStart(),o=et.getClosestListRootElm(e,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var u=Et(e.selection.getRng()),a=n.getParent(Kt(e,u,t,o),"LI",o);if(a)return e.undoManager.transact((function(){var r,u,s,c;u=i,s=o,c=(r=n).getParent(u.parentNode,r.isBlock,s),r.remove(u),c&&r.isEmpty(c)&&r.remove(c),Vt(n,a.parentNode),e.selection.select(a,!0),e.selection.collapse(t)})),!0}return!1}(e,t)}(e,t):(r=(n=e).selection.getStart(),o=et.getClosestListRootElm(n,r),!!(n.dom.getParent(r,"LI,DT,DD",o)||0<et.getSelectedListItems(n).length)&&(n.undoManager.transact((function(){n.execCommand("Delete"),function(e,t){Ue.each(Ue.grep(e.select("ol,ul",t)),(function(t){!function(e,t){var n,r=t.parentNode;"LI"===r.nodeName&&r.firstChild===t&&((n=r.previousSibling)&&"LI"===n.nodeName?(n.appendChild(t),Xe(e,r)&&zt.remove(r)):zt.setStyle(r,"listStyleType","none")),$e(r)&&(n=r.previousSibling)&&"LI"===n.nodeName&&n.appendChild(t)}(e,t)}))}(n.dom,n.getBody())})),!0));var n,r,o},Yt=Qt,Gt=function(e,t){return function(){var n=e.dom.getParent(e.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===t}},Jt=function(e,t){return function(n){var r=function(e){var r=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(e.parents,Ve),o=-1!==r?e.parents.slice(0,r):e.parents,i=Ue.grep(o,$e);n.setActive(0<i.length&&i[0].nodeName===t&&!Bt(i[0]))};return e.on("NodeChange",r),function(){return e.off("NodeChange",r)}}};c.add("lists",(function(e){return function(e){var t;(function(e){return e.getParam("lists_indent_on_tab",!0)})(e)&&(t=e).on("keydown",(function(e){e.keyCode!==Ce.TAB||Ce.metaKeyPressed(e)||t.undoManager.transact((function(){(e.shiftKey?kt(t):At(t))&&e.preventDefault()}))})),function(e){e.on("keydown",(function(t){t.keyCode===Ce.BACKSPACE?Qt(e,!1)&&t.preventDefault():t.keyCode===Ce.DELETE&&Qt(e,!0)&&t.preventDefault()}))}(e)}(e),function(e){var t,n,r=function(t){return function(){return e.execCommand(t)}};n=(t=e).settings.plugins?t.settings.plugins:"",-1===Ue.inArray(n.split(/[ ,]/),"advlist")&&(e.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:r("InsertOrderedList"),onSetup:Jt(e,"OL")}),e.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:r("InsertUnorderedList"),onSetup:Jt(e,"UL")}))}(e),function(e){e.on("BeforeExecCommand",(function(t){var n=t.command.toLowerCase();"indent"===n?At(e):"outdent"===n&&kt(e)})),e.addCommand("InsertUnorderedList",(function(t,n){Ht(e,"UL",n)})),e.addCommand("InsertOrderedList",(function(t,n){Ht(e,"OL",n)})),e.addCommand("InsertDefinitionList",(function(t,n){Ht(e,"DL",n)})),e.addCommand("RemoveList",(function(){wt(e)})),e.addQueryStateHandler("InsertUnorderedList",Gt(e,"UL")),e.addQueryStateHandler("InsertOrderedList",Gt(e,"OL")),e.addQueryStateHandler("InsertDefinitionList",Gt(e,"DL"))}(e),function(e){return{backspaceDelete:function(t){Yt(e,t)}}}(e)}))}(window);