!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.util.Tools");e.add("preview",(function(e){var n;(n=e).addCommand("mcePreview",(function(){var e,i;i=function(e){var n="",i=e.dom.encode,o=function(e){return e.getParam("content_style","")}(e);n+='<base href="'+i(e.documentBaseURI.getURI())+'">',o&&(n+='<style type="text/css">'+o+"</style>");var r=function(e){return e.getParam("content_css_cors",!1,"boolean")}(e)?' crossorigin="anonymous"':"";t.each(e.contentCSS,(function(t){n+='<link type="text/css" rel="stylesheet" href="'+i(e.documentBaseURI.toAbsolute(t))+'"'+r+">"}));var a=e.settings.body_id||"tinymce";-1!==a.indexOf("=")&&(a=(a=e.getParam("body_id","","hash"))[e.id]||a);var c=e.settings.body_class||"";-1!==c.indexOf("=")&&(c=(c=e.getParam("body_class","","hash"))[e.id]||"");var s=e.getBody().dir,d=s?' dir="'+i(s)+'"':"";return"<!DOCTYPE html><html><head>"+n+'</head><body id="'+i(a)+'" class="mce-content-body '+i(c)+'"'+d+">"+e.getContent()+'<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> </body></html>'}(e=n),e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:i}}).focus("close")})),function(e){e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:function(){return e.execCommand("mcePreview")}}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:function(){return e.execCommand("mcePreview")}})}(e)}))}();