!function(t){"use strict";var e=function(t){var n=t,r=function(){return n};return{get:r,set:function(t){n=t},clone:function(){return e(r())}}},n=function(){},r=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var c,a,l,f,s,d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},m=function(t){return t()},g=o(!1),p=o(!0),h=g,v=p,b=function(){return w},w=(f={fold:function(t,e){return t()},is:h,isSome:h,isNone:v,getOr:l=function(t){return t},getOrThunk:a=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:l,orThunk:a,map:b,ap:b,each:function(){},bind:b,flatten:b,exists:h,forall:v,filter:b,equals:c=function(t){return t.isNone()},equals_:c,toArray:function(){return[]},toString:o("none()")},Object.freeze&&Object.freeze(f),f),y=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:v,isNone:h,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return y(e(t))},ap:function(e){return e.fold(b,(function(e){return y(e(t))}))},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:w},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(h,(function(e){return n(t,e)}))},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},x={some:y,none:b,from:function(t){return null==t?w:y(t)}},S=tinymce.util.Tools.resolve("tinymce.PluginManager"),C=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e}(e)===t}},R=C("string"),T=C("array"),D=C("boolean"),O=C("function"),A=C("number"),N=Array.prototype.slice,E=void 0===(s=Array.prototype.indexOf)?function(t,e){return H(t,e)}:function(t,e){return s.call(t,e)},B=function(t,e){return-1<E(t,e)},I=function(t,e){return z(t,e).isSome()},P=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},k=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},M=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},W=function(t,e,n){return function(t,e){for(var n=t.length-1;0<=n;n--)e(t[n])}(t,(function(t){n=e(n,t)})),n},_=function(t,e,n){return k(t,(function(t){n=e(n,t)})),n},j=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return x.some(o)}return x.none()},z=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return x.some(n);return x.none()},H=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},L=Array.prototype.push,F=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!T(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);L.apply(e,t[n])}return e},U=function(t,e){var n=P(t,e);return F(n)},q=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n,t))return!1;return!0},V=(O(Array.from)&&Array.from,Object.keys),G=Object.hasOwnProperty,Y=function(t,e){for(var n=V(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},K=function(t,e){return X(t,(function(t,n,r){return{k:n,v:e(t,n,r)}}))},X=function(t,e){var n={};return Y(t,(function(r,o){var i=e(r,o,t);n[i.k]=i.v})),n},$=function(t,e){return J(t,e)?x.from(t[e]):x.none()},J=function(t,e){return G.call(t,e)},Q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return k(t,(function(t,n){r[t]=o(e[n])})),r}},Z=function(t){return t.slice(0).sort()},tt=function(t,e){throw new Error("All required keys ("+Z(t).join(", ")+") were not specified. Specified keys were: "+Z(e).join(", ")+".")},et=function(t){throw new Error("Unsupported keys for object: "+Z(t).join(", "))},nt=function(t,e){if(!T(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");k(e,(function(e){if(!R(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")}))},rt=function(t){var e=Z(t);j(e,(function(t,n){return n<e.length-1&&t===e[n+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}))},ot=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return nt("required",t),nt("optional",e),rt(n),function(r){var i=V(r);q(t,(function(t){return B(i,t)}))||tt(t,i);var u=M(i,(function(t){return!B(n,t)}));0<u.length&&et(u);var c={};return k(t,(function(t){c[t]=o(r[t])})),k(e,(function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?x.some(r[t]):x.none())})),c}},it=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),ut=t.Node.DOCUMENT_NODE,ct=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),at=t.Node.TEXT_NODE,lt=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,function(t){return t.dom().nodeName.toLowerCase()}),ft=function(t){return t.dom().nodeType},st=function(t){return function(e){return ft(e)===t}},dt=function(t){return ft(t)===it||"#comment"===lt(t)},mt=st(ct),gt=st(at),pt=st(ut),ht=function(e,n,r){if(!(R(r)||D(r)||A(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")},vt=function(t,e,n){ht(t.dom(),e,n)},bt=function(t,e){var n=t.dom();Y(e,(function(t,e){ht(n,e,t)}))},wt=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},yt=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},xt=function(t,e){t.dom().removeAttribute(e)},St=function(t){return _(t.dom().attributes,(function(t,e){return t[e.name]=e.value,t}),{})},Ct=function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e},Rt=function(t,e){return-1!==t.indexOf(e)},Tt=function(t,e){return Ct(t,e,0)},Dt=function(t){return void 0!==t.style&&O(t.style.getPropertyValue)},Ot=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},At=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},Nt={fromHtml:function(e,n){var r=(n||t.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return At(r.childNodes[0])},fromTag:function(e,n){var r=(n||t.document).createElement(e);return At(r)},fromText:function(e,n){var r=(n||t.document).createTextNode(e);return At(r)},fromDom:At,fromPoint:function(t,e,n){var r=t.dom();return x.from(r.elementFromPoint(e,n)).map(At)}},Et=function(t){var e=gt(t)?t.dom().parentNode:t.dom();return null!=e&&e.ownerDocument.body.contains(e)},Bt=Ot((function(){return It(Nt.fromDom(t.document))})),It=function(t){var e=t.dom().body;if(null==e)throw new Error("Body is not available yet");return Nt.fromDom(e)},Pt=function(e,n,r){if(!R(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);Dt(e)&&e.style.setProperty(n,r)},kt=function(t,e,n){var r=t.dom();Pt(r,e,n)},Mt=function(t,e){var n=t.dom();Y(e,(function(t,e){Pt(n,e,t)}))},Wt=function(e,n){var r=e.dom(),o=t.window.getComputedStyle(r).getPropertyValue(n),i=""!==o||Et(e)?o:_t(r,n);return null===i?void 0:i},_t=function(t,e){return Dt(t)?t.style.getPropertyValue(e):""},jt=function(t,e){var n=t.dom(),r=_t(n,e);return x.from(r).filter((function(t){return 0<t.length}))},zt=function(t,e){var n,r,o=t.dom();r=e,Dt(n=o)&&n.style.removeProperty(r),yt(t,"style")&&""===wt(t,"style").replace(/^\s+|\s+$/g,"")&&xt(t,"style")},Ht=function(){return Lt(0,0)},Lt=function(t,e){return{major:t,minor:e}},Ft=function(t,e){var n=String(e).toLowerCase();return 0===t.length?Ht():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return Lt(r(1),r(2))}(t,n)},Ut=Ht,qt="Firefox",Vt=function(t,e){return function(){return e===t}},Gt=function(t){var e=t.current;return{current:e,version:t.version,isEdge:Vt("Edge",e),isChrome:Vt("Chrome",e),isIE:Vt("IE",e),isOpera:Vt("Opera",e),isFirefox:Vt(qt,e),isSafari:Vt("Safari",e)}},Yt=function(){return Gt({current:void 0,version:Ut()})},Kt=Gt,Xt=(o("Edge"),o("Chrome"),o("IE"),o("Opera"),o(qt),o("Safari"),"Windows"),$t="Android",Jt="Solaris",Qt="FreeBSD",Zt=function(t,e){return function(){return e===t}},te=function(t){var e=t.current;return{current:e,version:t.version,isWindows:Zt(Xt,e),isiOS:Zt("iOS",e),isAndroid:Zt($t,e),isOSX:Zt("OSX",e),isLinux:Zt("Linux",e),isSolaris:Zt(Jt,e),isFreeBSD:Zt(Qt,e)}},ee=function(){return te({current:void 0,version:Ut()})},ne=te,re=(o(Xt),o("iOS"),o($t),o("Linux"),o("OSX"),o(Jt),o(Qt),function(t,e){var n=String(e).toLowerCase();return j(t,(function(t){return t.search(n)}))}),oe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ie=function(t){return function(e){return Rt(e,t)}},ue=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Rt(t,"edge/")&&Rt(t,"chrome")&&Rt(t,"safari")&&Rt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,oe],search:function(t){return Rt(t,"chrome")&&!Rt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Rt(t,"msie")||Rt(t,"trident")}},{name:"Opera",versionRegexes:[oe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ie("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ie("firefox")},{name:"Safari",versionRegexes:[oe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Rt(t,"safari")||Rt(t,"mobile/"))&&Rt(t,"applewebkit")}}],ce=[{name:"Windows",search:ie("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Rt(t,"iphone")||Rt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ie("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ie("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ie("linux"),versionRegexes:[]},{name:"Solaris",search:ie("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ie("freebsd"),versionRegexes:[]}],ae={browsers:o(ue),oses:o(ce)},le={detect:Ot((function(){return function(t){var e,n,r,i,u,c,a,l,f,s,d,m=ae.browsers(),g=ae.oses(),p=function(t,e){return re(t,e).map((function(t){var n=Ft(t.versionRegexes,e);return{current:t.name,version:n}}))}(m,t).fold(Yt,Kt),h=function(t,e){return re(t,e).map((function(t){var n=Ft(t.versionRegexes,e);return{current:t.name,version:n}}))}(g,t).fold(ee,ne);return{browser:p,os:h,deviceType:(n=p,r=t,i=(e=h).isiOS()&&!0===/ipad/i.test(r),u=e.isiOS()&&!i,c=e.isAndroid()&&3===e.version.major,a=e.isAndroid()&&4===e.version.major,l=i||c||a&&!0===/mobile/i.test(r),f=e.isiOS()||e.isAndroid(),s=f&&!l,d=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),{isiPad:o(i),isiPhone:o(u),isTablet:o(l),isPhone:o(s),isTouch:o(f),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:o(d)})}}(t.navigator.userAgent)}))},fe=ct,se=ut,de=function(t,e){var n=t.dom();if(n.nodeType!==fe)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},me=function(t){return t.nodeType!==fe&&t.nodeType!==se||0===t.childElementCount},ge=function(t,e){return t.dom()===e.dom()},pe=le.detect().browser.isIE()?function(e,n){return function(e,n){return function(t,e,n){return!!(t.compareDocumentPosition(e)&n)}(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)}(e.dom(),n.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},he=de,ve=function(t){return Nt.fromDom(t.dom().ownerDocument)},be=function(t){var e=t.dom();return x.from(e.parentNode).map(Nt.fromDom)},we=function(t,e){for(var n=O(e)?e:o(!1),r=t.dom(),i=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,c=Nt.fromDom(u);if(i.push(c),!0===n(c))break;r=u}return i},ye=function(t){var e=t.dom();return x.from(e.previousSibling).map(Nt.fromDom)},xe=function(t){var e=t.dom();return x.from(e.nextSibling).map(Nt.fromDom)},Se=function(t){var e=t.dom();return P(e.childNodes,Nt.fromDom)},Ce=function(t,e){var n=t.dom().childNodes;return x.from(n[e]).map(Nt.fromDom)},Re=(Q("element","offset"),function(t,e){be(t).each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))}),Te=function(t,e){xe(t).fold((function(){be(t).each((function(t){Oe(t,e)}))}),(function(t){Re(t,e)}))},De=function(t,e){Ce(t,0).fold((function(){Oe(t,e)}),(function(n){t.dom().insertBefore(e.dom(),n.dom())}))},Oe=function(t,e){t.dom().appendChild(e.dom())},Ae=function(t,e){Re(t,e),Oe(e,t)},Ne=function(t,e){k(e,(function(n,r){var o=0===r?t:e[r-1];Te(o,n)}))},Ee=function(t,e){k(e,(function(e){Oe(t,e)}))},Be=function(t){t.dom().textContent="",k(Se(t),(function(t){Ie(t)}))},Ie=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Pe=function(t){var e,n=Se(t);0<n.length&&(e=t,k(n,(function(t){Re(e,t)}))),Ie(t)},ke=(Q("width","height"),Q("width","height"),Q("rows","columns")),Me=Q("row","column"),We=(Q("x","y"),Q("element","rowspan","colspan")),_e=Q("element","rowspan","colspan","isNew"),je=Q("element","rowspan","colspan","row","column"),ze=Q("element","cells","section"),He=Q("element","isNew"),Le=Q("element","cells","section","isNew"),Fe=Q("cells","section"),Ue=Q("details","section"),qe=Q("startRow","startCol","finishRow","finishCol"),Ve=function(t,e){var n=[];return k(Se(t),(function(t){e(t)&&(n=n.concat([t])),n=n.concat(Ve(t,e))})),n},Ge=function(t,e,n){return r=function(t){return de(t,e)},M(we(t,n),r);var r},Ye=function(e,n){return r=n,i=void 0===(o=e)?t.document:o.dom(),me(i)?[]:P(i.querySelectorAll(r),Nt.fromDom);var r,o,i};function Ke(t,e,n,r,o){return t(n,r)?x.some(n):O(o)&&o(n)?x.none():e(n,r,o)}var Xe=function(t,e,n){for(var r=t.dom(),i=O(n)?n:o(!1);r.parentNode;){r=r.parentNode;var u=Nt.fromDom(r);if(e(u))return x.some(u);if(i(u))break}return x.none()},$e=function(t,e,n){return Xe(t,(function(t){return de(t,e)}),n)},Je=function(t,e){return n=function(t){return de(t,e)},j(t.dom().childNodes,r(n,Nt.fromDom)).map(Nt.fromDom);var n},Qe=function(e,n){return r=n,i=void 0===(o=e)?t.document:o.dom(),me(i)?x.none():x.from(i.querySelector(r)).map(Nt.fromDom);var r,o,i},Ze=function(t,e,n){return Ke(de,$e,t,e,n)},tn=function(t,e,n){return U(Se(t),(function(t){return de(t,e)?n(t)?[t]:[]:tn(t,e,n)}))},en={firstLayer:function(t,e){return tn(t,e,o(!0))},filterFirstLayer:tn},nn=function(t,e){return be(e).map((function(e){return function(t,e){return n=function(t){return de(t,e)},M(Se(t),n);var n}(e,t)}))},rn=(u(nn,"th,td"),u(nn,"tr"),function(t,e){return function(t,e,n){return void 0===n&&(n=g),n(e)?x.none():B(t,lt(e))?x.some(e):$e(e,t.join(","),(function(t){return de(t,"table")||n(t)}))}(["td","th"],t,e)}),on=function(t){return en.firstLayer(t,"th,td")},un=function(t,e){return Ze(t,"table",e)},cn=function(t){var e=function(t){return en.firstLayer(t,"tr")}(t);return P(e,(function(t){var e=t,n=be(e).map((function(t){var e=lt(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"})).getOr("tbody"),r=P(on(t),(function(t){var e=yt(t,"rowspan")?parseInt(wt(t,"rowspan"),10):1,n=yt(t,"colspan")?parseInt(wt(t,"colspan"),10):1;return We(t,e,n)}));return ze(e,r,n)}))},an=function(t,e){return t+","+e},ln=function(t,e){var n=U(t.all(),(function(t){return t.cells()}));return M(n,e)},fn=function(t){var e={},n=[],r=t.length,i=0;k(t,(function(t,r){var o=[];k(t.cells(),(function(t){for(var n=0;void 0!==e[an(r,n)];)n++;for(var u=je(t.element(),t.rowspan(),t.colspan(),r,n),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=n+c,f=an(r+a,l);e[f]=u,i=Math.max(i,l+1)}o.push(u)})),n.push(ze(t.element(),o,t.section()))}));var u=ke(r,i);return{grid:o(u),access:o(e),all:o(n)}},sn=function(t,e,n){var r=t.access()[an(e,n)];return void 0!==r?x.some(r):x.none()},dn=function(t,e,n){var r=ln(t,(function(t){return n(e,t.element())}));return 0<r.length?x.some(r[0]):x.none()},mn=ln,gn=function(t){var e=P(t.all(),(function(t){return t.cells()}));return F(e)},pn=Q("minRow","minCol","maxRow","maxCol"),hn=function(t,e){var n,r,o,i,u,c,a,l,f,s,d=function(t){return de(t.element(),e)},m=cn(t),g=fn(m),p=(r=d,o=(n=g).grid().columns(),i=n.grid().rows(),u=o,a=c=0,Y(n.access(),(function(t){if(r(t)){var e=t.row(),n=e+t.rowspan()-1,o=t.column(),l=o+t.colspan()-1;e<i?i=e:c<n&&(c=n),o<u?u=o:a<l&&(a=l)}})),pn(i,u,c,a)),h="th:not("+e+"),td:not("+e+")",v=en.filterFirstLayer(t,"th,td",(function(t){return de(t,h)}));return k(v,Ie),function(t,e,n,r){for(var o,i,u,c=e.grid().columns(),a=e.grid().rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<n.minRow()||l>n.maxRow()||s<n.minCol()||s>n.maxCol()||(sn(e,l,s).filter(r).isNone()?(o=f,i=t[l].element(),u=Nt.fromTag("td"),Oe(u,Nt.fromTag("br")),(o?Oe:De)(i,u)):f=!0)}(m,g,p,d),l=t,f=p,s=M(en.firstLayer(l,"tr"),(function(t){return 0===t.dom().childElementCount})),k(s,Ie),f.minCol()!==f.maxCol()&&f.minRow()!==f.maxRow()||k(en.firstLayer(l,"th,td"),(function(t){xt(t,"rowspan"),xt(t,"colspan")})),xt(l,"width"),xt(l,"height"),zt(l,"width"),zt(l,"height"),t},vn=function(t){var e=function(e){return t(e)?x.from(e.dom().nodeValue):x.none()},n=le.detect().browser,r=n.isIE()&&10===n.version.major?function(t){try{return e(t)}catch(t){return x.none()}}:e;return{get:function(e){if(!t(e))throw new Error("Can only get text value of a text node");return r(e).getOr("")},getOption:r,set:function(e,n){if(!t(e))throw new Error("Can only set raw text value of a text node");e.dom().nodeValue=n}}}(gt),bn=function(t){return vn.get(t)},wn=function(t){return vn.getOption(t)},yn=function(t,e){vn.set(t,e)},xn=function(t){return"img"===lt(t)?1:wn(t).fold((function(){return Se(t).length}),(function(t){return t.length}))},Sn=["img","br"],Cn=function(t){return wn(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf("Â ")})).isSome()||B(Sn,lt(t))},Rn=function(t){return e=Cn,(n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(Nt.fromDom(t.childNodes[r])))return x.some(Nt.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return x.none()})(t.dom());var e,n},Tn=function(t){return Dn(t,Cn)},Dn=function(t,e){var n=function(t){for(var r=Se(t),o=r.length-1;0<=o;o--){var i=r[o];if(e(i))return x.some(i);var u=n(i);if(u.isSome())return u}return x.none()};return n(t)},On=function(t,e){return Nt.fromDom(t.dom().cloneNode(e))},An=function(t){return On(t,!1)},Nn=function(t){return On(t,!0)},En=function(){var t=Nt.fromTag("td");return Oe(t,Nt.fromTag("br")),t},Bn=function(t,e,n){var r=function(t,e){var n,r,o,i=(n=t,r=Nt.fromTag(e),o=St(n),bt(r,o),r),u=Se(Nn(t));return Ee(i,u),i}(t,e);return Y(n,(function(t,e){null===t?xt(r,e):vt(r,e,t)})),r},In=function(t){return t},Pn=function(t){return function(){return Nt.fromTag("tr",t.dom())}},kn=function(t,e,n){return{row:Pn(e),cell:function(e){var r,o,i,u,c,a,l=ve(e.element()),f=Nt.fromTag(lt(e.element()),l.dom()),s=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),d=0<s.length?(r=e.element(),o=f,i=s,Rn(r).map((function(t){var e=i.join(","),n=Ge(t,e,(function(t){return ge(t,r)}));return W(n,(function(t,e){var n=An(e);return xt(n,"contenteditable"),Oe(t,n),n}),o)})).getOr(o)):f;return Oe(d,Nt.fromTag("br")),u=f,c=e.element().dom(),a=u.dom(),Dt(c)&&Dt(a)&&(a.style.cssText=c.style.cssText),zt(f,"height"),1!==e.colspan()&&zt(e.element(),"width"),t(e.element(),f),f},replace:Bn,gap:En}},Mn=function(t){return{row:Pn(t),cell:En,replace:In,gap:En}},Wn=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},_n=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},jn=function(t,e,n){var r=dn(t,e,ge),o=dn(t,n,ge);return r.bind((function(t){return o.map((function(e){return n=t,r=e,qe(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r}))}))},zn=jn,Hn=function(t,e,n){return zn(t,e,n).map((function(e){var n=mn(t,u(_n,e));return P(n,(function(t){return t.element()}))}))},Ln=function(t,e){return dn(t,e,(function(t,e){return pe(e,t)})).map((function(t){return t.element()}))},Fn=function(t){var e=cn(t);return fn(e)},Un=function(t,e,n){var r=Fn(t);return Hn(r,e,n)},qn=function(t,e,n,r,o){var i=Fn(t),u=ge(t,n)?x.some(e):Ln(i,e),c=ge(t,o)?x.some(r):Ln(i,r);return u.bind((function(t){return c.bind((function(e){return Hn(i,t,e)}))}))},Vn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Gn(){return{up:o({selector:$e,closest:Ze,predicate:Xe,all:we}),down:o({selector:Ye,predicate:Ve}),styles:o({get:Wt,getRaw:jt,set:kt,remove:zt}),attrs:o({get:wt,set:vt,remove:xt,copyTo:function(t,e){var n=St(t);bt(e,n)}}),insert:o({before:Re,after:Te,afterAll:Ne,append:Oe,appendAll:Ee,prepend:De,wrap:Ae}),remove:o({unwrap:Pe,remove:Ie}),create:o({nu:Nt.fromTag,clone:function(t){return Nt.fromDom(t.dom().cloneNode(!1))},text:Nt.fromText}),query:o({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:ye,nextSibling:xe}),property:o({children:Se,name:lt,parent:be,document:function(t){return t.dom().ownerDocument},isText:gt,isComment:dt,isElement:mt,getText:bn,setText:yn,isBoundary:function(t){return!!mt(t)&&("body"===lt(t)||B(Vn,lt(t)))},isEmptyTag:function(t){return!!mt(t)&&B(["br","img","hr","input"],lt(t))}}),eq:ge,is:he}}Q("left","right"),Q("first","second","splits");var Yn=function(t,e,n){return 0<n.length?function(t,e,n,r){var o=e(t,n);return W(r,(function(n,r){var o=e(t,r);return function(t,e,n){return e.bind((function(e){return n.filter(u(t.eq,e))}))}(t,n,o)}),o)}(t,e,(r=n)[0],r.slice(1)):x.none();var r},Kn=function(t,e,n,r){void 0===r&&(r=g);var i=[e].concat(t.up().all(e)),c=[n].concat(t.up().all(n)),a=function(t){return z(t,r).fold((function(){return t}),(function(e){return t.slice(0,e+1)}))},l=a(i),f=a(c),s=j(l,(function(e){return I(f,function(t,e){return u(t.eq,e)}(t,e))}));return{firstpath:o(l),secondpath:o(f),shared:o(s)}},Xn=Gn(),$n=function(t,e){return Yn(Xn,(function(e,n){return t(n)}),e)},Jn={create:ot(["boxes","start","finish"],[])},Qn=function(t){return $e(t,"table")},Zn=function(t,e,n){var r=function(t){return function(e){return void 0!==n&&n(e)||ge(e,t)}};return ge(t,e)?x.some(Jn.create({boxes:x.some([t]),start:t,finish:e})):Qn(t).bind((function(o){return Qn(e).bind((function(i){if(ge(o,i))return x.some(Jn.create({boxes:Un(o,t,e),start:t,finish:e}));if(pe(o,i)){var u=0<(c=Ge(e,"td,th",r(o))).length?c[c.length-1]:e;return x.some(Jn.create({boxes:qn(o,t,o,e,i),start:t,finish:u}))}if(pe(i,o)){var c,a=0<(c=Ge(t,"td,th",r(i))).length?c[c.length-1]:t;return x.some(Jn.create({boxes:qn(i,t,o,e,i),start:t,finish:a}))}return function(t,e,n){return Kn(Xn,t,e,n)}(t,e).shared().bind((function(u){return Ze(u,"table",n).bind((function(n){var u=Ge(e,"td,th",r(n)),c=0<u.length?u[u.length-1]:e,a=Ge(t,"td,th",r(n)),l=0<a.length?a[a.length-1]:t;return x.some(Jn.create({boxes:qn(n,t,o,e,i),start:l,finish:c}))}))}))}))}))},tr=Zn,er=function(t,e){var n=Ye(t,e);return 0<n.length?x.some(n):x.none()},nr=function(t,e,n){return Qe(t,e).bind((function(e){return Qe(t,n).bind((function(t){return $n(Qn,[e,t]).map((function(n){return{first:o(e),last:o(t),table:o(n)}}))}))}))},rr=function(t,e,n){return nr(t,e,n).bind((function(e){var n=function(e){return ge(t,e)},r=$e(e.first(),"thead,tfoot,tbody,table",n),o=$e(e.last(),"thead,tfoot,tbody,table",n);return r.bind((function(t){return o.bind((function(n){return ge(t,n)?function(t,e,n){return function(t,e,n){return jn(t,e,n).bind((function(e){return function(t,e){for(var n=!0,r=u(Wn,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&sn(t,o,i).exists(r);return n?x.some(e):x.none()}(t,e)}))}(Fn(t),e,n)}(e.table(),e.first(),e.last()):x.none()}))}))}))},or={selected:o("data-mce-selected"),selectedSelector:o("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:o("[data-mce-selected]"),firstSelected:o("data-mce-first-selected"),firstSelectedSelector:o("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:o("data-mce-last-selected"),lastSelectedSelector:o("td[data-mce-last-selected],th[data-mce-last-selected]")},ir=function(e){if(!T(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return k(e,(function(o,i){var u=V(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!T(a))throw new Error("case arguments must be an array");n.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var e=V(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!q(n,(function(t){return B(e,t)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[c].apply(null,o)},log:function(e){t.console.log(e,{constructors:n,constructor:c,params:o})}}}})),r},ur=ir([{none:[]},{multiple:["elements"]},{single:["selection"]}]),cr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:ur.none,multiple:ur.multiple,single:ur.single},ar=function(t,e){return cr.cata(e.get(),o([]),i,o([t]))},lr=function(t,e){return cr.cata(e.get(),x.none,(function(e,n){return 0===e.length?x.none():rr(t,or.firstSelectedSelector(),or.lastSelectedSelector()).bind((function(t){return 1<e.length?x.some({bounds:o(t),cells:o(e)}):x.none()}))}),x.none)},fr=function(t,e){var n=ar(t,e);return 0<n.length&&q(n,(function(t){return yt(t,"rowspan")&&1<parseInt(wt(t,"rowspan"),10)||yt(t,"colspan")&&1<parseInt(wt(t,"colspan"),10)}))?x.some(n):x.none()},sr=ar,dr=function(t){return{element:o(t),mergable:x.none,unmergable:x.none,selection:o([t])}},mr=Q("element","clipboard","generators"),gr={noMenu:dr,forMenu:function(t,e,n){return{element:o(n),mergable:o(lr(e,t)),unmergable:o(fr(n,t)),selection:o(sr(n,t))}},notCell:function(t){return dr(t)},paste:mr,pasteRows:function(t,e,n,r,i){return{element:o(n),mergable:x.none,unmergable:x.none,selection:o(sr(n,t)),clipboard:o(r),generators:o(i)}}};function pr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=Wt(n,t);return parseFloat(o)||0}return r},r=function(t,e){return _(e,(function(e,n){var r=Wt(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)};return{set:function(e,n){if(!A(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();Dt(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return o<e?e-o:0}}}var hr=pr("height",(function(t){var e=t.dom();return Et(t)?e.getBoundingClientRect().height:e.offsetHeight})),vr=function(t){return hr.get(t)},br=function(t){return hr.getOuter(t)},wr=pr("width",(function(t){return t.dom().offsetWidth})),yr=function(t){return wr.get(t)},xr=function(t){return wr.getOuter(t)},Sr=le.detect(),Cr=function(t,e,n){return r=Wt(t,e),o=n,i=parseFloat(r),isNaN(i)?o:i;var r,o,i},Rr=/(\d+(\.\d+)?)(\w|%)*/,Tr=/(\d+(\.\d+)?)%/,Dr=/(\d+(\.\d+)?)px|em/,Or=function(t,e){kt(t,"height",e+"px")},Ar=function(t){return jt(t,"width").fold((function(){return x.from(wt(t,"width"))}),(function(t){return x.some(t)}))},Nr=function(t,e){return t/e.pixelWidth()*100},Er={percentageBasedSizeRegex:o(Tr),pixelBasedSizeRegex:o(Dr),setPixelWidth:function(t,e){kt(t,"width",e+"px")},setPercentageWidth:function(t,e){kt(t,"width",e+"%")},setHeight:Or,getPixelWidth:function(t,e){return Ar(t).fold((function(){return yr(t)}),(function(n){return function(t,e,n){var r=Dr.exec(e);if(null!==r)return parseInt(r[1],10);var o=Tr.exec(e);return null===o?yr(t):parseFloat(o[1])/100*n.pixelWidth()}(t,n,e)}))},getPercentageWidth:function(t,e){return Ar(t).fold((function(){var n=yr(t);return Nr(n,e)}),(function(n){return function(t,e,n){var r=Tr.exec(e);if(null!==r)return parseFloat(r[1]);var o=yr(t);return Nr(o,n)}(t,n,e)}))},getGenericWidth:function(t){return Ar(t).bind((function(t){var e=Rr.exec(t);return null!==e?x.some({width:o(parseFloat(e[1])),unit:o(e[3])}):x.none()}))},setGenericWidth:function(t,e,n){kt(t,"width",e+n)},getHeight:function(t){return function(t){var e,n=jt(e=t,"height").getOrThunk((function(){return function(t){return Sr.browser.isIE()||Sr.browser.isEdge()?(n=Cr(e=t,"padding-top",0),r=Cr(e,"padding-bottom",0),o=Cr(e,"border-top-width",0),i=Cr(e,"border-bottom-width",0),u=e.dom().getBoundingClientRect().height,"border-box"===Wt(e,"box-sizing")?u:u-n-r-(o+i)):Cr(t,"height",vr(t));var e,n,r,o,i,u}(e)+"px"}));return n?function(t,e,n,r){var o,i,u,c,a,l,f=parseInt(t,10);return Ct(l=t,"%",l.length-1)&&"table"!==lt(e)?(i=f,u=n,c=r,a=un(o=e).map((function(t){var e=u(t);return Math.floor(i/100*e)})).getOr(i),c(o,a),a):f}(n,t,vr,Or):vr(t)}(e=t)/function(t,e){return yt(t,e)?parseInt(wt(t,e),10):1}(e,"rowspan");var e},getRawWidth:Ar},Br=function(t,e){Er.getGenericWidth(t).each((function(n){var r=n.width()/2;Er.setGenericWidth(t,r,n.unit()),Er.setGenericWidth(e,r,n.unit())}))},Ir=function(t,e){return{left:o(t),top:o(e),translate:function(n,r){return Ir(t+n,e+r)}}},Pr=Ir,kr=function(t,e){return void 0!==t?t:void 0!==e?e:0},Mr=function(e){var n,r,o=e.dom().ownerDocument,i=o.body,u=(r=(n=Nt.fromDom(o)).dom())===r.window&&n instanceof t.Window?n:pt(n)?r.defaultView||r.parentWindow:null,c=o.documentElement,a=kr(u.pageYOffset,c.scrollTop),l=kr(u.pageXOffset,c.scrollLeft),f=kr(c.clientTop,i.clientTop),s=kr(c.clientLeft,i.clientLeft);return Wr(e).translate(l-s,a-f)},Wr=function(e){var n,r,o,i=e.dom(),c=i.ownerDocument,a=c.body,l=Nt.fromDom(c.documentElement);return a===i?Pr(a.offsetLeft,a.offsetTop):(n=e,r=l||Nt.fromDom(t.document.documentElement),Xe(n,u(ge,r)).isSome()?(o=i.getBoundingClientRect(),Pr(o.left,o.top)):Pr(0,0))},_r=Q("row","y"),jr=Q("col","x"),zr=function(t){return Mr(t).left()+xr(t)},Hr=function(t){return Mr(t).left()},Lr=function(t,e){return jr(t,Hr(e))},Fr=function(t,e){return jr(t,zr(e))},Ur=function(t){return Mr(t).top()},qr=function(t,e){return _r(t,Ur(e))},Vr=function(t,e){return _r(t,Ur(e)+br(e))},Gr=function(t,e,n){if(0===n.length)return[];var r=P(n.slice(1),(function(e,n){return e.map((function(e){return t(n,e)}))})),o=n[n.length-1].map((function(t){return e(n.length-1,t)}));return r.concat([o])},Yr={height:{delta:i,positions:function(t){return Gr(qr,Vr,t)},edge:Ur},rtl:{delta:function(t){return-t},edge:zr,positions:function(t){return Gr(Fr,Lr,t)}},ltr:{delta:i,edge:Hr,positions:function(t){return Gr(Lr,Fr,t)}}},Kr={ltr:Yr.ltr,rtl:Yr.rtl};function Xr(t){var e=function(e){return t(e).isRtl()?Kr.rtl:Kr.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var $r,Jr=function(t){var e=cn(t);return fn(e).grid()},Qr=function(){return(Qr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Zr=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},to=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return x.none()},eo=function(t,e,n,r){n===r?xt(t,e):vt(t,e,n)},no=function(t){return void 0!==t.dom().classList},ro=function(t,e){no(t)?t.dom().classList.add(e):function(t,e){return r=e,o=function(t,e){var n=wt(t,e);return void 0===n||""===n?[]:n.split(" ")}(n=t,"class").concat([r]),vt(n,"class",o.join(" ")),!0;var n,r,o}(t,e)},oo=function(t,e){return no(t)&&t.dom().classList.contains(e)},io=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},uo=function(t,e){if(e<0||e>=t.length-1)return x.none();var n=t[e].fold((function(){var n=function(t){var e=N.call(t,0);return e.reverse(),e}(t.slice(0,e));return to(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return x.some({value:t,delta:0})})),r=t[e+1].fold((function(){var n=t.slice(e+1);return to(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return x.some({value:t,delta:1})}));return n.bind((function(t){return r.map((function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n}))}))},co=function(t,e,n){var r=t();return j(r,e).orThunk((function(){return x.from(r[0]).orThunk(n)})).map((function(t){return t.element()}))},ao=function(t){var e=t.grid(),n=io(0,e.columns()),r=io(0,e.rows());return P(n,(function(e){return co((function(){return U(r,(function(n){return sn(t,n,e).filter((function(t){return t.column()===e})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.colspan()}),(function(){return sn(t,0,e)}))}))},lo=function(t){var e=t.grid(),n=io(0,e.rows()),r=io(0,e.columns());return P(n,(function(e){return co((function(){return U(r,(function(n){return sn(t,e,n).filter((function(t){return t.row()===e})).fold(o([]),(function(t){return[t]}))}))}),(function(t){return 1===t.rowspan()}),(function(){return sn(t,e,0)}))}))},fo=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},so={resolve:fo("ephox-snooker").resolve},mo=so.resolve("resizer-bar"),go=so.resolve("resizer-rows"),po=so.resolve("resizer-cols"),ho=function(t){var e=Ye(t.parent(),"."+mo);k(e,Ie)},vo=function(t,e,n){var r=t.origin();k(e,(function(e,o){e.each((function(e){var o=n(r,e);ro(o,mo),Oe(t.parent(),o)}))}))},bo=function(t,e){var n=Ye(t.parent(),"."+mo);k(n,e)},wo=function(t,e,n,r){ho(t);var o=cn(e),i=fn(o);!function(t,e,n,r,o,i){var u,c,a,l,f,s,d,m,g=Mr(e);u=t,c=0<n.length?o.positions(n,e):[],a=g,l=xr(e),vo(u,c,(function(t,e){var n=function(t,e,n,r){var o=Nt.fromTag("div");return Mt(o,{position:"absolute",left:e+"px",top:n-3.5+"px",height:"7px",width:r+"px"}),bt(o,{"data-row":t,role:"presentation"}),o}(e.row(),a.left()-t.left(),e.y()-t.top(),l);return ro(n,go),n})),f=t,s=0<r.length?i.positions(r,e):[],d=g,m=br(e),vo(f,s,(function(t,e){var n=function(t,e,n,r,o){var i=Nt.fromTag("div");return Mt(i,{position:"absolute",left:e-3.5+"px",top:n+"px",height:o+"px",width:"7px"}),bt(i,{"data-column":t,role:"presentation"}),i}(e.col(),e.x()-t.left(),d.top()-t.top(),0,m);return ro(n,po),n}))}(t,e,lo(i),ao(i),n,r)},yo=function(t){bo(t,(function(t){kt(t,"display","none")}))},xo=function(t){bo(t,(function(t){kt(t,"display","block")}))},So=ho,Co=function(t,e){return Fe(e,t.section())},Ro=function(t,e){return t.cells()[e]},To=function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return Co(t,u)},Do=Co,Oo=function(t,e,n){t.cells()[e]=n},Ao=Ro,No=function(t,e){return Ro(t,e).element()},Eo=function(t,e){var n=t.cells(),r=P(n,e);return Fe(r,t.section())},Bo=function(t){return t.cells().length},Io=function(t,e){if(0===t.length)return 0;var n=t[0];return z(t,(function(t){return!e(n.element(),t.element())})).fold((function(){return t.length}),(function(t){return t}))},Po=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=sn(t,o,u).map((function(t){return He(t.element(),n)})).getOrThunk((function(){return He(e.gap(),!0)}));i.push(c)}var a=Fe(i,t.all()[o].section());r.push(a)}return r},ko=function(t,e){return function(t,e){return P(t,(function(t){var n,r=(n=t.details(),to(n,(function(t){return be(t.element()).map((function(t){var e=be(t).isNone();return He(t,e)}))})).getOrThunk((function(){return He(e.row(),!0)})));return Le(r.element(),t.details(),t.section(),r.isNew())}))}(function(t,e){var n=P(t,(function(t,e){return P(t.cells(),(function(t,e){return!1}))}));return P(t,(function(r,i){var u=U(r.cells(),(function(r,u){if(!1!==n[i][u])return[];var c=function(t,e,n,r){var i,u,c,a,l=(i=t,u=e,i[u]).cells().slice(n),f=Io(l,r),s=(c=t,a=n,P(c,(function(t){return Ao(t,a)}))).slice(e),d=Io(s,r);return{colspan:o(f),rowspan:o(d)}}(t,i,u,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(i,u,c.rowspan(),c.colspan()),[_e(r.element(),c.rowspan(),c.colspan(),r.isNew())]}));return Ue(u,r.section())}))}(t,ge),e)},Mo=function(t,e){var n=F(P(t.all(),(function(t){return t.cells()})));return j(n,(function(t){return ge(e,t.element())}))},Wo=function(t,e,n,r,i){return function(u,c,a,l,f){var s=cn(c),d=fn(s);return e(d,a).map((function(e){var n=Po(d,l,!1),r=t(n,e,ge,i(l)),u=ko(r.grid(),l);return{grid:o(u),cursor:r.cursor}})).fold((function(){return x.none()}),(function(t){var e=function(t,e){var n=[],r=[],i=function(e,o){0<e.length?function(e,o){var i=Je(t,o).getOrThunk((function(){var e=Nt.fromTag(o,ve(t).dom());return Oe(t,e),e}));Be(i);var u=P(e,(function(t){t.isNew()&&n.push(t.element());var e=t.element();return Be(e),k(t.cells(),(function(t){t.isNew()&&r.push(t.element()),eo(t.element(),"colspan",t.colspan(),1),eo(t.element(),"rowspan",t.rowspan(),1),Oe(e,t.element())})),e}));Ee(i,u)}(e,o):Je(t,o).each(Ie)},u=[],c=[],a=[];return k(e,(function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}})),i(u,"thead"),i(c,"tbody"),i(a,"tfoot"),{newRows:o(n),newCells:o(r)}}(c,t.grid());return n(c,t.grid(),f),r(c),wo(u,c,Yr.height,f),x.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})}))}},_o=function(t,e){return rn(e.element()).bind((function(e){return Mo(t,e)}))},jo=function(t,e){var n=P(e.selection(),(function(e){return rn(e).bind((function(e){return Mo(t,e)}))})),r=Zr(n);return 0<r.length?x.some({cells:r,generators:e.generators,clipboard:e.clipboard}):x.none()},zo=function(t,e){var n=P(e.selection(),(function(e){return rn(e).bind((function(e){return Mo(t,e)}))})),r=Zr(n);return 0<r.length?x.some(r):x.none()},Ho=function(t){return{is:function(e){return t===e},isValue:p,isError:g,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(e){return Ho(t)},orThunk:function(e){return Ho(t)},fold:function(e,n){return n(t)},map:function(e){return Ho(e(t))},mapError:function(e){return Ho(t)},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return x.some(t)}}},Lo=function(t){return{is:g,isValue:g,isError:p,getOr:i,getOrThunk:function(t){return t()},getOrDie:function(){return e=String(t),function(){throw new Error(e)}();var e},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Lo(t)},mapError:function(e){return Lo(e(t))},each:n,bind:function(e){return Lo(t)},exists:g,forall:p,toOption:x.none}},Fo={value:Ho,error:Lo,fromOption:function(t,e){return t.fold((function(){return Lo(e)}),Ho)}},Uo=function(t,e){return P(t,(function(){return He(e.cell(),!0)}))},qo=function(t,e,n){return t.concat(function(t,e){for(var n=[],r=0;r<t;r++)n.push(e());return n}(e,(function(e){return Do(t[t.length-1],Uo(t[t.length-1].cells(),n))})))},Vo=function(t,e,n){return P(t,(function(t){return Do(t,t.cells().concat(Uo(io(0,e),n)))}))},Go=function(t,e){var n=Bo(t[0]),r=Bo(e[0]);return{rowDelta:o(0),colDelta:o(n-r)}},Yo=function(t,e,n){var r=e.colDelta()<0?Vo:i;return(e.rowDelta()<0?qo:i)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},Ko=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Bo(t[0]);u++){var c=n(No(t[i],u),e);!0===c&&!1===o?Oo(t[i],u,He(r(),!0)):!0===c&&(o=!1)}return t},Xo=function(t,e,n,r,o){!function(t,e,n,r){if(0<e&&e<t.length){var o=t[e-1].cells(),i=(u=n,_(o,(function(t,e){return I(t,(function(t){return u(t.element(),e.element())}))?t:t.concat([e])}),[]));k(i,(function(o){for(var i=x.none(),u=function(e){for(var u=function(u){var c=t[e].cells()[u];n(c.element(),o.element())&&(i.isNone()&&(i=x.some(r())),i.each((function(n){Oo(t[e],u,He(n,!0))})))},c=0;c<Bo(t[0]);c++)u(c)},c=e;c<t.length;c++)u(c)}))}var u}(e,t,o,r.cell);var i=Go(n,e),u=Yo(n,i,r),c=Go(e,u),a=Yo(e,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},$o=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),c=Eo(t[n],(function(n,i){return 0<e&&e<t.length&&r(No(t[e-1],i),No(t[e],i))?Ao(t[e],i):He(o(n.element(),r),!0)}));return i.concat([c]).concat(u)},Jo=function(t,e,n,r,o){return P(t,(function(t){var i=0<e&&e<Bo(t)&&r(No(t,e-1),No(t,e))?Ao(t,e):He(o(No(t,n),r),!0);return To(t,e,i)}))},Qo=function(t,e,n,r){return P(t,(function(t){return Eo(t,(function(t){return o=t,I(e,(function(t){return n(o.element(),t.element())}))?He(r(t.element(),n),!0):t;var o}))}))},Zo=function(t,e,n,r){return void 0!==No(t[e],n)&&0<e&&r(No(t[e-1],n),No(t[e],n))},ti=function(t,e,n){return 0<e&&n(No(t,e-1),No(t,e))},ei=function(t,e,n,r){var o=U(t,(function(r,o){return Zo(t,o,e,n)||ti(r,e,n)?[]:[Ao(r,e)]}));return Qo(t,o,n,r)},ni=function(t,e,n,r){var o=t[e],i=U(o.cells(),(function(r,i){return Zo(t,e,i,n)||ti(o,i,n)?[]:[r]}));return Qo(t,i,n,r)},ri=ir([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),oi=Qr({},ri),ii=function(t,e){return yt(t,e)&&1<parseInt(wt(t,e),10)},ui={hasColspan:function(t){return ii(t,"colspan")},hasRowspan:function(t){return ii(t,"rowspan")},minWidth:o(10),minHeight:o(10),getInt:function(t,e){return parseInt(Wt(t,e),10)}},ci=function(t,e,n){return jt(t,e).fold((function(){return n(t)+"px"}),(function(t){return t}))},ai=function(t,e){return ci(t,"width",(function(t){return Er.getPixelWidth(t,e)}))},li=function(t){return ci(t,"height",Er.getHeight)},fi=function(t,e,n,r,o){var i=ao(t),u=P(i,(function(t){return t.map(e.edge)}));return P(i,(function(t,e){return t.filter(d(ui.hasColspan)).fold((function(){var t=uo(u,e);return r(t)}),(function(t){return n(t,o)}))}))},si=function(t){return t.map((function(t){return t+"px"})).getOr("")},di=function(t,e,n,r){var o=lo(t),i=P(o,(function(t){return t.map(e.edge)}));return P(o,(function(t,e){return t.filter(d(ui.hasRowspan)).fold((function(){var t=uo(i,e);return r(t)}),(function(t){return n(t)}))}))},mi={getRawWidths:function(t,e,n){return fi(t,e,ai,si,n)},getPixelWidths:function(t,e,n){return fi(t,e,Er.getPixelWidth,(function(t){return t.getOrThunk(n.minCellWidth)}),n)},getPercentageWidths:function(t,e,n){return fi(t,e,Er.getPercentageWidth,(function(t){return t.fold((function(){return n.minCellWidth()}),(function(t){return t/n.pixelWidth()*100}))}),n)},getPixelHeights:function(t,e){return di(t,e,Er.getHeight,(function(t){return t.getOrThunk(ui.minHeight)}))},getRawHeights:function(t,e){return di(t,e,li,si)}},gi=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},pi=function(t,e){var n=gn(t);return P(n,(function(t){var n=gi(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:o(n),colspan:t.colspan}}))},hi=function(t){var e=i;return{width:o(t),pixelWidth:o(t),getWidths:mi.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,e){return[Math.max(ui.minWidth(),t+e)-t]},minCellWidth:ui.minWidth,setElementWidth:Er.setPixelWidth,setTableWidth:function(t,e,n){var r=W(e,(function(t,e){return t+e}),0);Er.setPixelWidth(t,r)}}},vi=function(t){return Er.getRawWidth(t).fold((function(){var e=yr(t);return hi(e)}),(function(e){return function(t,e){var n,r,i,u,c=Er.percentageBasedSizeRegex().exec(e);if(null!==c)return n=c[1],r=t,i=parseFloat(n),u=yr(r),{width:o(i),pixelWidth:o(u),getWidths:mi.getPercentageWidths,getCellDelta:function(t){return t/u*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return ui.minWidth()/u*100},setElementWidth:Er.setPercentageWidth,setTableWidth:function(t,e,n){var r=n/100*i;Er.setPercentageWidth(t,i+r)}};var a=Er.pixelBasedSizeRegex().exec(e);if(null!==a){var l=parseInt(a[1],10);return hi(l)}var f=yr(t);return hi(f)}(t,e)}))},bi=function(t){return fn(t)},wi=function(t){var e=cn(t);return bi(e)},yi=function(t,e){var n=M(e,(function(e){return!B(t,e)}));0<n.length&&et(n)},xi=function(t){return function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return nt("required",e),rt(e),function(r){var o=V(r);q(e,(function(t){return B(o,t)}))||tt(e,o),t(e,o);var i=M(e,(function(t){return!n.validate(r[t],t)}));return 0<i.length&&function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+Z(t).join(", ")+") were not.")}(i,n.label),r}}(yi,t,{validate:O,label:"function"})},Si=xi(["cell","row","replace","gap"]),Ci=function(t){var e=yt(t,"colspan")?parseInt(wt(t,"colspan"),10):1,n=yt(t,"rowspan")?parseInt(wt(t,"rowspan"),10):1;return{element:o(t),colspan:o(e),rowspan:o(n)}},Ri=function(t,n){void 0===n&&(n=Ci),Si(t);var r=e(x.none()),o=function(e){var o=function(e){var r;return r=n(e),t.cell(r)}(e);return r.get().isNone()&&r.set(x.some(o)),i=x.some({item:e,replacement:o}),o},i=x.none();return{getOrInit:function(t,e){return i.fold((function(){return o(t)}),(function(n){return e(t,n.item)?n.replacement:o(t)}))},cursor:r.get}},Ti=function(t,n){return function(r){var o=e(x.none());Si(r);var i=[],u=function(e){var u={scope:t},c=r.replace(e,n,u);return i.push({item:e,sub:c}),o.get().isNone()&&o.set(x.some(c)),c};return{replaceOrInit:function(t,e){return(n=t,r=e,j(i,(function(t){return r(t.item,n)}))).fold((function(){return u(t)}),(function(n){return e(t,n.item)?n.sub:u(t)}));var n,r},cursor:o.get}}},Di=function(t){Si(t);var n=e(x.none());return{combine:function(e){return n.get().isNone()&&n.set(x.some(e)),function(){var n=t.cell({element:o(e),colspan:o(1),rowspan:o(1)});return zt(n,"width"),zt(e,"width"),n}},cursor:n.get}},Oi=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Ai=Gn(),Ni=function(t){return function(t,e){var n=t.property().name(e);return B(Oi,n)}(Ai,t)},Ei=function(t){return function(t,e){var n=t.property().name(e);return B(["ol","ul"],n)}(Ai,t)},Bi=function(t){var e,n=function(t){return"br"===lt(t)},r=function(t){return Tn(t).bind((function(e){var r=xe(e).map((function(t){return!!Ni(t)||!!function(t){return function(t,e){return B(["br","img","hr","input"],t.property().name(e))}(Ai,t)}(t)&&"img"!==lt(t)})).getOr(!1);return be(e).map((function(o){return!0===r||"li"===lt(i=o)||Xe(i,Ei).isSome()||n(e)||Ni(o)&&!ge(t,o)?[]:[Nt.fromTag("br")];var i}))})).getOr([])},o=0===(e=U(t,(function(t){var e=Se(t);return q(e,(function(t){return n(t)||gt(t)&&0===bn(t).trim().length}))?[]:e.concat(r(t))}))).length?[Nt.fromTag("br")]:e;Be(t[0]),Ee(t[0],o)},Ii=function(t){0===on(t).length&&Ie(t)},Pi=Q("grid","cursor"),ki=function(t,e,n){return Mi(t,e,n).orThunk((function(){return Mi(t,0,0)}))},Mi=function(t,e,n){return x.from(t[e]).bind((function(t){return x.from(t.cells()[n]).bind((function(t){return x.from(t.element())}))}))},Wi=function(t,e,n){return Pi(t,Mi(t,e,n))},_i=function(t){return _(t,(function(t,e){return I(t,(function(t){return t.row()===e.row()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.row()-e.row()}))},ji=function(t){return _(t,(function(t,e){return I(t,(function(t){return t.column()===e.column()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.column()-e.column()}))},zi=function(t,e,n){var r=function(t,e){return P(t,(function(t){var n=P(on(t),(function(t){var e=yt(t,"rowspan")?parseInt(wt(t,"rowspan"),10):1,n=yt(t,"colspan")?parseInt(wt(t,"colspan"),10):1;return We(t,e,n)}));return ze(t,n,e.section())}))}(t,n),o=fn(r);return Po(o,e,!0)},Hi=function(t,e,n){var r=vi(t),o=bi(e),i=r.getWidths(o,n,r),u=pi(o,i);k(u,(function(t){r.setElementWidth(t.element(),t.width())})),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},Li={insertRowBefore:Wo((function(t,e,n,r){var o=e.row(),i=e.row(),u=$o(t,i,o,n,r.getOrInit);return Wi(u,i,e.column())}),_o,n,n,Ri),insertRowsBefore:Wo((function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=_i(e),c=_(u,(function(t,e){return $o(t,i,o,n,r.getOrInit)}),t);return Wi(c,i,e[0].column())}),zo,n,n,Ri),insertRowAfter:Wo((function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=$o(t,i,o,n,r.getOrInit);return Wi(u,i,e.column())}),_o,n,n,Ri),insertRowsAfter:Wo((function(t,e,n,r){var o=_i(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),c=_(o,(function(t,e){return $o(t,u,i,n,r.getOrInit)}),t);return Wi(c,u,e[0].column())}),zo,n,n,Ri),insertColumnBefore:Wo((function(t,e,n,r){var o=e.column(),i=e.column(),u=Jo(t,i,o,n,r.getOrInit);return Wi(u,e.row(),i)}),_o,Hi,n,Ri),insertColumnsBefore:Wo((function(t,e,n,r){var o=ji(e),i=o[0].column(),u=o[0].column(),c=_(o,(function(t,e){return Jo(t,u,i,n,r.getOrInit)}),t);return Wi(c,e[0].row(),u)}),zo,Hi,n,Ri),insertColumnAfter:Wo((function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Jo(t,i,o,n,r.getOrInit);return Wi(u,e.row(),i)}),_o,Hi,n,Ri),insertColumnsAfter:Wo((function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=ji(e),c=_(u,(function(t,e){return Jo(t,i,o,n,r.getOrInit)}),t);return Wi(c,e[0].row(),i)}),zo,Hi,n,Ri),splitCellIntoColumns:Wo((function(t,e,n,r){var o=function(t,e,n,r,o){var i=n+1;return P(t,(function(t,u){var c=u===e?He(o(No(t,n),r),!0):Ao(t,n);return To(t,i,c)}))}(t,e.row(),e.column(),n,r.getOrInit);return Wi(o,e.row(),e.column())}),_o,Hi,n,Ri),splitCellIntoRows:Wo((function(t,e,n,r){var o=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),c=t.slice(i),a=Eo(t[e],(function(t,e){return e===n?He(o(t.element(),r),!0):t}));return u.concat([a]).concat(c)}(t,e.row(),e.column(),n,r.getOrInit);return Wi(o,e.row(),e.column())}),_o,n,n,Ri),eraseColumns:Wo((function(t,e,n,r){var o=ji(e),i=function(t,e,n){var r=P(t,(function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Fe(r,t.section())}));return M(r,(function(t){return 0<t.cells().length}))}(t,o[0].column(),o[o.length-1].column()),u=ki(i,e[0].row(),e[0].column());return Pi(i,u)}),zo,Hi,Ii,Ri),eraseRows:Wo((function(t,e,n,r){var o=_i(e),i=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))}(t,o[0].row(),o[o.length-1].row()),u=ki(i,e[0].row(),e[0].column());return Pi(i,u)}),zo,n,Ii,Ri),makeColumnHeader:Wo((function(t,e,n,r){var o=ei(t,e.column(),n,r.replaceOrInit);return Wi(o,e.row(),e.column())}),_o,n,n,Ti("row","th")),unmakeColumnHeader:Wo((function(t,e,n,r){var o=ei(t,e.column(),n,r.replaceOrInit);return Wi(o,e.row(),e.column())}),_o,n,n,Ti(null,"td")),makeRowHeader:Wo((function(t,e,n,r){var o=ni(t,e.row(),n,r.replaceOrInit);return Wi(o,e.row(),e.column())}),_o,n,n,Ti("col","th")),unmakeRowHeader:Wo((function(t,e,n,r){var o=ni(t,e.row(),n,r.replaceOrInit);return Wi(o,e.row(),e.column())}),_o,n,n,Ti(null,"td")),mergeCells:Wo((function(t,e,n,r){var i=e.cells();Bi(i);var u=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Oo(t[o],i,He(r(),!1));return t}(t,e.bounds(),0,o(i[0]));return Pi(u,x.from(i[0]))}),(function(t,e){return e.mergable()}),n,n,Di),unmergeCells:Wo((function(t,e,n,r){var o=W(e,(function(t,e){return Ko(t,e,n,r.combine(e))}),t);return Pi(o,x.from(e[0]))}),(function(t,e){return e.unmergable()}),Hi,n,Di),pasteCells:Wo((function(t,e,n,r){var i,c,a,l,f=(i=e.clipboard(),c=e.generators(),a=cn(i),l=fn(a),Po(l,c,!0));return function(t,e,n,r,i){return function(t,e,n){if(t.row()>=e.length||t.column()>Bo(e[0]))return Fo.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),i=r[0].cells().slice(t.column()),u=Bo(n[0]),c=n.length;return Fo.value({rowDelta:o(r.length-c),colDelta:o(i.length-u)})}(t,e,n).map((function(o){var c=Yo(e,o,r);return function(t,e,n,r,o){for(var i,c,a,l,f,s=t.row(),d=t.column(),m=s+n.length,g=d+Bo(n[0]),p=s;p<m;p++)for(var h=d;h<g;h++){a=h,f=l=void 0,l=u(o,Ao((i=e)[c=p],a).element()),f=i[c],1<i.length&&1<Bo(f)&&(0<a&&l(No(f,a-1))||a<f.cells().length-1&&l(No(f,a+1))||0<c&&l(No(i[c-1],a))||c<i.length-1&&l(No(i[c+1],a)))&&Ko(e,No(e[p],h),o,r.cell);var v=No(n[p-s],h-d),b=r.replace(v);Oo(e[p],h,He(b,!0))}return e}(t,c,n,r,i)}))}(Me(e.row(),e.column()),t,f,e.generators(),n).fold((function(){return Pi(t,x.some(e.element()))}),(function(t){var n=ki(t,e.row(),e.column());return Pi(t,n)}))}),(function(t,e){return rn(e.element()).bind((function(n){return Mo(t,n).map((function(t){return Qr({},t,{generators:e.generators,clipboard:e.clipboard})}))}))}),Hi,n,Ri),pasteRowsBefore:Wo((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=zi(e.clipboard(),e.generators(),o),c=Xo(i,t,u,e.generators(),n),a=ki(c,e.cells[0].row(),e.cells[0].column());return Pi(c,a)}),jo,n,n,Ri),pasteRowsAfter:Wo((function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=zi(e.clipboard(),e.generators(),o),c=Xo(i,t,u,e.generators(),n),a=ki(c,e.cells[0].row(),e.cells[0].column());return Pi(c,a)}),jo,n,n,Ri)},Fi=function(t){return Nt.fromDom(t.getBody())},Ui=function(t){return t.getBoundingClientRect().width},qi=function(t){return t.getBoundingClientRect().height},Vi=function(t){return function(e){return ge(e,Fi(t))}},Gi=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Yi=function(t){var e=Ye(t,"td[data-mce-style],th[data-mce-style]");xt(t,"data-mce-style"),k(e,(function(t){xt(t,"data-mce-style")}))},Ki={isRtl:o(!1)},Xi={isRtl:o(!0)},$i=function(t){return"rtl"==("rtl"===Wt(t,"direction")?"rtl":"ltr")?Xi:Ki},Ji={"border-collapse":"collapse",width:"100%"},Qi={border:"1"},Zi=function(t){return t.getParam("table_default_attributes",Qi,"object")},tu=function(t){return t.getParam("table_default_styles",Ji,"object")},eu=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},nu=function(t){return t.getParam("table_row_advtab",!0,"boolean")},ru=function(t){return t.getParam("table_advtab",!0,"boolean")},ou=function(t){return t.getParam("table_style_by_css",!1,"boolean")},iu=function(t){return t.getParam("table_class_list",[],"array")},uu=function(t){return!1===t.getParam("table_responsive_width")},cu=function(t,e){return t.fire("newrow",{node:e})},au=function(t,e){return t.fire("newcell",{node:e})},lu=function(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})},fu=function(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})},su=tinymce.util.Tools.resolve("tinymce.util.Tools"),du=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},mu=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},gu=function(t,e){su.each("left center right".split(" "),(function(n){t.formatter.remove("align"+n,{},e)}))},pu=function(t,e,n){return function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(undefined,t.select("td,th",e))},hu=function(t,e){var n=function(e){return Tt(e,"rgb")?t.toHex(e):e};return{borderstyle:jt(Nt.fromDom(e),"border-style").getOr(""),bordercolor:jt(Nt.fromDom(e),"border-color").map(n).getOr(""),backgroundcolor:jt(Nt.fromDom(e),"background-color").map(n).getOr("")}},vu=function(t,e,n,r,o){var i={};return su.each(t.split(" "),(function(t){r.formatter.matchNode(o,e+t)&&(i[n]=t)})),i[n]||(i[n]=""),i},bu=u(vu,"left center right"),wu=u(vu,"top middle bottom"),yu=function(t,e,n){var r=function(t,n){return n=n||[],su.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)})),n};return r(t,n||[])},xu=function(t){var e=t[0],n=t.slice(1),r=V(e);return k(n,(function(t){k(r,(function(n){Y(t,(function(t,r,o){var i=e[n];""!==i&&n===r&&i!==t&&(e[n]="")}))}))})),e},Su=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Cu=function(t){return(e=t,n=e.getParam("table_cell_class_list",[],"array"),r=yu(n,(function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})})),0<n.length?x.some({name:"class",type:"selectbox",label:"Class",items:r}):x.none()).fold((function(){return Su}),(function(t){return Su.concat(t)}));var e,n,r},Ru={normal:function(t,e){return{setAttrib:function(n,r){t.setAttrib(e,n,r)},setStyle:function(n,r){t.setStyle(e,n,r)}}},ifTruthy:function(t,e){return{setAttrib:function(n,r){r&&t.setAttrib(e,n,r)},setStyle:function(n,r){r&&t.setStyle(e,n,r)}}}},Tu=function(t,e){t.setAttrib("scope",e.scope),t.setAttrib("class",e.class),t.setStyle("width",Gi(e.width)),t.setStyle("height",Gi(e.height))},Du=function(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle)},Ou=function(t,e,n){var r=t.dom,o=n.celltype&&e[0].nodeName.toLowerCase()!==n.celltype?r.rename(e[0],n.celltype):e[0],i=Ru.normal(r,o);Tu(i,n),eu(t)&&Du(i,n),gu(t,o),function(t,e){su.each("top middle bottom".split(" "),(function(n){t.formatter.remove("valign"+n,{},e)}))}(t,o),n.halign&&du(t,o,n.halign),n.valign&&mu(t,o,n.valign)},Au=function(t,e,n){var r=t.dom;su.each(e,(function(e){n.celltype&&e.nodeName.toLowerCase()!==n.celltype&&(e=r.rename(e,n.celltype));var o=Ru.ifTruthy(r,e);Tu(o,n),eu(t)&&Du(o,n),n.halign&&du(t,e,n.halign),n.valign&&mu(t,e,n.valign)}))},Nu=function(t,e,n){var r=n.getData();n.close(),t.undoManager.transact((function(){(1===e.length?Ou:Au)(t,e,r),t.focus()}))},Eu=function(t){var e,n=[];if(n=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!n.length&&e&&n.push(e),e=e||n[0]){var r=su.map(n,(function(e){return function(t,e,n){var r=t.dom;return Qr({width:r.getStyle(e,"width")||r.getAttrib(e,"width"),height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),celltype:e.nodeName.toLowerCase(),class:r.getAttrib(e,"class","")},bu("align","halign",t,e),wu("valign","valign",t,e),n?hu(r,e):{})}(t,e,eu(t))})),o=xu(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Cu(t)},{title:"Advanced",name:"advanced",items:[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}]}]},c={type:"panel",items:[{type:"grid",columns:2,items:Cu(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:eu(t)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(Nu,t,n)})}},Bu=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Iu=function(t){return(e=t,n=e.getParam("table_row_class_list",[],"array"),r=yu(n,(function(t){t.value&&(t.textStyle=function(){return e.formatter.getCssText({block:"tr",classes:[t.value]})})})),0<n.length?x.some({name:"class",type:"selectbox",label:"Class",items:r}):x.none()).fold((function(){return Bu}),(function(t){return Bu.concat(t)}));var e,n,r},Pu=function(t,e,n,r){var o=t.dom,i=r.getData();r.close();var u=1===e.length?Ru.normal:Ru.ifTruthy;t.undoManager.transact((function(){su.each(e,(function(e){var r,c,a,l,f,s;i.type!==e.parentNode.nodeName.toLowerCase()&&(r=t.dom,c=e,a=i.type,l=r.getParent(c,"table"),f=c.parentNode,(s=r.select(a,l)[0])||(s=r.create(a),l.firstChild?"CAPTION"===l.firstChild.nodeName?r.insertAfter(s,l.firstChild):l.insertBefore(s,l.firstChild):l.appendChild(s)),s.appendChild(c),f.hasChildNodes()||r.remove(f));var d,m,g=u(o,e);g.setAttrib("scope",i.scope),g.setAttrib("class",i.class),g.setStyle("height",Gi(i.height)),nu(t)&&(m=i,(d=g).setStyle("background-color",m.backgroundcolor),d.setStyle("border-color",m.bordercolor),d.setStyle("border-style",m.borderstyle)),i.align!==n.align&&(gu(t,e),du(t,e,i.align))})),t.focus()}))},ku=function(t){var e,n,r=t.dom,o=[];if((e=r.getParent(t.selection.getStart(),"table"))&&(n=r.getParent(t.selection.getStart(),"td,th"),su.each(e.rows,(function(t){su.each(t.cells,(function(e){if((r.getAttrib(e,"data-mce-selected")||e===n)&&o.indexOf(t)<0)return o.push(t),!1}))})),o[0])){var i=su.map(o,(function(e){return function(t,e,n){var r=t.dom;return Qr({height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),class:r.getAttrib(e,"class",""),align:"",type:e.parentNode.nodeName.toLowerCase()},bu("align","align",t,e),n?hu(r,e):{})}(t,e,nu(t))})),c=xu(i),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:Iu(t)},{title:"Advanced",name:"advanced",items:[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}]}]},l={type:"panel",items:[{type:"grid",columns:2,items:Iu(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:nu(t)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(Pu,t,o,c)})}},Mu=Object.prototype.hasOwnProperty,Wu=($r=function(t,e){return e},function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},r=0;r<t.length;r++){var o=t[r];for(var i in o)Mu.call(o,i)&&(n[i]=$r(n[i],o[i]))}return n}),_u=tinymce.util.Tools.resolve("tinymce.Env"),ju={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},zu=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},Hu=function(t,e,n){var r,o=tu(t),i=function(t,e,n,r,o){void 0===o&&(o=ju);var i=Nt.fromTag("table");Mt(i,o.styles),bt(i,o.attributes);var u=Nt.fromTag("tbody");Oe(i,u);for(var c=[],a=0;a<t;a++){for(var l=Nt.fromTag("tr"),f=0;f<e;f++){var s=Nt.fromTag(a<0||f<0?"th":"td");f<0&&vt(s,"scope","row"),a<0&&vt(s,"scope","col"),Oe(s,Nt.fromTag("br")),o.percentages&&kt(s,"width",100/e+"%"),Oe(l,s)}c.push(l)}return Ee(u,c),i}(n,e,0,0,{styles:o,attributes:Zi(t),percentages:(r=o.width,R(r)&&-1!==r.indexOf("%")&&!uu(t))});vt(i,"data-mce-id","__mce");var c,a,l,f=(c=i,a=Nt.fromTag("div"),l=Nt.fromDom(c.dom().cloneNode(!0)),Oe(a,l),a.dom().innerHTML);return t.insertContent(f),Qe(Fi(t),'table[data-mce-id="__mce"]').map((function(e){var n,r;return uu(t)&&kt(e,"width",Wt(e,"width")),xt(e,"data-mce-id"),n=t,k(Ye(e,"tr"),(function(t){cu(n,t.dom()),k(Ye(t,"th,td"),(function(t){au(n,t.dom())}))})),r=t,Qe(e,"td,th").each(u(zu,r)),e.dom()})).getOr(null)},Lu=function(t,e,n){var r=n?[{type:"input",name:"cols",label:"Cols"},{type:"input",name:"rows",label:"Rows"}]:[],o=t.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing"},{type:"input",name:"cellpadding",label:"Cell padding"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=e?[{type:"selectbox",name:"class",label:"Class",items:yu(iu(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})}))}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},Fu=function(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)R(n)?t.setStyle(e,n,r):t.setStyle(e,n);else if(e.children)for(var o=0;o<e.children.length;o++)Fu(t,e.children[o],n,r)},Uu=function(t,e,n){var r,o=t.dom,i=n.getData();n.close(),""===i.class&&delete i.class,t.undoManager.transact((function(){if(!e){var n=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;e=Hu(t,n,u)}!function(t,e,n){var r,o=t.dom,i={},u={};if(i.class=n.class,u.height=Gi(n.height),o.getAttrib(e,"width")&&!ou(t)?i.width=(r=n.width)?r.replace(/px$/,""):"":u.width=Gi(n.width),ou(t)?(u["border-width"]=Gi(n.border),u["border-spacing"]=Gi(n.cellspacing)):(i.border=n.border,i.cellpadding=n.cellpadding,i.cellspacing=n.cellspacing),ou(t)&&e.children)for(var c=0;c<e.children.length;c++)Fu(o,e.children[c],{"border-width":Gi(n.border),padding:Gi(n.cellpadding)}),ru(t)&&Fu(o,e.children[c],{"border-color":n.bordercolor});ru(t)&&(u["background-color"]=n.backgroundcolor,u["border-color"]=n.bordercolor,u["border-style"]=n.borderstyle),i.style=o.serializeStyle(Wu(tu(t),u)),o.setAttribs(e,Wu(Zi(t),i))}(t,e,i),(r=o.select("caption",e)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=_u.ie?"Â ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),""===i.align?gu(t,e):du(t,e,i.align),t.focus(),t.addVisual()}))},qu=function(t,e){var n,r=t.dom,o=function(t,e){var n,r,o,i,u,c,a,l,f=tu(t),s=Zi(t),d=t.dom,m=e?(n=d,r=function(t){return Tt(t,"rgb")?n.toHex(t):t},o=$(f,"border-style").getOr(""),i=$(f,"border-color").getOr(""),u=$(f,"background-color").getOr(""),{borderstyle:o,bordercolor:r(i),backgroundcolor:r(u)}):{};return Qr({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},f,s,m,(l=f["border-width"],ou(t)&&l?{border:l}:$(s,"border").fold((function(){return{}}),(function(t){return{border:t}}))),(c=$(f,"border-spacing").or($(s,"cellspacing")).fold((function(){return{}}),(function(t){return{cellspacing:t}})),a=$(f,"border-padding").or($(s,"cellpadding")).fold((function(){return{}}),(function(t){return{cellpadding:t}})),Qr({},c,a)))}(t,ru(t));!1===e?(n=r.getParent(t.selection.getStart(),"table"))?o=function(t,e,n){var r,o,i,u=t.dom;return Qr({width:u.getStyle(e,"width")||u.getAttrib(e,"width"),height:u.getStyle(e,"height")||u.getAttrib(e,"height"),cellspacing:u.getStyle(e,"border-spacing")||u.getAttrib(e,"cellspacing"),cellpadding:u.getAttrib(e,"cellpadding")||pu(t.dom,e,"padding"),border:(r=u,o=e,i=jt(Nt.fromDom(o),"border-width"),ou(t)&&i.isSome()?i.getOr(""):r.getAttrib(o,"border")||pu(t.dom,o,"border-width")||pu(t.dom,o,"border")),caption:!!u.select("caption",e)[0],class:u.getAttrib(e,"class","")},bu("align","align",t,e),n?hu(u,e):{})}(t,n,ru(t)):ru(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",ru(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=0<iu(t).length;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:Lu(t,i,e)},a=ru(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},{title:"Advanced",name:"advanced",items:[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}]}]}:{type:"panel",items:[c]};t.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:u(Uu,t,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Vu=function(t){return function(e){return x.from(e.dom.getParent(e.selection.getStart(),t)).map(Nt.fromDom)}},Gu=Vu("th,td"),Yu=Vu("th,td,caption"),Ku=su.each,Xu=function(t,e,r,o,i){var c=Vi(t),a=function(t){return un(t,c)},l=function(t){return{width:Ui(t.dom()),height:Ui(t.dom())}},f=function(e){Gu(t).each((function(n){a(n).each((function(i){var u=gr.forMenu(o,i,n),c=l(i);e(i,u).each((function(e){var n,o,u,a;n=t,o=c,a=l(u=i),o.width===a.width&&o.height===a.height||(lu(n,u.dom(),o.width,o.height),fu(n,u.dom(),a.width,a.height)),t.selection.setRng(e),t.focus(),r.clear(i),Yi(i)}))}))}))},s=function(e){return Gu(t).map((function(e){return a(e).bind((function(r){var i=Nt.fromDom(t.getDoc());return function(t,e,n){var r=cn(t),o=fn(r);return zo(o,e).map((function(t){var e=Po(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan());return function(t){return P(t,(function(t){var e=An(t.element());return k(t.cells(),(function(t){var n=Nn(t.element());eo(n,"colspan",t.colspan(),1),eo(n,"rowspan",t.rowspan(),1),Oe(e,n)})),e}))}(ko(e,n))}))}(r,gr.forMenu(o,r,e),kn(n,i,x.none()))}))}))},m=function(e){i.get().each((function(n){var i=P(n,(function(t){return Nn(t)}));Gu(t).each((function(n){a(n).each((function(u){var c=Nt.fromDom(t.getDoc()),a=Mn(c),l=gr.pasteRows(o,u,n,i,a);e(u,l).each((function(e){t.selection.setRng(e),t.focus(),r.clear(u)}))}))}))}))};Ku({mceTableSplitCells:function(){f(e.unmergeCells)},mceTableMergeCells:function(){f(e.mergeCells)},mceTableInsertRowBefore:function(){f(e.insertRowsBefore)},mceTableInsertRowAfter:function(){f(e.insertRowsAfter)},mceTableInsertColBefore:function(){f(e.insertColumnsBefore)},mceTableInsertColAfter:function(){f(e.insertColumnsAfter)},mceTableDeleteCol:function(){f(e.deleteColumn)},mceTableDeleteRow:function(){f(e.deleteRow)},mceTableCutRow:function(t){s().each((function(t){i.set(t),f(e.deleteRow)}))},mceTableCopyRow:function(t){s().each((function(t){i.set(t)}))},mceTablePasteRowBefore:function(t){m(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){m(e.pasteRowsAfter)},mceTableDelete:function(){Yu(t).each((function(e){un(e,c).filter(d(c)).each((function(e){var n=Nt.fromText("");if(Te(e,n),Ie(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r),t.nodeChanged()}}))}))}},(function(e,n){t.addCommand(n,e)})),Ku({mceInsertTable:u(qu,t,!0),mceTableProps:u(qu,t,!1),mceTableRowProps:u(ku,t),mceTableCellProps:u(Eu,t)},(function(e,n){t.addCommand(n,(function(){e()}))}))},$u=function(t){var e=x.from(t.dom().documentElement).map(Nt.fromDom).getOr(t);return{parent:o(e),view:o(t),origin:o(Pr(0,0))}},Ju=function(t){var e=Q.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},unbind:function(t){n=M(n,(function(e){return e!==t}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);k(n,(function(t){t(o)}))}}},Qu=function(t){return{registry:K(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),trigger:K(t,(function(t){return t.trigger}))}},Zu=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},tc=o(!0),ec=function(t,e,n){return function(t,e,n,i){return c=t,a=e,l=!1,f=function(t,e){return function(n){if(t(n)){var i,u,c,a,l,f,s,d=Nt.fromDom(n.target),m=function(){n.stopPropagation()},g=function(){n.preventDefault()},p=r(g,m),h=(i=d,u=n.clientX,c=n.clientY,a=m,l=g,f=p,s=n,{target:o(i),x:o(u),y:o(c),stop:a,prevent:l,kill:f,raw:o(s)});e(h)}}}(n,i),c.dom().addEventListener(a,f,l),{unbind:u(Zu,c,a,f,l)};var c,a,l,f}(t,e,tc,n)},nc={resolve:fo("ephox-dragster").resolve},rc=xi(["compare","extract","mutate","sink"]),oc=xi(["element","start","stop","destroy"]),ic=xi(["forceDrop","drop","move","delayDrop"]),uc=rc({compare:function(t,e){return Pr(e.left()-t.left(),e.top()-t.top())},extract:function(t){return x.some(Pr(t.x(),t.y()))},sink:function(t,e){var n,r,o,i=(n=e,r=Wu({layerClass:nc.resolve("blocker")},n),o=Nt.fromTag("div"),vt(o,"role","presentation"),Mt(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ro(o,nc.resolve("blocker")),ro(o,r.layerClass),{element:function(){return o},destroy:function(){Ie(o)}}),u=ec(i.element(),"mousedown",t.forceDrop),c=ec(i.element(),"mouseup",t.drop),a=ec(i.element(),"mousemove",t.move),l=ec(i.element(),"mouseout",t.delayDrop);return oc({element:i.element,start:function(t){Oe(t,i.element())},stop:function(){Ie(i.element())},destroy:function(){i.destroy(),c.unbind(),a.unbind(),l.unbind(),u.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});var cc=function(e,r){return void 0===r&&(r={}),function(e,r,o){var i,u,c=!1,a=Qu({start:Ju([]),stop:Ju([])}),l=function(){var t={onEvent:n,reset:n},e=function(){var t=x.none(),e=Qu({move:Ju(["info"])});return{onEvent:function(n,r){r.extract(n).each((function(n){var o,i,u;(o=r,i=n,u=t.map((function(t){return o.compare(t,i)})),t=x.some(i),u).each((function(t){e.trigger.move(t)}))}))},reset:function(){t=x.none()},events:e.registry}}(),r=t;return{on:function(){r.reset(),r=e},off:function(){r.reset(),r=t},isOn:function(){return r===e},onEvent:function(t,e){r.onEvent(t,e)},events:e.events}}(),f=function(){m.stop(),l.isOn()&&(l.off(),a.trigger.stop())},s=(i=f,u=null,{cancel:function(){null!==u&&(t.clearTimeout(u),u=null)},throttle:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null!==u&&t.clearTimeout(u),u=t.setTimeout((function(){i.apply(null,e),u=null}),200)}});l.events.move.bind((function(t){r.mutate(e,t.info())}));var d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];c&&t.apply(null,e)}},m=r.sink(ic({forceDrop:f,drop:d(f),move:d((function(t){s.cancel(),l.onEvent(t,r)})),delayDrop:d(s.throttle)}),o);return{element:m.element,go:function(t){m.start(t),l.on(),a.trigger.start()},on:function(){c=!0},off:function(){c=!1},destroy:function(){m.destroy()},events:a.registry}}(e,void 0!==r.mode?r.mode:uc,r)},ac=function(t){return"true"===wt(t,"contenteditable")},lc=so.resolve("resizer-bar-dragging"),fc=function(t,e){return Ui(t.dom())/Ui(e.dom())*100+"%"},sc=function(t){var e,n,r=x.none(),i=x.none(),c=x.none(),a=/(\d+(\.\d+)?)%/,l=function(t){return"TABLE"===t.nodeName},f=function(e){var n=t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width");return x.from(n).filter((function(t){return 0<t.length}))},s=function(){return i};return t.on("init",(function(){var e,n=Xr($i),a=function(t){return t.inline?function(t,e){return{parent:o(e),view:o(t),origin:o(Pr(0,0))}}(Fi(t),(e=Nt.fromTag("div"),Mt(e,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Oe(Bt(),e),e)):$u(Nt.fromDom(t.getDoc()));var e}(t);if(c=x.some(a),e=t.getParam("object_resizing",!0),(R(e)?"table"===e:e)&&t.getParam("table_resize_bars",!0,"boolean")){var l=function(t,e){var n=Yr.height,r=function(t,e,n){var r=function(){var t,e=Qu({drag:Ju(["xDelta","yDelta","target"])}),n=x.none(),r={mutate:function(e,n){t.trigger.drag(e,n)},events:(t=Qu({drag:Ju(["xDelta","yDelta"])})).registry};return r.events.drag.bind((function(t){n.each((function(n){e.trigger.drag(t.xDelta(),t.yDelta(),n)}))})),{assign:function(t){n=x.some(t)},get:function(){return n},mutate:r.mutate,events:e.registry}}(),o=cc(r,{}),i=x.none(),c=function(t,e){return x.from(wt(t,e))};r.events.drag.bind((function(t){c(t.target(),"data-row").each((function(e){var n=ui.getInt(t.target(),"top");kt(t.target(),"top",n+t.yDelta()+"px")})),c(t.target(),"data-column").each((function(e){var n=ui.getInt(t.target(),"left");kt(t.target(),"left",n+t.xDelta()+"px")}))}));var a=function(t,e){return ui.getInt(t,e)-parseInt(wt(t,"data-initial-"+e),10)};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){c(r,"data-row").each((function(t){var e=a(r,"top");xt(r,"data-initial-top"),m.trigger.adjustHeight(o,e,parseInt(t,10))})),c(r,"data-column").each((function(t){var e=a(r,"left");xt(r,"data-initial-left"),m.trigger.adjustWidth(o,e,parseInt(t,10))})),wo(t,o,n,e)}))}))}));var l=function(e,n){m.trigger.startAdjust(),r.assign(e),vt(e,"data-initial-"+n,parseInt(Wt(e,n),10)),ro(e,lc),kt(e,"opacity","0.2"),o.go(t.parent())},f=ec(t.parent(),"mousedown",(function(t){(function(t){return oo(t,go)})(t.target())&&l(t.target(),"top"),function(t){return oo(t,po)}(t.target())&&l(t.target(),"left")})),s=function(e){return ge(e,t.view())},d=ec(t.view(),"mouseover",(function(r){(function(t){return Ze(t,"table",s).filter((function(t){return(e=t,n=s,Ze(e,"[contenteditable]",n)).exists(ac);var e,n}))})(r.target()).fold((function(){Et(r.target())&&So(t)}),(function(r){i=x.some(r),wo(t,r,n,e)}))})),m=Qu({adjustHeight:Ju(["table","delta","row"]),adjustWidth:Ju(["table","delta","column"]),startAdjust:Ju([])});return{destroy:function(){f.unbind(),d.unbind(),o.destroy(),So(t)},refresh:function(r){wo(t,r,n,e)},on:o.on,off:o.off,hideBars:u(yo,t),showBars:u(xo,t),events:m.registry}}(t,e,n),i=Qu({beforeResize:Ju(["table"]),afterResize:Ju(["table"]),startDrag:Ju([])});return r.events.adjustHeight.bind((function(t){i.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());(function(t,e,n,r){var i=wi(t),u=mi.getPixelHeights(i,r),c=P(u,(function(t,r){return n===r?Math.max(e+t,ui.minHeight()):t})),a=function(t,e){var n=gn(t);return P(n,(function(t){var n=gi(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:o(n),rowspan:t.rowspan}}))}(i,c),l=function(t,e){return P(t.all(),(function(t,n){return{element:t.element,height:o(e[n])}}))}(i,c);k(l,(function(t){Er.setHeight(t.element(),t.height())})),k(a,(function(t){Er.setHeight(t.element(),t.height())}));var f=W(c,(function(t,e){return t+e}),0);Er.setHeight(t,f)})(t.table(),e,t.row(),n),i.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){i.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){i.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());(function(t,e,n,r){var i=vi(t),u=i.getCellDelta(e),c=wi(t),a=i.getWidths(c,r,i),l=function(t,e,n,r){var i,u,c=t.slice(0),a=(u=e,0===(i=t).length?oi.none():1===i.length?oi.only(0):0===u?oi.left(0,1):u===i.length-1?oi.right(u-1,u):0<u&&u<i.length-1?oi.middle(u-1,u,u+1):oi.none()),l=function(t){return P(t,o(0))},f=o(l(c)),s=function(t,e){if(0<=n){var o=Math.max(r.minCellWidth(),c[e]-n);return l(c.slice(0,t)).concat([n,o-c[e]]).concat(l(c.slice(e+1)))}var i=Math.max(r.minCellWidth(),c[t]+n),u=c[t]-i;return l(c.slice(0,t)).concat([i-c[t],u]).concat(l(c.slice(e+1)))},d=s;return a.fold(f,(function(t){return r.singleColumnWidth(c[t],n)}),d,(function(t,e,n){return s(e,n)}),(function(t,e){if(0<=n)return l(c.slice(0,e)).concat([n]);var o=Math.max(r.minCellWidth(),c[e]+n);return l(c.slice(0,e)).concat([o-c[e]])}))}(a,n,u,i),f=P(l,(function(t,e){return t+a[e]})),s=pi(c,f);k(s,(function(t){i.setElementWidth(t.element(),t.width())})),n===c.grid().columns()-1&&i.setTableWidth(t,f,u)})(t.table(),n,t.column(),e),i.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:i.registry}}(a,n);l.on(),l.events.startDrag.bind((function(e){r=x.some(t.selection.getRng())})),l.events.beforeResize.bind((function(e){var n=e.table().dom();lu(t,n,Ui(n),qi(n))})),l.events.afterResize.bind((function(e){var n=e.table(),o=n.dom();Yi(n),r.each((function(e){t.selection.setRng(e),t.focus()})),fu(t,o,Ui(o),qi(o)),t.undoManager.add()})),i=x.some(l)}})),t.on("ObjectResizeStart",(function(r){var o,i,u=r.target;if(l(u)){var c=f(u).map((function(t){return a.test(t)})).getOr(!1);c&&uu(t)?kt(Nt.fromDom(i=u),"width",Ui(i).toString()+"px"):c||!0!==t.getParam("table_responsive_width")||(o=Nt.fromDom(u),be(o).map((function(t){return fc(o,t)})).each((function(t){kt(o,"width",t),k(Ye(o,"tr"),(function(t){k(Se(t),(function(e){kt(e,"width",fc(e,t))}))}))}))),e=r.width,n=f(u).getOr("")}})),t.on("ObjectResized",(function(r){var o=r.target;if(l(o)){var i=o;if(a.test(n)){var u=parseFloat(a.exec(n)[1]),c=r.width*u/e;t.dom.setStyle(i,"width",c+"%")}else{var f=[];su.each(i.rows,(function(e){su.each(e.cells,(function(e){var n=t.dom.getStyle(e,"width",!0);f.push({cell:e,width:n})}))})),su.each(f,(function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)}))}}})),t.on("SwitchMode",(function(){s().each((function(e){t.readonly?e.hideBars():e.showBars()}))})),{lazyResize:s,lazyWire:function(){return c.getOr($u(Nt.fromDom(t.getBody())))},destroy:function(){i.each((function(t){t.destroy()})),c.each((function(e){!function(t,e){t.inline&&Ie(e.parent())}(t,e)}))}}},dc=ir([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),mc=Qr({},dc,{none:function(t){return void 0===t&&(t=void 0),dc.none(t)}}),gc=function(t,e){return un(t,e).bind((function(e){var n=on(e);return z(n,(function(e){return ge(t,e)})).map((function(t){return{index:o(t),all:o(n)}}))}))},pc={create:Q("start","soffset","finish","foffset")},hc=ir([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),vc={before:hc.before,on:hc.on,after:hc.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(i,i,i)}},bc=ir([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),wc={domRange:bc.domRange,relative:bc.relative,exact:bc.exact,exactFromRange:function(t){return bc.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var e;return e=t.match({domRange:function(t){return Nt.fromDom(t.startContainer)},relative:function(t,e){return vc.getStart(t)},exact:function(t,e,n,r){return t}}).dom().ownerDocument.defaultView,Nt.fromDom(e)},range:pc.create},yc=function(t,e,n){var r,o,i=t.document.createRange();return r=i,e.fold((function(t){r.setStartBefore(t.dom())}),(function(t,e){r.setStart(t.dom(),e)}),(function(t){r.setStartAfter(t.dom())})),o=i,n.fold((function(t){o.setEndBefore(t.dom())}),(function(t,e){o.setEnd(t.dom(),e)}),(function(t){o.setEndAfter(t.dom())})),i},xc=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},Sc=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Cc=ir([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Rc=function(t,e,n){return e(Nt.fromDom(n.startContainer),n.startOffset,Nt.fromDom(n.endContainer),n.endOffset)},Tc=function(t,e){var n,r,i,u=(n=t,e.match({domRange:function(t){return{ltr:o(t),rtl:x.none}},relative:function(t,e){return{ltr:Ot((function(){return yc(n,t,e)})),rtl:Ot((function(){return x.some(yc(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:Ot((function(){return xc(n,t,e,r,o)})),rtl:Ot((function(){return x.some(xc(n,r,o,t,e))}))}}}));return(i=(r=u).ltr()).collapsed?r.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Cc.rtl(Nt.fromDom(t.endContainer),t.endOffset,Nt.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Rc(0,Cc.ltr,i)})):Rc(0,Cc.ltr,i)},Dc=function(t,e){return Tc(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},Oc=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},Ac=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return to(i,(function(t){return Oc(t,n,r)?x.some(t):x.none()})).map((function(o){return function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=bn(e).length,c=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(e-c.left);if(n<=c.bottom){if(n<c.top||i<a)return u-1;i=a}}return 0}((function(t){return i(t).getBoundingClientRect()}),n,r,o.right,u);return i(c)}(t,e,n,r,o)}))},Nc=function(t,e,n,r){var o=t.dom().createRange(),i=Se(e);return to(i,(function(e){return o.selectNode(e.dom()),Oc(o.getBoundingClientRect(),n,r)?Ec(t,e,n,r):x.none()}))},Ec=function(t,e,n,r){return(gt(e)?Ac:Nc)(t,e,n,r)},Bc=function(t,e){return e-t.left<t.right-e},Ic=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},Pc=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Bc(o,n);return(!0===i?Rn:Tn)(e).map((function(e){return Ic(t,e,i)}))},kc=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Bc(r,n);return x.some(Ic(t,e,o))},Mc=document.caretPositionFromPoint?function(t,e,n){return x.from(t.dom().caretPositionFromPoint(e,n)).bind((function(e){if(null===e.offsetNode)return x.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),x.some(n)}))}:document.caretRangeFromPoint?function(t,e,n){return x.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return Nt.fromPoint(t,e,n).bind((function(r){var o=function(){return n=t,i=e,(0===Se(o=r).length?kc:Pc)(n,o,i);var n,o,i};return 0===Se(r).length?o():function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect();return function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),c=Math.max(i.top,Math.min(i.bottom,r));return Ec(t,e,u,c)}(t,e,Math.max(i.left,Math.min(i.right,n)),Math.max(i.top,Math.min(i.bottom,r)))}(t,r,e,n).orThunk(o)}))},Wc=function(t,e){var n=lt(t);return"input"===n?vc.after(t):B(["br","img"],n)?0===e?vc.before(t):vc.after(t):vc.on(t,e)},_c=function(t,e){var n=t.fold(vc.before,Wc,vc.after),r=e.fold(vc.before,Wc,vc.after);return wc.relative(n,r)},jc=function(t,e,n,r){var o=Wc(t,e),i=Wc(n,r);return wc.relative(o,i)},zc=function(t,e){x.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(e)}))},Hc=function(t,e,n,r,o){var i=xc(t,e,n,r,o);zc(t,i)},Lc=function(t,e){return Tc(t,e).match({ltr:function(e,n,r,o){Hc(t,e,n,r,o)},rtl:function(e,n,r,o){var i,u,c,a,l,f=t.getSelection();if(f.setBaseAndExtent)f.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(f.extend)try{u=e,c=n,a=r,l=o,(i=f).collapse(u.dom(),c),i.extend(a.dom(),l)}catch(i){Hc(t,r,o,e,n)}else Hc(t,r,o,e,n)}})},Fc=function(t){var e=Nt.fromDom(t.anchorNode),n=Nt.fromDom(t.focusNode);return function(t,e,n,r){var o,i,u,c,a,l=(i=e,u=n,c=r,(a=ve(o=t).dom().createRange()).setStart(o.dom(),i),a.setEnd(u.dom(),c),a),f=ge(t,n)&&e===r;return l.collapsed&&!f}(e,t.anchorOffset,n,t.focusOffset)?x.some(pc.create(e,t.anchorOffset,n,t.focusOffset)):function(t){if(0<t.rangeCount){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return x.some(pc.create(Nt.fromDom(e.startContainer),e.startOffset,Nt.fromDom(n.endContainer),n.endOffset))}return x.none()}(t)},Uc=tinymce.util.Tools.resolve("tinymce.util.VK"),qc=function(t,e,n,r){return Yc(t,e,function(t){return gc(t,void 0).fold((function(){return mc.none(t)}),(function(e){return e.index()+1<e.all().length?mc.middle(t,e.all()[e.index()+1]):mc.last(t)}))}(n),r)},Vc=function(t,e,n,r){return Yc(t,e,function(t){return gc(t,void 0).fold((function(){return mc.none()}),(function(e){return 0<=e.index()-1?mc.middle(t,e.all()[e.index()-1]):mc.first(t)}))}(n),r)},Gc=function(t,e){return function(t){var e=wc.getWin(t).dom(),n=function(t,n,r,o){return xc(e,t,n,r,o)},r=t.match({domRange:function(t){var e=Nt.fromDom(t.startContainer),n=Nt.fromDom(t.endContainer);return jc(e,t.startOffset,n,t.endOffset)},relative:_c,exact:jc});return Tc(e,r).match({ltr:n,rtl:n})}(wc.exact(e,0,e,0))},Yc=function(t,e,n,r,o){return n.fold(x.none,x.none,(function(t,e){return Rn(e).map((function(t){return Gc(0,t)}))}),(function(n){return un(n,e).bind((function(e){var o=gr.noMenu(n);return t.undoManager.transact((function(){r.insertRowsAfter(e,o)})),function(t,e){var n;return(n=Ye(e,"tr"),0===n.length?x.none():x.some(n[n.length-1])).bind((function(t){return Qe(t,"td,th").map((function(t){return Gc(0,t)}))}))}(0,e)}))}))},Kc=["table","li","dl"],Xc=function(t,e,n,r){if(t.keyCode===Uc.TAB){var o=Fi(e),i=function(t){var e=lt(t);return ge(t,o)||B(Kc,e)},u=e.selection.getRng();if(u.collapsed){var c=Nt.fromDom(u.startContainer);rn(c,i).each((function(o){t.preventDefault(),(t.shiftKey?Vc:qc)(e,i,o,n,r).each((function(t){e.selection.setRng(t)}))}))}}},$c={create:Q("selection","kill")},Jc=function(t,e,n,r){return{start:o(vc.on(t,e)),finish:o(vc.on(n,r))}},Qc=function(t,e){var n=Dc(t,e);return pc.create(Nt.fromDom(n.startContainer),n.startOffset,Nt.fromDom(n.endContainer),n.endOffset)},Zc=Jc,ta=function(t,e,n,r,o){return ge(n,r)?x.none():tr(n,r,e).bind((function(e){var r=e.boxes().getOr([]);return 0<r.length?(o(t,r,e.start(),e.finish()),x.some($c.create(x.some(Zc(n,0,n,xn(n))),!0))):x.none()}))},ea=ta,na=function(t,e,n,r,i){return function(t,e,n,r,i){return(u=t,c=i,j(u,(function(t){return de(t,c)}))).bind((function(t){return function(t,e,n){return un(t).bind((function(r){return function(t,e,n,r){return dn(t,e,ge).bind((function(e){var o=0<n?e.row()+e.rowspan()-1:e.row(),i=0<r?e.column()+e.colspan()-1:e.column();return sn(t,o+n,i+r).map((function(t){return t.element()}))}))}(Fn(r),t,e,n)}))}(t,e,n).bind((function(t){return n=r,$e(e=t,"table").bind((function(t){return Qe(t,n).bind((function(t){return Zn(t,e).bind((function(t){return t.boxes().map((function(e){return{boxes:o(e),start:o(t.start()),finish:o(t.finish())}}))}))}))}));var e,n}))}));var u,c}(r,t,e,i.firstSelectedSelector(),i.lastSelectedSelector()).map((function(t){return i.clear(n),i.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()}))},ra=Q("item","mode"),oa=function(t,e,n,r){return void 0===r&&(r=ia),t.property().parent(e).map((function(t){return ra(t,r)}))},ia=function(t,e,n,r){return void 0===r&&(r=ua),n.sibling(t,e).map((function(t){return ra(t,r)}))},ua=function(t,e,n,r){void 0===r&&(r=ua);var o=t.property().children(e);return n.first(o).map((function(t){return ra(t,r)}))},ca=[{current:oa,next:ia,fallback:x.none()},{current:ia,next:ua,fallback:x.some(oa)},{current:ua,next:ua,fallback:x.some(ia)}],aa=function(t,e,n,r,o){return void 0===o&&(o=ca),j(o,(function(t){return t.current===n})).bind((function(n){return n.current(t,e,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return aa(t,e,n,r)}))}))}))},la=function(t,e,n,r,o,i){return aa(t,e,r,o).bind((function(e){return i(e.item())?x.none():n(e.item())?x.some(e.item()):la(t,e.item(),n,e.mode(),o,i)}))},fa=function(t){return function(e){return 0===t.property().children(e).length}},sa=function(t,e,n,r){return la(t,e,n,ia,{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return 0<t.length?x.some(t[t.length-1]):x.none()}},r)},da=function(t,e,n,r){return la(t,e,n,ia,{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return 0<t.length?x.some(t[0]):x.none()}},r)},ma=Gn(),ga=function(t,e){return r=e,sa(n=ma,t,fa(n),r);var n,r},pa=function(t,e){return r=e,da(n=ma,t,fa(n),r);var n,r},ha=Q("element","offset"),va=(Q("element","deltaOffset"),Q("element","start","finish"),Q("begin","end"),Q("element","text"),ir([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),ba=function(t){return Ze(t,"tr")},wa=Qr({},va,{verify:function(t,e,n,r,o,i,u){return Ze(r,"td,th",u).bind((function(n){return Ze(e,"td,th",u).map((function(e){return ge(n,e)?ge(r,n)&&xn(n)===o?i(e):va.none("in same cell"):$n(ba,[n,e]).fold((function(){return o=e,u=n,c=(r=t).getRect(o),(a=r.getRect(u)).right>c.left&&a.left<c.right?va.success():i(e);var r,o,u,c,a}),(function(t){return i(e)}))}))})).getOr(va.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)}}),ya=(Q("ancestor","descendants","element","index"),Q("parent","children","element","index")),xa=function(t){return"br"===lt(t)},Sa=function(t,e,n){return e(t,n).bind((function(t){return gt(t)&&0===bn(t).trim().length?Sa(t,e,n):x.some(t)}))},Ca=ot(["left","top","right","bottom"],[]),Ra={nu:Ca,moveUp:function(t,e){return Ca({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return Ca({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return Ca({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return Ca({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return Ca({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},Ta=function(t){return Ra.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Da=function(t,e){return x.some(t.getRect(e))},Oa=function(t,e,n){return mt(e)?Da(t,e).map(Ta):gt(e)?(r=t,o=e,i=n,0<=i&&i<xn(o)?r.getRangedRect(o,i,o,i+1):0<i?r.getRangedRect(o,i-1,o,i):x.none()).map(Ta):x.none();var r,o,i},Aa=function(t,e){return mt(e)?Da(t,e).map(Ta):gt(e)?t.getRangedRect(e,0,e,xn(e)).map(Ta):x.none()},Na=ir([{none:[]},{retry:["caret"]}]),Ea=function(t,e,n){return(r=e,i=Ni,Ke((function(t){return i(t)}),Xe,r,i,void 0)).fold(o(!1),(function(e){return Aa(t,e).exists((function(t){return r=t,(e=n).left()<r.left()||Math.abs(r.right()-e.left())<1||e.left()>r.right();var e,r}))}));var r,i},Ba={point:Ra.getTop,adjuster:function(t,e,n,r,o){var i=Ra.moveUp(o,5);return Math.abs(n.top()-r.top())<1||n.bottom()<o.top()?Na.retry(i):n.bottom()===o.top()?Na.retry(Ra.moveUp(o,1)):Ea(t,e,o)?Na.retry(Ra.translate(i,5,0)):Na.none()},move:Ra.moveUp,gather:ga},Ia={point:Ra.getBottom,adjuster:function(t,e,n,r,o){var i=Ra.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1||n.top()>o.bottom()?Na.retry(i):n.top()===o.bottom()?Na.retry(Ra.moveDown(o,1)):Ea(t,e,o)?Na.retry(Ra.translate(i,5,0)):Na.none()},move:Ra.moveDown,gather:pa},Pa=function(t,e,n,r,o){return 0===o?x.some(r):(a=t,l=r.left(),f=e.point(r),a.elementFromPoint(l,f).filter((function(t){return"table"===lt(t)})).isSome()?(u=r,c=o-1,Pa(t,i=e,n,i.move(u,5),c)):t.situsFromPoint(r.left(),e.point(r)).bind((function(i){return i.start().fold(x.none,(function(i){return Aa(t,i).bind((function(u){return e.adjuster(t,i,u,n,r).fold(x.none,(function(r){return Pa(t,e,n,r,o-1)}))})).orThunk((function(){return x.some(r)}))}),x.none)})));var i,u,c,a,l,f},ka=function(t,e,n){var r,o,i,u=t.move(n,5),c=Pa(e,t,n,u,100).getOr(u);return(r=t,o=c,i=e,r.point(o)>i.getInnerHeight()?x.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?x.some(-r.point(o)):x.none()).fold((function(){return e.situsFromPoint(c.left(),t.point(c))}),(function(n){return e.scrollBy(0,n),e.situsFromPoint(c.left(),t.point(c)-n)}))},Ma={tryUp:u(ka,Ba),tryDown:u(ka,Ia),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:o(5)},Wa=le.detect(),_a=function(t,e,n,r,o,i){return 0===i?x.none():Ha(t,e,n,r,o).bind((function(u){var c=t.fromSitus(u),a=wa.verify(t,n,r,c.finish(),c.foffset(),o.failure,e);return wa.cata(a,(function(){return x.none()}),(function(){return x.some(u)}),(function(u){return ge(n,u)&&0===r?ja(t,n,r,Ra.moveUp,o):_a(t,e,u,0,o,i-1)}),(function(u){return ge(n,u)&&r===xn(u)?ja(t,n,r,Ra.moveDown,o):_a(t,e,u,xn(u),o,i-1)}))}))},ja=function(t,e,n,r,o){return Oa(t,e,n).bind((function(e){return za(t,o,r(e,Ma.getJumpSize()))}))},za=function(t,e,n){return Wa.browser.isChrome()||Wa.browser.isSafari()||Wa.browser.isFirefox()||Wa.browser.isEdge()?e.otherRetry(t,n):Wa.browser.isIE()?e.ieRetry(t,n):x.none()},Ha=function(t,e,n,r,o){return Oa(t,n,r).bind((function(e){return za(t,o,e)}))},La=function(t,e,n){return(r=t,i=e,c=n,r.getSelection().bind((function(t){return function(t,e,n,r){var i,c,a;return(xa(e)?(i=t,c=e,(a=r).traverse(c).orThunk((function(){return Sa(c,a.gather,i)})).map(a.relative)):function(t,e,n,r){return(o=e,i=n,Ce(o,i).filter(xa).orThunk((function(){return Ce(o,i-1).filter(xa)}))).bind((function(e){return r.traverse(e).fold((function(){return Sa(e,r.gather,t).map(r.relative)}),(function(t){return(e=t,be(e).bind((function(t){var n=Se(t);return function(t,e){return z(t,u(ge,e))}(n,e).map((function(r){return ya(t,n,e,r)}))}))).map((function(t){return vc.on(t.parent(),t.index())}));var e}))}));var o,i}(t,e,n,r)).map((function(t){return{start:o(t),finish:o(t)}}))}(i,t.finish(),t.foffset(),c).fold((function(){return x.some(ha(t.finish(),t.foffset()))}),(function(e){var n=r.fromSitus(e);return function(t){return wa.cata(t,(function(t){return x.none()}),(function(){return x.none()}),(function(t){return x.some(ha(t,0))}),(function(t){return x.some(ha(t,xn(t)))}))}(wa.verify(r,t.finish(),t.foffset(),n.finish(),n.foffset(),c.failure,i))}))}))).bind((function(r){return _a(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)}));var r,i,c},Fa=le.detect(),Ua=function(t,e,n,r,i){return Ze(r,"td,th",e).bind((function(r){return Ze(r,"table",e).bind((function(u){return function(t,e){return Xe(t,(function(t){return be(t).exists((function(t){return ge(t,e)}))}),void 0).isSome()}(i,u)?La(t,e,n).bind((function(t){return Ze(t.finish(),"td,th",e).map((function(e){return{start:o(r),finish:o(e),range:o(t)}}))})):x.none()}))}))},qa=function(t,e,n,r,o,i){return Fa.browser.isIE()?x.none():i(r,e).orThunk((function(){return Ua(t,e,n,r,o).map((function(t){var e=t.range();return $c.create(x.some(Zc(e.start(),e.soffset(),e.finish(),e.foffset())),!0)}))}))},Va=function(t,e,n,r,o,i,u){return Ua(t,n,r,o,i).bind((function(t){return ea(e,n,t.start(),t.finish(),u)}))},Ga=function(t,e){return Ze(t,"tr",e).bind((function(t){return Ze(t,"table",e).bind((function(n){var r,o,i,u=Ye(n,"tr");return ge(t,u[0])?(r=n,o=function(t){return Tn(t).isSome()},i=e,sa(ma,r,o,i)).map((function(t){var e=xn(t);return $c.create(x.some(Zc(t,e,t,e)),!0)})):x.none()}))}))},Ya=function(t,e){return Ze(t,"tr",e).bind((function(t){return Ze(t,"table",e).bind((function(n){var r,o,i,u=Ye(n,"tr");return ge(t,u[u.length-1])?(r=n,o=function(t){return Rn(t).isSome()},i=e,da(ma,r,o,i)).map((function(t){return $c.create(x.some(Zc(t,0,t,0)),!0)})):x.none()}))}))},Ka=function(t,e){return Ze(t,"td,th",e)},Xa={down:{traverse:xe,gather:pa,relative:vc.before,otherRetry:Ma.tryDown,ieRetry:Ma.ieTryDown,failure:wa.failedDown},up:{traverse:ye,gather:ga,relative:vc.before,otherRetry:Ma.tryUp,ieRetry:Ma.ieTryUp,failure:wa.failedUp}},$a=function(t){return function(e){return e===t}},Ja=$a(38),Qa=$a(40),Za={ltr:{isBackward:$a(37),isForward:$a(39)},rtl:{isBackward:$a(39),isForward:$a(37)},isUp:Ja,isDown:Qa,isNavigation:function(t){return 37<=t&&t<=40}},tl=(le.detect().browser.isSafari(),function(e){return{elementFromPoint:function(t,n){return Nt.fromPoint(Nt.fromDom(e.document),t,n)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,n,r,o){var i=wc.exact(t,n,r,o);return function(t,e){var n,r,o;return 0<(o=0<(r=(n=Dc(t,e)).getClientRects()).length?r[0]:n.getBoundingClientRect()).width||0<o.height?x.some(o).map(Sc):x.none()}(e,i).map((function(t){return K(t,m)}))},getSelection:function(){return function(t){return(e=t,x.from(e.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Fc)).map((function(t){return wc.exact(t.start(),t.soffset(),t.finish(),t.foffset())}));var e}(e).map((function(t){return Qc(e,t)}))},fromSitus:function(t){var n=wc.relative(t.start(),t.finish());return Qc(e,n)},situsFromPoint:function(t,n){return function(t,e,n){return r=e,o=n,i=Nt.fromDom(t.document),Mc(i,r,o).map((function(t){return pc.create(Nt.fromDom(t.startContainer),t.startOffset,Nt.fromDom(t.endContainer),t.endOffset)}));var r,o,i}(e,t,n).map((function(t){return Jc(t.start(),t.soffset(),t.finish(),t.foffset())}))},clearSelection:function(){e.getSelection().removeAllRanges()},setSelection:function(t){var n,r,o,i,u,c;n=e,r=t.start(),o=t.soffset(),i=t.finish(),u=t.foffset(),c=jc(r,o,i,u),Lc(n,c)},setRelativeSelection:function(t,n){var r,o;r=e,o=_c(t,n),Lc(r,o)},selectContents:function(t){!function(t,e){var n,r,o=(n=e,function(t,e){t.selectNodeContents(e.dom())}(r=t.document.createRange(),n),r);zc(t,o)}(e,t)},getInnerHeight:function(){return e.innerHeight},getScrollY:function(){var n,r,o,i;return(n=Nt.fromDom(e.document),r=void 0!==n?n.dom():t.document,o=r.body.scrollLeft||r.documentElement.scrollLeft,i=r.body.scrollTop||r.documentElement.scrollTop,Pr(o,i)).top()},scrollBy:function(n,r){var o,i,u;o=n,i=r,(void 0!==(u=Nt.fromDom(e.document))?u.dom():t.document).defaultView.scrollBy(o,i)}}}),el=Q("rows","cols"),nl=function(t,e,n,r){var o=tl(t),i=function(){return r.clear(e),x.none()};return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return er(e,r.selectedSelector()).fold((function(){return Za.isDown(m)&&g?u(Va,o,e,n,Xa.down,l,c,r.selectRange):Za.isUp(m)&&g?u(Va,o,e,n,Xa.up,l,c,r.selectRange):Za.isDown(m)?u(qa,o,n,Xa.down,l,c,Ya):Za.isUp(m)?u(qa,o,n,Xa.up,l,c,Ga):x.none}),(function(t){var n=function(n){return function(){return to(n,(function(n){return na(n.rows(),n.cols(),e,t,r)})).fold((function(){return nr(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var n=Za.isDown(m)||s.isForward(m)?vc.after:vc.before;return o.setRelativeSelection(vc.on(t.first(),0),n(t.table())),r.clear(e),$c.create(x.none(),!0)}))}),(function(t){return x.some($c.create(x.none(),!0))}))}};return Za.isDown(m)&&g?n([el(1,0)]):Za.isUp(m)&&g?n([el(-1,0)]):s.isBackward(m)&&g?n([el(0,-1),el(-1,0)]):s.isForward(m)&&g?n([el(0,1),el(1,0)]):Za.isNavigation(m)&&!1===g?i:x.none}))()},keyup:function(t,o,i,u,c){return er(e,r.selectedSelector()).fold((function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?x.none():Za.isNavigation(l)?function(t,e,n,r,o,i,u){return ge(n,o)&&r===i?x.none():Ze(n,"td,th",e).bind((function(n){return Ze(o,"td,th",e).bind((function(r){return ta(t,e,n,r,u)}))}))}(e,n,o,i,u,c,r.selectRange):x.none()}),x.none)}}},rl=function(t){return!1===oo(Nt.fromDom(t.target),"ephox-snooker-resizer-bar")};S.add("table",(function(i){var u=sc(i),c=function(t,e){var i=ot(["mousedown","mouseover","mouseup","keyup","keydown"],[]),u=x.none(),c=function(t){var e=function(e){xt(e,t.selected()),xt(e,t.firstSelected()),xt(e,t.lastSelected())},n=function(e){vt(e,t.selected(),"1")},r=function(n){var r=Ye(n,t.selectedSelector());k(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),k(o,n),vt(i,t.firstSelected(),"1"),vt(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}(or);return t.on("init",(function(a){var l=t.getWin(),f=Fi(t),s=Vi(t),d=function(t,e,n,r){var o=function(t,e,n,r){var o=x.none(),i=function(){o=x.none()};return{mousedown:function(t){r.clear(e),o=Ka(t.target(),n)},mouseover:function(i){o.each((function(o){r.clear(e),Ka(i.target(),n).each((function(i){tr(o,i,n).each((function(n){var u=n.boxes().getOr([]);(1<u.length||1===u.length&&!ge(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))}))}))}))},mouseup:function(t){o.each(i)}}}(tl(t),e,n,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(l,f,s,c),m=nl(l,f,s,c),g=function(e,n){!0===e.raw().shiftKey&&(n.kill()&&e.kill(),n.selection().each((function(e){var n=wc.relative(e.start(),e.finish()),r=Dc(l,n);t.selection.setRng(r)})))},p=function(e){var n=b(e);if(n.raw().shiftKey&&Za.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=Nt.fromDom(r.startContainer),i=Nt.fromDom(r.endContainer);m.keyup(n,o,r.startOffset,i,r.endOffset).each((function(t){g(n,t)}))}},h=function(n){var r=b(n);e().each((function(t){t.hideBars()}));var o=t.selection.getRng(),i=Nt.fromDom(t.selection.getStart()),u=Nt.fromDom(o.startContainer),c=Nt.fromDom(o.endContainer),a=$i(i).isRtl()?Za.rtl:Za.ltr;m.keydown(r,u,o.startOffset,c,o.endOffset,a).each((function(t){g(r,t)})),e().each((function(t){t.showBars()}))},v=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},b=function(t){var e=Nt.fromDom(t.target),n=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,n);return{target:o(e),x:o(v(t)?t.x:null),y:o(v(t)?t.y:null),stop:n,prevent:i,kill:u,raw:o(t)}},w=function(t){return 0===t.button},y=function(t){w(t)&&rl(t)&&d.mousedown(b(t))},S=function(t){var e;void 0!==(e=t).buttons&&!(1&e.buttons)||!rl(t)||d.mouseover(b(t))},C=function(t){w(t)&&rl(t)&&d.mouseup(b(t))};t.on("mousedown",y),t.on("mouseover",S),t.on("mouseup",C),t.on("keyup",p),t.on("keydown",h),t.on("NodeChange",(function(){var e=t.selection,r=Nt.fromDom(e.getStart()),o=Nt.fromDom(e.getEnd());$n(un,[r,o]).fold((function(){c.clear(f)}),n)})),u=x.some(i({mousedown:y,mouseover:S,mouseup:C,keyup:p,keydown:h}))})),{clear:c.clear,destroy:function(){u.each((function(t){}))}}}(i,u.lazyResize),a=function(t,e){var r,o=function(t){return"table"===lt(Fi(t))},i=(r=t.getParam("table_clone_elements"),R(r)?x.some(r.split(/[ ,]/)):Array.isArray(r)?x.some(r):x.none()),u=function(e,n,r,o){return function(u,c){Yi(u);var a=o(),l=Nt.fromDom(t.getDoc()),f=Xr($i),s=kn(r,l,i);return n(u)?e(a,u,c,s,f).bind((function(e){return k(e.newRows(),(function(e){cu(t,e.dom())})),k(e.newCells(),(function(e){au(t,e.dom())})),e.cursor().map((function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n}))})):x.none()}};return{deleteRow:u(Li.eraseRows,(function(e){var n=Jr(e);return!1===o(t)||1<n.rows()}),n,e),deleteColumn:u(Li.eraseColumns,(function(e){var n=Jr(e);return!1===o(t)||1<n.columns()}),n,e),insertRowsBefore:u(Li.insertRowsBefore,p,n,e),insertRowsAfter:u(Li.insertRowsAfter,p,n,e),insertColumnsBefore:u(Li.insertColumnsBefore,p,Br,e),insertColumnsAfter:u(Li.insertColumnsAfter,p,Br,e),mergeCells:u(Li.mergeCells,p,n,e),unmergeCells:u(Li.unmergeCells,p,n,e),pasteRowsBefore:u(Li.pasteRowsBefore,p,n,e),pasteRowsAfter:u(Li.pasteRowsAfter,p,n,e),pasteCells:u(Li.pasteCells,p,n,e)}}(i,u.lazyWire),l=function(t){return{get:function(){return function(t,e){return er(t,e)}(Fi(t),or.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?cr.none():cr.single(t.selection)}),(function(t){return cr.multiple(t)}))}}}(i),f=function(t,n){var r=e(x.none()),o=e([]),i=function(){return Yu(t).bind((function(t){return un(t).map((function(e){return"caption"===lt(t)?gr.notCell(t):gr.forMenu(n,e,t)}))}))},u=function(){r.set(Ot(i)()),k(o.get(),(function(t){return t()}))},c=function(t,e){var n=function(){return r.get().fold((function(){t.setDisabled(!0)}),(function(n){t.setDisabled(e(n))}))};return n(),o.set(o.get().concat([n])),function(){o.set(M(o.get(),(function(t){return t!==n})))}};return t.on("NodeChange",u),{onSetupTable:function(t){return c(t,(function(t){return!1}))},onSetupCellOrRow:function(t){return c(t,(function(t){return"caption"===lt(t.element())}))},onSetupMergeable:function(t){return c(t,(function(t){return t.mergable().isNone()}))},onSetupUnmergeable:function(t){return c(t,(function(t){return t.unmergable().isNone()}))},resetTargets:u,targets:function(){return r.get()}}}(i,l),s=e(x.none());return Xu(i,a,c,l,s),function(e,r,o,i){e.on("BeforeGetContent",(function(t){!0===t.selection&&cr.cata(r.get(),n,(function(n){var r;t.preventDefault(),(r=n,un(r[0]).map(Nn).map((function(t){return[hn(t,or.attributeSelector())]}))).each((function(n){var r;t.content="text"===t.format?P(n,(function(t){return t.dom().innerText})).join(""):(r=e,P(n,(function(t){return r.selection.serializer.serialize(t.dom(),{})})).join(""))}))}),n)})),e.on("BeforeSetContent",(function(n){!0===n.selection&&!0===n.paste&&x.from(e.dom.getParent(e.selection.getStart(),"th,td")).each((function(r){var u=Nt.fromDom(r);un(u).each((function(r){var c,a,l=M((c=n.content,(a=t.document.createElement("div")).innerHTML=c,Se(Nt.fromDom(a))),(function(t){return"meta"!==lt(t)}));if(1===l.length&&"table"===lt(l[0])){n.preventDefault();var f=Nt.fromDom(e.getDoc()),s=Mn(f),d=gr.paste(u,l[0],s);o.pasteCells(r,d).each((function(t){e.selection.setRng(t),e.focus(),i.clear(r)}))}}))}))}))}(i,l,a,c),function(t,e){var n=function(e){return function(){return t.execCommand(e)}},r=function(e){var n=e.numRows,r=e.numColumns;t.undoManager.transact((function(){Hu(t,r,n)})),t.addVisual()},o={text:"Table properties",onSetup:e.onSetupTable,onAction:n("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:n("mceTableDelete")},u={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:n("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:n("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:n("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:n("mceTableRowProps"),onSetup:e.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:n("mceTableCutRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:n("mceTableCopyRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:n("mceTablePasteRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:n("mceTablePasteRowAfter"),onSetup:e.onSetupCellOrRow}]}},c={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:n("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:n("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:n("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}]}},a={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:n("mceTableCellProps"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:n("mceTableMergeCells"),onSetup:e.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:n("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}]}};!1===t.getParam("table_grid",!0,"boolean")?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:n("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:n("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",u),t.ui.registry.addNestedMenuItem("column",c),t.ui.registry.addNestedMenuItem("cell",a),t.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold((function(){return""}),(function(t){return"caption"===lt(t.element())?"tableprops deletetable":"cell row column | tableprops deletetable"}))}})}(i,f),function(t,e){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable tableprops deletetable | cell row column")}});var n=function(e){return function(){return t.execCommand(e)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:n("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:n("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:n("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:n("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:n("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:n("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:n("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:n("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:n("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:n("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:n("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:n("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:n("mceTableCutRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:n("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:n("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:n("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:n("mceInsertTable"),icon:"table"})}(i,f),function(t){var e=t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<e.length&&t.ui.registry.addContextToolbar("table",{predicate:function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},items:e,scope:"node",position:"node"})}(i),i.on("PreInit",(function(){i.serializer.addTempAttr(or.firstSelected()),i.serializer.addTempAttr(or.lastSelected())})),function(t){return t.getParam("table_tab_navigation",!0,"boolean")}(i)&&i.on("keydown",(function(t){Xc(t,i,a,u.lazyWire)})),i.on("remove",(function(){u.destroy(),c.destroy()})),function(t,e){return{insertTable:function(e,n){return Hu(t,e,n)},setClipboardRows:function(t){return n=e,r=P(t,Nt.fromDom),void n.set(x.from(r));var n,r},getClipboardRows:function(){return e.get().fold((function(){}),(function(t){return P(t,(function(t){return t.dom()}))}))}}}(i,s)}))}(window);