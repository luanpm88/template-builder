!function(n){"use strict";var e=function(){return(e=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function t(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]])}return t}var r=function(){},o=function(n,e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n(e.apply(null,t))}},i=function(n){return function(){return n}},u=function(n){return n};function c(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.concat(t);return n.apply(null,o)}}var a,s,f,l,d,m,g,p=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!n.apply(null,e)}},v=function(n){return function(){throw new Error(n)}},h=function(n){return n()},y=i(!1),b=i(!0),x=y,w=b,S=function(){return O},O=(l={fold:function(n,e){return n()},is:x,isSome:x,isNone:w,getOr:f=function(n){return n},getOrThunk:s=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:f,orThunk:s,map:S,ap:S,each:function(){},bind:S,flatten:S,exists:x,forall:w,filter:S,equals:a=function(n){return n.isNone()},equals_:a,toArray:function(){return[]},toString:i("none()")},Object.freeze&&Object.freeze(l),l),T=function(n){var e=function(){return n},t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:w,isNone:x,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return T(e(n))},ap:function(e){return e.fold(S,(function(e){return T(e(n))}))},each:function(e){e(n)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(n)?o:O},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(x,(function(e){return t(n,e)}))},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},k={some:T,none:S,from:function(n){return null==n?O:T(n)}},E=Object.keys,C=Object.hasOwnProperty,M=function(n,e){for(var t=E(n),r=0,o=t.length;r<o;r++){var i=t[r];e(n[i],i,n)}},I=function(n,e){return D(n,(function(n,t,r){return{k:t,v:e(n,t,r)}}))},D=function(n,e){var t={};return M(n,(function(r,o){var i=e(r,o,n);t[i.k]=i.v})),t},F=function(n,e){var t=[];return M(n,(function(n,r){t.push(e(n,r))})),t},A=function(n,e){return C.call(n,e)},R=i("touchstart"),B=i("touchmove"),V=i("touchend"),N=i("mousedown"),j=i("mousemove"),_=i("mouseup"),H=i("mouseover"),z=i("keydown"),P=i("keyup"),L=i("input"),G=i("change"),U=i("click"),$=i("transitionend"),W=i("selectstart"),X=function(n){var e,t=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return t||(t=!0,e=n.apply(null,r)),e}},q=function(){return Y(0,0)},Y=function(n,e){return{major:n,minor:e}},K=function(n,e){var t=String(e).toLowerCase();return 0===n.length?q():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}}(n,e);if(!t)return{major:0,minor:0};var r=function(n){return Number(e.replace(t,"$"+n))};return Y(r(1),r(2))}(n,t)},J=q,Q="Edge",Z="Chrome",nn="Opera",en="Firefox",tn="Safari",rn=function(n,e){return function(){return e===n}},on=function(n){var e=n.current;return{current:e,version:n.version,isEdge:rn(Q,e),isChrome:rn(Z,e),isIE:rn("IE",e),isOpera:rn(nn,e),isFirefox:rn(en,e),isSafari:rn(tn,e)}},un=function(){return on({current:void 0,version:J()})},cn=on,an=(i(Q),i(Z),i("IE"),i(nn),i(en),i(tn),"Windows"),sn="Android",fn="Solaris",ln="FreeBSD",dn=function(n,e){return function(){return e===n}},mn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:dn(an,e),isiOS:dn("iOS",e),isAndroid:dn(sn,e),isOSX:dn("OSX",e),isLinux:dn("Linux",e),isSolaris:dn(fn,e),isFreeBSD:dn(ln,e)}},gn=function(){return mn({current:void 0,version:J()})},pn=mn,vn=(i(an),i("iOS"),i(sn),i("Linux"),i("OSX"),i(fn),i(ln),function(n){return function(e){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(e)===n}}),hn=vn("string"),yn=vn("object"),bn=vn("array"),xn=vn("boolean"),wn=vn("function"),Sn=vn("number"),On=Array.prototype.slice,Tn=void 0===(d=Array.prototype.indexOf)?function(n,e){return Bn(n,e)}:function(n,e){return d.call(n,e)},kn=function(n,e){return-1<Tn(n,e)},En=function(n,e){return Rn(n,e).isSome()},Cn=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var i=n[o];r[o]=e(i,o,n)}return r},Mn=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t,n)},In=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var i=n[r];e(i,r,n)&&t.push(i)}return t},Dn=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t])}(n,(function(n){t=e(t,n)})),t},Fn=function(n,e,t){return Mn(n,(function(n){t=e(t,n)})),t},An=function(n,e){for(var t=0,r=n.length;t<r;t++){var o=n[t];if(e(o,t,n))return k.some(o)}return k.none()},Rn=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t,n))return k.some(t);return k.none()},Bn=function(n,e){for(var t=0,r=n.length;t<r;++t)if(n[t]===e)return t;return-1},Vn=Array.prototype.push,Nn=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!bn(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);Vn.apply(e,n[t])}return e},jn=function(n,e){var t=Cn(n,e);return Nn(t)},_n=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t,n))return!1;return!0},Hn=function(n){var e=On.call(n,0);return e.reverse(),e},zn=function(n){return[n]},Pn=(wn(Array.from)&&Array.from,function(n,e){var t=String(e).toLowerCase();return An(n,(function(n){return n.search(t)}))}),Ln=function(n,e){return-1!==n.indexOf(e)},Gn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Un=function(n){return function(e){return Ln(e,n)}},$n=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Ln(n,"edge/")&&Ln(n,"chrome")&&Ln(n,"safari")&&Ln(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Gn],search:function(n){return Ln(n,"chrome")&&!Ln(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Ln(n,"msie")||Ln(n,"trident")}},{name:"Opera",versionRegexes:[Gn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Un("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Un("firefox")},{name:"Safari",versionRegexes:[Gn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Ln(n,"safari")||Ln(n,"mobile/"))&&Ln(n,"applewebkit")}}],Wn=[{name:"Windows",search:Un("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Ln(n,"iphone")||Ln(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Un("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Un("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Un("linux"),versionRegexes:[]},{name:"Solaris",search:Un("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Un("freebsd"),versionRegexes:[]}],Xn={browsers:i($n),oses:i(Wn)},qn={detect:X((function(){return function(n){var e,t,r,o,u,c,a,s,f,l,d,m=Xn.browsers(),g=Xn.oses(),p=function(n,e){return Pn(n,e).map((function(n){var t=K(n.versionRegexes,e);return{current:n.name,version:t}}))}(m,n).fold(un,cn),v=function(n,e){return Pn(n,e).map((function(n){var t=K(n.versionRegexes,e);return{current:n.name,version:t}}))}(g,n).fold(gn,pn);return{browser:p,os:v,deviceType:(t=p,r=n,o=(e=v).isiOS()&&!0===/ipad/i.test(r),u=e.isiOS()&&!o,c=e.isAndroid()&&3===e.version.major,a=e.isAndroid()&&4===e.version.major,s=o||c||a&&!0===/mobile/i.test(r),f=e.isiOS()||e.isAndroid(),l=f&&!s,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),{isiPad:i(o),isiPhone:i(u),isTablet:i(s),isPhone:i(l),isTouch:i(f),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:i(d)})}}(n.navigator.userAgent)}))},Yn={tap:i("alloy.tap")},Kn=i("alloy.focus"),Jn=i("alloy.blur.post"),Qn=i("alloy.paste.post"),Zn=i("alloy.receive"),ne=i("alloy.execute"),ee=i("alloy.focus.item"),te=Yn.tap,re=qn.detect().deviceType.isTouch()?Yn.tap:U,oe=i("alloy.longpress"),ie=i("alloy.system.init"),ue=i("alloy.system.attached"),ce=i("alloy.system.detached"),ae=i("alloy.focusmanager.shifted"),se=i("alloy.highlight"),fe=i("alloy.dehighlight"),le=function(n,e){pe(n,n.element(),e,{})},de=function(n,e,t){pe(n,n.element(),e,t)},me=function(n){le(n,ne())},ge=function(n,e,t){pe(n,e,t,{})},pe=function(n,t,r,o){var u=e({target:t},o);n.getSystem().triggerEvent(r,t,I(u,i))},ve=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:i(n)}},he=function(e,t){var r=(t||n.document).createElement(e);return ve(r)},ye=ve,be=(n.Node.ATTRIBUTE_NODE,n.Node.CDATA_SECTION_NODE,n.Node.COMMENT_NODE,n.Node.DOCUMENT_NODE),xe=(n.Node.DOCUMENT_TYPE_NODE,n.Node.DOCUMENT_FRAGMENT_NODE,n.Node.ELEMENT_NODE),we=n.Node.TEXT_NODE,Se=(n.Node.PROCESSING_INSTRUCTION_NODE,n.Node.ENTITY_REFERENCE_NODE,n.Node.ENTITY_NODE,n.Node.NOTATION_NODE,function(n){return n.dom().nodeName.toLowerCase()}),Oe=function(n){return function(e){return e.dom().nodeType===n}},Te=Oe(xe),ke=Oe(we),Ee=function(n){var e=ke(n)?n.dom().parentNode:n.dom();return null!=e&&e.ownerDocument.body.contains(e)},Ce=X((function(){return Me(ye(n.document))})),Me=function(n){var e=n.dom().body;if(null==e)throw new Error("Body is not available yet");return ye(e)},Ie=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(n.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+e.length+" arguments");var r={};return Mn(n,(function(n,t){r[n]=i(e[t])})),r}},De=function(n){return n.slice(0).sort()},Fe=function(n,e){if(!bn(e))throw new Error("The "+n+" fields must be an array. Was: "+e+".");Mn(e,(function(e){if(!hn(e))throw new Error("The value "+e+" in the "+n+" fields was not a string.")}))},Ae=function(n,e){var t,r=n.concat(e);if(0===r.length)throw new Error("You must specify at least one required or optional field.");return Fe("required",n),Fe("optional",e),t=De(r),An(t,(function(n,e){return e<t.length-1&&n===t[e+1]})).each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")})),function(t){var o=E(t);_n(n,(function(n){return kn(o,n)}))||function(n,e){throw new Error("All required keys ("+De(n).join(", ")+") were not specified. Specified keys were: "+De(e).join(", ")+".")}(n,o);var u=In(o,(function(n){return!kn(r,n)}));0<u.length&&function(n){throw new Error("Unsupported keys for object: "+De(n).join(", "))}(u);var c={};return Mn(n,(function(n){c[n]=i(t[n])})),Mn(e,(function(n){c[n]=i(Object.prototype.hasOwnProperty.call(t,n)?k.some(t[n]):k.none())})),c}},Re=xe,Be=be,Ve=function(n,e){var t=n.dom();if(t.nodeType!==Re)return!1;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Ne=function(n){return n.nodeType!==Re&&n.nodeType!==Be||0===n.childElementCount},je=function(e,t){var r=void 0===t?n.document:t.dom();return Ne(r)?[]:Cn(r.querySelectorAll(e),ye)},_e=function(e,t){var r=void 0===t?n.document:t.dom();return Ne(r)?k.none():k.from(r.querySelector(e)).map(ye)},He=function(n,e){return n.dom()===e.dom()},ze=(qn.detect().browser.isIE(),function(n){return ye(n.dom().ownerDocument)}),Pe=function(n){var e=n.dom();return k.from(e.parentNode).map(ye)},Le=function(n){var e=n.dom();return Cn(e.childNodes,ye)},Ge=function(n,e){var t=n.dom().childNodes;return k.from(t[e]).map(ye)},Ue=(Ie("element","offset"),function(n,e){Pe(n).each((function(t){t.dom().insertBefore(e.dom(),n.dom())}))}),$e=function(n,e){var t;(t=n.dom(),k.from(t.nextSibling).map(ye)).fold((function(){Pe(n).each((function(n){Xe(n,e)}))}),(function(n){Ue(n,e)}))},We=function(n,e){Ge(n,0).fold((function(){Xe(n,e)}),(function(t){n.dom().insertBefore(e.dom(),t.dom())}))},Xe=function(n,e){n.dom().appendChild(e.dom())},qe=function(n,e){Mn(e,(function(e){Xe(n,e)}))},Ye=function(n){n.dom().textContent="",Mn(Le(n),(function(n){Ke(n)}))},Ke=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Je=function(n){le(n,ce());var e=n.components();Mn(e,Je)},Qe=function(n){var e=n.components();Mn(e,Qe),le(n,ue())},Ze=function(n,e){nt(n,e,Xe)},nt=function(n,e,t){n.getSystem().addToWorld(e),t(n.element(),e.element()),Ee(n.element())&&Qe(e),n.syncComponents()},et=function(n){Je(n),Ke(n.element()),n.getSystem().removeFromWorld(n)},tt=function(n){var e=Pe(n.element()).bind((function(e){return n.getSystem().getByDom(e).fold(k.none,k.some)}));et(n),e.each((function(n){n.syncComponents()}))},rt=function(n){return{is:function(e){return n===e},isValue:b,isError:y,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:function(e){return rt(n)},orThunk:function(e){return rt(n)},fold:function(e,t){return t(n)},map:function(e){return rt(e(n))},mapError:function(e){return rt(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOption:function(){return k.some(n)}}},ot=function(n){return{is:y,isValue:y,isError:b,getOr:u,getOrThunk:function(n){return n()},getOrDie:function(){return v(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(e,t){return e(n)},map:function(e){return ot(n)},mapError:function(e){return ot(e(n))},each:r,bind:function(e){return ot(n)},exists:y,forall:b,toOption:k.none}},it={value:rt,error:ot,fromOption:function(n,e){return n.fold((function(){return ot(e)}),rt)}},ut=function(e){if(!bn(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var t=[],r={};return Mn(e,(function(o,i){var u=E(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!bn(a))throw new Error("case arguments must be an array");t.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(n){var e=E(n);if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","));if(!_n(t,(function(n){return kn(e,n)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "));return n[c].apply(null,o)},log:function(e){n.console.log(e,{constructors:t,constructor:c,params:o})}}}})),r},ct=Object.prototype.hasOwnProperty,at=function(n){return function(){for(var e=new Array(arguments.length),t=0;t<e.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)ct.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}},st=at((function(n,e){return yn(n)&&yn(e)?st(n,e):e})),ft=at((function(n,e){return e})),lt=ut([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),dt=function(n){return lt.defaultedThunk(i(n))},mt=lt.strict,gt=lt.asOption,pt=lt.defaultedThunk,vt=lt.mergeWithThunk,ht=function(n){return function(e){return A(e,n)?k.from(e[n]):k.none()}},yt=function(n,e){return ht(e)(n)},bt=function(n,e){var t={};return t[n]=e,t},xt=(ut([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,e){return t=e,r={},M(n,(function(n,e){kn(t,e)||(r[e]=n)})),r;var t,r}),wt=function(n){return ht(n)},St=function(n,e){return t=n,r=e,function(n){return A(n,t)?n[t]:r};var t,r},Ot=function(n,e){return yt(n,e)},Tt=function(n,e){return bt(n,e)},kt=function(n){return e={},Mn(n,(function(n){e[n.key]=n.value})),e;var e},Et=function(n,e){return A(t=n,r=e)&&void 0!==t[r]&&null!==t[r];var t,r};(g=m||(m={}))[g.Error=0]="Error",g[g.Value=1]="Value";var Ct,Mt=function(n,e,t){return n.stype===m.Error?e(n.serror):t(n.svalue)},It=function(n){return{stype:m.Value,svalue:n}},Dt=function(n){return{stype:m.Error,serror:n}},Ft=It,At=function(n){var e=[],t=[];return Mn(n,(function(n){Mt(n,(function(n){return t.push(n)}),(function(n){return e.push(n)}))})),{values:e,errors:t}},Rt=Dt,Bt=function(n,e){return n.stype===m.Value?e(n.svalue):n},Vt=function(n,e){return n.stype===m.Value?{stype:m.Value,svalue:e(n.svalue)}:n},Nt=function(n,e){return n.stype===m.Error?{stype:m.Error,serror:e(n.serror)}:n},jt=function(n){return o(Rt,Nn)(n)},_t=ut([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),Ht=ut([{field:["name","presence","type"]},{state:["name"]}]),zt=function(n){return yn(n)&&100<E(n).length?" removed due to size":JSON.stringify(n,null,2)},Pt=function(n,e){return Rt([{path:n,getErrorInfo:e}])},Lt=ut([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Gt=function(n,e,t){var r=yt(n,e).fold((function(){return t(n)}),u);return Ft(r)},Ut=function(n){return{extract:function(e,t,r){return function(n){return n.stype===m.Error?function(n){return t=n,Pt(e,(function(){return t}));var t}(n.serror):n}(n(r,t))},toString:function(){return"val"},toDsl:function(){return _t.itemOf(n)}}},$t=function(n){var e=Wt(n),t=Dn(n,(function(n,e){return e.fold((function(e){return st(n,Tt(e,!0))}),i(n))}),{});return{extract:function(n,r,o){var i,u,c,a=xn(o)?[]:(u=E(i=o),In(u,(function(n){return Et(i,n)}))),s=In(a,(function(n){return!Et(t,n)}));return 0===s.length?e.extract(n,r,o):(c=s,Pt(n,(function(){return"There are unsupported fields: ["+c.join(", ")+"] specified"})))},toString:e.toString,toDsl:e.toDsl}},Wt=function(n){return{extract:function(e,t,r){return o=e,u=r,c=t,a=Cn(n,(function(n){return function(n,e,t,r){return t.fold((function(t,o,u,c){var a=function(e){var i=c.extract(n.concat([t]),r,e);return Vt(i,(function(n){return bt(o,r(n))}))},s=function(e){return e.fold((function(){var n=bt(o,r(k.none()));return Ft(n)}),(function(e){var i=c.extract(n.concat([t]),r,e);return Vt(i,(function(n){return bt(o,r(k.some(n)))}))}))};return u.fold((function(){return Bt(function(n,e,t){return yt(e,t).fold((function(){return r=t,o=e,Pt(n,(function(){return'Could not find valid *strict* value for "'+r+'" in '+zt(o)}));var r,o}),Ft)}(n,e,t),a)}),(function(n){return Bt(Gt(e,t,n),a)}),(function(){return Bt(Ft(yt(e,t)),s)}),(function(n){return Bt((o=n,i=yt(r=e,t).map((function(n){return!0===n?o(r):n})),Ft(i)),s);var r,o,i}),(function(n){var r=n(e),o=Vt(Gt(e,t,i({})),(function(n){return st(r,n)}));return Bt(o,a)}))}),(function(n,t){var o=t(e);return Ft(bt(n,r(o)))}))}(o,u,n,c)})),function(n){var e,t,r=At(n);return 0<r.errors.length?jt(r.errors):(t={},0<(e=r.values).length?Ft(st(t,ft.apply(void 0,e))):Ft(t))}(a);var o,u,c,a},toString:function(){return"obj{\n"+Cn(n,(function(n){return n.fold((function(n,e,t,r){return n+" -> "+r.toString()}),(function(n,e){return"state("+n+")"}))})).join("\n")+"}"},toDsl:function(){return _t.objOf(Cn(n,(function(n){return n.fold((function(n,e,t,r){return Ht.field(n,t,r)}),(function(n,e){return Ht.state(n)}))})))}}},Xt=i(Ut(Ft)),qt=Lt.state,Yt=Lt.field,Kt=Ut(Ft),Jt=function(n){return Ut((function(e){return n(e).fold(Rt,Ft)}))},Qt=function(n,e){return function(n,e){var t=function(e,t){return(r=Ut(n),{extract:function(n,e,t){var o=Cn(t,(function(t,o){return r.extract(n.concat(["["+o+"]"]),e,t)}));return function(n){var e=At(n);return 0<e.errors.length?jt(e.errors):Ft(e.values)}(o)},toString:function(){return"array("+r.toString()+")"},toDsl:function(){return _t.arrOf(r)}}).extract(e,u,t);var r};return{extract:function(n,r,o){var i=E(o),u=t(n,i);return Bt(u,(function(t){var i=Cn(t,(function(n){return Lt.field(n,n,mt(),e)}));return Wt(i).extract(n,r,o)}))},toString:function(){return"setOf("+e.toString()+")"},toDsl:function(){return _t.setOf(n,e)}}}((function(e){return function(n){return n.fold(Dt,It)}(n(e))}),e)},Zt=function(n,e,t){return function(n){return Mt(n,it.error,it.value)}((r=n,o=u,i=t,c=e.extract([r],o,i),Nt(c,(function(n){return{input:i,errors:n}}))));var r,o,i,c},nr=function(n){return n.fold((function(n){throw new Error(tr(n))}),u)},er=function(n,e,t){return nr(Zt(n,e,t))},tr=function(n){return"Errors: \n"+(t=10<(e=n.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):e,Cn(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))+"\n\nInput object: ")+zt(n.input);var e,t},rr=function(n,e){return function(n,e){return{extract:function(t,r,o){return Ot(o,n).fold((function(){return e=n,Pt(t,(function(){return'Choice schema did not contain choice key: "'+e+'"'}));var e}),(function(n){return function(n,e,t,r,o){return Ot(r,o).fold((function(){return e=r,t=o,Pt(n,(function(){return'The chosen schema: "'+t+'" did not exist in branches: '+zt(e)}));var e,t}),(function(r){return r.extract(n.concat(["branch: "+o]),e,t)}))}(t,r,o,e,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+E(e)},toDsl:function(){return _t.choiceOf(n,e)}}}(n,I(e,Wt))},or=i(Kt),ir=(Ct=wn,Ut((function(n){var e=typeof n;return Ct(n)?Ft(n):Rt("Expected type: function but got: "+e)}))),ur=function(n){return Yt(n,n,mt(),Xt())},cr=function(n,e){return Yt(n,n,mt(),e)},ar=function(n,e){return Yt(n,n,mt(),Wt(e))},sr=function(n){return Yt(n,n,gt(),Xt())},fr=function(n,e){return Yt(n,n,gt(),e)},lr=function(n,e){return fr(n,Wt(e))},dr=function(n,e){return fr(n,$t(e))},mr=function(n,e){return Yt(n,n,dt(e),Xt())},gr=function(n,e,t){return Yt(n,n,dt(e),t)},pr=function(n,e){return qt(n,e)},vr=function(n,e){return He(n.element(),e.event().target())},hr=function(n){if(!Et(n,"can")&&!Et(n,"abort")&&!Et(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return er("Extracting event.handler",$t([mr("can",i(!0)),mr("abort",i(!1)),mr("run",r)]),n)};function yr(n,e,t,r,o){return n(t,r)?k.some(t):wn(o)&&o(t)?k.none():e(t,r,o)}var br,xr,wr,Sr=function(n,e,t){for(var r=n.dom(),o=wn(t)?t:i(!1);r.parentNode;){r=r.parentNode;var u=ye(r);if(e(u))return k.some(u);if(o(u))break}return k.none()},Or=function(n,e,t){return yr((function(n){return e(n)}),Sr,n,e,t)},Tr=function(n){return kt(n)},kr=function(n,e){return{key:n,value:hr({abort:e})}},Er=function(n,e){return{key:n,value:hr({run:e})}},Cr=function(n,e,t){return{key:n,value:hr({run:function(n){e.apply(void 0,[n].concat(t))}})}},Mr=function(n){return function(e){return{key:n,value:hr({run:function(n,t){vr(n,t)&&e(n,t)}})}}},Ir=function(n,e,t){var r,o,i=e.partUids[t];return o=i,Er(r=n,(function(n,e){n.getSystem().getByUid(o).each((function(n){var t,o,i,u;o=(t=n).element(),i=r,u=e,t.getSystem().triggerEvent(i,o,u.event())}))}))},Dr=function(n){return Er(n,(function(n,e){e.cut()}))},Fr=Mr(ue()),Ar=Mr(ce()),Rr=Mr(ie()),Br=(br=ne(),function(n){return Er(br,n)}),Vr=function(n){return Cn(n,(function(n){return t="/*",r=(e=n).length-2,e.length<2||e.substr(r,r+2)!==t?n:n.substring(0,n.length-2);var e,t,r}))},Nr=function(n,e){var t=n.toString(),r=t.indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:Vr(i)}},n},jr=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},_r=function(n,e,t){return Rr((function(r,o){t(r,n,e)}))},Hr=function(n){return{key:n,value:void 0}},zr=function(n,t,r,o,u,a,s){var f=function(n){return Et(n,r)?n[r]():k.none()},l=I(u,(function(n,e){return function(n,e,t){var r,o,u,c,a,s;return r=function(r){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var c=[r].concat(o);return r.config({name:i(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+t)}),(function(n){var t=Array.prototype.slice.call(c,1);return e.apply(void 0,[r,n.config,n.state].concat(t))}))},o=t,c=(u=e.toString()).indexOf(")")+1,a=u.indexOf("("),s=u.substring(a+1,c-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:o,parameters:Vr(s.slice(0,1).concat(s.slice(3)))}},r}(r,n,e)})),d=I(a,(function(n,e){return Nr(n,e)})),m=e({},d,l,{revoke:c(Hr,r),config:function(e){var t=er(r+"-config",n,e);return{key:r,value:{config:t,me:m,configAsRaw:X((function(){return er(r+"-config",n,e)})),initialConfig:e,state:s}}},schema:function(){return t},exhibit:function(n,e){return f(n).bind((function(n){return Ot(o,"exhibit").map((function(t){return t(e,n.config,n.state)}))})).getOr(jr({}))},name:function(){return r},handlers:function(n){return f(n).map((function(n){return St("events",(function(n,e){return{}}))(o)(n.config,n.state)})).getOr({})}});return m},Pr={init:function(){return Lr({readState:function(){return"No State required"}})}},Lr=function(n){return n},Gr=function(n){return kt(n)},Ur=$t([ur("fields"),ur("name"),mr("active",{}),mr("apis",{}),mr("state",Pr),mr("extra",{})]),$r=function(n){var e,t,r,o,i,u,c,a,s=er("Creating behaviour: "+n.name,Ur,n);return e=s.fields,t=s.name,r=s.active,o=s.apis,i=s.extra,u=s.state,c=$t(e),a=lr(t,[dr("config",e)]),zr(c,a,t,r,o,i,u)},Wr=$t([ur("branchKey"),ur("branches"),ur("name"),mr("active",{}),mr("apis",{}),mr("state",Pr),mr("extra",{})]),Xr=i(void 0),qr=function(e,t,r){if(!(hn(r)||xn(r)||Sn(r)))throw n.console.error("Invalid call to Attr.set. Key ",t,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,r+"")},Yr=function(n,e,t){qr(n.dom(),e,t)},Kr=function(n,e){var t=n.dom();M(e,(function(n,e){qr(t,e,n)}))},Jr=function(n,e){var t=n.dom().getAttribute(e);return null===t?void 0:t},Qr=function(n,e){var t=n.dom();return!(!t||!t.hasAttribute)&&t.hasAttribute(e)},Zr=function(n,e){n.dom().removeAttribute(e)},no=function(n,e){var t=Jr(n,e);return void 0===t||""===t?[]:t.split(" ")},eo=function(n){return void 0!==n.dom().classList},to=function(n,e){eo(n)?n.dom().classList.add(e):function(n,e){return r=e,o=no(t=n,"class").concat([r]),Yr(t,"class",o.join(" ")),!0;var t,r,o}(n,e)},ro=function(n,e){eo(n)?n.dom().classList.remove(e):function(n,e){return o=e,0<(i=In(no(t=n,r="class"),(function(n){return n!==o}))).length?Yr(t,r,i.join(" ")):Zr(t,r),!1;var t,r,o,i}(n,e),function(n){0===(eo(n)?n.dom().classList:no(n,"class")).length&&Zr(n,"class")}(n)},oo=function(n,e){return eo(n)&&n.dom().classList.contains(e)},io=function(n,e,t){ro(n,t),to(n,e)},uo=Object.freeze({toAlpha:function(n,e,t){io(n.element(),e.alpha,e.omega)},toOmega:function(n,e,t){io(n.element(),e.omega,e.alpha)},isAlpha:function(n,e,t){return oo(n.element(),e.alpha)},isOmega:function(n,e,t){return oo(n.element(),e.omega)},clear:function(n,e,t){ro(n.element(),e.alpha),ro(n.element(),e.omega)}}),co=[ur("alpha"),ur("omega")],ao=$r({fields:co,name:"swapping",apis:uo}),so=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return so(t())}}},fo=function(n){n.dom().focus()},lo=function(n){n.dom().blur()},mo=function(e){var t=void 0!==e?e.dom():n.document;return k.from(t.activeElement).map(ye)},go=function(n){return mo(ze(n)).filter((function(e){return n.dom().contains(e.dom())}))},po=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),vo=tinymce.util.Tools.resolve("tinymce.ThemeManager"),ho={formatChanged:i("formatChanged"),orientationChanged:i("orientationChanged"),dropupDismissed:i("dropupDismissed")},yo=function(n){return n.dom().innerHTML},bo=function(n){return function(n){var e,t,r,o=function(n){return ye(n.dom().cloneNode(!1))}(n);return e=o,t=he("div"),r=ye(e.dom().cloneNode(!0)),Xe(t,r),yo(t)}(n)},xo=Object.freeze({events:function(n){return Tr([Er(Zn(),(function(e,t){var r,o,i=n.channels,u=(r=E(i),(o=t).universal()?r:In(r,(function(n){return kn(o.channels(),n)})));Mn(u,(function(n){var r=i[n],o=r.schema,u=er("channel["+n+"] data\nReceiver: "+bo(e.element()),o,t.data());r.onReceive(e,u)}))}))])}}),wo=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},So=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return k.none()};(wr=xr||(xr={}))[wr.STOP=0]="STOP",wr[wr.NORMAL=1]="NORMAL",wr[wr.LOGGING=2]="LOGGING";var Oo,To=so({}),ko=["alloy/data/Fields","alloy/debugging/Debugging"],Eo=function(e,t,r){return function(e,t,r){var o,i,u,c;switch(Ot(To.get(),e).orThunk((function(){var n=E(To.get());return So(n,(function(n){return-1<e.indexOf(n)?k.some(To.get()[n]):k.none()}))})).getOr(xr.NORMAL)){case xr.NORMAL:return r(Co());case xr.LOGGING:var a=(o=e,i=t,u=[],c=(new Date).getTime(),{logEventCut:function(n,e,t){u.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){u.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){u.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){u.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){u.push({outcome:"response",purpose:t,target:e})},write:function(){var e=(new Date).getTime();kn(["mousemove","mouseover","mouseout",ie()],o)||n.console.log(o,{event:o,time:e-c,target:i.dom(),sequence:Cn(u,(function(n){return kn(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+bo(n.target)+")":n.outcome}))})}}),s=r(a);return a.write(),s;case xr.STOP:return!0}}(e,t,r)},Co=i({logEventCut:r,logEventStopped:r,logNoParent:r,logEventNoHandlers:r,logEventResponse:r,write:r}),Mo=i([ur("menu"),ur("selectedMenu")]),Io=i([ur("item"),ur("selectedItem")]),Do=(i(Wt(Io().concat(Mo()))),i(Wt(Io()))),Fo=ar("initSize",[ur("numColumns"),ur("numRows")]),Ao=function(n,e,t){return function(){var n=new Error;if(void 0!==n.stack){var e=n.stack.split("\n");An(e,(function(n){return 0<n.indexOf("alloy")&&!En(ko,(function(e){return-1<n.indexOf(e)}))})).getOr("unknown")}}(),Yt(e,e,t,Jt((function(n){return it.value((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)}))})))},Ro=function(n){return Ao(0,n,dt(r))},Bo=function(n){return Ao(0,n,dt(k.none))},Vo=function(n){return Ao(0,n,mt())},No=function(n){return Ao(0,n,mt())},jo=function(n,e){return pr(n,i(e))},_o=function(n){return pr(n,u)},Ho=i(Fo),zo=[cr("channels",Qt(it.value,$t([Vo("onReceive"),mr("schema",or())])))],Po=$r({fields:zo,name:"receiving",active:xo}),Lo=function(n,e,t){var r=e.aria;r.update(n,r,t.get())},Go=function(n,e,t){e.toggleClass.each((function(e){t.get()?to(n.element(),e):ro(n.element(),e)}))},Uo=function(n,e,t){Xo(n,e,t,!t.get())},$o=function(n,e,t){t.set(!0),Go(n,e,t),Lo(n,e,t)},Wo=function(n,e,t){t.set(!1),Go(n,e,t),Lo(n,e,t)},Xo=function(n,e,t,r){(r?$o:Wo)(n,e,t)},qo=function(n,e,t){Xo(n,e,t,e.selected)},Yo=Object.freeze({onLoad:qo,toggle:Uo,isOn:function(n,e,t){return t.get()},on:$o,off:Wo,set:Xo}),Ko=Object.freeze({exhibit:function(n,e,t){return jr({})},events:function(n,e){var t,r,o,i=(t=n,r=e,o=Uo,Br((function(n){o(n,t,r)}))),u=_r(n,e,qo);return Tr(Nn([n.toggleOnExecute?[i]:[],[u]]))}}),Jo=function(n,e,t){Yr(n.element(),"aria-expanded",t)},Qo=[mr("selected",!1),sr("toggleClass"),mr("toggleOnExecute",!0),gr("aria",{mode:"none"},rr("mode",{pressed:[mr("syncWithExpanded",!1),jo("update",(function(n,e,t){Yr(n.element(),"aria-pressed",t),e.syncWithExpanded&&Jo(n,0,t)}))],checked:[jo("update",(function(n,e,t){Yr(n.element(),"aria-checked",t)}))],expanded:[jo("update",Jo)],selected:[jo("update",(function(n,e,t){Yr(n.element(),"aria-selected",t)}))],none:[jo("update",r)]}))],Zo=$r({fields:Qo,name:"toggling",active:Ko,apis:Yo,state:(Oo=!1,{init:function(){var n=so(Oo);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(Oo)},readState:function(){return n.get()}}}})}),ni=function(n,e){return Po.config({channels:Tt(ho.formatChanged(),{onReceive:function(t,r){r.command===n&&e(t,r.state)}})})},ei=function(n){return Po.config({channels:Tt(ho.orientationChanged(),{onReceive:n})})},ti=function(n,e){return{key:n,value:{onReceive:e}}},ri="tinymce-mobile",oi={resolve:function(n){return ri+"-"+n},prefix:i(ri)},ii=function(n,e){e.ignore||(fo(n.element()),e.onFocus(n))},ui=Object.freeze({focus:ii,blur:function(n,e){e.ignore||lo(n.element())},isFocused:function(n){return e=n.element(),t=ze(e).dom(),e.dom()===t.activeElement;var e,t}}),ci=Object.freeze({exhibit:function(n,e){var t=e.ignore?{}:{attributes:{tabindex:"-1"}};return jr(t)},events:function(n){return Tr([Er(Kn(),(function(e,t){ii(e,n),t.stop()}))].concat(n.stopMousedown?[Er(N(),(function(n,e){e.event().prevent()}))]:[]))}}),ai=[Ro("onFocus"),mr("stopMousedown",!1),mr("ignore",!1)],si=$r({fields:ai,name:"focusing",active:ci,apis:ui}),fi=function(n){return void 0!==n.style&&wn(n.style.getPropertyValue)},li=function(e,t,r){if(!hn(r))throw n.console.error("Invalid call to CSS.set. Property ",t,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);fi(e)&&e.style.setProperty(t,r)},di=function(n,e,t){var r=n.dom();li(r,e,t)},mi=function(n,e){var t=n.dom();M(e,(function(n,e){li(t,e,n)}))},gi=function(e,t){var r=e.dom(),o=n.window.getComputedStyle(r).getPropertyValue(t),i=""!==o||Ee(e)?o:pi(r,t);return null===i?void 0:i},pi=function(n,e){return fi(n)?n.style.getPropertyValue(e):""},vi=function(n,e){var t=n.dom(),r=pi(t,e);return k.from(r).filter((function(n){return 0<n.length}))},hi=function(n,e){var t,r,o=n.dom();r=e,fi(t=o)&&t.style.removeProperty(r),Qr(n,"style")&&""===Jr(n,"style").replace(/^\s+|\s+$/g,"")&&Zr(n,"style")},yi=function(n){return n.dom().offsetWidth};function bi(n,e){var t=function(t){var r=e(t);if(r<=0||null===r){var o=gi(t,n);return parseFloat(o)||0}return r},r=function(n,e){return Fn(e,(function(e,t){var r=gi(n,t),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)};return{set:function(e,t){if(!Sn(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var r=e.dom();fi(r)&&(r.style[n]=t+"px")},get:t,getOuter:t,aggregate:r,max:function(n,e,t){var o=r(n,t);return o<e?e-o:0}}}var xi,wi,Si=bi("height",(function(n){var e=n.dom();return Ee(n)?e.getBoundingClientRect().height:e.offsetHeight})),Oi=function(n){return Si.get(n)},Ti=function(n,e){return je(e,n)},ki=function(n){return _e(n)},Ei=function(n,e,t){return Sr(n,(function(n){return Ve(n,e)}),t)},Ci=function(n,e){return _e(e,n)},Mi=function(n,e,t){return yr(Ve,Ei,n,e,t)},Ii=function(n,e,t){var r=Hn(n.slice(0,e)),o=Hn(n.slice(e+1));return An(r.concat(o),t)},Di=function(n,e,t){var r=Hn(n.slice(0,e));return An(r,t)},Fi=function(n,e,t){var r=n.slice(0,e),o=n.slice(e+1);return An(o.concat(r),t)},Ai=function(n,e,t){var r=n.slice(e+1);return An(r,t)},Ri=function(n){return function(e){var t=e.raw();return kn(n,t.which)}},Bi=function(n){return function(e){return _n(n,(function(n){return n(e)}))}},Vi=function(n){return!0===n.raw().shiftKey},Ni=function(n){return!0===n.raw().ctrlKey},ji=p(Vi),_i=function(n,e){return{matches:n,classification:e}},Hi=function(n,e,t,r){var o=n+e;return r<o?t:o<t?r:o},zi=function(n,e,t){return n<=e?e:t<=n?t:n},Pi=function(n,e,t,r){var o=Ti(n.element(),"."+e.highlightClass);Mn(o,(function(t){En(r,(function(n){return n.element()===t}))||(ro(t,e.highlightClass),n.getSystem().getByDom(t).each((function(t){e.onDehighlight(n,t),le(t,fe())})))}))},Li=function(n,e,t,r){Pi(n,e,0,[r]),Gi(n,e,t,r)||(to(r.element(),e.highlightClass),e.onHighlight(n,r),le(r,se()))},Gi=function(n,e,t,r){return oo(r.element(),e.highlightClass)},Ui=function(n,e,t){return Ci(n.element(),"."+e.itemClass).bind((function(e){return n.getSystem().getByDom(e).toOption()}))},$i=function(n,e,t){var r=Ti(n.element(),"."+e.itemClass);return(0<r.length?k.some(r[r.length-1]):k.none()).bind((function(e){return n.getSystem().getByDom(e).toOption()}))},Wi=function(n,e,t,r){var o=Ti(n.element(),"."+e.itemClass);return Rn(o,(function(n){return oo(n,e.highlightClass)})).bind((function(e){var t=Hi(e,r,0,o.length-1);return n.getSystem().getByDom(o[t]).toOption()}))},Xi=function(n,e,t){var r=Ti(n.element(),"."+e.itemClass);return wo(Cn(r,(function(e){return n.getSystem().getByDom(e).toOption()})))},qi=Object.freeze({dehighlightAll:function(n,e,t){return Pi(n,e,0,[])},dehighlight:function(n,e,t,r){Gi(n,e,t,r)&&(ro(r.element(),e.highlightClass),e.onDehighlight(n,r),le(r,fe()))},highlight:Li,highlightFirst:function(n,e,t){Ui(n,e).each((function(r){Li(n,e,t,r)}))},highlightLast:function(n,e,t){$i(n,e).each((function(r){Li(n,e,t,r)}))},highlightAt:function(n,e,t,r){(function(n,e,t,r){var o=Ti(n.element(),"."+e.itemClass);return k.from(o[r]).fold((function(){return it.error("No element found with index "+r)}),n.getSystem().getByDom)})(n,e,0,r).fold((function(n){throw new Error(n)}),(function(r){Li(n,e,t,r)}))},highlightBy:function(n,e,t,r){var o=Xi(n,e);An(o,r).each((function(r){Li(n,e,t,r)}))},isHighlighted:Gi,getHighlighted:function(n,e,t){return Ci(n.element(),"."+e.highlightClass).bind((function(e){return n.getSystem().getByDom(e).toOption()}))},getFirst:Ui,getLast:$i,getPrevious:function(n,e,t){return Wi(n,e,0,-1)},getNext:function(n,e,t){return Wi(n,e,0,1)},getCandidates:Xi}),Yi=[ur("highlightClass"),ur("itemClass"),Ro("onHighlight"),Ro("onDehighlight")],Ki=$r({fields:Yi,name:"highlighting",apis:qi}),Ji=function(n,e,t){e.exists((function(n){return t.exists((function(e){return He(e,n)}))}))||de(n,ae(),{prevFocus:e,newFocus:t})},Qi=function(){var n=function(n){return go(n.element())};return{get:n,set:function(e,t){var r=n(e);e.getSystem().triggerFocus(t,e.element());var o=n(e);Ji(e,r,o)}}};(wi=xi||(xi={})).OnFocusMode="onFocus",wi.OnEnterOrSpaceMode="onEnterOrSpace",wi.OnApiMode="onApi";var Zi,nu,eu,tu,ru,ou,iu,uu,cu,au,su,fu,lu,du=function(n,e,t,r,o){var i=function(n,e,t,r,o){var i,u;return(i=t(n,e,r,o),u=e.event(),An(i,(function(n){return n.matches(u)})).map((function(n){return n.classification}))).bind((function(t){return t(n,e,r,o)}))},u={schema:function(){return n.concat([mr("focusManager",Qi()),gr("focusInside","onFocus",Jt((function(n){return kn(["onFocus","onEnterOrSpace","onApi"],n)?it.value(n):it.error("Invalid value for focusInside")}))),jo("handler",u),jo("state",e),jo("sendFocusIn",o)])},processKey:i,toEvents:function(n,e){var u=n.focusInside!==xi.OnFocusMode?k.none():o(n).map((function(t){return Er(Kn(),(function(r,o){t(r,n,e),o.stop()}))}));return Tr(u.toArray().concat([Er(z(),(function(r,u){i(r,u,t,n,e).fold((function(){var t,i,c;t=r,i=u,c=Ri([32].concat([13]))(i.event()),n.focusInside===xi.OnEnterOrSpaceMode&&c&&vr(t,i)&&o(n).each((function(r){r(t,n,e),i.stop()}))}),(function(n){u.stop()}))})),Er(P(),(function(t,o){i(t,o,r,n,e).each((function(n){o.stop()}))}))]))}};return u},mu=function(n){var e=[sr("onEscape"),sr("onEnter"),mr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),mr("firstTabstop",0),mr("useTabstopAt",i(!0)),sr("visibilitySelector")].concat([n]),t=function(n,e){var t=n.visibilitySelector.bind((function(n){return Mi(e,n)})).getOr(e);return 0<Oi(t)},r=function(n,e){var r,o,i,u;(r=n,o=e,i=Ti(r.element(),o.selector),u=In(i,(function(n){return t(o,n)})),k.from(u[o.firstTabstop])).each((function(t){e.focusManager.set(n,t)}))},o=function(n,e,r,o,i){return i(e,r,(function(n){return t(e=o,r=n)&&e.useTabstopAt(r);var e,r})).fold((function(){return o.cyclic?k.some(!0):k.none()}),(function(e){return o.focusManager.set(n,e),k.some(!0)}))},u=function(n,e,t,r){var i,u,a=Ti(n.element(),t.selector);return(i=n,u=t,u.focusManager.get(i).bind((function(n){return Mi(n,u.selector)}))).bind((function(e){return Rn(a,c(He,e)).bind((function(e){return o(n,a,e,t,r)}))}))},a=i([_i(Bi([Vi,Ri([9])]),(function(n,e,t,r){var o=t.cyclic?Ii:Di;return u(n,0,t,o)})),_i(Ri([9]),(function(n,e,t,r){var o=t.cyclic?Fi:Ai;return u(n,0,t,o)})),_i(Ri([27]),(function(n,e,t,r){return t.onEscape.bind((function(t){return t(n,e)}))})),_i(Bi([ji,Ri([13])]),(function(n,e,t,r){return t.onEnter.bind((function(t){return t(n,e)}))}))]),s=i([]);return du(e,Pr.init,a,s,(function(){return k.some(r)}))},gu=mu(pr("cyclic",i(!1))),pu=mu(pr("cyclic",i(!0))),vu=function(n){return"input"===Se(n)&&"radio"!==Jr(n,"type")||"textarea"===Se(n)},hu=function(n,e,t){return vu(t)&&Ri([32])(e.event())?k.none():(ge(n,t,ne()),k.some(!0))},yu=function(n,e){return k.some(!0)},bu=[mr("execute",hu),mr("useSpace",!1),mr("useEnter",!0),mr("useControlEnter",!1),mr("useDown",!1)],xu=function(n,e,t){return t.execute(n,e,n.element())},wu=du(bu,Pr.init,(function(n,e,t,r){var o=t.useSpace&&!vu(n.element())?[32]:[],i=t.useEnter?[13]:[],u=t.useDown?[40]:[],c=o.concat(i).concat(u);return[_i(Ri(c),xu)].concat(t.useControlEnter?[_i(Bi([Ni,Ri([13])]),xu)]:[])}),(function(n,e,t,r){return t.useSpace&&!vu(n.element())?[_i(Ri([32]),yu)]:[]}),(function(){return k.none()})),Su=function(n){var e=so(k.none());return Lr({readState:function(){return e.get().map((function(n){return{numRows:n.numRows(),numColumns:n.numColumns()}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,t){e.set(k.some({numRows:i(n),numColumns:i(t)}))},getNumRows:function(){return e.get().map((function(n){return n.numRows()}))},getNumColumns:function(){return e.get().map((function(n){return n.numColumns()}))}})},Ou=Object.freeze({flatgrid:Su,init:function(n){return n.state(n)}}),Tu=function(n,e){return function(t){return"rtl"===ku(t)?e:n}},ku=function(n){return"rtl"===gi(n,"direction")?"rtl":"ltr"},Eu=function(n){return function(e,t,r,o){var i=n(e.element());return Du(i,e,t,r,o)}},Cu=function(n,e){var t=Tu(n,e);return Eu(t)},Mu=function(n,e){var t=Tu(e,n);return Eu(t)},Iu=function(n){return function(e,t,r,o){return Du(n,e,t,r,o)}},Du=function(n,e,t,r,o){return r.focusManager.get(e).bind((function(t){return n(e.element(),t,r,o)})).map((function(n){return r.focusManager.set(e,n),!0}))},Fu=Iu,Au=Iu,Ru=Iu,Bu=function(n){var e;return!((e=n.dom()).offsetWidth<=0&&e.offsetHeight<=0)},Vu=Ae(["index","candidates"],[]),Nu=function(n,e,t){var r,o=c(He,e),i=Ti(n,t),u=In(i,Bu);return Rn(r=u,o).map((function(n){return Vu({index:n,candidates:r})}))},ju=function(n,e){return Rn(n,(function(n){return He(e,n)}))},_u=function(n,e,t,r){return r(Math.floor(e/t),e%t).bind((function(e){var r=e.row()*t+e.column();return 0<=r&&r<n.length?k.some(n[r]):k.none()}))},Hu=function(n,e,t,r,o){return _u(n,e,r,(function(e,u){var c=e===t-1?n.length-e*r:r,a=Hi(u,o,0,c-1);return k.some({row:i(e),column:i(a)})}))},zu=function(n,e,t,r,o){return _u(n,e,r,(function(e,u){var c=Hi(e,o,0,t-1),a=c===t-1?n.length-c*r:r,s=zi(u,0,a-1);return k.some({row:i(c),column:i(s)})}))},Pu=[ur("selector"),mr("execute",hu),Bo("onEscape"),mr("captureTab",!1),Ho()],Lu=function(n,e,t){Ci(n.element(),e.selector).each((function(t){e.focusManager.set(n,t)}))},Gu=function(n){return function(e,t,r,o){return Nu(e,t,r.selector).bind((function(e){return n(e.candidates(),e.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},Uu=function(n,e,t,r){return t.captureTab?k.some(!0):k.none()},$u=Gu((function(n,e,t,r){return Hu(n,e,t,r,-1)})),Wu=Gu((function(n,e,t,r){return Hu(n,e,t,r,1)})),Xu=Gu((function(n,e,t,r){return zu(n,e,t,r,-1)})),qu=Gu((function(n,e,t,r){return zu(n,e,t,r,1)})),Yu=i([_i(Ri([37]),Cu($u,Wu)),_i(Ri([39]),Mu($u,Wu)),_i(Ri([38]),Fu(Xu)),_i(Ri([40]),Au(qu)),_i(Bi([Vi,Ri([9])]),Uu),_i(Bi([ji,Ri([9])]),Uu),_i(Ri([27]),(function(n,e,t,r){return t.onEscape(n,e)})),_i(Ri([32].concat([13])),(function(n,e,t,r){return(o=n,i=t,i.focusManager.get(o).bind((function(n){return Mi(n,i.selector)}))).bind((function(r){return t.execute(n,e,r)}));var o,i}))]),Ku=i([_i(Ri([32]),yu)]),Ju=du(Pu,Su,Yu,Ku,(function(){return k.some(Lu)})),Qu=function(n,e,t,r){var o=function(n,e,t){var i,u=Hi(e,r,0,t.length-1);return u===n?k.none():(i=t[u],"button"===Se(i)&&"disabled"===Jr(i,"disabled")?o(n,u,t):k.from(t[u]))};return Nu(n,t,e).bind((function(n){var e=n.index(),t=n.candidates();return o(e,e,t)}))},Zu=[ur("selector"),mr("getInitial",k.none),mr("execute",hu),Bo("onEscape"),mr("executeOnMove",!1),mr("allowVertical",!0)],nc=function(n,e,t){return(r=n,o=t,o.focusManager.get(r).bind((function(n){return Mi(n,o.selector)}))).bind((function(r){return t.execute(n,e,r)}));var r,o},ec=function(n,e){e.getInitial(n).orThunk((function(){return Ci(n.element(),e.selector)})).each((function(t){e.focusManager.set(n,t)}))},tc=function(n,e,t){return Qu(n,t.selector,e,-1)},rc=function(n,e,t){return Qu(n,t.selector,e,1)},oc=function(n){return function(e,t,r){return n(e,t,r).bind((function(){return r.executeOnMove?nc(e,t,r):k.some(!0)}))}},ic=function(n,e,t,r){return t.onEscape(n,e)},uc=i([_i(Ri([32]),yu)]),cc=du(Zu,Pr.init,(function(n,e,t,r){var o=[37].concat(t.allowVertical?[38]:[]),i=[39].concat(t.allowVertical?[40]:[]);return[_i(Ri(o),oc(Cu(tc,rc))),_i(Ri(i),oc(Mu(tc,rc))),_i(Ri([13]),nc),_i(Ri([32]),nc),_i(Ri([27]),ic)]}),uc,(function(){return k.some(ec)})),ac=Ae(["rowIndex","columnIndex","cell"],[]),sc=function(n,e,t){return k.from(n[e]).bind((function(n){return k.from(n[t]).map((function(n){return ac({rowIndex:e,columnIndex:t,cell:n})}))}))},fc=function(n,e,t,r){var o=n[e].length,i=Hi(t,r,0,o-1);return sc(n,e,i)},lc=function(n,e,t,r){var o=Hi(t,r,0,n.length-1),i=n[o].length,u=zi(e,0,i-1);return sc(n,o,u)},dc=function(n,e,t,r){var o=n[e].length,i=zi(t+r,0,o-1);return sc(n,e,i)},mc=function(n,e,t,r){var o=zi(t+r,0,n.length-1),i=n[o].length,u=zi(e,0,i-1);return sc(n,o,u)},gc=[ar("selectors",[ur("row"),ur("cell")]),mr("cycles",!0),mr("previousSelector",k.none),mr("execute",hu)],pc=function(n,e){e.previousSelector(n).orThunk((function(){var t=e.selectors;return Ci(n.element(),t.cell)})).each((function(t){e.focusManager.set(n,t)}))},vc=function(n,e){return function(t,r,o){var i=o.cycles?n:e;return Mi(r,o.selectors.row).bind((function(n){var e=Ti(n,o.selectors.cell);return ju(e,r).bind((function(e){var r=Ti(t,o.selectors.row);return ju(r,n).bind((function(n){var t,u=(t=o,Cn(r,(function(n){return Ti(n,t.selectors.cell)})));return i(u,n,e).map((function(n){return n.cell()}))}))}))}))}},hc=vc((function(n,e,t){return fc(n,e,t,-1)}),(function(n,e,t){return dc(n,e,t,-1)})),yc=vc((function(n,e,t){return fc(n,e,t,1)}),(function(n,e,t){return dc(n,e,t,1)})),bc=vc((function(n,e,t){return lc(n,t,e,-1)}),(function(n,e,t){return mc(n,t,e,-1)})),xc=vc((function(n,e,t){return lc(n,t,e,1)}),(function(n,e,t){return mc(n,t,e,1)})),wc=i([_i(Ri([37]),Cu(hc,yc)),_i(Ri([39]),Mu(hc,yc)),_i(Ri([38]),Fu(bc)),_i(Ri([40]),Au(xc)),_i(Ri([32].concat([13])),(function(n,e,t){return go(n.element()).bind((function(r){return t.execute(n,e,r)}))}))]),Sc=i([_i(Ri([32]),yu)]),Oc=du(gc,Pr.init,wc,Sc,(function(){return k.some(pc)})),Tc=[ur("selector"),mr("execute",hu),mr("moveOnTab",!1)],kc=function(n,e,t){return t.focusManager.get(n).bind((function(r){return t.execute(n,e,r)}))},Ec=function(n,e){Ci(n.element(),e.selector).each((function(t){e.focusManager.set(n,t)}))},Cc=function(n,e,t){return Qu(n,t.selector,e,-1)},Mc=function(n,e,t){return Qu(n,t.selector,e,1)},Ic=i([_i(Ri([38]),Ru(Cc)),_i(Ri([40]),Ru(Mc)),_i(Bi([Vi,Ri([9])]),(function(n,e,t){return t.moveOnTab?Ru(Cc)(n,e,t):k.none()})),_i(Bi([ji,Ri([9])]),(function(n,e,t){return t.moveOnTab?Ru(Mc)(n,e,t):k.none()})),_i(Ri([13]),kc),_i(Ri([32]),kc)]),Dc=i([_i(Ri([32]),yu)]),Fc=du(Tc,Pr.init,Ic,Dc,(function(){return k.some(Ec)})),Ac=[Bo("onSpace"),Bo("onEnter"),Bo("onShiftEnter"),Bo("onLeft"),Bo("onRight"),Bo("onTab"),Bo("onShiftTab"),Bo("onUp"),Bo("onDown"),Bo("onEscape"),mr("stopSpaceKeyup",!1),sr("focusIn")],Rc=du(Ac,Pr.init,(function(n,e,t){return[_i(Ri([32]),t.onSpace),_i(Bi([ji,Ri([13])]),t.onEnter),_i(Bi([Vi,Ri([13])]),t.onShiftEnter),_i(Bi([Vi,Ri([9])]),t.onShiftTab),_i(Bi([ji,Ri([9])]),t.onTab),_i(Ri([38]),t.onUp),_i(Ri([40]),t.onDown),_i(Ri([37]),t.onLeft),_i(Ri([39]),t.onRight),_i(Ri([32]),t.onSpace),_i(Ri([27]),t.onEscape)]}),(function(n,e,t){return t.stopSpaceKeyup?[_i(Ri([32]),yu)]:[]}),(function(n){return n.focusIn})),Bc=gu.schema(),Vc=pu.schema(),Nc=cc.schema(),jc=Ju.schema(),_c=Oc.schema(),Hc=wu.schema(),zc=Fc.schema(),Pc=Rc.schema(),Lc=(au=er("Creating behaviour: "+(Zi={branchKey:"mode",branches:Object.freeze({acyclic:Bc,cyclic:Vc,flow:Nc,flatgrid:jc,matrix:_c,execution:Hc,menu:zc,special:Pc}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(n,e,t){e.sendFocusIn(e).fold((function(){n.getSystem().triggerFocus(n.element(),n.element())}),(function(r){r(n,e,t)}))},setGridSize:function(e,t,r,o,i){Et(r,"setGridSize")?r.setGridSize(o,i):n.console.error("Layout does not support setGridSize")}},state:Ou}).name,Wr,Zi),nu=rr(au.branchKey,au.branches),eu=au.name,tu=au.active,ru=au.apis,ou=au.extra,iu=au.state,cu=lr(eu,[fr("config",uu=nu)]),zr(uu,cu,eu,tu,ru,ou,iu)),Gc=function(n,e){return t=n,r={},o=Cn(e,(function(e){return t=e.name(),r="Cannot configure "+e.name()+" for "+n,Yt(t,t,gt(),Ut((function(n){return Rt("The field: "+t+" is forbidden. "+r)})));var t,r})).concat([pr("dump",u)]),gr(t,r,Wt(o));var t,r,o},Uc=function(n){return n.dump},$c=function(n,t){return e({},n.dump,Gr(t))},Wc=Gc,Xc=$c,qc="placeholder",Yc=ut([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Kc=function(n,t,r,o){return function(n,e,t,r){return t.uiType===qc?(u=t,c=r,(o=n).exists((function(n){return n!==u.owner}))?Yc.single(!0,i(u)):Ot(c,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+E(c)+"]\nNamespace: "+o.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(n){return n.replace()}))):Yc.single(!1,i(t));var o,u,c}(n,0,r,o).fold((function(i,u){var c=u(t,r.config,r.validated),a=Ot(c,"components").getOr([]),s=jn(a,(function(e){return Kc(n,t,e,o)}));return[e({},c,{components:s})]}),(function(n,e){var o=e(t,r.config,r.validated);return r.validated.preprocess.getOr(u)(o)}))},Jc=Yc.single,Qc=Yc.multiple,Zc=i(qc),na=0,ea=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++na+String(e)},ta=ut([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ra=mr("factory",{sketch:u}),oa=mr("schema",[]),ia=ur("name"),ua=Yt("pname","pname",pt((function(n){return"<alloy."+ea(n.name)+">"})),or()),ca=pr("schema",(function(){return[sr("preprocess")]})),aa=mr("defaults",i({})),sa=mr("overrides",i({})),fa=Wt([ra,oa,ia,ua,aa,sa]),la=Wt([ra,oa,ia,ua,aa,sa]),da=Wt([ra,ca,ia,ur("unit"),ua,aa,sa]),ma=function(n){var e=function(n){return n.name};return n.fold(e,e,e,e)},ga=function(n,e){return function(t){var r=er("Converting part type",e,t);return n(r)}},pa=ga(ta.required,fa),va=ga(ta.optional,la),ha=ga(ta.group,da),ya=i("entirety"),ba=function(n,e,t,r){return st(e.defaults(n,t,r),t,{uid:n.partUids[e.name]},e.overrides(n,t,r))},xa=function(n,e,t){return r=e,o={},u={},Mn(t,(function(n){n.fold((function(n){o[n.pname]=Jc(!0,(function(e,t,r){return n.factory.sketch(ba(e,n,t,r))}))}),(function(n){var e=r.parts[n.name];u[n.name]=i(n.factory.sketch(ba(r,n,e[ya()]),e))}),(function(n){o[n.pname]=Jc(!1,(function(e,t,r){return n.factory.sketch(ba(e,n,t,r))}))}),(function(n){o[n.pname]=Qc(!0,(function(e,t,r){var o=e[n.name];return Cn(o,(function(t){return n.factory.sketch(st(n.defaults(e,t,r),t,n.overrides(e,t)))}))}))}))})),{internals:i(o),externals:i(u)};var r,o,u},wa=function(n,e,t){return function(n,e,t,r){var o,u,c,a=I(r,(function(n,e){return r=n,o=!1,{name:i(t=e),required:function(){return r.fold((function(n,e){return n}),(function(n,e){return n}))},used:function(){return o},replace:function(){if(!0===o)throw new Error("Trying to use the same placeholder more than once: "+t);return o=!0,r}};var t,r,o})),s=(o=n,u=e,c=a,jn(t,(function(n){return Kc(o,u,n,c)})));return M(a,(function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))})),s}(k.some(n),e,e.components,t)},Sa=function(n,e,t){var r=e.partUids[t];return n.getSystem().getByUid(r).toOption()},Oa=function(n,e,t){return Sa(n,e,t).getOrDie("Could not find part: "+t)},Ta=function(n){return Yt("partUids","partUids",vt((function(e){return function(n,e){var t=Cn(e,ma);return kt(Cn(t,(function(e){return{key:e,value:n+"-"+e}})))}(e.uid,n)})),or())},ka=ea("alloy-premade"),Ea=function(n){return Tt(ka,n)},Ca=function(n){return e=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return n.apply(void 0,[e.getApis()].concat([e].concat(t)))},r=(t=n.toString()).indexOf(")")+1,o=t.indexOf("("),i=t.substring(o+1,r-1).split(/,\s*/),e.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Vr(i.slice(1))}},e;var e,t,r,o,i},Ma=i("alloy-id-"),Ia=i("data-alloy-id"),Da=Ma(),Fa=Ia(),Aa=function(n,e){Object.defineProperty(n.dom(),Fa,{value:e,writable:!0})},Ra=function(n){var e=Te(n)?n.dom()[Fa]:null;return k.from(e)},Ba=function(n){return ea(n)},Va=function(n,e,t,r,o){var i,u,c=(u=o,(0<(i=r).length?[ar("parts",i)]:[]).concat([ur("uid"),mr("dom",{}),mr("components",[]),_o("originalSpec"),mr("debug.sketcher",{})]).concat(u));return er(n+" [SpecSchema]",$t(c.concat(e)),t)},Na=function(n,e,t,r,o){var i=ja(o),u=jn(t,(function(n){return n.fold(k.none,k.some,k.none,k.none).map((function(n){return ar(n.name,n.schema.concat([_o(ya())]))})).toArray()})),c=Ta(t),a=Va(n,e,i,u,[c]),s=xa(0,a,t);return r(a,wa(n,a,s.internals()),i,s.externals())},ja=function(n){return n.hasOwnProperty("uid")?n:e({},n,{uid:Ba("uid")})},_a=$t([ur("name"),ur("factory"),ur("configFields"),mr("apis",{}),mr("extraApis",{})]),Ha=$t([ur("name"),ur("factory"),ur("configFields"),ur("partFields"),mr("apis",{}),mr("extraApis",{})]),za=function(n){var t=er("Sketcher for "+n.name,_a,n),r=I(t.apis,Ca),o=I(t.extraApis,(function(n,e){return Nr(n,e)}));return e({name:i(t.name),partFields:i([]),configFields:i(t.configFields),sketch:function(n){return e=t.name,r=t.configFields,o=t.factory,i=ja(n),o(Va(e,r,i,[],[]),i);var e,r,o,i}},r,o)},Pa=function(n){var t=er("Sketcher for "+n.name,Ha,n),r=function(n,t){var r={};return Mn(t,(function(t){var o;(o=t,o.fold(k.some,k.none,k.some,k.some)).each((function(t){var o=function(n,e){return{uiType:Zc(),owner:n,name:e}}(n,t.pname);r[t.name]=function(r){var i=er("Part: "+t.name+" in "+n,Wt(t.schema),r);return e({},o,{config:r,validated:i})}}))})),r}(t.name,t.partFields),o=I(t.apis,Ca),u=I(t.extraApis,(function(n,e){return Nr(n,e)}));return e({name:i(t.name),partFields:i(t.partFields),configFields:i(t.configFields),sketch:function(n){return Na(t.name,t.configFields,t.partFields,t.factory,n)},parts:i(r)},o,u)},La=za({name:"Button",factory:function(n){var t,r,o,i=(t=n.action,r=function(n,e){e.stop(),me(n)},o=qn.detect().deviceType.isTouch()?[Er(te(),r)]:[Er(U(),r),Er(N(),(function(n,e){e.cut()}))],Tr(Nn([t.map((function(n){return Er(ne(),(function(e,t){n(e),t.stop()}))})).toArray(),o]))),u=n.dom.tag,c=function(e){return Ot(n.dom,"attributes").bind((function(n){return Ot(n,e)}))};return{uid:n.uid,dom:n.dom,components:n.components,events:i,behaviours:Xc(n.buttonBehaviours,[si.config({}),Lc.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==u)return{role:c("role").getOr("button")};var n=c("type").getOr("button"),t=c("role").map((function(n){return{role:n}})).getOr({});return e({type:n},t)}()},eventOrder:n.eventOrder}},configFields:[mr("uid",void 0),ur("dom"),mr("components",[]),Wc("buttonBehaviours",[si,Lc]),sr("action"),sr("role"),mr("eventOrder",{})]}),Ga=$r({fields:[],name:"unselecting",active:Object.freeze({events:function(n){return Tr([kr(W(),i(!0))])},exhibit:function(n,e){return jr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ua=function(t){var r,o,i=(r=t,o={prefix:oi.prefix()},r.replace(/\$\{([^{}]*)\}/g,(function(n,e){var t,r=o[e];return"string"==(t=typeof r)||"number"===t?r.toString():n})));return function(t){var r,o,i,u=function(e,t){var r=(t||n.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw n.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return ve(r.childNodes[0])}(t),c=Le(u),a=(o=void 0!==(r=u).dom().attributes?r.dom().attributes:[],Fn(o,(function(n,t){var r;return"class"===t.name?n:e({},n,((r={})[t.name]=t.value,r))}),{})),s=(i=u,Array.prototype.slice.call(i.dom().classList,0)),f=0===c.length?{}:{innerHtml:yo(u)};return e({tag:Se(u),classes:s,attributes:a},f)}(i)},$a=function(n){return{dom:Ua(n)}},Wa=function(n){return Gr([Zo.config({toggleClass:oi.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ni(n,(function(n,e){(e?Zo.on:Zo.off)(n)}))])},Xa=function(n,e){var t=e.ui.registry.getAll().icons;return k.from(t[n]).fold((function(){return Ua('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')}),(function(n){return Ua('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")}))},qa=function(n,e,t,r){return La.sketch({dom:Xa(n,r),action:e,buttonBehaviours:st(Gr([Ga.config({})]),t)})},Ya=qa,Ka=function(n,e,t,r){var o=Wa(t);return qa(e,r,o,n)},Ja=Xa,Qa=qn.detect().deviceType.isTouch(),Za=va({schema:[ur("dom")],name:"label"}),ns=function(n){return va({name:n+"-edge",overrides:function(e){return e.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){var t=Tr([Cr(R(),n,[e])]),r=Tr([Cr(N(),n,[e]),Cr(j(),(function(e,t){t.mouseIsDown.get()&&n(e,t)}),[e])]);return{events:Qa?t:r}}))}})},es=ns("top-left"),ts=ns("top"),rs=ns("top-right"),os=ns("right"),is=ns("bottom-right"),us=ns("bottom"),cs=ns("bottom-left"),as=[Za,ns("left"),os,ts,us,es,rs,cs,is,pa({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Tr([Ir(R(),n,"spectrum"),Ir(B(),n,"spectrum"),Ir(V(),n,"spectrum"),Ir(N(),n,"spectrum"),Ir(j(),n,"spectrum"),Ir(_(),n,"spectrum")])}}}),pa({schema:[pr("mouseIsDown",(function(){return so(!1)}))],name:"spectrum",overrides:function(n){var e=n.model.manager,t=function(t,r){return e.getValueFromEvent(r).map((function(r){return e.setValueFrom(t,n,r)}))},r=Tr([Er(R(),t),Er(B(),t)]),o=Tr([Er(N(),t),Er(j(),(function(e,r){n.mouseIsDown.get()&&t(e,r)}))]);return{behaviours:Gr(Qa?[]:[Lc.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),si.config({})]),events:Qa?r:o}}})],ss=function(n,e,t){e.store.manager.onLoad(n,e,t)},fs=function(n,e,t){e.store.manager.onUnload(n,e,t)},ls=Object.freeze({onLoad:ss,onUnload:fs,setValue:function(n,e,t,r){e.store.manager.setValue(n,e,t,r)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),ds=Object.freeze({events:function(n,e){var t=n.resetOnDom?[Fr((function(t,r){ss(t,n,e)})),Ar((function(t,r){fs(t,n,e)}))]:[_r(n,e,ss)];return Tr(t)}}),ms=function(){var n=so(null);return Lr({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},gs=function(){var n=so({}),t=so({});return Lr({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},lookup:function(e){return Ot(n.get(),e).orThunk((function(){return Ot(t.get(),e)}))},update:function(r){var o=n.get(),i=t.get(),u={},c={};Mn(r,(function(n){u[n.value]=n,Ot(n,"meta").each((function(e){Ot(e,"text").each((function(e){c[e]=n}))}))})),n.set(e({},o,u)),t.set(e({},i,c))},clear:function(){n.set({}),t.set({})}})},ps=Object.freeze({memory:ms,dataset:gs,manual:function(){return Lr({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),vs=function(n,e,t,r){var o=e.store;t.update([r]),o.setValue(n,r),e.onSetValue(n,r)},hs=[sr("initialValue"),ur("getFallbackEntry"),ur("getDataKey"),ur("setValue"),jo("manager",{setValue:vs,getValue:function(n,e,t){var r=e.store,o=r.getDataKey(n);return t.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(n){return n}))},onLoad:function(n,e,t){e.store.initialValue.each((function(r){vs(n,e,t,r)}))},onUnload:function(n,e,t){t.clear()},state:gs})],ys=[ur("getValue"),mr("setValue",r),sr("initialValue"),jo("manager",{setValue:function(n,e,t,r){e.store.setValue(n,r),e.onSetValue(n,r)},getValue:function(n,e,t){return e.store.getValue(n)},onLoad:function(n,e,t){e.store.initialValue.each((function(t){e.store.setValue(n,t)}))},onUnload:r,state:Pr.init})],bs=[sr("initialValue"),jo("manager",{setValue:function(n,e,t,r){t.set(r),e.onSetValue(n,r)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each((function(n){t.isNotSet()&&t.set(n)}))},onUnload:function(n,e,t){t.clear()},state:ms})],xs=[gr("store",{mode:"memory"},rr("mode",{memory:bs,manual:ys,dataset:hs})),Ro("onSetValue"),mr("resetOnDom",!1)],ws=$r({fields:xs,name:"representing",active:ds,apis:ls,extra:{setValueFrom:function(n,e){var t=ws.getValue(e);ws.setValue(n,t)}},state:ps}),Ss=bi("width",(function(n){return n.dom().offsetWidth})),Os=function(n,e){Ss.set(n,e)},Ts=function(n){return Ss.get(n)},ks=function(n,e){return{left:i(n),top:i(e),translate:function(t,r){return ks(n+t,e+r)}}},Es=ks,Cs=qn.detect().deviceType.isTouch(),Ms=i("slider.change.value"),Is=function(n){var e=n.event().raw();if(Cs){var t=e;return void 0!==t.touches&&1===t.touches.length?k.some(t.touches[0]).map((function(n){return Es(n.clientX,n.clientY)})):k.none()}var r=e;return void 0!==r.clientX?k.some(r).map((function(n){return Es(n.clientX,n.clientY)})):k.none()},Ds=function(n){return n.model.minX},Fs=function(n){return n.model.minY},As=function(n){return n.model.minX-1},Rs=function(n){return n.model.minY-1},Bs=function(n){return n.model.maxX},Vs=function(n){return n.model.maxY},Ns=function(n){return n.model.maxX+1},js=function(n){return n.model.maxY+1},_s=function(n,e,t){return e(n)-t(n)},Hs=function(n){return _s(n,Bs,Ds)},zs=function(n){return _s(n,Vs,Fs)},Ps=function(n){return Hs(n)/2},Ls=function(n){return zs(n)/2},Gs=function(n){return n.stepSize},Us=function(n){return n.snapToGrid},$s=function(n){return n.snapStart},Ws=function(n){return n.rounded},Xs=function(n,e){return void 0!==n[e+"-edge"]},qs=function(n){return Xs(n,"left")},Ys=function(n){return Xs(n,"right")},Ks=function(n){return Xs(n,"top")},Js=function(n){return Xs(n,"bottom")},Qs=function(n){return n.model.value.get()},Zs=function(n){return{x:i(n)}},nf=function(n){return{y:i(n)}},ef=function(n,e){return{x:i(n),y:i(e)}},tf=function(n,e){de(n,Ms(),{value:e})},rf=function(n,e,t,r){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-r)},of=function(n,e,t,r){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+r)},uf=function(n,e,t){return Math.max(e,Math.min(t,n))},cf=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?e-1:e,p=f?t+1:t;if(o<l)return g;if(d<o)return p;var v,h,y,b,x,w,S,O=(x=o,w=l,S=d,Math.min(S,Math.max(x,w))-w),T=uf(O/m*r+e,g,p);return u&&e<=T&&T<=t?(v=T,h=e,y=t,b=i,c.fold((function(){var n=v-h,e=Math.round(n/b)*b;return uf(h+e,h-1,y+1)}),(function(n){var e=(v-n)%b,t=Math.round(e/b),r=Math.floor((v-n)/b),o=Math.floor((y-n)/b),i=n+Math.min(o,r+t)*b;return Math.max(n,i)}))):a?Math.round(T):T},af=function(n){var e=n.min,t=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return o<e?i?0:s:t<o?u?c:f:(o-e)/r*a},sf="left",ff=function(n){return n.element().dom().getBoundingClientRect()},lf=function(n,e){return n[e]},df=function(n){var e=ff(n);return lf(e,sf)},mf=function(n){var e=ff(n);return lf(e,"right")},gf=function(n){var e=ff(n);return lf(e,"top")},pf=function(n){var e=ff(n);return lf(e,"bottom")},vf=function(n){var e=ff(n);return lf(e,"width")},hf=function(n){var e=ff(n);return lf(e,"height")},yf=function(n,e,t){return(n+e)/2-t},bf=function(n,e){var t=ff(n),r=ff(e),o=lf(t,sf),i=lf(t,"right"),u=lf(r,sf);return yf(o,i,u)},xf=function(n,e){var t=ff(n),r=ff(e),o=lf(t,"top"),i=lf(t,"bottom"),u=lf(r,"top");return yf(o,i,u)},wf=function(n,e){de(n,Ms(),{value:e})},Sf=function(n){return{x:i(n)}},Of=function(n,e,t){var r={min:Ds(e),max:Bs(e),range:Hs(e),value:t,step:Gs(e),snap:Us(e),snapStart:$s(e),rounded:Ws(e),hasMinEdge:qs(e),hasMaxEdge:Ys(e),minBound:df(n),maxBound:mf(n),screenRange:vf(n)};return cf(r)},Tf=function(n){return function(e,t){return(r=n,o=e,i=t,u=(0<r?of:rf)(Qs(i).x(),Ds(i),Bs(i),Gs(i)),wf(o,Sf(u)),k.some(u)).map((function(){return!0}));var r,o,i,u}},kf=function(n,e,t,r,o,i){var u,c,a,s,f,l,d,m,g,p=(c=i,a=t,s=r,f=o,l=vf(u=e),d=s.bind((function(n){return k.some(bf(n,u))})).getOr(0),m=f.bind((function(n){return k.some(bf(n,u))})).getOr(l),g={min:Ds(c),max:Bs(c),range:Hs(c),value:a,hasMinEdge:qs(c),hasMaxEdge:Ys(c),minBound:df(u),minOffset:0,maxBound:mf(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},af(g));return df(e)-df(n)+p},Ef=Tf(-1),Cf=Tf(1),Mf=k.none,If=k.none,Df={"top-left":k.none(),top:k.none(),"top-right":k.none(),right:k.some((function(n,e){tf(n,Zs(Ns(e)))})),"bottom-right":k.none(),bottom:k.none(),"bottom-left":k.none(),left:k.some((function(n,e){tf(n,Zs(As(e)))}))},Ff=Object.freeze({setValueFrom:function(n,e,t){var r=Of(n,e,t),o=Sf(r);return wf(n,o),r},setToMin:function(n,e){var t=Ds(e);wf(n,Sf(t))},setToMax:function(n,e){var t=Bs(e);wf(n,Sf(t))},findValueOfOffset:Of,getValueFromEvent:function(n){return Is(n).map((function(n){return n.left()}))},findPositionOfValue:kf,setPositionFromValue:function(n,e,t,r){var o=Qs(t),i=kf(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),t),u=Ts(e.element())/2;di(e.element(),"left",i-u+"px")},onLeft:Ef,onRight:Cf,onUp:Mf,onDown:If,edgeActions:Df}),Af=function(n,e){de(n,Ms(),{value:e})},Rf=function(n){return{y:i(n)}},Bf=function(n,e,t){var r={min:Fs(e),max:Vs(e),range:zs(e),value:t,step:Gs(e),snap:Us(e),snapStart:$s(e),rounded:Ws(e),hasMinEdge:Ks(e),hasMaxEdge:Js(e),minBound:gf(n),maxBound:pf(n),screenRange:hf(n)};return cf(r)},Vf=function(n){return function(e,t){return(r=n,o=e,i=t,u=(0<r?of:rf)(Qs(i).y(),Fs(i),Vs(i),Gs(i)),Af(o,Rf(u)),k.some(u)).map((function(){return!0}));var r,o,i,u}},Nf=function(n,e,t,r,o,i){var u,c,a,s,f,l,d,m,g,p=(c=i,a=t,s=r,f=o,l=hf(u=e),d=s.bind((function(n){return k.some(xf(n,u))})).getOr(0),m=f.bind((function(n){return k.some(xf(n,u))})).getOr(l),g={min:Fs(c),max:Vs(c),range:zs(c),value:a,hasMinEdge:Ks(c),hasMaxEdge:Js(c),minBound:gf(u),minOffset:0,maxBound:pf(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},af(g));return gf(e)-gf(n)+p},jf=k.none,_f=k.none,Hf=Vf(-1),zf=Vf(1),Pf={"top-left":k.none(),top:k.some((function(n,e){tf(n,nf(Rs(e)))})),"top-right":k.none(),right:k.none(),"bottom-right":k.none(),bottom:k.some((function(n,e){tf(n,nf(js(e)))})),"bottom-left":k.none(),left:k.none()},Lf=Object.freeze({setValueFrom:function(n,e,t){var r=Bf(n,e,t),o=Rf(r);return Af(n,o),r},setToMin:function(n,e){var t=Fs(e);Af(n,Rf(t))},setToMax:function(n,e){var t=Vs(e);Af(n,Rf(t))},findValueOfOffset:Bf,getValueFromEvent:function(n){return Is(n).map((function(n){return n.top()}))},findPositionOfValue:Nf,setPositionFromValue:function(n,e,t,r){var o=Qs(t),i=Nf(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),t),u=Oi(e.element())/2;di(e.element(),"top",i-u+"px")},onLeft:jf,onRight:_f,onUp:Hf,onDown:zf,edgeActions:Pf}),Gf=function(n,e){de(n,Ms(),{value:e})},Uf=function(n,e){return{x:i(n),y:i(e)}},$f=function(n,e){return function(t,r){return(o=n,i=e,u=t,c=r,a=0<o?of:rf,s=i?Qs(c).x():a(Qs(c).x(),Ds(c),Bs(c),Gs(c)),f=i?a(Qs(c).y(),Fs(c),Vs(c),Gs(c)):Qs(c).y(),Gf(u,Uf(s,f)),k.some(s)).map((function(){return!0}));var o,i,u,c,a,s,f}},Wf=$f(-1,!1),Xf=$f(1,!1),qf=$f(-1,!0),Yf=$f(1,!0),Kf={"top-left":k.some((function(n,e){tf(n,ef(As(e),Rs(e)))})),top:k.some((function(n,e){tf(n,ef(Ps(e),Rs(e)))})),"top-right":k.some((function(n,e){tf(n,ef(Ns(e),Rs(e)))})),right:k.some((function(n,e){tf(n,ef(Ns(e),Ls(e)))})),"bottom-right":k.some((function(n,e){tf(n,ef(Ns(e),js(e)))})),bottom:k.some((function(n,e){tf(n,ef(Ps(e),js(e)))})),"bottom-left":k.some((function(n,e){tf(n,ef(As(e),js(e)))})),left:k.some((function(n,e){tf(n,ef(As(e),Ls(e)))}))},Jf=Object.freeze({setValueFrom:function(n,e,t){var r=Of(n,e,t.left()),o=Bf(n,e,t.top()),i=Uf(r,o);return Gf(n,i),i},setToMin:function(n,e){var t=Ds(e),r=Fs(e);Gf(n,Uf(t,r))},setToMax:function(n,e){var t=Bs(e),r=Vs(e);Gf(n,Uf(t,r))},getValueFromEvent:function(n){return Is(n)},setPositionFromValue:function(n,e,t,r){var o=Qs(t),i=kf(n,r.getSpectrum(n),o.x(),r.getLeftEdge(n),r.getRightEdge(n),t),u=Nf(n,r.getSpectrum(n),o.y(),r.getTopEdge(n),r.getBottomEdge(n),t),c=Ts(e.element())/2,a=Oi(e.element())/2;di(e.element(),"left",i-c+"px"),di(e.element(),"top",u-a+"px")},onLeft:Wf,onRight:Xf,onUp:qf,onDown:Yf,edgeActions:Kf}),Qf=qn.detect().deviceType.isTouch(),Zf=[mr("stepSize",1),mr("onChange",r),mr("onChoose",r),mr("onInit",r),mr("onDragStart",r),mr("onDragEnd",r),mr("snapToGrid",!1),mr("rounded",!0),sr("snapStart"),cr("model",rr("mode",{x:[mr("minX",0),mr("maxX",100),pr("value",(function(n){return so(n.mode.minX)})),ur("getInitialValue"),jo("manager",Ff)],y:[mr("minY",0),mr("maxY",100),pr("value",(function(n){return so(n.mode.minY)})),ur("getInitialValue"),jo("manager",Lf)],xy:[mr("minX",0),mr("maxX",100),mr("minY",0),mr("maxY",100),pr("value",(function(n){return so({x:i(n.mode.minX),y:i(n.mode.minY)})})),ur("getInitialValue"),jo("manager",Jf)]})),Gc("sliderBehaviours",[Lc,ws])].concat(Qf?[]:[pr("mouseIsDown",(function(){return so(!1)}))]),nl=qn.detect().deviceType.isTouch(),el=Pa({name:"Slider",configFields:Zf,partFields:as,factory:function(n,e,t,r){var o=function(e){return Oa(e,n,"thumb")},u=function(e){return Oa(e,n,"spectrum")},c=function(e){return Sa(e,n,"left-edge")},a=function(e){return Sa(e,n,"right-edge")},s=function(e){return Sa(e,n,"top-edge")},f=function(e){return Sa(e,n,"bottom-edge")},l=n.model,d=l.manager,m=function(e,t){d.setPositionFromValue(e,t,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(e,t){l.value.set(t);var r=o(e);return m(e,r),n.onChange(e,r,t),k.some(!0)},p=[Er(R(),(function(e,t){n.onDragStart(e,o(e))})),Er(V(),(function(e,t){n.onDragEnd(e,o(e))}))],v=[Er(N(),(function(e,t){t.stop(),n.onDragStart(e,o(e)),n.mouseIsDown.set(!0)})),Er(_(),(function(e,t){n.onDragEnd(e,o(e))}))],h=nl?p:v;return{uid:n.uid,dom:n.dom,components:e,behaviours:$c(n.sliderBehaviours,Nn([nl?[]:[Lc.config({mode:"special",focusIn:function(e){return Sa(e,n,"spectrum").map(Lc.focusIn).map(i(!0))}})],[ws.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),Po.config({channels:{"mouse.released":{onReceive:function(e,t){var r=n.mouseIsDown.get();n.mouseIsDown.set(!1),r&&Sa(e,n,"thumb").each((function(t){var r=l.value.get();n.onChoose(e,t,r)}))}}}})]])),events:Tr([Er(Ms(),(function(n,e){g(n,e.event().value())})),Fr((function(e,t){var r=l.getInitialValue();l.value.set(r);var i=o(e);m(e,i);var c=u(e);n.onInit(e,i,c,l.value.get())}))].concat(h)),apis:{resetToMin:function(e){d.setToMin(e,n)},resetToMax:function(e){d.setToMax(e,n)},changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),tl=function(n,e,t,r){return Ya(e,(function(){var r=t();n.setContextToolbar([{label:e+" group",items:r}])}),{},r)},rl=$t([ur("getInitialValue"),ur("onChange"),ur("category"),ur("sizes")]),ol=function(n){var e=er("SizeSlider",rl,n);return el.sketch({dom:{tag:"div",classes:[oi.resolve("slider-"+e.category+"-size-container"),oi.resolve("slider"),oi.resolve("slider-size-container")]},onChange:function(n,t,r){var o,i=r.x();0<=(o=i)&&o<e.sizes.length&&e.onChange(i)},onDragStart:function(n,e){Zo.on(e)},onDragEnd:function(n,e){Zo.off(e)},model:{mode:"x",minX:0,maxX:e.sizes.length-1,getInitialValue:function(){return{x:function(){return e.getInitialValue()}}}},stepSize:1,snapToGrid:!0,sliderBehaviours:Gr([ei(el.refresh)]),components:[el.parts().spectrum({dom:Ua('<div class="${prefix}-slider-size-container"></div>'),components:[$a('<div class="${prefix}-slider-size-line"></div>')]}),el.parts().thumb({dom:Ua('<div class="${prefix}-slider-thumb"></div>'),behaviours:Gr([Zo.config({toggleClass:oi.resolve("thumb-active")})])})]})},il=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],ul=function(n){var e,t,r=n.selection.getStart(),o=ye(r),i=ye(n.getBody()),u=(e=function(n){return He(i,n)},(Te(t=o)?k.some(t):Pe(t)).map((function(n){return Or(n,(function(n){return vi(n,"font-size").isSome()}),e).bind((function(n){return vi(n,"font-size")})).getOrThunk((function(){return gi(n,"font-size")}))})).getOr(""));return An(il,(function(n){return u===n})).getOr("medium")},cl={candidates:i(il),get:function(n){var e,t=ul(n);return(e=t,Rn(il,(function(n){return n===e}))).getOr(2)},apply:function(n,e){var t;(t=e,k.from(il[t])).each((function(e){var t,r;r=e,ul(t=n)!==r&&t.execCommand("fontSize",!1,r)}))}},al=cl.candidates(),sl=function(n){var t=function(n){return void 0!==n.uid}(n)&&Et(n,"uid")?n.uid:Ba("memento");return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).fold(k.none,k.some)},asSpec:function(){return e({},n,{uid:t})}}},fl=window.Promise?window.Promise:function(){var e=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(n,r(u,this),r(c,this))},t=e.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(e){n.setTimeout(e,1)};function r(n,e){return function(){return n.apply(e,arguments)}}var o=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var e=this;null!==this._state?t((function(){var t=e._state?n.onFulfilled:n.onRejected;if(null!==t){var r;try{r=t(e._value)}catch(e){return void n.reject(e)}n.resolve(r)}else(e._state?n.resolve:n.reject)(e._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if("function"==typeof e)return void f(r(e,n),r(u,this),r(c,this))}this._state=!0,this._value=n,a.call(this)}catch(n){c.call(this,n)}}function c(n){this._state=!1,this._value=n,a.call(this)}function a(){for(var n=0,e=this._deferreds;n<e.length;n++){var t=e[n];i.call(this,t)}this._deferreds=[]}function s(n,e,t,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.resolve=t,this.reject=r}function f(n,e,t){var r=!1;try{n((function(n){r||(r=!0,e(n))}),(function(n){r||(r=!0,t(n))}))}catch(n){if(r)return;r=!0,t(n)}}return e.prototype.catch=function(n){return this.then(null,n)},e.prototype.then=function(n,t){var r=this;return new e((function(e,o){i.call(r,new s(n,t,e,o))}))},e.all=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r=Array.prototype.slice.call(1===n.length&&o(n[0])?n[0]:n);return new e((function(n,e){if(0===r.length)return n([]);var t=r.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),e)}r[i]=u,0==--t&&n(r)}catch(n){e(n)}}for(var i=0;i<r.length;i++)o(i,r[i])}))},e.resolve=function(n){return n&&"object"==typeof n&&n.constructor===e?n:new e((function(e){e(n)}))},e.reject=function(n){return new e((function(e,t){t(n)}))},e.race=function(n){return new e((function(e,t){for(var r=0,o=n;r<o.length;r++)o[r].then(e,t)}))},e}(),ll=function(e,t){var r;(r=t,function(e){return function(e){return new fl((function(t){var r=new n.FileReader;r.onloadend=function(){t(r.result)},r.readAsDataURL(e)}))}(e).then((function(n){return n.split(",")[1]}))}(r)).then((function(n){e.undoManager.transact((function(){var r=e.editorUpload.blobCache,o=r.create(ea("mceu"),t,n);r.add(o);var i=e.dom.createHTML("img",{src:o.blobUri()});e.insertContent(i)}))}))},dl=function(n){return n.dom().textContent},ml=function(n){return 0<n.length},gl=function(n){return null==n?"":n},pl=function(n){var e=ye(n.selection.getStart());return Mi(e,"a")},vl=pl,hl=qn.detect(),yl=function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)},bl=function(n,e){(hl.os.isAndroid()?yl:h)(e,n)},xl=function(n,e){var t,r;return{key:n,value:{config:{},me:(t=n,r=Tr(e),$r({fields:[ur("enabled")],name:t,active:{events:i(r)}})),configAsRaw:i({}),initialConfig:{},state:Pr}}},wl=Object.freeze({getCurrent:function(n,e,t){return e.find(n)}}),Sl=[ur("find")],Ol=$r({fields:Sl,name:"composing",apis:wl}),Tl=za({name:"Container",factory:function(n){var r=n.dom,o=r.attributes,i=t(r,["attributes"]);return{uid:n.uid,dom:e({tag:"div",attributes:e({role:"presentation"},o)},i),components:n.components,behaviours:Uc(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[mr("components",[]),Gc("containerBehaviours",[]),mr("events",{}),mr("domModification",{}),mr("eventOrder",{})]}),kl=za({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:Xc(n.dataBehaviours,[ws.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),Ol.config({find:k.some})]),events:Tr([Fr((function(e,t){ws.setValue(e,n.getInitialValue())}))])}},configFields:[ur("uid"),ur("dom"),ur("getInitialValue"),Wc("dataBehaviours",[ws,Ol])]}),El=function(n){return n.dom().value},Cl=function(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom().value=e},Ml=i([sr("data"),mr("inputAttributes",{}),mr("inputStyles",{}),mr("tag","input"),mr("inputClasses",[]),Ro("onSetValue"),mr("styles",{}),mr("eventOrder",{}),Gc("inputBehaviours",[ws,si]),mr("selectOnFocus",!0)]),Il=function(n){return e({},(t=n,Gr([si.config({onFocus:!1===t.selectOnFocus?r:function(n){var e=n.element(),t=El(e);e.dom().setSelectionRange(0,t.length)}})])),$c(n.inputBehaviours,[ws.config({store:{mode:"manual",initialValue:n.data.getOr(void 0),getValue:function(n){return El(n.element())},setValue:function(n,e){El(n.element())!==e&&Cl(n.element(),e)}},onSetValue:n.onSetValue})]));var t},Dl=za({name:"Input",configFields:Ml(),factory:function(n,t){return{uid:n.uid,dom:(r=n,{tag:r.tag,attributes:e({type:"text"},r.inputAttributes),styles:r.inputStyles,classes:r.inputClasses}),components:[],behaviours:Il(n),eventOrder:n.eventOrder};var r}}),Fl=Object.freeze({exhibit:function(n,e){return jr({attributes:kt([{key:e.tabAttr,value:"true"}])})}}),Al=[mr("tabAttr","data-alloy-tabstop")],Rl=$r({fields:Al,name:"tabstopping",active:Fl}),Bl=tinymce.util.Tools.resolve("tinymce.util.I18n"),Vl=function(n,e){var t=sl(Dl.sketch({inputAttributes:{placeholder:Bl.translate(e)},onSetValue:function(n,e){le(n,L())},inputBehaviours:Gr([Ol.config({find:k.some}),Rl.config({}),Lc.config({mode:"execution"})]),selectOnFocus:!1})),r=sl(La.sketch({dom:Ua('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);ws.setValue(e,"")}}));return{name:n,spec:Tl.sketch({dom:Ua('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),r.asSpec()],containerBehaviours:Gr([Zo.config({toggleClass:oi.resolve("input-container-empty")}),Ol.config({find:function(n){return k.some(t.get(n))}}),xl("input-clearing",[Er(L(),(function(n){var e=t.get(n);(0<ws.getValue(e).length?Zo.off:Zo.on)(n)}))])])})}},Nl=["input","button","textarea","select"],jl=function(n,e,t){e.disabled&&Gl(n,e)},_l=function(n,e){return!0===e.useNative&&kn(Nl,Se(n.element()))},Hl=function(n){Yr(n.element(),"disabled","disabled")},zl=function(n){Zr(n.element(),"disabled")},Pl=function(n){Yr(n.element(),"aria-disabled","true")},Ll=function(n){Yr(n.element(),"aria-disabled","false")},Gl=function(n,e,t){e.disableClass.each((function(e){to(n.element(),e)})),(_l(n,e)?Hl:Pl)(n),e.onDisabled(n)},Ul=function(n,e,t){e.disableClass.each((function(e){ro(n.element(),e)})),(_l(n,e)?zl:Ll)(n),e.onEnabled(n)},$l=function(n,e){return _l(n,e)?Qr(n.element(),"disabled"):"true"===Jr(n.element(),"aria-disabled")},Wl=Object.freeze({enable:Ul,disable:Gl,isDisabled:$l,onLoad:jl,set:function(n,e,t,r){(r?Gl:Ul)(n,e,t)}}),Xl=Object.freeze({exhibit:function(n,e,t){return jr({classes:e.disabled?e.disableClass.map(zn).getOr([]):[]})},events:function(n,e){return Tr([kr(ne(),(function(e,t){return $l(e,n)})),_r(n,e,jl)])}}),ql=[mr("disabled",!1),mr("useNative",!0),sr("disableClass"),Ro("onDisabled"),Ro("onEnabled")],Yl=$r({fields:ql,name:"disabling",active:Xl,apis:Wl}),Kl=[Gc("formBehaviours",[ws])],Jl=function(n){return"<alloy.field."+n+">"},Ql=function(n,e,t){return{uid:n.uid,dom:n.dom,components:e,behaviours:$c(n.formBehaviours,[ws.config({store:{mode:"manual",getValue:function(e){var t,r,o=(t=n,r=e.getSystem(),I(t.partUids,(function(n,e){return i(r.getByUid(n))})));return I(o,(function(n,e){return n().bind((function(n){return Ol.getCurrent(n).fold((function(){return it.error("missing current")}),it.value)})).map(ws.getValue)}))},setValue:function(e,t){M(t,(function(t,r){Sa(e,n,r).each((function(n){Ol.getCurrent(n).each((function(n){ws.setValue(n,t)}))}))}))}}})]),apis:{getField:function(e,t){return Sa(e,n,t).bind(Ol.getCurrent)}}}},Zl=(Ca((function(n,e,t){return n.getField(e,t)})),function(n){var e,t=(e=[],{field:function(n,t){return e.push(n),r=Jl(n),o=t,{uiType:Zc(),owner:"form",name:r,config:o,validated:{}};var r,o},record:function(){return e}}),r=n(t),o=t.record(),i=Cn(o,(function(n){return pa({name:n,pname:Jl(n)})}));return Na("form",Kl,i,Ql,r)}),nd=function(){var n=so(k.none()),e=function(){n.get().each((function(n){n.destroy()}))};return{clear:function(){e(),n.set(k.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(k.some(t))},run:function(e){n.get().each(e)}}},ed=function(){var n=so(k.none());return{clear:function(){n.set(k.none())},set:function(e){n.set(k.some(e))},isSet:function(){return n.get().isSome()},on:function(e){n.get().each(e)}}},td=function(n){var e="navigateEvent",t=Wt([ur("fields"),mr("maxFieldIndex",n.fields.length-1),ur("onExecute"),ur("getInitialValue"),pr("state",(function(){return{dialogSwipeState:ed(),currentScreen:so(0)}}))]),r=er("SerialisedDialog",t,n),o=function(n,t,r){return La.sketch({dom:Ua('<span class="${prefix}-icon-'+t+' ${prefix}-icon"></span>'),action:function(t){de(t,e,{direction:n})},buttonBehaviours:Gr([Yl.config({disableClass:oi.resolve("toolbar-navigation-disabled"),disabled:!r})])})},i=function(n,e){var t=Ti(n.element(),"."+oi.resolve("serialised-dialog-screen"));Ci(n.element(),"."+oi.resolve("serialised-dialog-chain")).each((function(n){0<=r.state.currentScreen.get()+e&&r.state.currentScreen.get()+e<t.length&&(vi(n,"left").each((function(r){var o=parseInt(r,10),i=Ts(t[0]);di(n,"left",o-e*i+"px")})),r.state.currentScreen.set(r.state.currentScreen.get()+e))}))},u=function(n){var e=Ti(n.element(),"input");k.from(e[r.state.currentScreen.get()]).each((function(e){n.getSystem().getByDom(e).each((function(e){var t,r;t=n,r=e.element(),t.getSystem().triggerFocus(r,t.element())}))}));var t=a.get(n);Ki.highlightAt(t,r.state.currentScreen.get())},c=sl(Zl((function(n){return{dom:Ua('<div class="${prefix}-serialised-dialog"></div>'),components:[Tl.sketch({dom:Ua('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:Cn(r.fields,(function(e,t){return t<=r.maxFieldIndex?Tl.sketch({dom:Ua('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[o(-1,"previous",0<t),n.field(e.name,e.spec),o(1,"next",t<r.maxFieldIndex)]}):n.field(e.name,e.spec)}))})],formBehaviours:Gr([ei((function(n,e){var t;t=e,Ci(n.element(),"."+oi.resolve("serialised-dialog-chain")).each((function(n){di(n,"left",-r.state.currentScreen.get()*t.width+"px")}))})),Lc.config({mode:"special",focusIn:function(n){u(n)},onTab:function(n){return i(n,1),k.some(!0)},onShiftTab:function(n){return i(n,-1),k.some(!0)}}),xl("form-events",[Fr((function(n,e){r.state.currentScreen.set(0),r.state.dialogSwipeState.clear();var t=a.get(n);Ki.highlightFirst(t),r.getInitialValue(n).each((function(e){ws.setValue(n,e)}))})),Br(r.onExecute),Er($(),(function(n,e){"left"===e.event().raw().propertyName&&u(n)})),Er(e,(function(n,e){var t=e.event().direction();i(n,t)}))])])}}))),a=sl({dom:Ua('<div class="${prefix}-dot-container"></div>'),behaviours:Gr([Ki.config({highlightClass:oi.resolve("dot-active"),itemClass:oi.resolve("dot-item")})]),components:jn(r.fields,(function(n,e){return e<=r.maxFieldIndex?[$a('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]}))});return{dom:Ua('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:Gr([Lc.config({mode:"special",focusIn:function(n){var e=c.get(n);Lc.focusIn(e)}}),xl("serializer-wrapper-events",[Er(R(),(function(n,e){var t=e.event();r.state.dialogSwipeState.set(function(n){return{xValue:n,points:[]}}(t.raw().touches[0].clientX))})),Er(B(),(function(n,e){var t=e.event();r.state.dialogSwipeState.on((function(n){e.event().prevent(),r.state.dialogSwipeState.set(function(n,e){if(e===n.xValue)return n;var t=0<e-n.xValue?1:-1,r={direction:t,xValue:e};return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([r])}}(n,t.raw().touches[0].clientX))}))})),Er(V(),(function(n){r.state.dialogSwipeState.on((function(e){var t=c.get(n),r=-1*function(n){if(0===n.points.length)return 0;var e=n.points[0].direction,t=n.points[n.points.length-1].direction;return-1===e&&-1===t?-1:1===e&&1===t?1:0}(e);i(t,r)}))}))])])}},rd=X((function(n,e){return[{label:"the link group",items:[td({fields:[Vl("url","Type or paste URL"),Vl("text","Link text"),Vl("title","Link title"),Vl("target","Link target"),{name:"link",spec:kl.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return k.none()}})}],maxFieldIndex:3,getInitialValue:function(){return k.some(function(n){return pl(n).fold((function(){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:k.none()}}),(function(n){return t=dl(e=n),r=Jr(e,"href"),o=Jr(e,"title"),i=Jr(e,"target"),{url:gl(r),text:t!==r?gl(t):"",title:gl(o),target:gl(i),link:k.some(e)};var e,t,r,o,i}))}(e))},onExecute:function(t){var r=ws.getValue(t);(function(n,e){e.url.toOption().filter(ml).fold((function(){var t;t=n,e.link.bind(u).each((function(n){t.execCommand("unlink")}))}),(function(t){var r,o,i=(r=e,(o={}).href=t,r.title.toOption().filter(ml).each((function(n){o.title=n})),r.target.toOption().filter(ml).each((function(n){o.target=n})),o);e.link.bind(u).fold((function(){var r=e.text.toOption().filter(ml).getOr(t);n.insertContent(n.dom.createHTML("a",i,n.dom.encode(r)))}),(function(n){var r=function(n,e,t){return t.text.toOption().filter(ml).fold((function(){return Jr(t=n,"href")===dl(t)?k.some(e):k.none();var t}),k.some)}(n,t,e);Kr(n,i),r.each((function(e){var t;t=e,n.dom().textContent=t}))}))}))})(e,r),n.restoreToolbar(),e.focus()}})]}]})),od=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],id=Tr([(su=Kn(),fu=function(e,t){var r,o,i=t.event().originator(),u=t.event().target();return o=u,!(He(r=i,e.element())&&!He(r,o)&&(n.console.warn(Kn()+" did not get interpreted by the desired target. \nOriginator: "+bo(i)+"\nTarget: "+bo(u)+"\nCheck the "+Kn()+" event handlers"),1))},{key:su,value:hr({can:fu})})]),ud=Object.freeze({events:id}),cd=u,ad=function(n){var e=function(e){return function(){throw new Error("The component must be in a context to send: "+e+"\n"+bo(n().element())+" is not in context.")}};return{debugInfo:i("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:i(!1)}},sd=ad(),fd=function(n,e){var t={};return M(n,(function(n,r){M(n,(function(n,o){var i=St(o,[])(t);t[o]=i.concat([e(r,n)])}))})),t},ld=function(n){return n.cHandler},dd=function(n,e){return{name:i(n),handler:i(e)}},md=function(n,e){var t=F(n,(function(n,t){return(1===n.length?it.value(n[0].handler()):function(n,e,t){var r,o,i=e[t];return i?function(n,e,t,r){var o=t.slice(0);try{var i=o.sort((function(t,o){var i=t[e](),u=o[e](),c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0}));return it.value(i)}catch(n){return it.error([n])}}("Event: "+t,"name",n,i).map((function(n){var e=Cn(n,(function(n){return n.handler()}));return function(n){var e,t,r,o,i=(e=n,t=function(n){return n.can},function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Fn(e,(function(e,r){return e&&t(r).apply(void 0,n)}),!0)}),u=(r=n,o=function(n){return n.abort},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return Fn(r,(function(e,t){return e||o(t).apply(void 0,n)}),!1)});return hr({can:i,abort:u,run:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Mn(n,(function(n){n.run.apply(void 0,e)}))}})}(e)})):(r=t,o=n,it.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(Cn(o,(function(n){return n.name()})),null,2)]))}(n,e,t)).map((function(r){var o=function(n){var e,t=wn(e=n)?{can:i(!0),abort:i(!1),run:e}:e;return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,e].concat(r);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}}(r),u=1<n.length?In(e,(function(e){return kn(n,(function(n){return n.name()===e}))})).join(" > "):n[0].name();return Tt(t,{handler:o,purpose:i(u)})}))}));return function(n){var e,t,r,i,u,c=(e=[],t=[],Mn(n,(function(n){n.fold((function(n){e.push(n)}),(function(n){t.push(n)}))})),{errors:e,values:t});return 0<c.errors.length?(u=c.errors,o(it.error,Nn)(u)):(i={},0===(r=c.values).length?it.value(i):it.value(st(i,ft.apply(void 0,r))))}(t)},gd=function(n,e){Mn(e,(function(e){to(n,e)}))},pd=function(n,e){Mn(e,(function(e){ro(n,e)}))},vd=function(t){var r=function(){return m},o=so(sd),u=nr(function(n){return Zt("custom.definition",Wt([Yt("dom","dom",mt(),Wt([ur("tag"),mr("styles",{}),mr("classes",[]),mr("attributes",{}),sr("value"),sr("innerHtml")])),ur("components"),ur("uid"),mr("events",{}),mr("apis",{}),Yt("eventOrder","eventOrder",(e={"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]},lt.mergeWithThunk(i(e))),or()),sr("domModification")]),n);var e}(t)),c=function(n){var e,t,r,o=(e=n,t=St("behaviours",{})(e),r=In(E(t),(function(n){return void 0!==t[n]})),Cn(r,(function(n){return t[n].me})));return function(n,e){return t=n,o=Cn(r=e,(function(n){return lr(n.name(),[ur("config"),mr("state",Pr)])})),i=Zt("component.behaviours",Wt(o),t.behaviours).fold((function(n){throw new Error(tr(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),(function(n){return n})),{list:r,data:I(i,(function(n){var e=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return e}}))};var t,r,o,i}(n,o)}(t),a=c.list,s=c.data,f=function(e){var t=he(e.tag);Kr(t,e.attributes),gd(t,e.classes),mi(t,e.styles),e.innerHtml.each((function(e){return function(e,t){var r,o,i=ze(e).dom(),u=ye(i.createDocumentFragment()),c=(r=t,(o=(i||n.document).createElement("div")).innerHTML=r,Le(ye(o)));qe(u,c),Ye(e),Xe(e,u)}(t,e)}));var r=e.domChildren;return qe(t,r),e.value.each((function(n){Cl(t,n)})),e.uid,Aa(t,e.uid),t}(function(n,t,r){var o,i,u,c=e({},(o=n).dom,{uid:o.uid,domChildren:Cn(o.components,(function(n){return n.element()}))}),a=n.domModification.fold((function(){return jr({})}),jr),s={"alloy.base.modification":a},f=0<t.length?function(n,t,r,o){var i=e({},t);Mn(r,(function(e){i[e.name()]=e.exhibit(n,o)}));var u=fd(i,(function(n,e){return{name:n,modification:e}})),c=function(n){return Dn(n,(function(n,t){return e({},t.modification,n)}),{})},a=Dn(u.classes,(function(n,e){return e.modification.concat(n)}),[]),s=c(u.attributes),f=c(u.styles);return jr({classes:a,attributes:s,styles:f})}(r,s,t,c):a;return u=f,e({},i=c,{attributes:e({},i.attributes,u.attributes),styles:e({},i.styles,u.styles),classes:i.classes.concat(u.classes)})}(u,a,s)),l=function(n,t,r){var o,i,u,c,a,s,f={"alloy.base.behaviour":(o=n,o.events)};return(i=r,u=n.eventOrder,c=t,a=f,s=function(n,t,r){var o,i,u=e({},r,(o=n,i={},Mn(t,(function(n){i[n.name()]=n.handlers(o)})),i));return fd(u,dd)}(i,c,a),md(s,u)).getOrDie()}(u,a,s),d=so(u.components),m={getSystem:o.get,config:function(n){var e=s;return(wn(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(n){return wn(s[n.name()])},spec:i(t),readState:function(n){return s[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return u.apis},connect:function(n){o.set(n)},disconnect:function(){o.set(ad(r))},element:i(f),syncComponents:function(){var n=Le(f),e=jn(n,(function(n){return o.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));d.set(e)},components:d.get,events:i(l)};return m},hd=function(e){var t=function(e,t){var r=(t||n.document).createTextNode(e);return ve(r)}(e);return yd({element:t})},yd=function(n){var e=er("external.component",$t([ur("element"),sr("uid")]),n),t=so(ad());e.uid.each((function(n){Aa(e.element,n)}));var o={getSystem:t.get,config:k.none,hasConfigured:i(!1),connect:function(n){t.set(n)},disconnect:function(){t.set(ad((function(){return o})))},getApis:function(){return{}},element:i(e.element),spec:i(n),readState:i("No state"),syncComponents:r,components:i([]),events:i({})};return Ea(o)},bd=Ba,xd=function(n){return(r=n,Ot(r,ka)).fold((function(){return function(n){var r,o,i=cd(n),u=i.events,c=t(i,["events"]),a=(r=c,o=St("components",[])(r),Cn(o,xd)),s=e({},c,{events:e({},ud,u),components:a});return it.value(vd(s))}(n.hasOwnProperty("uid")?n:e({uid:bd("")},n)).getOrDie()}),(function(n){return n}));var r},wd=Ea,Sd="alloy.item-hover",Od="alloy.item-focus",Td=function(n){(go(n.element()).isNone()||si.isFocused(n))&&(si.isFocused(n)||si.focus(n),de(n,Sd,{item:n}))},kd=function(n){de(n,Od,{item:n})},Ed=i(Sd),Cd=i(Od),Md=[ur("data"),ur("components"),ur("dom"),mr("hasSubmenu",!1),sr("toggling"),Wc("itemBehaviours",[Zo,si,Lc,ws]),mr("ignoreFocus",!1),mr("domModification",{}),jo("builder",(function(n){return{dom:n.dom,domModification:e({},n.domModification,{attributes:e({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes,{"aria-haspopup":n.hasSubmenu},n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Xc(n.itemBehaviours,[n.toggling.fold(Zo.revoke,(function(n){return Zo.config(e({aria:{mode:"checked"}},n))})),si.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){kd(n)}}),Lc.config({mode:"execution"}),ws.config({store:{mode:"memory",initialValue:n.data}}),xl("item-type-events",[Er(re(),me),Dr(N()),Er(H(),Td),Er(ee(),si.focus)])]),components:n.components,eventOrder:n.eventOrder}})),mr("eventOrder",{})],Id=[ur("dom"),ur("components"),jo("builder",(function(n){return{dom:n.dom,components:n.components,events:Tr([(e=ee(),Er(e,(function(n,e){e.stop()})))])};var e}))],Dd=i([pa({name:"widget",overrides:function(n){return{behaviours:Gr([ws.config({store:{mode:"manual",getValue:function(e){return n.data},setValue:function(){}}})])}}})]),Fd=[ur("uid"),ur("data"),ur("components"),ur("dom"),mr("autofocus",!1),mr("ignoreFocus",!1),Wc("widgetBehaviours",[ws,si,Lc]),mr("domModification",{}),Ta(Dd()),jo("builder",(function(n){var e=xa(0,n,Dd()),t=wa("item-widget",n,e.internals()),r=function(e){return Sa(e,n,"widget").map((function(n){return Lc.focusIn(n),n}))},o=function(e,t){return vu(t.event().target())||n.autofocus&&t.setSource(e.element()),k.none()};return{dom:n.dom,components:t,domModification:n.domModification,events:Tr([Br((function(n,e){r(n).each((function(n){e.stop()}))})),Er(H(),Td),Er(ee(),(function(e,t){n.autofocus?r(e):si.focus(e)}))]),behaviours:Xc(n.widgetBehaviours,[ws.config({store:{mode:"memory",initialValue:n.data}}),si.config({ignore:n.ignoreFocus,onFocus:function(n){kd(n)}}),Lc.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:Xr(),onLeft:o,onRight:o,onEscape:function(e,t){return si.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element()),k.none()):(si.focus(e),k.some(!0))}})])}}))],Ad=rr("type",{widget:Fd,item:Md,separator:Id}),Rd=i([ha({factory:{sketch:function(n){var e=er("menu.spec item",Ad,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:e({},t,{uid:Ba("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Bd=i([ur("value"),ur("items"),ur("dom"),ur("components"),mr("eventOrder",{}),Gc("menuBehaviours",[Ki,ws,Ol,Lc]),gr("movement",{mode:"menu",moveOnTab:!0},rr("mode",{grid:[Ho(),jo("config",(function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}}))],matrix:[jo("config",(function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),ur("rowSelector")],menu:[mr("moveOnTab",!0),jo("config",(function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}}))]})),cr("markers",Do()),mr("fakeFocus",!1),mr("focusManager",Qi()),Ro("onHighlight")]),Vd=i("alloy.menu-focus"),Nd=Pa({name:"Menu",configFields:Bd(),partFields:Rd(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:$c(n.menuBehaviours,[Ki.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),ws.config({store:{mode:"memory",initialValue:n.value}}),Ol.config({find:k.some}),Lc.config(n.movement.config(n,n.movement))]),events:Tr([Er(Cd(),(function(n,e){var t=e.event();n.getSystem().getByDom(t.target()).each((function(t){Ki.highlight(n,t),e.stop(),de(n,Vd(),{menu:n,item:t})}))})),Er(Ed(),(function(n,e){var t=e.event().item();Ki.highlight(n,t)}))]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),jd=function(n,e,t,r){var o=n.getSystem().build(r);nt(n,o,t)},_d=function(n,e,t,r){var o=Hd(n);An(o,(function(n){return He(r.element(),n.element())})).each(tt)},Hd=function(n,e){return n.components()},zd=function(n,e,t,r,o){var i=Hd(n);return k.from(i[r]).map((function(e){return _d(n,0,0,e),o.each((function(e){jd(n,0,(function(n,e){var t,o;o=e,Ge(t=n,r).fold((function(){Xe(t,o)}),(function(n){Ue(n,o)}))}),e)})),e}))},Pd=$r({fields:[],name:"replacing",apis:Object.freeze({append:function(n,e,t,r){jd(n,0,Xe,r)},prepend:function(n,e,t,r){jd(n,0,We,r)},remove:_d,replaceAt:zd,replaceBy:function(n,e,t,r,o){var i=Hd(n);return Rn(i,r).bind((function(e){return zd(n,0,0,e,o)}))},set:function(n,e,t,o){var i,u,c,a,s,f;u=(i=n).components(),Mn(u,et),Ye(i.element()),i.syncComponents(),c=function(){var e=Cn(o,n.getSystem().build);Mn(e,(function(e){Ze(n,e)}))},a=n.element(),s=ze(a),f=mo(s).bind((function(n){var e=function(e){return He(n,e)};return e(a)?k.some(a):function(n,e){var t=function(n){for(var r=0;r<n.childNodes.length;r++){if(e(ye(n.childNodes[r])))return k.some(ye(n.childNodes[r]));var o=t(n.childNodes[r]);if(o.isSome())return o}return k.none()};return t(n.dom())}(a,e)})),c(),f.each((function(n){mo(s).filter((function(e){return He(e,n)})).fold((function(){fo(n)}),r)}))},contents:Hd})}),Ld=function(n,e,t,r){return Ot(t,r).bind((function(r){return Ot(n,r).bind((function(r){var o=Ld(n,e,t,r);return k.some([r].concat(o))}))})).getOr([])},Gd=i("collapse-item"),Ud=za({name:"TieredMenu",configFields:[No("onExecute"),No("onEscape"),Vo("onOpenMenu"),Vo("onOpenSubmenu"),Ro("onCollapseMenu"),mr("highlightImmediately",!0),ar("data",[ur("primary"),ur("menus"),ur("expansions")]),mr("fakeFocus",!1),Ro("onHighlight"),Ro("onHover"),ar("markers",[ur("backgroundMenu")].concat(Mo()).concat(Io())),ur("dom"),mr("navigateOnHover",!0),mr("stayInDom",!1),Gc("tmenuBehaviours",[Lc,Ki,Ol,Pd]),mr("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)}},factory:function(n,t){var o,i,u=so(k.none()),c=function(){var n=so({}),t=so({}),r=so({}),o=so(k.none()),i=so({}),u=function(n){return Ot(t.get(),n)};return{setMenuBuilt:function(n,r){var o;t.set(e({},t.get(),((o={})[n]={type:"prepared",menu:r},o)))},setContents:function(e,u,c,a){o.set(k.some(e)),n.set(c),t.set(u),i.set(a);var s=function(n,e){var t={};M(n,(function(n,e){Mn(n,(function(n){t[n]=e}))}));var r=e,o=D(e,(function(n,e){return{k:n,v:e}})),i=I(o,(function(n,e){return[e].concat(Ld(t,r,o,e))}));return I(t,(function(n){return Ot(i,n).getOr([n])}))}(a,c);r.set(s)},expand:function(e){return Ot(n.get(),e).map((function(n){var t=Ot(r.get(),e).getOr([]);return[n].concat(t)}))},refresh:function(n){return Ot(r.get(),n)},collapse:function(n){return Ot(r.get(),n).bind((function(n){return 1<n.length?k.some(n.slice(1)):k.none()}))},lookupMenu:u,otherMenus:function(n){var e,t,r=i.get();return e=E(r),t=n,In(e,(function(n){return!kn(t,n)}))},getPrimary:function(){return o.get().bind((function(n){return u(n).bind((function(n){return"prepared"===n.type?k.some(n.menu):k.none()}))}))},getMenus:function(){return t.get()},clear:function(){n.set({}),t.set({}),r.set({}),o.set(k.none())},isClear:function(){return o.get().isNone()}}}(),a=function(n){return ws.getValue(n).value},s=function(n,e){Ki.highlight(n,e),Ki.getHighlighted(e).orThunk((function(){return Ki.getFirst(e)})).each((function(e){ge(n,e.element(),ee())}))},f=function(n,e){return wo(Cn(e,(function(e){return n.lookupMenu(e).bind((function(n){return"prepared"===n.type?k.some(n.menu):k.none()}))})))},l=function(e,t,r){var o=f(t,t.otherMenus(r));Mn(o,(function(t){pd(t.element(),[n.markers.backgroundMenu]),n.stayInDom||Pd.remove(e,t)}))},d=function(e,t){var r,o=(r=e,u.get().getOrThunk((function(){var e={},t=Ti(r.element(),"."+n.markers.item),o=In(t,(function(n){return"true"===Jr(n,"aria-haspopup")}));return Mn(o,(function(n){r.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),u.set(k.some(e)),e})));M(o,(function(n,e){var r=kn(t,e);Yr(n.element(),"aria-expanded",r)}))},m=function(e,t,r){return k.from(r[0]).bind((function(o){return t.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return k.none();var i=o.menu,u=f(t,r.slice(1));return Mn(u,(function(e){to(e.element(),n.markers.backgroundMenu)})),Ee(i.element())||Pd.append(e,wd(i)),pd(i.element(),[n.markers.backgroundMenu]),s(e,i),l(e,t,r),k.some(i)}))}))};(i=o||(o={}))[i.HighlightSubmenu=0]="HighlightSubmenu",i[i.HighlightParent=1]="HighlightParent";var g=function(e,t,r){void 0===r&&(r=o.HighlightSubmenu);var i=a(t);return c.expand(i).bind((function(i){return d(e,i),k.from(i[0]).bind((function(u){return c.lookupMenu(u).bind((function(a){var s=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var r=n.getSystem().build(t.nbMenu());return c.setMenuBuilt(e,r),r}(e,u,a);return Ee(s.element())||Pd.append(e,wd(s)),n.onOpenSubmenu(e,t,s),r===o.HighlightSubmenu?(Ki.highlightFirst(s),m(e,c,i)):(Ki.dehighlightAll(s),k.some(t))}))}))}))},p=function(e,t){var r=a(t);return c.collapse(r).bind((function(r){return d(e,r),m(e,c,r).map((function(r){return n.onCollapseMenu(e,t,r),r}))}))},v=function(e){return function(t,r){return Mi(r.getSource(),"."+n.markers.item).bind((function(n){return t.getSystem().getByDom(n).toOption().bind((function(n){return e(t,n).map((function(){return!0}))}))}))}},h=Tr([Er(Vd(),(function(n,e){var t=e.event().menu();Ki.highlight(n,t);var r=a(e.event().item());c.refresh(r).each((function(e){return l(n,c,e)}))})),Br((function(e,t){var r=t.event().target();e.getSystem().getByDom(r).each((function(t){0===a(t).indexOf("collapse-item")&&p(e,t),g(e,t,o.HighlightSubmenu).fold((function(){n.onExecute(e,t)}),(function(){}))}))})),Fr((function(t,o){var i,u,a;(i=t,u=function(t,o,i){return I(i,(function(i,u){var c=function(){return Nd.sketch(e({dom:i.dom},i,{value:u,items:i.items,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?(t=function(n){return Ki.getHighlighted(n).map((function(n){return n.element()}))},{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(r,(function(e){Ki.highlight(n,e)}));var i=t(n);Ji(n,o,i)}}):Qi()}));var t};return u===o?{type:"prepared",menu:t.getSystem().build(c())}:{type:"notbuilt",nbMenu:c}}))}(i,n.data.primary,n.data.menus),a=I(n.data.menus,(function(n,e){return jn(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))})),c.setContents(n.data.primary,u,n.data.expansions,a),c.getPrimary()).each((function(e){Pd.append(t,wd(e)),n.onOpenMenu(t,e),n.highlightImmediately&&s(t,e)}))}))].concat(n.navigateOnHover?[Er(Ed(),(function(e,t){var r,i,u=t.event().item();r=e,i=a(u),c.refresh(i).bind((function(n){return d(r,n),m(r,c,n)})),g(e,u,o.HighlightParent),n.onHover(e,u)}))]:[])),y={collapseMenu:function(n){Ki.getHighlighted(n).each((function(e){Ki.getHighlighted(e).each((function(e){p(n,e)}))}))},highlightPrimary:function(n){c.getPrimary().each((function(e){s(n,e)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:$c(n.tmenuBehaviours,[Lc.config({mode:"special",onRight:v((function(n,e){return vu(e.element())?k.none():g(n,e,o.HighlightSubmenu)})),onLeft:v((function(n,e){return vu(e.element())?k.none():p(n,e)})),onEscape:v((function(e,t){return p(e,t).orThunk((function(){return n.onEscape(e,t).map((function(){return e}))}))})),focusIn:function(n,e){c.getPrimary().each((function(e){ge(n,e.element(),ee())}))}}),Ki.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Ol.config({find:function(n){return Ki.getHighlighted(n)}}),Pd.config({})]),eventOrder:n.eventOrder,apis:y,events:h}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:Tt(n,e),expansions:{}}},collapseItem:function(n){return{value:ea(Gd()),meta:{text:n}}}}}),$d=function(n,e,t,r){return Ot(e.routes,r.start).bind((function(n){return Ot(n,r.destination)}))},Wd=function(n,e,t,r){return $d(0,e,0,r).bind((function(n){return n.transition.map((function(e){return{transition:e,route:n}}))}))},Xd=function(n,e,t){var r,o;(r=n,o=e,qd(r,o).bind((function(n){return Wd(0,o,0,n)}))).each((function(t){var r=t.transition;ro(n.element(),r.transitionClass),Zr(n.element(),e.destinationAttr)}))},qd=function(n,e,t){var r=n.element();return Qr(r,e.destinationAttr)?k.some({start:Jr(n.element(),e.stateAttr),destination:Jr(n.element(),e.destinationAttr)}):k.none()},Yd=function(n,e,t,r){Xd(n,e),Qr(n.element(),e.stateAttr)&&Jr(n.element(),e.stateAttr)!==r&&e.onFinish(n,r),Yr(n.element(),e.stateAttr,r)},Kd=Object.freeze({findRoute:$d,disableTransition:Xd,getCurrentRoute:qd,jumpTo:Yd,progressTo:function(n,e,t,r){var o,i;i=e,Qr((o=n).element(),i.destinationAttr)&&(Yr(o.element(),i.stateAttr,Jr(o.element(),i.destinationAttr)),Zr(o.element(),i.destinationAttr));var u,c,a=(u=e,c=r,{start:Jr(n.element(),u.stateAttr),destination:c});Wd(0,e,0,a).fold((function(){Yd(n,e,0,r)}),(function(t){Xd(n,e);var o=t.transition;to(n.element(),o.transitionClass),Yr(n.element(),e.destinationAttr,r)}))},getState:function(n,e,t){var r=n.element();return Qr(r,e.stateAttr)?k.some(Jr(r,e.stateAttr)):k.none()}}),Jd=Object.freeze({events:function(n,e){return Tr([Er($(),(function(e,t){var r=t.event().raw();qd(e,n).each((function(t){$d(0,n,0,t).each((function(o){o.transition.each((function(o){r.propertyName===o.property&&(Yd(e,n,0,t.destination),n.onTransition(e,t))}))}))}))})),Fr((function(e,t){Yd(e,n,0,n.initialState)}))])}}),Qd=[mr("destinationAttr","data-transitioning-destination"),mr("stateAttr","data-transitioning-state"),ur("initialState"),Ro("onTransition"),Ro("onFinish"),cr("routes",Qt(it.value,Qt(it.value,$t([dr("transition",[ur("property"),ur("transitionClass")])]))))],Zd=$r({fields:Qd,name:"transitioning",active:Jd,apis:Kd,extra:{createRoutes:function(n){var e={};return M(n,(function(n,t){var r=t.split("<->");e[r[0]]=Tt(r[1],n),e[r[1]]=Tt(r[0],n)})),e},createBistate:function(n,e,t){return kt([{key:n,value:Tt(e,t)},{key:e,value:Tt(n,t)}])},createTristate:function(n,e,t,r){return kt([{key:n,value:kt([{key:e,value:r},{key:t,value:r}])},{key:e,value:kt([{key:n,value:r},{key:t,value:r}])},{key:t,value:kt([{key:n,value:r},{key:e,value:r}])}])}}}),nm=oi.resolve("scrollable"),em={register:function(n){to(n,nm)},deregister:function(n){ro(n,nm)},scrollable:i(nm)},tm=function(n){return Ot(n,"format").getOr(n.title)},rm=function(n,e,t,r,o){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:o?[oi.resolve("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:oi.resolve("format-matches"),selected:t},itemBehaviours:Gr(o?[]:[ni(n,(function(n,e){(e?Zo.on:Zo.off)(n)}))]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:e}}]}},om=function(n,e,t,r){return{value:n,dom:{tag:"div"},components:[La.sketch({dom:{tag:"div",classes:[oi.resolve("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[oi.resolve("styles-collapse-icon")]}},hd(n)]:[hd(n)],action:function(n){if(r){var e=t().get(n);Ud.collapseMenu(e)}}}),{dom:{tag:"div",classes:[oi.resolve("styles-menu-items-container")]},components:[Nd.parts().items({})],behaviours:Gr([xl("adhoc-scrollable-menu",[Fr((function(n,e){di(n.element(),"overflow-y","auto"),di(n.element(),"-webkit-overflow-scrolling","touch"),em.register(n.element())})),Ar((function(n){hi(n.element(),"overflow-y"),hi(n.element(),"-webkit-overflow-scrolling"),em.deregister(n.element())}))])])}],items:e,menuBehaviours:Gr([Zd.config({initialState:"after",routes:Zd.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},im=function(n){return Dn(n,(function(n,e){var t=function(n){return Et(n,"items")?(t=st(xt(e=n,["items"]),{menu:!0}),r=im(e.items),{item:t,menus:st(r.menus,Tt(e.title,r.items)),expansions:st(r.expansions,Tt(e.title,e.title))}):{item:n,menus:{},expansions:{}};var e,t,r}(e);return{menus:st(n.menus,t.menus),items:[t.item].concat(n.items),expansions:st(n.expansions,t.expansions)}}),{menus:{},expansions:{},items:[]})},um={expand:im},cm=["undo","bold","italic","link","image","bullist","styleselect"],am=function(n){var e=n.replace(/\|/g," ").trim();return 0<e.length?e.split(/\s+/):[]},sm=function(n){return jn(n,(function(n){return bn(n)?sm(n):am(n)}))},fm=function(n,e){var t=function(n){return function(){return function(n,e){return qa(e,(function(){n.execCommand(e)}),{},n)}(e,n)}},r=function(n){return function(){return function(n,e){var t=Wa(e);return qa(e,(function(){n.execCommand(e)}),t,n)}(e,n)}},o=function(n,t,r){return function(){return Ka(e,n,t,r)}},u=t("undo"),c=t("redo"),a=r("bold"),s=r("italic"),f=r("underline"),l=t("removeformat"),d=o("unlink","link",(function(){e.execCommand("unlink",null,!1)})),m=o("unordered-list","ul",(function(){e.execCommand("InsertUnorderedList",null,!1)})),g=o("ordered-list","ol",(function(){e.execCommand("InsertOrderedList",null,!1)})),p=function(n,e){var t=function(e){return function(){return n.formatter.match(e)}},r=function(e){return function(){return n.formatter.getCssText(e)}},o=Ot(e,"style_formats").getOr(od),u=function(e){return Cn(e,(function(e){if(Et(e,"items")){var o=u(e.items);return st(st(e,{isSelected:i(!1),getPreview:i("")}),{items:o})}return Et(e,"format")?st(f=e,{isSelected:t(f.format),getPreview:r(f.format)}):(a=ea((c=e).title),s=st(c,{format:a,isSelected:t(a),getPreview:r(a)}),n.formatter.register(a,s),s);var c,a,s,f}))};return u(o)}(e,e.settings),v=function(){return function(n,e,t){var r,o,i,u=(r=n,i=(o=function(n){return jn(n,(function(n){return void 0===n.items?!Et(n,"format")||r.formatter.canApply(n.format)?[n]:[]:0<o(n.items).length?[n]:[]}))})(e),um.expand(i));return function(n){var e,t,r,o,i,u=(t=function(){return c},r=om("Styles",[].concat(Cn((e=n.formats).items,(function(n){return rm(tm(n),n.title,n.isSelected(),n.getPreview(),Et(e.expansions,tm(n)))}))),t,!1),o=I(e.menus,(function(n,r){var o=Cn(n,(function(n){return rm(tm(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",Et(e.expansions,tm(n)))}));return om(r,o,t,!0)})),i=st(o,Tt("styles",r)),{tmenu:Ud.tieredData("styles",i,e.expansions)}),c=sl(Ud.sketch({dom:{tag:"div",classes:[oi.resolve("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(e,t){var r=ws.getValue(t);return n.handle(t,r.value),k.none()},onEscape:function(){return k.none()},onOpenMenu:function(n,e){var t=Ts(n.element());Os(e.element(),t),Zd.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var r=Ts(n.element()),o=Ei(e.element(),'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();Os(t.element(),r),Zd.progressTo(i,"before"),Zd.jumpTo(t,"after"),Zd.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var r=Ei(e.element(),'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();Zd.progressTo(o,"after"),Zd.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:u.tmenu,markers:{backgroundMenu:oi.resolve("styles-background-menu"),menu:oi.resolve("styles-menu"),selectedMenu:oi.resolve("styles-selected-menu"),item:oi.resolve("styles-item"),selectedItem:oi.resolve("styles-selected-item")}}));return c.asSpec()}({formats:u,handle:function(e,r){n.undoManager.transact((function(){Zo.isOn(e)?n.formatter.remove(r):n.formatter.apply(r)})),t()}})}(e,p,(function(){e.fire("scrollIntoView")}))},h=function(n,t){return{isSupported:function(){var t=e.ui.registry.getAll().buttons;return n.forall((function(n){return Et(t,n)}))},sketch:t}};return{undo:h(k.none(),u),redo:h(k.none(),c),bold:h(k.none(),a),italic:h(k.none(),s),underline:h(k.none(),f),removeformat:h(k.none(),l),link:h(k.none(),(function(){return t=n,Ka(r=e,"link","link",(function(){var n=rd(t,r);t.setContextToolbar(n),bl(r,(function(){t.focusToolbar()})),vl(r).each((function(n){r.selection.select(n.dom())}))}));var t,r})),unlink:h(k.none(),d),image:h(k.none(),(function(){return function(n){var e=sl({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Tr([Dr(U()),Er(G(),(function(e,t){var r,o,i;(r=t,o=r.event(),i=o.raw().target.files||o.raw().dataTransfer.files,k.from(i[0])).each((function(e){ll(n,e)}))}))])});return La.sketch({dom:Ja("image",n),components:[e.asSpec()],action:function(n){e.get(n).element().dom().click()}})}(e)})),bullist:h(k.some("bullist"),m),numlist:h(k.some("numlist"),g),fontsizeselect:h(k.none(),(function(){return r={onChange:function(n){cl.apply(t,n)},getInitialValue:function(){return cl.get(t)}},tl(n,"font-size",(function(){return function(n){return[$a('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),(e=n,ol({onChange:e.onChange,sizes:al,category:"font",getInitialValue:e.getInitialValue})),$a('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var e}(r)}),t=e);var t,r})),forecolor:h(k.none(),(function(){return function(n,e){var t={onChange:function(n,t,r){e.undoManager.transact((function(){e.formatter.apply("forecolor",{value:r}),e.nodeChanged()}))},getInitialValue:function(){return-1}};return tl(n,"color-levels",(function(){return function(n){return[(e=n,t=function(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"},el.sketch({dom:Ua('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[el.parts()["left-edge"]($a('<div class="${prefix}-hue-slider-black"></div>')),el.parts().spectrum({dom:Ua('<div class="${prefix}-slider-gradient-container"></div>'),components:[$a('<div class="${prefix}-slider-gradient"></div>')],behaviours:Gr([Zo.config({toggleClass:oi.resolve("thumb-active")})])}),el.parts()["right-edge"]($a('<div class="${prefix}-hue-slider-white"></div>')),el.parts().thumb({dom:Ua('<div class="${prefix}-slider-thumb"></div>'),behaviours:Gr([Zo.config({toggleClass:oi.resolve("thumb-active")})])})],onChange:function(n,r,o){var i=t(o.x());di(r.element(),"background-color",i),e.onChange(n,r,i)},onDragStart:function(n,e){Zo.on(e)},onDragEnd:function(n,e){Zo.off(e)},onInit:function(n,e,r,o){var i=t(o.x());di(e.element(),"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:function(){return e.getInitialValue()}}}},sliderBehaviours:Gr([ei(el.refresh)])}))];var e,t}(t)}),e)}(n,e)})),styleselect:h(k.none(),(function(){return Ya("style-formats",(function(t){e.fire("toReading"),n.dropup().appear(v,Zo.on,t)}),Gr([Zo.config({toggleClass:oi.resolve("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Po.config({channels:kt([ti(ho.orientationChanged(),Zo.off),ti(ho.dropupDismissed(),Zo.off)])})]),e)}))}},lm=function(n,e,t,r,u){var a=function(n,e){return function(t){if(n(t)){var r,u,c,a,s,f,l,d=ye(t.target),m=function(){t.stopPropagation()},g=function(){t.preventDefault()},p=o(g,m),v=(r=d,u=t.clientX,c=t.clientY,a=m,s=g,f=p,l=t,{target:i(r),x:i(u),y:i(c),stop:a,prevent:s,kill:f,raw:i(l)});e(v)}}}(t,r);return n.dom().addEventListener(e,a,u),{unbind:c(dm,n,e,a,u)}},dm=function(n,e,t,r){n.dom().removeEventListener(e,t,r)},mm=i(!0),gm=function(n,e,t){return lm(n,e,mm,t,!1)},pm=function(n,e,t){return lm(n,e,mm,t,!0)},vm=tinymce.util.Tools.resolve("tinymce.util.Delay"),hm=function(n){var e=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:i(e)}},ym=hm,bm=function(n,e){var t=ye(n),r=null,o=gm(t,"orientationchange",(function(){vm.clearInterval(r);var t=hm(n);e.onChange(t),i((function(){e.onReady(t)}))})),i=function(e){vm.clearInterval(r);var t=n.innerHeight,o=0;r=vm.setInterval((function(){t!==n.innerHeight?(vm.clearInterval(r),e(k.some(n.innerHeight))):20<o&&(vm.clearInterval(r),e(k.none())),o++}),50)};return{onAdjustment:i,destroy:function(){o.unbind()}}},xm=function(n){var e=qn.detect().os.isiOS(),t=hm(n).isPortrait();return e&&!t?n.screen.height:n.screen.width},wm=function(n){var e=n.raw();return void 0===e.touches||1!==e.touches.length?k.none():k.some(e.touches[0])},Sm=function(e){var t=so(k.none()),r=function(e){var t=null;return{cancel:function(){null!==t&&(n.clearTimeout(t),t=null)},schedule:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];t=n.setTimeout((function(){e.apply(null,r),t=null}),400)}}}((function(n){t.set(k.none()),e.triggerEvent(oe(),n)})),o=kt([{key:R(),value:function(n){return wm(n).each((function(e){r.cancel();var o={x:i(e.clientX),y:i(e.clientY),target:n.target};r.schedule(n),t.set(k.some(o))})),k.none()}},{key:B(),value:function(n){return r.cancel(),wm(n).each((function(n){t.get().each((function(e){var r,o,i,u;r=n,o=e,i=Math.abs(r.clientX-o.x()),u=Math.abs(r.clientY-o.y()),(5<i||5<u)&&t.set(k.none())}))})),k.none()}},{key:V(),value:function(n){return r.cancel(),t.get().filter((function(e){return He(e.target(),n.target())})).map((function(t){return e.triggerEvent(te(),n)}))}}]);return{fireIfReady:function(n,e){return Ot(o,e).bind((function(e){return e(n)}))}}},Om=function(n){var e=Sm({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return gm(n.body(),"touchend",(function(n){e.fireIfReady(n,"touchend")}))},onTouchmove:function(){return gm(n.body(),"touchmove",(function(n){e.fireIfReady(n,"touchmove")}))}}},Tm=6<=qn.detect().os.version.major,km=function(n,e){var t=parseInt(Jr(n,e),10);return isNaN(t)?0:t},Em=function(n){var e=function(e){return n(e)?k.from(e.dom().nodeValue):k.none()},t=qn.detect().browser,r=t.isIE()&&10===t.version.major?function(n){try{return e(n)}catch(n){return k.none()}}:e;return{get:function(e){if(!n(e))throw new Error("Can only get text value of a text node");return r(e).getOr("")},getOption:r,set:function(e,t){if(!n(e))throw new Error("Can only set raw text value of a text node");e.dom().nodeValue=t}}}(ke),Cm={create:Ie("start","soffset","finish","foffset")},Mm=ut([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Im={before:Mm.before,on:Mm.on,after:Mm.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(u,u,u)}},Dm=ut([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Fm={domRange:Dm.domRange,relative:Dm.relative,exact:Dm.exact,exactFromRange:function(n){return Dm.exact(n.start(),n.soffset(),n.finish(),n.foffset())},getWin:function(n){var e;return e=n.match({domRange:function(n){return ye(n.startContainer)},relative:function(n,e){return Im.getStart(n)},exact:function(n,e,t,r){return n}}).dom().ownerDocument.defaultView,ye(e)},range:Cm.create},Am=function(n,e,t){var r,o,i=n.document.createRange();return r=i,e.fold((function(n){r.setStartBefore(n.dom())}),(function(n,e){r.setStart(n.dom(),e)}),(function(n){r.setStartAfter(n.dom())})),o=i,t.fold((function(n){o.setEndBefore(n.dom())}),(function(n,e){o.setEnd(n.dom(),e)}),(function(n){o.setEndAfter(n.dom())})),i},Rm=function(n,e,t,r,o){var i=n.document.createRange();return i.setStart(e.dom(),t),i.setEnd(r.dom(),o),i},Bm=function(n){return{left:i(n.left),top:i(n.top),right:i(n.right),bottom:i(n.bottom),width:i(n.width),height:i(n.height)}},Vm=ut([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nm=function(n,e,t){return e(ye(t.startContainer),t.startOffset,ye(t.endContainer),t.endOffset)},jm=function(n,e){var t,r,o,u=(t=n,e.match({domRange:function(n){return{ltr:i(n),rtl:k.none}},relative:function(n,e){return{ltr:X((function(){return Am(t,n,e)})),rtl:X((function(){return k.some(Am(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:X((function(){return Rm(t,n,e,r,o)})),rtl:X((function(){return k.some(Rm(t,r,o,n,e))}))}}}));return(o=(r=u).ltr()).collapsed?r.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Vm.rtl(ye(n.endContainer),n.endOffset,ye(n.startContainer),n.startOffset)})).getOrThunk((function(){return Nm(0,Vm.ltr,o)})):Nm(0,Vm.ltr,o)},_m=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(n,e){var t=Se(n);return"input"===t?Im.after(n):kn(["br","img"],t)?0===e?Im.before(n):Im.after(n):Im.on(n,e)}),Hm=function(n,e,t,r,o){var i,u,c=Rm(n,e,t,r,o);i=n,u=c,k.from(i.getSelection()).each((function(n){n.removeAllRanges(),n.addRange(u)}))},zm=function(n){var e=ye(n.anchorNode),t=ye(n.focusNode);return function(n,e,t,r){var o,i,u,c,a,s=(i=e,u=t,c=r,(a=ze(o=n).dom().createRange()).setStart(o.dom(),i),a.setEnd(u.dom(),c),a),f=He(n,t)&&e===r;return s.collapsed&&!f}(e,n.anchorOffset,t,n.focusOffset)?k.some(Cm.create(e,n.anchorOffset,t,n.focusOffset)):function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return k.some(Cm.create(ye(e.startContainer),e.startOffset,ye(t.endContainer),t.endOffset))}return k.none()}(n)},Pm=function(n){return k.from(n.getSelection()).filter((function(n){return 0<n.rangeCount})).bind(zm)},Lm=function(n,e){var t,r,o,i,u=jm(t=n,e).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}});return 0<(i=0<(o=(r=u).getClientRects()).length?o[0]:r.getBoundingClientRect()).width||0<i.height?k.some(i).map(Bm):k.none()},Gm=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:i(2),height:n.height}},Um=function(n){return{left:i(n.left),top:i(n.top),right:i(n.right),bottom:i(n.bottom),width:i(n.width),height:i(n.height)}},$m=function(n){var e=n.getSelection();return void 0!==e&&0<e.rangeCount?function(n){if(n.collapsed){var e=ye(n.startContainer);return Pe(e).bind((function(t){var r,o=Fm.exact(e,n.startOffset,t,"img"===Se(r=t)?1:function(n){return Em.getOption(n)}(r).fold((function(){return Le(r).length}),(function(n){return n.length})));return Lm(n.startContainer.ownerDocument.defaultView,o).map(Gm).map(zn)})).getOr([])}return Cn(n.getClientRects(),Um)}(e.getRangeAt(0)):[]},Wm="data-"+oi.resolve("last-outer-height"),Xm=function(n,e){Yr(n,Wm,e)},qm=function(n){return{top:i(n.top()),bottom:i(n.top()+n.height())}},Ym=function(n){return k.some(ye(n.dom().contentWindow.document.body))},Km=function(n){return k.some(ye(n.dom().contentWindow.document))},Jm=function(n){return k.from(n.dom().contentWindow)},Qm=function(n){return Jm(n).bind(Pm)},Zm=function(n){return n.getFrame()},ng=function(n,e){return function(t){return t[n].getOrThunk((function(){var n=Zm(t);return function(){return e(n)}}))()}},eg=function(n,e,t,r){return n[t].getOrThunk((function(){return function(n){return gm(e,r,n)}}))},tg=function(n){return{left:i(n.left),top:i(n.top),right:i(n.right),bottom:i(n.bottom),width:i(n.width),height:i(n.height)}},rg={getBody:ng("getBody",Ym),getDoc:ng("getDoc",Km),getWin:ng("getWin",Jm),getSelection:ng("getSelection",Qm),getFrame:Zm,getActiveApi:function(n){var e=Zm(n);return Ym(e).bind((function(t){return Km(e).bind((function(r){return Jm(e).map((function(o){var u=ye(r.dom().documentElement),a=n.getCursorBox.getOrThunk((function(){return function(){return(n=o,Pm(n).map((function(n){return Fm.exact(n.start(),n.soffset(),n.finish(),n.foffset())}))).bind((function(n){return Lm(o,n).orThunk((function(){return Pm(o).filter((function(n){return He(n.start(),n.finish())&&n.soffset()===n.foffset()})).bind((function(n){var e=n.start().dom().getBoundingClientRect();return 0<e.width||0<e.height?k.some(e).map(tg):k.none()}))}))}));var n}})),s=n.setSelection.getOrThunk((function(){return function(n,e,t,r){!function(n,e,t,r,o){var i,u,c,a,s,f=(i=r,u=o,c=_m(e,t),a=_m(i,u),Fm.relative(c,a));jm(s=n,f).match({ltr:function(n,e,t,r){Hm(s,n,e,t,r)},rtl:function(n,e,t,r){var o,i,u,c,a,f=s.getSelection();if(f.setBaseAndExtent)f.setBaseAndExtent(n.dom(),e,t.dom(),r);else if(f.extend)try{i=n,u=e,c=t,a=r,(o=f).collapse(i.dom(),u),o.extend(c.dom(),a)}catch(o){Hm(s,t,r,n,e)}else Hm(s,t,r,n,e)}})}(o,n,e,t,r)}})),f=n.clearSelection.getOrThunk((function(){return function(){o.getSelection().removeAllRanges()}}));return{body:i(t),doc:i(r),win:i(o),html:i(u),getSelection:c(Qm,e),setSelection:s,clearSelection:f,frame:i(e),onKeyup:eg(n,r,"onKeyup","keyup"),onNodeChanged:eg(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:a}}))}))}))}},og="data-ephox-mobile-fullscreen-style",ig="position:absolute!important;",ug="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",cg=qn.detect().os.isAndroid(),ag=function(n,e){var t,r=function(n){return function(e){var t=Jr(e,"style"),r=void 0===t?"no-styles":t.trim();r!==n&&(Yr(e,og,r),Yr(e,"style",n))}},o=function(n){return In(function(n,e){for(var t=wn(e)?e:i(!1),r=n.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var u=r.parentNode,c=ye(u);if(o.push(c),!0===t(c))break;r=u}return o}(n,void 0),(function(n){return Ve(n,"*")}))}(n),u=jn(o,(function(n){return function(n){return In(Pe(e=n).map(Le).map((function(n){return In(n,(function(n){return!He(e,n)}))})).getOr([]),(function(n){return Ve(n,"*")}));var e}(n)})),c=void 0!==(t=gi(e,"background-color"))&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;";Mn(u,r("display:none!important;")),Mn(o,r(ig+ug+c)),r((!0===cg?"":ig)+ug+c)(n)},sg=function(){var n=je("["+og+"]");Mn(n,(function(n){var e=Jr(n,og);"no-styles"!==e?Yr(n,"style",e):Zr(n,"style"),Zr(n,og)}))},fg=function(){var n=ki("head").getOrDie(),e=ki('meta[name="viewport"]').getOrThunk((function(){var e=he("meta");return Yr(e,"name","viewport"),Xe(n,e),e})),t=Jr(e,"content");return{maximize:function(){Yr(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&0<t.length?Yr(e,"content",t):Yr(e,"content","user-scalable=yes")}}},lg=function(n,e){var t=fg(),o=nd(),i=nd();return{enter:function(){e.hide(),to(n.container,oi.resolve("fullscreen-maximized")),to(n.container,oi.resolve("android-maximized")),t.maximize(),to(n.body,oi.resolve("android-scroll-reload")),o.set(function(n,e){var t=ye(e.document.body),r=gm(ye(n),"resize",(function(){(function(n,e){var t=km(e,Wm),r=n.innerHeight;return r<t?k.some(t-r):k.none()})(n,t).each((function(n){var t,r;(t=e,r=$m(t),0<r.length?k.some(r[0]).map(qm):k.none()).each((function(t){var r,o,i,u=(r=e,i=n,(o=t).top()>r.innerHeight||o.bottom()>r.innerHeight?Math.min(i,o.bottom()-r.innerHeight+50):0);0!==u&&e.scrollTo(e.pageXOffset,e.pageYOffset+u)}))})),Xm(t,n.innerHeight)}));return Xm(t,n.innerHeight),{toEditing:function(){!function(n){n.focus();var e=ye(n.document.body);(mo().exists((function(n){return kn(["input","textarea"],Se(n))}))?function(n){vm.setTimeout((function(){n()}),0)}:h)((function(){mo().each(lo),fo(e)}))}(e)},destroy:function(){r.unbind()}}}(n.win,rg.getWin(n.editor).getOrDie("no"))),rg.getActiveApi(n.editor).each((function(e){ag(n.container,e.body()),i.set(function(n,e,t){var o=Om(n),i=ze(e),u=function(n){return!He(n.start(),n.finish())||n.soffset()!==n.foffset()},c=function(){var r=n.doc().dom().hasFocus()&&n.getSelection().exists(u);t.getByDom(e).each(!0===(r||mo(i).filter((function(n){return"input"===Se(n)})).exists((function(n){return n.dom().selectionStart!==n.dom().selectionEnd})))?Zo.on:Zo.off)},a=[gm(n.body(),"touchstart",(function(e){n.onTouchContent(),o.fireTouchstart(e)})),o.onTouchmove(),o.onTouchend(),gm(e,"touchstart",(function(e){n.onTouchToolstrip()})),n.onToReading((function(){lo(n.body())})),n.onToEditing(r),n.onScrollToCursor((function(e){e.preventDefault(),n.getCursorBox().each((function(e){var t=n.win(),r=e.top()>t.innerHeight||e.bottom()>t.innerHeight?e.bottom()-t.innerHeight+50:0;0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)}))}))].concat(!0===Tm?[]:[gm(ye(n.win()),"blur",(function(){t.getByDom(e).each(Zo.off)})),gm(i,"select",c),gm(n.doc(),"selectionchange",c)]);return{destroy:function(){Mn(a,(function(n){n.unbind()}))}}}(e,n.toolstrip,n.alloy))}))},exit:function(){t.restore(),e.show(),ro(n.container,oi.resolve("fullscreen-maximized")),ro(n.container,oi.resolve("android-maximized")),sg(),ro(n.body,oi.resolve("android-scroll-reload")),i.clear(),o.clear()}}},dg=function(e,t){var r=null;return{cancel:function(){null!==r&&(n.clearTimeout(r),r=null)},throttle:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&n.clearTimeout(r),r=n.setTimeout((function(){e.apply(null,o),r=null}),t)}}},mg=function(e,t){var r,o,i=sl(Tl.sketch({dom:Ua('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:Gr([Zo.config({toggleClass:oi.resolve("mask-tap-icon-selected"),toggleOnExecute:!1})])})),u=(r=e,o=null,{cancel:function(){null!==o&&(n.clearTimeout(o),o=null)},throttle:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];null===o&&(o=n.setTimeout((function(){r.apply(null,e),o=null}),200))}});return Tl.sketch({dom:Ua('<div class="${prefix}-disabled-mask"></div>'),components:[Tl.sketch({dom:Ua('<div class="${prefix}-content-container"></div>'),components:[La.sketch({dom:Ua('<div class="${prefix}-content-tap-section"></div>'),components:[i.asSpec()],action:function(n){u.throttle()},buttonBehaviours:Gr([Zo.config({toggleClass:oi.resolve("mask-tap-icon-selected")})])})]})]})},gg=Wt([ar("editor",[ur("getFrame"),sr("getBody"),sr("getDoc"),sr("getWin"),sr("getSelection"),sr("setSelection"),sr("clearSelection"),sr("cursorSaver"),sr("onKeyup"),sr("onNodeChanged"),sr("getCursorBox"),ur("onDomChanged"),mr("onTouchContent",r),mr("onTapContent",r),mr("onTouchToolstrip",r),mr("onScrollToCursor",i({unbind:r})),mr("onScrollToElement",i({unbind:r})),mr("onToEditing",i({unbind:r})),mr("onToReading",i({unbind:r})),mr("onToolbarScrollStart",u)]),ur("socket"),ur("toolstrip"),ur("dropup"),ur("toolbar"),ur("container"),ur("alloy"),pr("win",(function(n){return ze(n.socket).dom().defaultView})),pr("body",(function(n){return ye(n.socket.dom().ownerDocument.body)})),mr("translate",u),mr("setReadOnly",r),mr("readOnlyOnInit",i(!0))]),pg=i([ur("dom"),mr("shell",!0),Gc("toolbarBehaviours",[Pd])]),vg=i([va({name:"groups",overrides:function(n){return{behaviours:Gr([Pd.config({})])}}})]),hg=Pa({name:"Toolbar",configFields:pg(),partFields:vg(),factory:function(e,t,r,o){var i=function(n){return e.shell?k.some(n):Sa(n,e,"groups")},u=e.shell?{behaviours:[Pd.config({})],components:[]}:{behaviours:[],components:t};return{uid:e.uid,dom:e.dom,components:u.components,behaviours:$c(e.toolbarBehaviours,u.behaviours),apis:{setGroups:function(e,t){i(e).fold((function(){throw n.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){Pd.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),yg=i([ur("items"),(lu=["itemSelector"],ar("markers",Cn(lu,ur))),Gc("tgroupBehaviours",[Lc])]),bg=i([ha({name:"items",unit:"item"})]),xg=Pa({name:"ToolbarGroup",configFields:yg(),partFields:bg(),factory:function(n,e,t,r){return{uid:n.uid,dom:n.dom,components:e,behaviours:$c(n.tgroupBehaviours,[Lc.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),wg="data-"+oi.resolve("horizontal-scroll"),Sg=function(n){return"true"===Jr(n,wg)?0<(t=n).dom().scrollLeft||function(n){n.dom().scrollLeft=1;var e=0!==n.dom().scrollLeft;return n.dom().scrollLeft=0,e}(t):0<(e=n).dom().scrollTop||function(n){n.dom().scrollTop=1;var e=0!==n.dom().scrollTop;return n.dom().scrollTop=0,e}(e);var e,t},Og=function(n,e){return gm(n,"touchmove",(function(n){Mi(n.target(),e).filter(Sg).fold((function(){n.raw().preventDefault()}),r)}))};function Tg(){var n=function(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Ua('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:Gr([xl("adhoc-scrollable-toolbar",!0===n.scrollable?[Rr((function(n,e){di(n.element(),"overflow-x","auto"),function(n){Yr(n,wg,"true")}(n.element()),em.register(n.element())}))]:[])]),components:[Tl.sketch({components:[xg.parts().items({})]})],markers:{itemSelector:"."+oi.resolve("toolbar-group-item")},items:n.items}},e=xd(hg.sketch({dom:Ua('<div class="${prefix}-toolbar"></div>'),components:[hg.parts().groups({})],toolbarBehaviours:Gr([Zo.config({toggleClass:oi.resolve("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Lc.config({mode:"cyclic"})]),shell:!0})),t=xd(Tl.sketch({dom:{classes:[oi.resolve("toolstrip")]},components:[wd(e)],containerBehaviours:Gr([Zo.config({toggleClass:oi.resolve("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){hg.setGroups(e,u.get()),Zo.off(e)},u=so([]);return{wrapper:i(t),toolbar:i(e),createGroups:function(e){return Cn(e,o(xg.sketch,n))},setGroups:function(n){u.set(n),r()},setContextToolbar:function(n){Zo.on(e),hg.setGroups(e,n)},restoreToolbar:function(){Zo.isOn(e)&&r()},refresh:function(){},focus:function(){Lc.focusIn(e)}}}var kg=function(n,e){Pd.append(n,wd(e))},Eg=function(n,e){Pd.remove(n,e)},Cg=function(n){return xd(La.sketch({dom:Ua('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run((function(n){n.setReadOnly(!1)}))}}))},Mg=function(){return xd(Tl.sketch({dom:Ua('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:Gr([Pd.config({})])}))},Ig=function(n,e,t,r){(!0===t?ao.toAlpha:ao.toOmega)(r),(t?kg:Eg)(n,e)},Dg=function(n,e){return e.getAnimationRoot.fold((function(){return n.element()}),(function(e){return e(n)}))},Fg=function(n){return n.dimension.property},Ag=function(n,e){return n.dimension.getDimension(e)},Rg=function(n,e){var t=Dg(n,e);pd(t,[e.shrinkingClass,e.growingClass])},Bg=function(n,e){ro(n.element(),e.openClass),to(n.element(),e.closedClass),di(n.element(),Fg(e),"0px"),yi(n.element())},Vg=function(n,e){ro(n.element(),e.closedClass),to(n.element(),e.openClass),hi(n.element(),Fg(e))},Ng=function(n,e,t,r){t.setCollapsed(),di(n.element(),Fg(e),Ag(e,n.element())),yi(n.element()),Rg(n,e),Bg(n,e),e.onStartShrink(n),e.onShrunk(n)},jg=function(n,e,t,r){var o=r.getOrThunk((function(){return Ag(e,n.element())}));t.setCollapsed(),di(n.element(),Fg(e),o),yi(n.element());var i=Dg(n,e);ro(i,e.growingClass),to(i,e.shrinkingClass),Bg(n,e),e.onStartShrink(n)},_g=function(n,e,t){var r=Ag(e,n.element());("0px"===r?Ng:jg)(n,e,t,k.some(r))},Hg=function(n,e,t){var r=Dg(n,e),o=oo(r,e.shrinkingClass),i=Ag(e,n.element());Vg(n,e);var u=Ag(e,n.element());(o?function(){di(n.element(),Fg(e),i),yi(n.element())}:function(){Bg(n,e)})(),ro(r,e.shrinkingClass),to(r,e.growingClass),Vg(n,e),di(n.element(),Fg(e),u),t.setExpanded(),e.onStartGrow(n)},zg=function(n,e,t){var r=Dg(n,e);return!0===oo(r,e.growingClass)},Pg=function(n,e,t){var r=Dg(n,e);return!0===oo(r,e.shrinkingClass)},Lg=Object.freeze({refresh:function(n,e,t){if(t.isExpanded()){hi(n.element(),Fg(e));var r=Ag(e,n.element());di(n.element(),Fg(e),r)}},grow:function(n,e,t){t.isExpanded()||Hg(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&_g(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&Ng(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:zg,isShrinking:Pg,isTransitioning:function(n,e,t){return!0===zg(n,e)||!0===Pg(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?_g:Hg)(n,e,t)},disableTransitions:Rg}),Gg=Object.freeze({exhibit:function(n,e){var t=e.expanded;return jr(t?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:Tt(e.dimension.property,"0px")})},events:function(n,e){return Tr([(t=$(),r=function(t,r){r.event().raw().propertyName===n.dimension.property&&(Rg(t,n),e.isExpanded()&&hi(t.element(),n.dimension.property),(e.isExpanded()?n.onGrown:n.onShrunk)(t))},Mr(t)(r))]);var t,r}}),Ug=[ur("closedClass"),ur("openClass"),ur("shrinkingClass"),ur("growingClass"),sr("getAnimationRoot"),Ro("onShrunk"),Ro("onStartShrink"),Ro("onGrown"),Ro("onStartGrow"),mr("expanded",!1),cr("dimension",rr("property",{width:[jo("property","width"),jo("getDimension",(function(n){return Ts(n)+"px"}))],height:[jo("property","height"),jo("getDimension",(function(n){return Oi(n)+"px"}))]}))],$g=$r({fields:Ug,name:"sliding",active:Gg,apis:Lg,state:Object.freeze({init:function(n){var e=so(n.expanded);return Lr({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:c(e.set,!1),setExpanded:c(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),Wg=function(e,t){var o=xd(Tl.sketch({dom:{tag:"div",classes:[oi.resolve("dropup")]},components:[],containerBehaviours:Gr([Pd.config({}),$g.config({closedClass:oi.resolve("dropup-closed"),openClass:oi.resolve("dropup-open"),shrinkingClass:oi.resolve("dropup-shrinking"),growingClass:oi.resolve("dropup-growing"),dimension:{property:"height"},onShrunk:function(n){e(),t(),Pd.set(n,[])},onGrown:function(n){e(),t()}}),ei((function(n,e){u(r)}))])})),u=function(e){n.window.requestAnimationFrame((function(){e(),$g.shrink(o)}))};return{appear:function(e,t,r){!0===$g.hasShrunk(o)&&!1===$g.isTransitioning(o)&&n.window.requestAnimationFrame((function(){t(r),Pd.set(o,[e()]),$g.grow(o)}))},disappear:u,component:i(o),element:o.element}},Xg=qn.detect().browser.isFirefox(),qg=$t([cr("triggerEvent",ir),mr("stopBackspace",!0)]),Yg=function(n,e){var t=Ot(n,"target").map((function(n){return n()})).getOr(e);return so(t)},Kg=ut([{stopped:[]},{resume:["element"]},{complete:[]}]),Jg=function(n,e,t,r,o,u){var c,a,s,f,l=n(e,r),d=(c=t,a=o,s=so(!1),f=so(!1),{stop:function(){s.set(!0)},cut:function(){f.set(!0)},isStopped:s.get,isCut:f.get,event:i(c),setSource:a.set,getSource:a.get});return l.fold((function(){return u.logEventNoHandlers(e,r),Kg.complete()}),(function(n){var t=n.descHandler();return ld(t)(d),d.isStopped()?(u.logEventStopped(e,n.element(),t.purpose()),Kg.stopped()):d.isCut()?(u.logEventCut(e,n.element(),t.purpose()),Kg.complete()):Pe(n.element()).fold((function(){return u.logNoParent(e,n.element(),t.purpose()),Kg.complete()}),(function(r){return u.logEventResponse(e,n.element(),t.purpose()),Kg.resume(r)}))}))},Qg=function(n,e,t,r,o,i){return Jg(n,e,t,r,o,i).fold((function(){return!0}),(function(r){return Qg(n,e,t,r,o,i)}),(function(){return!1}))},Zg=function(n,e,t){var o,u,c=(o=e,u=so(!1),{stop:function(){u.set(!0)},cut:r,isStopped:u.get,isCut:i(!1),event:i(o),setSource:v("Cannot set source of a broadcasted event"),getSource:v("Cannot get source of a broadcasted event")});return Mn(n,(function(n){var e=n.descHandler();ld(e)(c)})),c.isStopped()},np=function(n,e,t,r,o){var i=Yg(t,r);return Qg(n,e,t,r,i,o)},ep=Ie("element","descHandler");function tp(){var n=function(){var n={};return{registerId:function(e,t,r){M(r,(function(r,o){var u=void 0!==n[o]?n[o]:{};u[t]=function(n,e){return t=c.apply(void 0,[n.handler].concat(e)),r=n.purpose(),{cHandler:t,purpose:i(r)};var t,r}(r,e),n[o]=u}))},unregisterId:function(e){M(n,(function(n,t){n.hasOwnProperty(e)&&delete n[e]}))},filterByType:function(e){return Ot(n,e).map((function(n){return F(n,(function(n,e){return function(n,e){return{id:i(n),descHandler:i(e)}}(e,n)}))})).getOr([])},find:function(e,t,r){var o=wt(t)(n);return function(n,e,t){return Or(n,(function(n){return e(n).isSome()}),t).bind(e)}(r,(function(n){return e=o,Ra(t=n).fold((function(){return k.none()}),(function(n){var r=wt(n);return e.bind(r).map((function(n){return ep(t,n)}))}));var e,t}),e)}}}(),e={},t=function(t){Ra(t.element()).each((function(t){delete e[t],n.unregisterId(t)}))};return{find:function(e,t,r){return n.find(e,t,r)},filter:function(e){return n.filterByType(e)},register:function(r){var o=function(n){var e=n.element();return Ra(e).fold((function(){return e=n.element(),t=ea(Da+"uid-"),Aa(e,t),t;var e,t}),(function(n){return n}))}(r);Et(e,o)&&function(n,r){var o=e[r];if(o!==n)throw new Error('The tagId "'+r+'" is already used by: '+bo(o.element())+"\nCannot use it for: "+bo(n.element())+"\nThe conflicting element is"+(Ee(o.element())?" ":" not ")+"already in the DOM");t(n)}(r,o);var i=[r];n.registerId(i,o,r.events()),e[o]=r},unregister:t,getById:function(n){return wt(n)(e)}}}var rp=i(oi.resolve("readonly-mode")),op=i(oi.resolve("edit-mode"));function ip(e){return function(e){var t=function(n){return Pe(e.element()).fold((function(){return!0}),(function(e){return He(n,e)}))},o=tp(),u=function(n,e){return o.find(t,n,e)},c=function(e,t){var r,o,i,u,c=er("Getting GUI events settings",qg,t),a=qn.detect().deviceType.isTouch()?["touchstart","touchmove","touchend","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],s=Sm(c),f=Cn(a.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return gm(e,n,(function(e){s.fireIfReady(e,n).each((function(n){n&&e.kill()})),c.triggerEvent(n,e)&&e.kill()}))})),l=so(k.none()),d=gm(e,"paste",(function(e){s.fireIfReady(e,"paste").each((function(n){n&&e.kill()})),c.triggerEvent("paste",e)&&e.kill(),l.set(k.some(n.setTimeout((function(){c.triggerEvent(Qn(),e)}),0)))})),m=gm(e,"keydown",(function(n){c.triggerEvent("keydown",n)?n.kill():!0===c.stopBackspace&&function(n){var e;return 8===n.raw().which&&!kn(["input","textarea"],Se(n.target()))&&(e=n.target(),!Mi(e,'[contenteditable="true"]',void 0).isSome())}(n)&&n.prevent()})),g=(r=e,o=function(n){c.triggerEvent("focusin",n)&&n.kill()},Xg?pm(r,"focus",o):gm(r,"focusin",o)),p=so(k.none()),v=(i=e,u=function(e){c.triggerEvent("focusout",e)&&e.kill(),p.set(k.some(n.setTimeout((function(){c.triggerEvent(Jn(),e)}),0)))},Xg?pm(i,"blur",u):gm(i,"focusout",u));return{unbind:function(){Mn(f,(function(n){n.unbind()})),m.unbind(),g.unbind(),v.unbind(),d.unbind(),l.get().each(n.clearTimeout),p.get().each(n.clearTimeout)}}}(e.element(),{triggerEvent:function(n,e){return Eo(n,e.target(),(function(t){return r=u,o=n,c=t,a=(i=e).target(),np(r,o,i,a,c);var r,o,i,c,a}))}}),a={debugInfo:i("real"),triggerEvent:function(n,e,t){Eo(n,e,(function(r){np(u,n,t,e,r)}))},triggerFocus:function(n,e){Ra(n).fold((function(){fo(n)}),(function(t){Eo(Kn(),n,(function(t){var o,c,a,s,f,l;o=u,c=Kn(),a={originator:i(e),kill:r,prevent:r,target:i(n)},f=t,l=Yg(a,s=n),Jg(o,c,a,s,l,f)}))}))},triggerEscape:function(n,e){a.triggerEvent("keydown",n.element(),e.event())},getByUid:function(n){return h(n)},getByDom:function(n){return y(n)},build:xd,addToGui:function(n){l(n)},removeFromGui:function(n){d(n)},addToWorld:function(n){s(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){g(n)},broadcastOn:function(n,e){p(n,e)},broadcastEvent:function(n,e){v(n,e)},isConnected:i(!0)},s=function(n){n.connect(a),ke(n.element())||(o.register(n),Mn(n.components(),s),a.triggerEvent(ie(),n.element(),{target:i(n.element())}))},f=function(n){ke(n.element())||(Mn(n.components(),f),o.unregister(n)),n.disconnect()},l=function(n){Ze(e,n)},d=function(n){tt(n)},m=function(n){var e=o.filter(Zn());Mn(e,(function(e){var t=e.descHandler();ld(t)(n)}))},g=function(n){m({universal:i(!0),data:i(n)})},p=function(n,e){m({universal:i(!1),channels:i(n),data:i(e)})},v=function(n,e){var t=o.filter(n);return Zg(t,e)},h=function(n){return o.getById(n).fold((function(){return it.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),it.value)},y=function(n){var e=Ra(n).getOr("not found");return h(e)};return s(e),{root:i(e),element:e.element,destroy:function(){c.unbind(),Ke(e.element())},add:l,remove:d,getByUid:h,getByDom:y,addToWorld:s,removeFromWorld:f,broadcast:g,broadcastOn:p,broadcastEvent:v}}(xd(Tl.sketch({dom:{classes:[oi.resolve("outer-container")].concat(e.classes)},containerBehaviours:Gr([ao.config({alpha:rp(),omega:op()})])})))}var up,cp,ap=function(n,e){var t=he("input");mi(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),Xe(n,t),fo(t),e(t),Ke(t)},sp=function(n){var e=n.getSelection();if(0<e.rangeCount){var t=e.getRangeAt(0),r=n.document.createRange();r.setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(r)}},fp=function(n,e){mo().each((function(n){He(n,e)||lo(n)})),n.focus(),fo(ye(n.document.body)),sp(n)},lp={stubborn:function(n,e,t,r){var o=function(){fp(e,r)},i=gm(t,"keydown",(function(n){kn(["input","textarea"],Se(n.target()))||o()}));return{toReading:function(){ap(n,lo)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},timid:function(n,e,t,o){var i=function(){lo(o)};return{toReading:function(){i()},toEditing:function(){fp(e,o)},onToolbarTouch:function(){i()},destroy:r}}},dp={},mp={exports:dp};up=dp,cp=mp,function(n){"object"==typeof up&&void 0!==cp?cp.exports=n():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}((function(){return function n(e,t,r){function o(u,c){if(!t[u]){if(!e[u]){if(i)return i(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var s=t[u]={exports:{}};e[u][0].call(s.exports,(function(n){return o(e[u][1][n]||n)}),s,s.exports,n,e,t,r)}return t[u].exports}for(var i=!1,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,e,t){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0);try{return r(n,0)}catch(e){try{return r.call(null,n,0)}catch(e){return r.call(this,n,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var n=a(m);l=!0;for(var e=f.length;e;){for(s=f,f=[];++d<e;)s&&s[d].run();d=-1,e=f.length}s=null,l=!1,function(n){if(o===clearTimeout)return clearTimeout(n);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n);try{return o(n)}catch(e){try{return o.call(null,n)}catch(e){return o.call(this,n)}}}(n)}}function p(n,e){this.fun=n,this.array=e}function v(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];f.push(new p(n,e)),1!==f.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,e,t){(function(n){!function(t){var r=setTimeout;function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function u(n,e){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn((function(){var t=1===n._state?e.onFulfilled:e.onRejected;if(null!==t){var r;try{r=t(n._value)}catch(n){return void a(e.promise,n)}c(e.promise,r)}else(1===n._state?c:a)(e.promise,n._value)}))):n._deferreds.push(e)}function c(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof i)return n._state=3,n._value=e,void s(n);if("function"==typeof t)return void l(function(n,e){return function(){n.apply(e,arguments)}}(t,e),n)}n._state=1,n._value=e,s(n)}catch(e){a(n,e)}}function a(n,e){n._state=2,n._value=e,s(n)}function s(n){2===n._state&&0===n._deferreds.length&&i._immediateFn((function(){n._handled||i._unhandledRejectionFn(n._value)}));for(var e=0,t=n._deferreds.length;e<t;e++)u(n,n._deferreds[e]);n._deferreds=null}function f(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function l(n,e){var t=!1;try{n((function(n){t||(t=!0,c(e,n))}),(function(n){t||(t=!0,a(e,n))}))}catch(n){if(t)return;t=!0,a(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(o);return u(this,new f(n,e,t)),t},i.all=function(n){var e=Array.prototype.slice.call(n);return new i((function(n,t){if(0===e.length)return n([]);var r=e.length;function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),t)}e[i]=u,0==--r&&n(e)}catch(n){t(n)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i((function(e){e(n)}))},i.reject=function(n){return new i((function(e,t){t(n)}))},i.race=function(n){return new i((function(e,t){for(var r=0,o=n.length;r<o;r++)n[r].then(e,t)}))},i._immediateFn="function"==typeof n?function(e){n(e)}:function(n){r(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==e&&e.exports?e.exports=i:t.Promise||(t.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,e,t){(function(e,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0;function s(n,e){this._id=n,this._clearFn=e}t.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},t.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},t._unrefActive=t.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),e))},t.setImmediate="function"==typeof e?e:function(n){var e=a++,r=!(arguments.length<2)&&u.call(arguments,1);return c[e]=!0,o((function(){c[e]&&(r?n.apply(null,r):n.call(null),t.clearImmediate(e))})),e},t.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}));var gp=mp.exports.boltExport,pp=function(e){var t=k.none(),r=[],o=function(n){i()?u(n):r.push(n)},i=function(){return t.isSome()},u=function(e){t.each((function(t){n.setTimeout((function(){e(t)}),0)}))};return e((function(n){t=k.some(n),function(n){Mn(n,u)}(r),r=[]})),{get:o,map:function(n){return pp((function(e){o((function(t){e(n(t))}))}))},isReady:i}},vp={nu:pp,pure:function(n){return pp((function(e){e(n)}))}},hp=function(e){n.setTimeout((function(){throw e}),0)},yp=function(n){var e=function(e){n().then(e,hp)};return{map:function(e){return yp((function(){return n().then(e)}))},bind:function(e){return yp((function(){return n().then((function(n){return e(n).toPromise()}))}))},anonBind:function(e){return yp((function(){return n().then((function(){return e.toPromise()}))}))},toLazy:function(){return vp.nu(e)},toCached:function(){var e=null;return yp((function(){return null===e&&(e=n()),e}))},toPromise:n,get:e}},bp=function(n){return yp((function(){return new gp(n)}))},xp=function(n,e){var t=ze(n).dom().defaultView;return Oi(n)+Oi(e)-function(n){var e,t=ym(n).isPortrait(),r=function(n,e){return So([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],(function(t){return n<=t.width&&e<=t.height?k.some(t.keyboard):k.none()})).getOr({portrait:e/5,landscape:n/4})}((e=n).screen.width,e.screen.height),o=t?r.portrait:r.landscape;return(t?n.screen.height:n.screen.width)-n.innerHeight>o?0:o}(t)},wp=xp,Sp=function(n,e,t){var r=xp(e,t),o=Oi(e)+Oi(t)-r;di(n,"padding-bottom",o+"px")},Op=ut([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Tp="data-"+oi.resolve("position-y-fixed"),kp="data-"+oi.resolve("y-property"),Ep="data-"+oi.resolve("scrolling"),Cp="data-"+oi.resolve("last-window-height"),Mp=function(n){return km(n,Tp)},Ip=function(n,e){var t=Jr(n,kp);return Op.fixed(n,t,e)},Dp=function(n,e){return Op.scroller(n,e)},Fp=function(n){var e=Mp(n);return("true"===Jr(n,Ep)?Dp:Ip)(n,e)},Ap=function(n,e,t){var r=ze(n).dom().defaultView.innerHeight;return Yr(n,Cp,r+"px"),r-e-t},Rp=Mp,Bp=function(){var n=null;return{animate:function(e,t,r,o,i,u){var c=!1,a=function(n){c=!0,i(n)};vm.clearInterval(n);var s=function(e){vm.clearInterval(n),a(e)};n=vm.setInterval((function(){var i=e();(function(n,e,t){return Math.abs(n-e)<=t?k.none():n<e?k.some(n+t):k.some(n-t)})(i,t,r).fold((function(){vm.clearInterval(n),a(t)}),(function(r){if(o(r,s),!c){var u=e();(u!==r||Math.abs(u-t)>Math.abs(i-t))&&(vm.clearInterval(n),a(t))}}))}),u)}}}(),Vp="data-"+oi.resolve("last-scroll-top"),Np=function(n){var e=vi(n,"top").getOr("0");return parseInt(e,10)},jp=function(n){return parseInt(n.dom().scrollTop,10)},_p=function(n,e){var t=e+Rp(n)+"px";di(n,"top",t)},Hp=function(n,e){return bp((function(t){var r=c(jp,n);Yr(n,Vp,r());var o=Math.abs(e-r()),i=Math.ceil(o/10);Bp.animate(r,e,i,(function(e,t){km(n,Vp)!==n.dom().scrollTop?t(n.dom().scrollTop):(n.dom().scrollTop=e,Yr(n,Vp,e))}),(function(){n.dom().scrollTop=e,Yr(n,Vp,e),t(e)}),10)}))},zp=function(n,e){return bp((function(t){var r=c(Np,n),o=function(e){di(n,"top",e+"px")},i=Math.abs(e-r()),u=Math.ceil(i/10);Bp.animate(r,e,u,o,(function(){o(e),t(e)}),10)}))},Pp=function(n,e,t,r,o){var i=wp(e,t),u=c(sp,n);i<r||i<o?Hp(e,e.dom().scrollTop-i+o).get(u):r<0&&Hp(e,e.dom().scrollTop+r).get(u)},Lp=function(n,e){var t=function(n){var e=Ti(n,"["+Tp+"]");return Cn(e,Fp)}(n),r=Cn(t,(function(n){return function(n,e){return n.fold((function(n,t,r){return di(n,t,e+(o=r)+"px"),function(n){return yp((function(){return gp.resolve(n)}))}(o);var o}),(function(n,t){return i=e+(o=t),u=vi(r=n,"top").getOr(o),a=i-parseInt(u,10),s=r.dom().scrollTop+a,function(n,e,t){return bp((function(r){var o=c(jp,n);Bp.animate(o,e,15,(function(e){n.dom().scrollTop=e,di(n,"top",Np(n)+15+"px")}),(function(){n.dom().scrollTop=e,di(n,"top",t+"px"),r(e)}),10)}))}(r,s,i);var r,o,i,u,a,s}))}(n,e)}));return function(n,e){return e((function(e){var t=[],r=0;0===n.length?e([]):Mn(n,(function(o,i){var u;o.get((u=i,function(o){t[u]=o,++r>=n.length&&e(t)}))}))}))}(r,bp)},Gp=function(n){var e=n.cWin(),t=n.ceBody(),o=n.socket(),c=n.toolstrip(),a=n.toolbar(),s=n.contentElement(),f=n.keyboardType(),l=n.outerWindow(),d=n.dropup(),m=function(n,e,t,r){var o,i,u,c,a,s,f,l,d=ze(n).dom().defaultView,m=(l=Jr(f=t,"style"),mi(f,{position:"absolute",top:"0px"}),Yr(f,Tp,"0px"),Yr(f,kp,"top"),{restore:function(){Yr(f,"style",l||""),Zr(f,Tp),Zr(f,kp)}}),g=Oi(t),v=Oi(r),h=(u=g,c=Ap(n,g,v),s=Jr(a=n,"style"),em.register(a),mi(a,{position:"absolute",height:c+"px",width:"100%",top:u+"px"}),Yr(a,Tp,u+"px"),Yr(a,Ep,"true"),Yr(a,kp,"top"),{restore:function(){em.deregister(a),Yr(a,"style",s||""),Zr(a,Tp),Zr(a,Ep),Zr(a,kp)}}),y=(i=Jr(o=r,"style"),mi(o,{position:"absolute",bottom:"0px"}),Yr(o,Tp,"0px"),Yr(o,kp,"bottom"),{restore:function(){Yr(o,"style",i||""),Zr(o,Tp),Zr(o,kp)}}),b=!0,x=function(){var e=d.innerHeight;return km(n,Cp)<e},w=function(){if(b){var o=Oi(t),i=Oi(r),u=Ap(n,o,i);Yr(n,Tp,o+"px"),di(n,"height",u+"px"),Sp(e,n,r)}};return Sp(e,n,r),{setViewportOffset:function(e){Yr(n,Tp,e+"px"),w()},isExpanding:x,isShrinking:p(x),refresh:w,restore:function(){b=!1,m.restore(),h.restore(),y.restore()}}}(o,t,c,d),g=f(n.outerBody(),e,Ce(),s,c,a),v=bm(l,{onChange:r,onReady:m.refresh});v.onAdjustment((function(){m.refresh()}));var h=gm(ye(l),"resize",(function(){m.isExpanding()&&m.refresh()})),y=function(n,e,t,r,o,c){var a=function(n){var e=so(vp.pure({}));return{start:function(t){var r=vp.nu((function(e){return n(t).get(e)}));e.set(r)},idle:function(n){e.get().get((function(){n()}))}}}((function(t){return function(n,e,t){var r=ze(n).dom().defaultView;return bp((function(o){_p(n,t),_p(e,t),r.scrollTo(0,t),o(t)}))}(n,e,t)})),s=dg((function(){a.idle((function(){Lp(t,r.pageYOffset).get((function(){var n;(n=$m(c),k.from(n[0]).bind((function(n){var t=n.top()-e.dom().scrollTop;return t>r.innerHeight+5||t<-5?k.some({top:i(t),bottom:i(t+n.height())}):k.none()}))).each((function(n){e.dom().scrollTop=e.dom().scrollTop+n.top()})),a.start(0),o.refresh()}))}))}),1e3),f=gm(ye(r),"scroll",(function(){r.pageYOffset<0||s.throttle()}));return Lp(t,r.pageYOffset).get(u),{unbind:f.unbind}}(c,o,n.outerBody(),l,m,e),b=function(n,e){var t=n.document,r=he("div");to(r,oi.resolve("unfocused-selections")),Xe(ye(t.documentElement),r);var o=gm(r,"touchstart",(function(t){t.prevent(),fp(n,e),u()})),i=function(n){var e=he("span");return gd(e,[oi.resolve("layer-editor"),oi.resolve("unfocused-selection")]),mi(e,{left:n.left()+"px",top:n.top()+"px",width:n.width()+"px",height:n.height()+"px"}),e},u=function(){Ye(r)};return{update:function(){u();var e=$m(n),t=Cn(e,i);qe(r,t)},isActive:function(){return 0<Le(r).length},destroy:function(){o.unbind(),Ke(r)},clear:u}}(e,s),x=function(){b.clear()};return{toEditing:function(){g.toEditing(),x()},toReading:function(){g.toReading()},onToolbarTouch:function(n){g.onToolbarTouch(n)},refreshSelection:function(){b.isActive()&&b.update()},clearSelection:x,highlightSelection:function(){b.update()},scrollIntoView:function(n,t){Pp(e,o,d,n,t)},updateToolbarPadding:r,setViewportOffset:function(n){m.setViewportOffset(n),zp(o,n).get(u)},syncHeight:function(){di(s,"height",s.dom().contentWindow.document.body.scrollHeight+"px")},refreshStructure:m.refresh,destroy:function(){m.restore(),v.destroy(),y.unbind(),h.unbind(),g.destroy(),b.destroy(),ap(Ce(),lo)}}},Up=tinymce.util.Tools.resolve("tinymce.EditorManager"),$p=function(n,e,t){n.system().broadcastOn([ho.formatChanged()],{command:e,state:t})},Wp=(i(["x-small","small","medium","large","x-large"]),function(n){var e=function(){n._skinLoaded=!0,n.fire("SkinLoaded")};return function(){n.initialized?e():n.on("init",e)}}),Xp=i("toReading"),qp=i("toEditing");vo.add("mobile",(function(e){return{getNotificationManagerImpl:function(){return{open:i({progressBar:{value:r},close:r,text:r}),close:r,reposition:r,getArgs:i({})}},renderUI:function(){var t=e.getElement(),o=function(n){var e=Ot(n.settings,"skin_url").fold((function(){return Up.baseURL+"/skins/ui/oxide"}),(function(n){return n}));return{content:e+"/content.mobile.min.css",ui:e+"/skin.mobile.min.css"}}(e);0==(!1===e.settings.skin)?(e.contentCSS.push(o.content),po.DOM.styleSheetLoader.load(o.ui,Wp(e))):Wp(e)();var u=function(){e.fire("ScrollIntoView")},c=qn.detect().os.isAndroid()?function(n){var e=ip({classes:[oi.resolve("android-container")]}),t=Tg(),o=nd(),u=Cg(o),c=Mg(),a=Wg(r,n);return e.add(t.wrapper()),e.add(c),e.add(a.component()),{system:i(e),element:e.element,init:function(n){o.set(function(n){var e=er("Getting AndroidWebapp schema",gg,n);di(e.toolstrip,"width","100%");var t=xd(mg((function(){e.setReadOnly(e.readOnlyOnInit()),i.enter()}),e.translate));e.alloy.add(t);var o={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}};Xe(e.container,t.element());var i=lg(e,o);return{setReadOnly:e.setReadOnly,refreshStructure:r,enter:i.enter,exit:i.exit,destroy:r}}(n))},exit:function(){o.run((function(n){n.exit(),Pd.remove(c,u)}))},setToolbarGroups:function(n){var e=t.createGroups(n);t.setGroups(e)},setContextToolbar:function(n){var e=t.createGroups(n);t.setContextToolbar(e)},focusToolbar:function(){t.focus()},restoreToolbar:function(){t.restoreToolbar()},updateMode:function(n){Ig(c,u,n,e.root())},socket:i(c),dropup:i(a)}}(u):function(e){var t=ip({classes:[oi.resolve("ios-container")]}),o=Tg(),u=nd(),c=Cg(u),a=Mg(),s=Wg((function(){u.run((function(n){n.refreshStructure()}))}),e);return t.add(o.wrapper()),t.add(a),t.add(s.component()),{system:i(t),element:t.element,init:function(e){u.set(function(e){var t=er("Getting IosWebapp schema",gg,e);di(t.toolstrip,"width","100%"),di(t.container,"position","relative");var o=xd(mg((function(){t.setReadOnly(t.readOnlyOnInit()),u.enter()}),t.translate));t.alloy.add(o);var i={show:function(){t.alloy.add(o)},hide:function(){t.alloy.remove(o)}},u=function(e,t){var o=fg(),i=ed(),u=ed(),c=nd(),a=nd();return{enter:function(){t.hide();var s=ye(n.document);rg.getActiveApi(e.editor).each((function(t){i.set({socketHeight:vi(e.socket,"height"),iframeHeight:vi(t.frame(),"height"),outerScroll:n.document.body.scrollTop}),u.set({exclusives:Og(s,"."+em.scrollable())}),to(e.container,oi.resolve("fullscreen-maximized")),ag(e.container,t.body()),o.maximize(),di(e.socket,"overflow","scroll"),di(e.socket,"-webkit-overflow-scrolling","touch"),fo(t.body());var f=Ae(["cWin","ceBody","socket","toolstrip","toolbar","dropup","contentElement","cursor","keyboardType","isScrolling","outerWindow","outerBody"],[]);c.set(Gp(f({cWin:t.win(),ceBody:t.body(),socket:e.socket,toolstrip:e.toolstrip,toolbar:e.toolbar,dropup:e.dropup.element(),contentElement:t.frame(),cursor:r,outerBody:e.body,outerWindow:e.win,keyboardType:lp.stubborn,isScrolling:function(){return u.get().exists((function(n){return n.socket.isScrolling()}))}}))),c.run((function(n){n.syncHeight()})),a.set(function(n,e,t,r){var o=function(){e.run((function(n){n.refreshSelection()}))},i=function(n,t){var o=n-r.dom().scrollTop;e.run((function(n){n.scrollIntoView(o,o+t)}))},u=function(){e.run((function(n){n.clearSelection()}))},c=function(){n.getCursorBox().each((function(n){i(n.top(),n.height())})),e.run((function(n){n.syncHeight()}))},a=Om(n),s=dg(c,300),f=[n.onKeyup((function(){u(),s.throttle()})),n.onNodeChanged(o),n.onDomChanged(s.throttle),n.onDomChanged(o),n.onScrollToCursor((function(n){n.preventDefault(),s.throttle()})),n.onScrollToElement((function(n){n.element(),i(e,r)})),n.onToEditing((function(){e.run((function(n){n.toEditing()}))})),n.onToReading((function(){e.run((function(n){n.toReading()}))})),gm(n.doc(),"touchend",(function(e){He(n.html(),e.target())||He(n.body(),e.target())})),gm(t,"transitionend",(function(n){var r;"height"===n.raw().propertyName&&(r=Oi(t),e.run((function(n){n.setViewportOffset(r)})),o(),c())})),pm(t,"touchstart",(function(t){var r;e.run((function(n){n.highlightSelection()})),r=t,e.run((function(n){n.onToolbarTouch(r)})),n.onTouchToolstrip()})),gm(n.body(),"touchstart",(function(e){u(),n.onTouchContent(),a.fireTouchstart(e)})),a.onTouchmove(),a.onTouchend(),gm(n.body(),"click",(function(n){n.kill()})),gm(t,"touchmove",(function(){n.onToolbarScrollStart()}))];return{destroy:function(){Mn(f,(function(n){n.unbind()}))}}}(t,c,e.toolstrip,e.socket,e.dropup))}))},refreshStructure:function(){c.run((function(n){n.refreshStructure()}))},exit:function(){o.restore(),a.clear(),c.clear(),t.show(),i.on((function(t){t.socketHeight.each((function(n){di(e.socket,"height",n)})),t.iframeHeight.each((function(n){di(e.editor.getFrame(),"height",n)})),n.document.body.scrollTop=t.scrollTop})),i.clear(),u.on((function(n){n.exclusives.unbind()})),u.clear(),ro(e.container,oi.resolve("fullscreen-maximized")),sg(),em.deregister(e.toolbar),hi(e.socket,"overflow"),hi(e.socket,"-webkit-overflow-scrolling"),lo(e.editor.getFrame()),rg.getActiveApi(e.editor).each((function(n){n.clearSelection()}))}}}(t,i);return{setReadOnly:t.setReadOnly,refreshStructure:u.refreshStructure,enter:u.enter,exit:u.exit,destroy:r}}(e))},exit:function(){u.run((function(n){Pd.remove(a,c),n.exit()}))},setToolbarGroups:function(n){var e=o.createGroups(n);o.setGroups(e)},setContextToolbar:function(n){var e=o.createGroups(n);o.setContextToolbar(e)},focusToolbar:function(){o.focus()},restoreToolbar:function(){o.restoreToolbar()},updateMode:function(n){Ig(a,c,n,t.root())},socket:i(a),dropup:i(s)}}(u);!function(n,e,t){t(n,e.element());var r=Le(e.element());Mn(r,(function(n){e.getByDom(n).each(Qe)}))}(ye(t),c.system(),$e);var a=t.ownerDocument.defaultView,s=bm(a,{onChange:function(){c.system().broadcastOn([ho.orientationChanged()],{width:xm(a)})},onReady:r}),f=function(n,t,r,o){!1===o&&e.selection.collapse();var i=l(n,t,r);c.setToolbarGroups(!0===o?i.readOnly:i.main),e.setMode(!0===o?"readonly":"design"),e.fire(!0===o?Xp():qp()),c.updateMode(o)},l=function(n,e,t){var r=n.get();return{readOnly:r.backToMask.concat(e.get()),main:r.backToMask.concat(t.get())}},d=function(n,t){return e.on(n,t),{unbind:function(){e.off(n)}}};return e.on("init",(function(){c.init({editor:{getFrame:function(){return ye(e.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:r}},onToReading:function(n){return d(Xp(),n)},onToEditing:function(n){return d(qp(),n)},onScrollToCursor:function(n){return e.on("ScrollIntoView",(function(e){n(e)})),{unbind:function(){e.off("ScrollIntoView"),s.destroy()}}},onTouchToolstrip:function(){t()},onTouchContent:function(){var n;(n=ye(e.editorContainer.querySelector("."+oi.resolve("toolbar"))),go(n).bind((function(n){return c.system().getByDom(n).toOption()}))).each(me),c.restoreToolbar(),t()},onTapContent:function(t){var r=t.target();"img"===Se(r)?(e.selection.select(r.dom()),t.kill()):"a"===Se(r)&&c.system().getByDom(ye(e.editorContainer)).each((function(e){ao.isAlpha(e)&&function(e){var t=n.document.createElement("a");t.target="_blank",t.href=e.href,t.rel="noreferrer noopener";var r=n.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,n.window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.document.body.appendChild(t),t.dispatchEvent(r),n.document.body.removeChild(t)}(r.dom())}))}},container:ye(e.editorContainer),socket:ye(e.contentAreaContainer),toolstrip:ye(e.editorContainer.querySelector("."+oi.resolve("toolstrip"))),toolbar:ye(e.editorContainer.querySelector("."+oi.resolve("toolbar"))),dropup:c.dropup(),alloy:c.system(),translate:r,setReadOnly:function(n){f(p,g,m,n)},readOnlyOnInit:function(){return!1}});var t=function(){c.dropup().disappear((function(){c.system().broadcastOn([ho.dropupDismissed()],{})}))},o={label:"The first group",scrollable:!1,items:[Ya("back",(function(){e.selection.collapse(),c.exit()}),{},e)]},i={label:"Back to read only",scrollable:!1,items:[Ya("readonly-back",(function(){f(p,g,m,!0)}),{},e)]},u=fm(c,e),a=function(n,e){var t=function(n){var e=void 0!==n.toolbar?n.toolbar:cm;return bn(e)?sm(e):am(e)}(n),r={};return jn(t,(function(n){var t=!Et(r,n)&&Et(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return r[n]=!0,t}))}(e.settings,u),l={label:"The extra group",scrollable:!1,items:[]},m=so([{label:"the action group",scrollable:!0,items:a},l]),g=so([{label:"The read only mode group",scrollable:!0,items:[]},l]),p=so({backToMask:[o],backToReadOnly:[i]});!function(n,e){var t=E(e.formatter.get());Mn(t,(function(t){e.formatter.formatChanged(t,(function(e){$p(n,t,e)}))})),Mn(["ul","ol"],(function(t){e.selection.selectorChanged(t,(function(e,r){$p(n,t,e)}))}))}(c,e)})),e.on("remove",(function(){c.exit()})),e.on("detach",(function(){var n,e;n=c.system(),e=Le(n.element()),Mn(e,(function(e){n.getByDom(e).each(Je)})),Ke(n.element()),c.system().destroy()})),{iframeContainer:c.socket().element().dom(),editorContainer:c.element().dom()}}}}))}(window);