!function(t){"use strict";var n=function(){},e=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},o=function(t){return function(){return t}},r=function(t){return t};function i(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var u=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}},a=function(t){return function(){throw new Error(t)}},c=o(!1),s=o(!0),l=tinymce.util.Tools.resolve("tinymce.ThemeManager"),f=function(){return(f=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function d(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}var m,g,p,h,v,b,y,x=c,w=s,S=function(){return k},k=(h={fold:function(t,n){return t()},is:x,isSome:x,isNone:w,getOr:p=function(t){return t},getOrThunk:g=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){},or:p,orThunk:g,map:S,ap:S,each:function(){},bind:S,flatten:S,exists:x,forall:w,filter:S,equals:m=function(t){return t.isNone()},equals_:m,toArray:function(){return[]},toString:o("none()")},Object.freeze&&Object.freeze(h),h),C=function(t){var n=function(){return t},e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:w,isNone:x,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return C(n(t))},ap:function(n){return n.fold(S,(function(n){return C(n(t))}))},each:function(n){n(t)},bind:o,flatten:n,exists:o,forall:o,filter:function(n){return n(t)?r:k},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(x,(function(n){return e(t,n)}))},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},O={some:C,none:S,from:function(t){return null==t?k:C(t)}},T=function(t){return{is:function(n){return t===n},isValue:s,isError:c,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:function(n){return T(t)},orThunk:function(n){return T(t)},fold:function(n,e){return e(t)},map:function(n){return T(n(t))},mapError:function(n){return T(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return O.some(t)}}},E=function(t){return{is:c,isValue:c,isError:s,getOr:r,getOrThunk:function(t){return t()},getOrDie:function(){return a(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return E(t)},mapError:function(n){return E(n(t))},each:n,bind:function(n){return E(t)},exists:c,forall:s,toOption:O.none}},B={value:T,error:E,fromOption:function(t,n){return t.fold((function(){return E(n)}),T)}},_=function(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},A=_("string"),F=_("object"),M=_("array"),D=_("boolean"),I=_("function"),R=_("number"),V=function(t,n){if(M(t)){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e]))return!1;return!0}return!1},N=Array.prototype.slice,H=void 0===(v=Array.prototype.indexOf)?function(t,n){return K(t,n)}:function(t,n){return v.call(t,n)},P=function(t,n){return-1<H(t,n)},z=function(t,n){return q(t,n).isSome()},L=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=N.call(t,o,o+n);e.push(r)}return e},j=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r,t)}return o},U=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e,t)},W=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o,t)&&e.push(i)}return e},G=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e])}(t,(function(t){e=n(e,t)})),e},X=function(t,n,e){return U(t,(function(t){e=n(e,t)})),e},Y=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e,t))return O.some(r)}return O.none()},q=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e,t))return O.some(e);return O.none()},K=function(t,n){for(var e=0,o=t.length;e<o;++e)if(t[e]===n)return e;return-1},J=Array.prototype.push,$=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!M(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);J.apply(n,t[e])}return n},Q=function(t,n){var e=j(t,n);return $(e)},Z=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e,t))return!1;return!0},tt=function(t){var n=N.call(t,0);return n.reverse(),n},nt=function(t,n){return W(t,(function(t){return!P(n,t)}))},et=function(t){return[t]},ot=function(t){return 0===t.length?O.none():O.some(t[0])},rt=function(t){return 0===t.length?O.none():O.some(t[t.length-1])},it=I(Array.from)?Array.from:function(t){return N.call(t)},ut=Object.keys,at=Object.hasOwnProperty,ct=function(t,n){for(var e=ut(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i,t)}},st=function(t,n){return lt(t,(function(t,e,o){return{k:e,v:n(t,e,o)}}))},lt=function(t,n){var e={};return ct(t,(function(o,r){var i=n(o,r,t);e[i.k]=i.v})),e},ft=function(t,n){var e=[];return ct(t,(function(t,o){e.push(n(t,o))})),e},dt=function(t){return ft(t,(function(t){return t}))},mt=function(t,n){return gt(t,n)?O.from(t[n]):O.none()},gt=function(t,n){return at.call(t,n)},pt=function(n){if(!M(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],o={};return U(n,(function(r,i){var u=ut(r);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=r[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!M(c))throw new Error("case arguments must be an array");e.push(a),o[a]=function(){var o=arguments.length;if(o!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+o);for(var r=new Array(o),u=0;u<r.length;u++)r[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[i].apply(null,r)},match:function(t){var n=ut(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!Z(e,(function(t){return P(n,t)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[a].apply(null,r)},log:function(n){t.console.log(n,{constructors:e,constructor:a,params:r})}}}})),o},ht=Object.prototype.hasOwnProperty,vt=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)ht.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},bt=vt((function(t,n){return F(t)&&F(n)?bt(t,n):n})),yt=vt((function(t,n){return n})),xt=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},wt=pt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),St=function(t){return wt.defaultedThunk(o(t))},kt=wt.strict,Ct=wt.asOption,Ot=wt.defaultedThunk,Tt=wt.mergeWithThunk,Et=function(t){return function(n){return gt(n,t)?O.from(n[t]):O.none()}},Bt=function(t,n){return Et(n)(t)},_t=function(t,n){var e={};return e[t]=n,e},At=(pt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){return e=n,o={},ct(t,(function(t,n){P(e,n)||(o[n]=t)})),o;var e,o}),Ft=function(t){return Et(t)},Mt=function(t,n){return e=t,o=n,function(t){return gt(t,e)?t[e]:o};var e,o},Dt=function(t,n){return Bt(t,n)},It=function(t,n){return _t(t,n)},Rt=function(t){return n={},U(t,(function(t){n[t.key]=t.value})),n;var n},Vt=function(t,n){return gt(e=t,o=n)&&void 0!==e[o]&&null!==e[o];var e,o};(y=b||(b={}))[y.Error=0]="Error",y[y.Value=1]="Value";var Nt=function(t,n,e){return t.stype===b.Error?n(t.serror):e(t.svalue)},Ht=function(t){return{stype:b.Value,svalue:t}},Pt=function(t){return{stype:b.Error,serror:t}},zt=Ht,Lt=function(t){var n=[],e=[];return U(t,(function(t){Nt(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},jt=Pt,Ut=function(t,n){return t.stype===b.Value?n(t.svalue):t},Wt=function(t,n){return t.stype===b.Value?{stype:b.Value,svalue:n(t.svalue)}:t},Gt=function(t){return e(jt,$)(t)},Xt=pt([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),Yt=pt([{field:["name","presence","type"]},{state:["name"]}]),qt=function(t){return F(t)&&100<ut(t).length?" removed due to size":JSON.stringify(t,null,2)},Kt=function(t,n){return jt([{path:t,getErrorInfo:n}])},Jt=pt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),$t=function(t,n,e){var o=Bt(t,n).fold((function(){return e(t)}),r);return zt(o)},Qt=function(t){return{extract:function(n,e,o){return function(t){return t.stype===b.Error?function(t){return e=t,Kt(n,(function(){return e}));var e}(t.serror):t}(t(o,e))},toString:function(){return"val"},toDsl:function(){return Xt.itemOf(t)}}},Zt=function(t){var n=tn(t),e=G(t,(function(t,n){return n.fold((function(n){return bt(t,It(n,!0))}),o(t))}),{});return{extract:function(t,o,r){var i,u,a,c=D(r)?[]:(u=ut(i=r),W(u,(function(t){return Vt(i,t)}))),s=W(c,(function(t){return!Vt(e,t)}));return 0===s.length?n.extract(t,o,r):(a=s,Kt(t,(function(){return"There are unsupported fields: ["+a.join(", ")+"] specified"})))},toString:n.toString,toDsl:n.toDsl}},tn=function(t){return{extract:function(n,e,r){return i=n,u=r,a=e,c=j(t,(function(t){return function(t,n,e,r){return e.fold((function(e,i,u,a){var c=function(n){var o=a.extract(t.concat([e]),r,n);return Wt(o,(function(t){return _t(i,r(t))}))},s=function(n){return n.fold((function(){var t=_t(i,r(O.none()));return zt(t)}),(function(n){var o=a.extract(t.concat([e]),r,n);return Wt(o,(function(t){return _t(i,r(O.some(t)))}))}))};return u.fold((function(){return Ut(function(t,n,e){return Bt(n,e).fold((function(){return o=e,r=n,Kt(t,(function(){return'Could not find valid *strict* value for "'+o+'" in '+qt(r)}));var o,r}),zt)}(t,n,e),c)}),(function(t){return Ut($t(n,e,t),c)}),(function(){return Ut(zt(Bt(n,e)),s)}),(function(t){return Ut((r=t,i=Bt(o=n,e).map((function(t){return!0===t?r(o):t})),zt(i)),s);var o,r,i}),(function(t){var r=t(n),i=Wt($t(n,e,o({})),(function(t){return bt(r,t)}));return Ut(i,c)}))}),(function(t,e){var o=e(n);return zt(_t(t,r(o)))}))}(i,u,t,a)})),function(t){var n,e,o=Lt(t);return 0<o.errors.length?Gt(o.errors):(e={},0<(n=o.values).length?zt(bt(e,yt.apply(void 0,n))):zt(e))}(c);var i,u,a,c},toString:function(){return"obj{\n"+j(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"},toDsl:function(){return Xt.objOf(j(t,(function(t){return t.fold((function(t,n,e,o){return Yt.field(t,e,o)}),(function(t,n){return Yt.state(t)}))})))}}},nn=function(t){return{extract:function(n,e,o){var r=j(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}));return function(t){var n=Lt(t);return 0<n.errors.length?Gt(n.errors):zt(n.values)}(r)},toString:function(){return"array("+t.toString()+")"},toDsl:function(){return Xt.arrOf(t)}}},en=o(Qt(zt)),on=e(nn,tn),rn=Jt.state,un=Jt.field,an=function(t,n){return{extract:function(e,o,r){return Dt(r,t).fold((function(){return n=t,Kt(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}));var n}),(function(t){return function(t,n,e,o,r){return Dt(o,r).fold((function(){return n=o,e=r,Kt(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+qt(n)}));var n,e}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))}(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+ut(n)},toDsl:function(){return Xt.choiceOf(t,n)}}},cn=Qt(zt),sn=function(t){return Qt((function(n){return t(n).fold(jt,zt)}))},ln=function(t,n){return function(t,n){return{extract:function(e,o,i){var u,a,c=ut(i),s=(u=e,a=c,nn(Qt(t)).extract(u,r,a));return Ut(s,(function(t){var r=j(t,(function(t){return Jt.field(t,t,kt(),n)}));return tn(r).extract(e,o,i)}))},toString:function(){return"setOf("+n.toString()+")"},toDsl:function(){return Xt.setOf(t,n)}}}((function(n){return function(t){return t.fold(Pt,Ht)}(t(n))}),n)},fn=function(t,n,e){return function(t){return Nt(t,B.error,B.value)}((o=t,i=r,u=e,function(t){return t.stype===b.Error?{stype:b.Error,serror:function(t){return{input:u,errors:t}}(t.serror)}:t}(n.extract([o],i,u))));var o,i,u},dn=function(t){return t.fold((function(t){throw new Error(gn(t))}),r)},mn=function(t,n,e){return dn(fn(t,n,e))},gn=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,j(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))+"\n\nInput object: ")+qt(t.input);var n,e},pn=function(t,n){return an(t,n)},hn=function(t,n){return an(t,st(n,tn))},vn=o(cn),bn=function(t,n){return Qt((function(e){var o=typeof e;return t(e)?zt(e):jt("Expected type: "+n+" but got: "+o)}))},yn=bn(R,"number"),xn=bn(A,"string"),wn=bn(D,"boolean"),Sn=bn(I,"function"),kn=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return kn(t[n])}));case"Map":return n(t.keys(),kn)&&n(t.values(),kn);case"Set":return n(t.keys(),kn);default:return!1}},Cn=Qt((function(t){return kn(t)?zt(t):jt("Expected value to be acceptable for sending via postMessage")})),On=function(t){return sn((function(n){return P(t,n)?B.value(n):B.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Tn=function(t){return un(t,t,kt(),en())},En=function(t,n){return un(t,t,kt(),n)},Bn=function(t){return En(t,xn)},_n=function(t,n){return un(t,t,kt(),On(n))},An=function(t){return En(t,Sn)},Fn=function(t,n){return un(t,t,kt(),tn(n))},Mn=function(t,n){return un(t,t,kt(),on(n))},Dn=function(t,n){return un(t,t,kt(),nn(n))},In=function(t){return un(t,t,Ct(),en())},Rn=function(t,n){return un(t,t,Ct(),n)},Vn=function(t){return Rn(t,yn)},Nn=function(t){return Rn(t,xn)},Hn=function(t){return Rn(t,Sn)},Pn=function(t,n){return Rn(t,tn(n))},zn=function(t,n){return un(t,t,St(n),en())},Ln=function(t,n,e){return un(t,t,St(n),e)},jn=function(t,n){return Ln(t,n,yn)},Un=function(t,n){return Ln(t,n,xn)},Wn=function(t,n,e){return Ln(t,n,On(e))},Gn=function(t,n){return Ln(t,n,wn)},Xn=function(t,n){return Ln(t,n,Sn)},Yn=function(t,n,e){return Ln(t,n,tn(e))},qn=function(t,n){return rn(t,n)},Kn=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return Kn(e())}}},Jn=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},$n=function(n,e){var o=(e||t.document).createElement("div");if(o.innerHTML=n,!o.hasChildNodes()||1<o.childNodes.length)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Jn(o.childNodes[0])},Qn=function(n,e){var o=(e||t.document).createElement(n);return Jn(o)},Zn=function(n,e){var o=(e||t.document).createTextNode(n);return Jn(o)},te=Jn,ne=function(){return ee(0,0)},ee=function(t,n){return{major:t,minor:n}},oe=function(t,n){var e=String(n).toLowerCase();return 0===t.length?ne():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return ee(o(1),o(2))}(t,e)},re=ne,ie="Firefox",ue=function(t,n){return function(){return n===t}},ae=function(t){var n=t.current;return{current:n,version:t.version,isEdge:ue("Edge",n),isChrome:ue("Chrome",n),isIE:ue("IE",n),isOpera:ue("Opera",n),isFirefox:ue(ie,n),isSafari:ue("Safari",n)}},ce=function(){return ae({current:void 0,version:re()})},se=ae,le=(o("Edge"),o("Chrome"),o("IE"),o("Opera"),o(ie),o("Safari"),"Windows"),fe="Android",de="Solaris",me="FreeBSD",ge=function(t,n){return function(){return n===t}},pe=function(t){var n=t.current;return{current:n,version:t.version,isWindows:ge(le,n),isiOS:ge("iOS",n),isAndroid:ge(fe,n),isOSX:ge("OSX",n),isLinux:ge("Linux",n),isSolaris:ge(de,n),isFreeBSD:ge(me,n)}},he=function(){return pe({current:void 0,version:re()})},ve=pe,be=(o(le),o("iOS"),o(fe),o("Linux"),o("OSX"),o(de),o(me),function(t,n){var e=String(n).toLowerCase();return Y(t,(function(t){return t.search(e)}))}),ye=function(t,n){return-1!==t.indexOf(n)},xe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,we=function(t){return function(n){return ye(n,t)}},Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ye(t,"edge/")&&ye(t,"chrome")&&ye(t,"safari")&&ye(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xe],search:function(t){return ye(t,"chrome")&&!ye(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ye(t,"msie")||ye(t,"trident")}},{name:"Opera",versionRegexes:[xe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:we("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:we("firefox")},{name:"Safari",versionRegexes:[xe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ye(t,"safari")||ye(t,"mobile/"))&&ye(t,"applewebkit")}}],ke=[{name:"Windows",search:we("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ye(t,"iphone")||ye(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:we("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:we("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:we("linux"),versionRegexes:[]},{name:"Solaris",search:we("sunos"),versionRegexes:[]},{name:"FreeBSD",search:we("freebsd"),versionRegexes:[]}],Ce={browsers:o(Se),oses:o(ke)},Oe={detect:xt((function(){return function(t){var n,e,r,i,u,a,c,s,l,f,d,m=Ce.browsers(),g=Ce.oses(),p=function(t,n){return be(t,n).map((function(t){var e=oe(t.versionRegexes,n);return{current:t.name,version:e}}))}(m,t).fold(ce,se),h=function(t,n){return be(t,n).map((function(t){var e=oe(t.versionRegexes,n);return{current:t.name,version:e}}))}(g,t).fold(he,ve);return{browser:p,os:h,deviceType:(e=p,r=t,i=(n=h).isiOS()&&!0===/ipad/i.test(r),u=n.isiOS()&&!i,a=n.isAndroid()&&3===n.version.major,c=n.isAndroid()&&4===n.version.major,s=i||a||c&&!0===/mobile/i.test(r),l=n.isiOS()||n.isAndroid(),f=l&&!s,d=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),{isiPad:o(i),isiPhone:o(u),isTablet:o(s),isPhone:o(f),isTouch:o(l),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:o(d)})}}(t.navigator.userAgent)}))},Te=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE),Ee=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),Be=t.Node.TEXT_NODE,_e=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,Ee),Ae=Te,Fe=function(t,n){var e=t.dom();if(e.nodeType!==_e)return!1;if(void 0!==e.matches)return e.matches(n);if(void 0!==e.msMatchesSelector)return e.msMatchesSelector(n);if(void 0!==e.webkitMatchesSelector)return e.webkitMatchesSelector(n);if(void 0!==e.mozMatchesSelector)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Me=function(t){return t.nodeType!==_e&&t.nodeType!==Ae||0===t.childElementCount},De=function(n,e){var o=void 0===e?t.document:e.dom();return Me(o)?[]:j(o.querySelectorAll(n),te)},Ie=function(t,n){return t.dom()===n.dom()},Re=(Oe.detect().browser.isIE(),function(t,n){return Ie(t.element(),n.event().target())}),Ve=function(t){if(!Vt(t,"can")&&!Vt(t,"abort")&&!Vt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return mn("Extracting event.handler",Zt([zn("can",o(!0)),zn("abort",o(!1)),zn("run",n)]),t)},Ne=o("touchstart"),He=o("touchmove"),Pe=o("touchend"),ze=o("mousedown"),Le=o("mousemove"),je=o("mouseout"),Ue=o("mouseup"),We=o("mouseover"),Ge=o("focusin"),Xe=o("focusout"),Ye=o("keydown"),qe=o("keyup"),Ke=o("input"),Je=o("change"),$e=o("click"),Qe=o("transitionend"),Ze=o("selectstart"),to={tap:o("alloy.tap")},no=o("alloy.focus"),eo=o("alloy.blur.post"),oo=o("alloy.paste.post"),ro=o("alloy.receive"),io=o("alloy.execute"),uo=o("alloy.focus.item"),ao=to.tap,co=Oe.detect().deviceType.isTouch()?to.tap:$e,so=o("alloy.longpress"),lo=o("alloy.sandbox.close"),fo=o("alloy.typeahead.cancel"),mo=o("alloy.system.init"),go=o("alloy.system.scroll"),po=o("alloy.system.resize"),ho=o("alloy.system.attached"),vo=o("alloy.system.detached"),bo=o("alloy.system.dismissRequested"),yo=o("alloy.focusmanager.shifted"),xo=o("alloy.slotcontainer.visibility"),wo=o("alloy.change.tab"),So=o("alloy.dismiss.tab"),ko=o("alloy.highlight"),Co=o("alloy.dehighlight"),Oo=function(t,n){_o(t,t.element(),n,{})},To=function(t,n,e){_o(t,t.element(),n,e)},Eo=function(t){Oo(t,io())},Bo=function(t,n,e){_o(t,n,e,{})},_o=function(t,n,e,r){var i=f({target:n},r);t.getSystem().triggerEvent(e,n,st(i,o))},Ao=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event())};function Fo(t,n,e,o,r){return t(e,o)?O.some(e):I(r)&&r(e)?O.none():n(e,o,r)}var Mo,Do,Io,Ro,Vo,No=function(t){return t.dom().nodeName.toLowerCase()},Ho=function(t){return function(n){return n.dom().nodeType===t}},Po=Ho(Ee),zo=Ho(Be),Lo=Ho(Te),jo=function(t){var n=zo(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)},Uo=xt((function(){return Wo(te(t.document))})),Wo=function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return te(n)},Go=function(t,n,e){for(var r=t.dom(),i=I(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=te(r);if(n(u))return O.some(u);if(i(u))break}return O.none()},Xo=function(t,n,e){return Fo((function(t){return n(t)}),Go,t,n,e)},Yo=function(t,n,e){return Xo(t,(function(t){return n(t).isSome()}),e).bind(n)},qo=function(t){return Rt(t)},Ko=function(t,n){return{key:t,value:Ve({abort:n})}},Jo=function(t){return{key:t,value:Ve({run:function(t,n){n.event().prevent()}})}},$o=function(t,n){return{key:t,value:Ve({run:n})}},Qo=function(t,n,e){return{key:t,value:Ve({run:function(t){n.apply(void 0,[t].concat(e))}})}},Zo=function(t){return function(n){return{key:t,value:Ve({run:function(t,e){Re(t,e)&&n(t,e)}})}}},tr=function(t,n,e){var o,r,i=n.partUids[e];return r=i,$o(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){Ao(t,t.element(),o,n)}))}))},nr=function(t,n){return $o(t,(function(t,e){var r=e.event(),i=t.getSystem().getByDom(r.target()).fold((function(){return Yo(r.target(),(function(n){return t.getSystem().getByDom(n).toOption()}),o(!1)).getOr(t)}),(function(t){return t}));n(t,i,e)}))},er=function(t){return $o(t,(function(t,n){n.cut()}))},or=function(t,n){return Zo(t)(n)},rr=Zo(ho()),ir=Zo(vo()),ur=Zo(mo()),ar=(Mo=io(),function(t){return $o(Mo,t)}),cr=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return U(t,(function(t,e){r[t]=o(n[e])})),r}},sr=function(t){return t.slice(0).sort()},lr=function(t,n){if(!M(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");U(n,(function(n){if(!A(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")}))},fr=function(t,n){var e,r=t.concat(n);if(0===r.length)throw new Error("You must specify at least one required or optional field.");return lr("required",t),lr("optional",n),e=sr(r),Y(e,(function(t,n){return n<e.length-1&&t===e[n+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})),function(e){var i=ut(e);Z(t,(function(t){return P(i,t)}))||function(t,n){throw new Error("All required keys ("+sr(t).join(", ")+") were not specified. Specified keys were: "+sr(n).join(", ")+".")}(t,i);var u=W(i,(function(t){return!P(r,t)}));0<u.length&&function(t){throw new Error("Unsupported keys for object: "+sr(t).join(", "))}(u);var a={};return U(t,(function(t){a[t]=o(e[t])})),U(n,(function(t){a[t]=o(Object.prototype.hasOwnProperty.call(e,t)?O.some(e[t]):O.none())})),a}},dr=function(t){return te(t.dom().ownerDocument)},mr=function(t){var n=t.dom().ownerDocument.defaultView;return te(n)},gr=function(t){var n=t.dom();return O.from(n.parentNode).map(te)},pr=function(t){var n=t.dom();return O.from(n.offsetParent).map(te)},hr=function(t){var n=t.dom();return j(n.childNodes,te)},vr=function(t,n){var e=t.dom().childNodes;return O.from(e[n]).map(te)},br=(cr("element","offset"),function(t,n){gr(t).each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))}),yr=function(t,n){var e;(e=t.dom(),O.from(e.nextSibling).map(te)).fold((function(){gr(t).each((function(t){wr(t,n)}))}),(function(t){br(t,n)}))},xr=function(t,n){vr(t,0).fold((function(){wr(t,n)}),(function(e){t.dom().insertBefore(n.dom(),e.dom())}))},wr=function(t,n){t.dom().appendChild(n.dom())},Sr=function(t,n){U(n,(function(n){wr(t,n)}))},kr=function(t){t.dom().textContent="",U(hr(t),(function(t){Cr(t)}))},Cr=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},Or=function(t){var n,e=hr(t);0<e.length&&(n=t,U(e,(function(t){br(n,t)}))),Cr(t)},Tr=function(t){return t.dom().innerHTML},Er=function(n,e){var o,r,i=dr(n).dom(),u=te(i.createDocumentFragment()),a=(o=e,(r=(i||t.document).createElement("div")).innerHTML=o,hr(te(r)));Sr(u,a),kr(n),wr(n,u)},Br=function(n,e,o){if(!(A(o)||D(o)||R(o)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",o,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,o+"")},_r=function(t,n,e){Br(t.dom(),n,e)},Ar=function(t,n){var e=t.dom();ct(n,(function(t,n){Br(e,n,t)}))},Fr=function(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e},Mr=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Dr=function(t,n){t.dom().removeAttribute(n)},Ir=function(t){return function(t){var n,e,o,r=function(t){return te(t.dom().cloneNode(!1))}(t);return n=r,e=Qn("div"),o=te(n.dom().cloneNode(!0)),wr(e,o),Tr(e)}(t)},Rr=qo([(Do=no(),Io=function(n,e){var o,r,i=e.event().originator(),u=e.event().target();return r=u,!(Ie(o=i,n.element())&&!Ie(o,r)&&(t.console.warn(no()+" did not get interpreted by the desired target. \nOriginator: "+Ir(i)+"\nTarget: "+Ir(u)+"\nCheck the "+no()+" event handlers"),1))},{key:Do,value:Ve({can:Io})})]),Vr=Object.freeze({events:Rr}),Nr=0,Hr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Nr+String(n)},Pr=o("alloy-id-"),zr=o("data-alloy-id"),Lr=Pr(),jr=zr(),Ur=function(t,n){Object.defineProperty(t.dom(),jr,{value:n,writable:!0})},Wr=function(t){var n=Po(t)?t.dom()[jr]:null;return O.from(n)},Gr=function(t){return Hr(t)},Xr=r,Yr=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+"\n"+Ir(t().element())+" is not in context.")}};return{debugInfo:o("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:o(!1)}},qr=Yr(),Kr=function(t){return j(t,(function(t){return e="/*",o=(n=t).length-2,n.length<2||n.substr(o,o+2)!==e?t:t.substring(0,t.length-2);var n,e,o}))},Jr=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Kr(i)}},t},$r=Hr("alloy-premade"),Qr=function(t){return It($r,t)},Zr=function(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,[n.getApis()].concat([n].concat(e)))},o=(e=t.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Kr(i.slice(1))}},n;var n,e,o,r,i},ti={init:function(){return ni({readState:function(){return"No State required"}})}},ni=function(t){return t},ei=function(t,n){var e={};return ct(t,(function(t,o){ct(t,(function(t,r){var i=Mt(r,[])(e);e[r]=i.concat([n(o,t)])}))})),e},oi=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},ri=function(t){return t.cHandler},ii=function(t,n){return{name:o(t),handler:o(n)}},ui=function(t,n){var r=ft(t,(function(t,e){return(1===t.length?B.value(t[0].handler()):function(t,n,e){var o,r,i=n[e];return i?function(t,n,e,o){var r=e.slice(0);try{var i=r.sort((function(e,r){var i=e[n](),u=r[n](),a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return B.value(i)}catch(t){return B.error([t])}}("Event: "+e,"name",t,i).map((function(t){var n=j(t,(function(t){return t.handler()}));return function(t){var n,e,o,r,i=(n=t,e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return X(n,(function(n,o){return n&&e(o).apply(void 0,t)}),!0)}),u=(o=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return X(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)});return Ve({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];U(t,(function(t){t.run.apply(void 0,n)}))}})}(n)})):(o=e,r=t,B.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(j(r,(function(t){return t.name()})),null,2)]))}(t,n,e)).map((function(r){var i=function(t){var n,e=I(n=t)?{can:o(!0),abort:o(!1),run:n}:n;return function(t,n){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,n].concat(o);e.abort.apply(void 0,i)?n.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}}(r),u=1<t.length?W(n,(function(n){return P(t,(function(t){return t.name()===n}))})).join(" > "):t[0].name();return It(e,{handler:i,purpose:o(u)})}))}));return function(t){var n,o,r,i,u,a=(n=[],o=[],U(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){o.push(t)}))})),{errors:n,values:o});return 0<a.errors.length?(u=a.errors,e(B.error,$)(u)):(i={},0===(r=a.values).length?B.value(i):B.value(bt(i,yt.apply(void 0,r))))}(r)},ai=function(t,n){var e=Fr(t,n);return void 0===e||""===e?[]:e.split(" ")},ci=function(t){return void 0!==t.dom().classList},si=function(t,n){ci(t)?t.dom().classList.add(n):function(t,n){return o=n,r=ai(e=t,"class").concat([o]),_r(e,"class",r.join(" ")),!0;var e,o,r}(t,n)},li=function(t,n){ci(t)?t.dom().classList.remove(n):function(t,n){return r=n,0<(i=W(ai(e=t,o="class"),(function(t){return t!==r}))).length?_r(e,o,i.join(" ")):Dr(e,o),!1;var e,o,r,i}(t,n),function(t){0===(ci(t)?t.dom().classList:ai(t,"class")).length&&Dr(t,"class")}(t)},fi=function(t,n){return ci(t)&&t.dom().classList.contains(n)},di=function(t,n){U(n,(function(n){si(t,n)}))},mi=function(t,n){U(n,(function(n){li(t,n)}))},gi=function(t){return void 0!==t.style&&I(t.style.getPropertyValue)},pi=function(n,e,o){if(!A(o))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",o,":: Element ",n),new Error("CSS value must be a string: "+o);gi(n)&&n.style.setProperty(e,o)},hi=function(t,n){gi(t)&&t.style.removeProperty(n)},vi=function(t,n,e){var o=t.dom();pi(o,n,e)},bi=function(t,n){var e=t.dom();ct(n,(function(t,n){pi(e,n,t)}))},yi=function(n,e){var o=n.dom(),r=t.window.getComputedStyle(o).getPropertyValue(e),i=""!==r||jo(n)?r:xi(o,e);return null===i?void 0:i},xi=function(t,n){return gi(t)?t.style.getPropertyValue(n):""},wi=function(t,n){var e=t.dom(),o=xi(e,n);return O.from(o).filter((function(t){return 0<t.length}))},Si=function(t,n,e){var o=Qn(t);return vi(o,n,e),wi(o,n).isSome()},ki=function(t,n){var e=t.dom();hi(e,n),Mr(t,"style")&&""===Fr(t,"style").replace(/^\s+|\s+$/g,"")&&Dr(t,"style")},Ci=function(t){return t.dom().offsetWidth},Oi=function(t){return t.dom().value},Ti=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom().value=n},Ei=function(t){var n=function(){return d},e=Kn(qr),r=dn(function(t){return fn("custom.definition",tn([un("dom","dom",kt(),tn([Tn("tag"),zn("styles",{}),zn("classes",[]),zn("attributes",{}),In("value"),In("innerHtml")])),Tn("components"),Tn("uid"),zn("events",{}),zn("apis",{}),un("eventOrder","eventOrder",(n={"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]},wt.mergeWithThunk(o(n))),vn()),In("domModification")]),t);var n}(t)),i=function(t){var n,e,o,r=(n=t,e=Mt("behaviours",{})(n),o=W(ut(e),(function(t){return void 0!==e[t]})),j(o,(function(t){return e[t].me})));return function(t,n){return e=t,r=j(o=n,(function(t){return Pn(t.name(),[Tn("config"),zn("state",ti)])})),i=fn("component.behaviours",tn(r),e.behaviours).fold((function(t){throw new Error(gn(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),(function(t){return t})),{list:o,data:st(i,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))};var e,o,r,i}(t,r)}(t),u=i.list,a=i.data,c=function(t){var n=Qn(t.tag);Ar(n,t.attributes),di(n,t.classes),bi(n,t.styles),t.innerHtml.each((function(t){return Er(n,t)}));var e=t.domChildren;return Sr(n,e),t.value.each((function(t){Ti(n,t)})),t.uid,Ur(n,t.uid),n}(function(t,n,e){var o,r,i,u=f({},(o=t).dom,{uid:o.uid,domChildren:j(o.components,(function(t){return t.element()}))}),a=t.domModification.fold((function(){return oi({})}),oi),c={"alloy.base.modification":a},s=0<n.length?function(t,n,e,o){var r=f({},n);U(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=ei(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return G(t,(function(t,n){return f({},n.modification,t)}),{})},a=G(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return oi({classes:a,attributes:c,styles:s})}(e,c,n,u):a;return i=s,f({},r=u,{attributes:f({},r.attributes,i.attributes),styles:f({},r.styles,i.styles),classes:r.classes.concat(i.classes)})}(r,u,a)),s=function(t,n,e){var o,r,i,u,a,c,s={"alloy.base.behaviour":(o=t,o.events)};return(r=e,i=t.eventOrder,u=n,a=s,c=function(t,n,e){var o,r,i=f({},e,(o=t,r={},U(n,(function(t){r[t.name()]=t.handlers(o)})),r));return ei(i,ii)}(r,u,a),ui(c,i)).getOrDie()}(r,u,a),l=Kn(r.components),d={getSystem:e.get,config:function(n){var e=a;return(I(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return I(a[t.name()])},spec:o(t),readState:function(t){return a[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return r.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(Yr(n))},element:o(c),syncComponents:function(){var t=hr(c),n=Q(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));l.set(n)},components:l.get,events:o(s)};return d},Bi=function(t){var n=Zn(t);return _i({element:n})},_i=function(t){var e=mn("external.component",Zt([Tn("element"),In("uid")]),t),r=Kn(Yr());e.uid.each((function(t){Ur(e.element,t)}));var i={getSystem:r.get,config:O.none,hasConfigured:o(!1),connect:function(t){r.set(t)},disconnect:function(){r.set(Yr((function(){return i})))},getApis:function(){return{}},element:o(e.element),spec:o(t),readState:o("No state"),syncComponents:n,components:o([]),events:o({})};return Qr(i)},Ai=Gr,Fi=function(t){return(n=t,Dt(n,$r)).fold((function(){return function(t){var n,e,o=Xr(t),r=o.events,i=d(o,["events"]),u=(n=i,e=Mt("components",[])(n),j(e,Fi)),a=f({},i,{events:f({},Vr,r),components:u});return B.value(Ei(a))}(t.hasOwnProperty("uid")?t:f({uid:Ai("")},t)).getOrDie()}),(function(t){return t}));var n},Mi=Qr,Di=function(t,n,e){return Go(t,(function(t){return Fe(t,n)}),e)},Ii=function(n,e){return o=e,i=void 0===(r=n)?t.document:r.dom(),Me(i)?O.none():O.from(i.querySelector(o)).map(te);var o,r,i},Ri=function(t,n,e){return Fo(Fe,Di,t,n,e)},Vi=function(){var t=Hr("aria-owns");return{id:o(t),link:function(n){_r(n,"aria-owns",t)},unlink:function(t){Dr(t,"aria-owns")}}},Ni=function(t,n){return e=n,i=o(!(r=function(n){return Ie(n,t.element())})),Xo(e,r,i).isSome()||function(t,n){return(e=n,Xo(e,(function(t){if(!Po(t))return!1;var n=Fr(t,"id");return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Fr(t,"id"),e=dr(t);return Ii(e,'[aria-owns="'+n+'"]')}))).exists((function(n){return Ni(t,n)}));var e}(t,n);var e,r,i},Hi=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Pi=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return O.none()};(Vo=Ro||(Ro={}))[Vo.STOP=0]="STOP",Vo[Vo.NORMAL=1]="NORMAL",Vo[Vo.LOGGING=2]="LOGGING";var zi=Kn({}),Li=["alloy/data/Fields","alloy/debugging/Debugging"],ji=function(n,e,o){return function(n,e,o){var r,i,u,a;switch(Dt(zi.get(),n).orThunk((function(){var t=ut(zi.get());return Pi(t,(function(t){return-1<n.indexOf(t)?O.some(zi.get()[t]):O.none()}))})).getOr(Ro.NORMAL)){case Ro.NORMAL:return o(Ui());case Ro.LOGGING:var c=(r=n,i=e,u=[],a=(new Date).getTime(),{logEventCut:function(t,n,e){u.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){u.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){u.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){u.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){u.push({outcome:"response",purpose:e,target:n})},write:function(){var n=(new Date).getTime();P(["mousemove","mouseover","mouseout",mo()],r)||t.console.log(r,{event:r,time:n-a,target:i.dom(),sequence:j(u,(function(t){return P(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Ir(t.target)+")":t.outcome}))})}}),s=o(c);return c.write(),s;case Ro.STOP:return!0}}(n,e,o)},Ui=o({logEventCut:n,logEventStopped:n,logNoParent:n,logEventNoHandlers:n,logEventResponse:n,write:n}),Wi=o([Tn("menu"),Tn("selectedMenu")]),Gi=o([Tn("item"),Tn("selectedItem")]),Xi=(o(tn(Gi().concat(Wi()))),o(tn(Gi()))),Yi=Fn("initSize",[Tn("numColumns"),Tn("numRows")]),qi=function(){return Fn("markers",[Tn("backgroundMenu")].concat(Wi()).concat(Gi()))},Ki=function(t){return Fn("markers",j(t,Tn))},Ji=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");Y(n,(function(t){return 0<t.indexOf("alloy")&&!z(Li,(function(n){return-1<t.indexOf(n)}))})).getOr("unknown")}}(),un(n,n,e,sn((function(t){return B.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},$i=function(t){return Ji(0,t,St(n))},Qi=function(t){return Ji(0,t,St(O.none))},Zi=function(t){return Ji(0,t,kt())},tu=function(t){return Ji(0,t,kt())},nu=function(t,n){return qn(t,o(n))},eu=function(t){return qn(t,r)},ou=o(Yi),ru=function(t,n,e){return ur((function(o,r){e(o,t,n)}))},iu=function(t){return{key:t,value:void 0}},uu=function(t,n,e,r,u,a,c){var s=function(t){return Vt(t,e)?t[e]():O.none()},l=st(u,(function(t,n){return function(t,n,e){var r,i,u,a,c,s;return r=function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[r].concat(i);return r.config({name:o(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(a,1);return n.apply(void 0,[r,t.config,t.state].concat(e))}))},i=e,a=(u=n.toString()).indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:i,parameters:Kr(s.slice(0,1).concat(s.slice(3)))}},r}(e,t,n)})),d=st(a,(function(t,n){return Jr(t,n)})),m=f({},d,l,{revoke:i(iu,e),config:function(n){var o=mn(e+"-config",t,n);return{key:e,value:{config:o,me:m,configAsRaw:xt((function(){return mn(e+"-config",t,n)})),initialConfig:n,state:c}}},schema:function(){return n},exhibit:function(t,n){return s(t).bind((function(t){return Dt(r,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(oi({}))},name:function(){return e},handlers:function(t){return s(t).map((function(t){return Mt("events",(function(t,n){return{}}))(r)(t.config,t.state)})).getOr({})}});return m},au=function(t){return Rt(t)},cu=Zt([Tn("fields"),Tn("name"),zn("active",{}),zn("apis",{}),zn("state",ti),zn("extra",{})]),su=function(t){var n=mn("Creating behaviour: "+t.name,cu,t);return function(t,n,e,o,r,i){var u,a=Zt(t),c=Pn(n,[(u=t,Rn("config",Zt(u)))]);return uu(a,c,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},lu=Zt([Tn("branchKey"),Tn("branches"),Tn("name"),zn("active",{}),zn("apis",{}),zn("state",ti),zn("extra",{})]),fu=function(t){var n,e,o,r,i,u,a,c,s=mn("Creating behaviour: "+t.name,lu,t);return n=hn(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=Pn(e,[Rn("config",a=n)]),uu(a,c,e,o,r,i,u)},du=o(void 0),mu=Object.freeze({events:function(t){return qo([$o(ro(),(function(n,e){var o,r,i=t.channels,u=(o=ut(i),(r=e).universal()?o:W(o,(function(t){return P(r.channels(),t)})));U(u,(function(t){var o=i[t],r=o.schema,u=mn("channel["+t+"] data\nReceiver: "+Ir(n.element()),r,e.data());o.onReceive(n,u)}))}))])}}),gu=[En("channels",ln(B.value,Zt([Zi("onReceive"),zn("schema",vn())])))],pu=su({fields:gu,name:"receiving",active:mu}),hu=Object.freeze({exhibit:function(t,n){return oi({classes:[],styles:n.useFixed?{}:{position:"relative"}})}}),vu=function(t,n){return{left:o(t),top:o(n),translate:function(e,o){return vu(t+e,n+o)}}},bu=vu,yu=function(t,n){return void 0!==t?t:void 0!==n?n:0},xu=function(n){var e,o,r=n.dom().ownerDocument,i=r.body,u=(o=(e=te(r)).dom())===o.window&&e instanceof t.Window?e:Lo(e)?o.defaultView||o.parentWindow:null,a=r.documentElement,c=yu(u.pageYOffset,a.scrollTop),s=yu(u.pageXOffset,a.scrollLeft),l=yu(a.clientTop,i.clientTop),f=yu(a.clientLeft,i.clientLeft);return wu(n).translate(s-f,c-l)},wu=function(n){var e,o,r,u=n.dom(),a=u.ownerDocument,c=a.body,s=te(a.documentElement);return c===u?bu(c.offsetLeft,c.offsetTop):(e=n,o=s||te(t.document.documentElement),Go(e,i(Ie,o)).isSome()?(r=u.getBoundingClientRect(),bu(r.left,r.top)):bu(0,0))};function Su(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=yi(e,t);return parseFloat(r)||0}return o},o=function(t,n){return X(n,(function(n,e){var o=yi(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!R(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom();gi(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}}var ku,Cu,Ou=Su("height",(function(t){var n=t.dom();return jo(t)?n.getBoundingClientRect().height:n.offsetHeight})),Tu=function(t){return Ou.get(t)},Eu=function(t){return Ou.getOuter(t)},Bu=Su("width",(function(t){return t.dom().offsetWidth})),_u=function(t){return Bu.get(t)},Au=function(t){return Bu.getOuter(t)},Fu=(Oe.detect().browser.isSafari(),function(n){var e=void 0!==n?n.dom():t.document,o=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return bu(o,r)}),Mu=function(t,n){return t.view(n).fold(o([]),(function(n){var e=t.owner(n),o=Mu(t,e);return[n].concat(o)}))},Du=Object.freeze({view:function(n){return(n.dom()===t.document?O.none():O.from(n.dom().defaultView.frameElement)).map(te)},owner:function(t){return dr(t)}}),Iu=function(n){var e,o,r,u,a=te(t.document),c=Fu(a);return(e=n,r=(o=Du).owner(e),u=Mu(o,r),O.some(u)).fold(i(xu,n),(function(t){var e=wu(n),o=G(t,(function(t,n){var e=wu(n);return{left:t.left+e.left(),top:t.top+e.top()}}),{left:0,top:0});return bu(o.left+e.left()+c.left(),o.top+e.top()+c.top())}))},Ru=cr("point","width","height"),Vu=cr("x","y","width","height"),Nu=function(t,n,e,r){return{x:o(t),y:o(n),width:o(e),height:o(r),right:o(t+e),bottom:o(n+r)}},Hu=function(t){var n=xu(t),e=Au(t),o=Eu(t);return Nu(n.left(),n.top(),e,o)},Pu=function(){var n=t.window.innerWidth,e=t.window.innerHeight,o=te(t.document),r=Fu(o);return Nu(r.left(),r.top(),n,e)},zu=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Lu=function(t,n,e){var o=function(t){return Dt(e,t).getOr([])},r=function(t,n,e){var r=nt(zu,e);return{offset:function(){return bu(t,n)},classesOn:function(){return Q(e,o)},classesOff:function(){return Q(r,o)}}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},ju=function(){return Lu(0,0,{})},Uu=cr("x","y","bubble","direction","label"),Wu=pt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Gu=Wu.southeast,Xu=Wu.southwest,Yu=Wu.northeast,qu=Wu.northwest,Ku=Wu.south,Ju=Wu.north,$u=Wu.east,Qu=Wu.west,Zu=function(t){return t.x()},ta=function(t,n){return t.x()+t.width()/2-n.width()/2},na=function(t,n){return t.x()+t.width()-n.width()},ea=function(t,n){return t.y()-n.height()},oa=function(t){return t.y()+t.height()},ra=function(t,n){return t.y()+t.height()/2-n.height()/2},ia=function(t,n,e){return Uu(Zu(t),oa(t),e.southeast(),Gu(),"layout-se")},ua=function(t,n,e){return Uu(na(t,n),oa(t),e.southwest(),Xu(),"layout-sw")},aa=function(t,n,e){return Uu(Zu(t),ea(t,n),e.northeast(),Yu(),"layout-ne")},ca=function(t,n,e){return Uu(na(t,n),ea(t,n),e.northwest(),qu(),"layout-nw")},sa=function(t,n,e){return Uu(ta(t,n),ea(t,n),e.north(),Ju(),"layout-n")},la=function(t,n,e){return Uu(ta(t,n),oa(t),e.south(),Ku(),"layout-s")},fa=function(t,n,e){return Uu((o=t).x()+o.width(),ra(t,n),e.east(),$u(),"layout-e");var o},da=function(t,n,e){return Uu((o=n,t.x()-o.width()),ra(t,n),e.west(),Qu(),"layout-w");var o},ma=function(){return[ia,ua,aa,ca,la,sa,fa,da]},ga=function(){return[ua,ia,ca,aa,la,sa,fa,da]},pa=fr(["x","y","width","height","maxHeight","direction","classes","label","candidateYforTest"],[]),ha=cr("position","left","top","right","bottom"),va=pt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ba=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=n.x()-e,p=n.y()-o,h=r-(g+n.width()),v=i-(p+n.height()),b=O.some(g),y=O.some(p),x=O.some(h),w=O.some(v),S=O.none();return u=function(){return ha(t,b,y,S,S)},a=function(){return ha(t,S,y,x,S)},c=function(){return ha(t,b,S,S,w)},s=function(){return ha(t,S,S,x,w)},l=function(){return ha(t,b,y,S,S)},f=function(){return ha(t,b,S,S,w)},d=function(){return ha(t,b,y,S,S)},m=function(){return ha(t,S,y,x,S)},n.direction().fold(u,a,c,s,l,f,d,m)},ya=function(t,n){var e=i(Iu,n),o=t.fold(e,e,(function(){var t=Fu();return Iu(n).translate(-t.left(),-t.top())})),r=Au(n),u=Eu(n);return Nu(o.left(),o.top(),r,u)},xa=va.relative,wa=va.fixed,Sa=function(t,n){return function(e){return"rtl"===ka(e)?n:t}},ka=function(t){return"rtl"===yi(t,"direction")?"rtl":"ltr"},Ca=function(){return Pn("layouts",[Tn("onLtr"),Tn("onRtl")])},Oa=function(t,n,e,o){var r=n.layouts.map((function(n){return n.onLtr(t)})).getOr(e),i=n.layouts.map((function(n){return n.onRtl(t)})).getOr(o);return Sa(r,i)(t)},Ta=[Tn("hotspot"),In("bubble"),zn("overrides",{}),Ca(),nu("placement",(function(t,n,e){var o=n.hotspot,r=ya(e,o.element()),i=Oa(t.element(),n,ma(),ga());return O.some({anchorBox:r,bubble:n.bubble.getOr(ju()),overrides:n.overrides,layouts:i,placer:O.none()})}))],Ea=[Tn("x"),Tn("y"),zn("height",0),zn("width",0),zn("bubble",ju()),zn("overrides",{}),Ca(),nu("placement",(function(t,n,e){var o=Nu(n.x,n.y,n.width,n.height),r=Oa(t.element(),n,ma(),ga());return O.some({anchorBox:o,bubble:n.bubble,overrides:n.overrides,layouts:r,placer:O.none()})}))],Ba={create:cr("start","soffset","finish","foffset")},_a=pt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Aa=(_a.before,_a.on,_a.after,function(t){return t.fold(r,r,r)}),Fa=pt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ma={domRange:Fa.domRange,relative:Fa.relative,exact:Fa.exact,exactFromRange:function(t){return Fa.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){var n=t.match({domRange:function(t){return te(t.startContainer)},relative:function(t,n){return Aa(t)},exact:function(t,n,e,o){return t}});return mr(n)},range:Ba.create},Da=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold((function(t){o.setStartBefore(t.dom())}),(function(t,n){o.setStart(t.dom(),n)}),(function(t){o.setStartAfter(t.dom())})),r=i,e.fold((function(t){r.setEndBefore(t.dom())}),(function(t,n){r.setEnd(t.dom(),n)}),(function(t){r.setEndAfter(t.dom())})),i},Ia=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(o.dom(),r),i},Ra=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Va=pt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Na=function(t,n,e){return n(te(e.startContainer),e.startOffset,te(e.endContainer),e.endOffset)},Ha=function(t){var n=function(n){return t(n)?O.from(n.dom().nodeValue):O.none()},e=Oe.detect().browser,o=e.isIE()&&10===e.version.major?function(t){try{return n(t)}catch(t){return O.none()}}:n;return{get:function(n){if(!t(n))throw new Error("Can only get text value of a text node");return o(n).getOr("")},getOption:o,set:function(n,e){if(!t(n))throw new Error("Can only set raw text value of a text node");n.dom().nodeValue=e}}}(zo),Pa=function(t){return Ha.getOption(t)},za=["img","br"],La=function(t){return Pa(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf(" ")})).isSome()||P(za,No(t))},ja=function(t,n){var e=function(t){for(var o=hr(t),r=o.length-1;0<=r;r--){var i=o[r];if(n(i))return O.some(i);var u=e(i);if(u.isSome())return u}return O.none()};return e(t)},Ua=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(t,n){return De(n,t)}),Wa=function(t){var n=te(t.anchorNode),e=te(t.focusNode);return function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=dr(r=t).dom().createRange()).setStart(r.dom(),i),c.setEnd(u.dom(),a),c),l=Ie(t,e)&&n===o;return s.collapsed&&!l}(n,t.anchorOffset,e,t.focusOffset)?O.some(Ba.create(n,t.anchorOffset,e,t.focusOffset)):function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return O.some(Ba.create(te(n.startContainer),n.startOffset,te(e.endContainer),e.endOffset))}return O.none()}(t)},Ga=function(t,n){var e,r,i,u,a=function(t,n){var e,r,i,u=(e=t,n.match({domRange:function(t){return{ltr:o(t),rtl:O.none}},relative:function(t,n){return{ltr:xt((function(){return Da(e,t,n)})),rtl:xt((function(){return O.some(Da(e,n,t))}))}},exact:function(t,n,o,r){return{ltr:xt((function(){return Ia(e,t,n,o,r)})),rtl:xt((function(){return O.some(Ia(e,o,r,t,n))}))}}}));return(i=(r=u).ltr()).collapsed?r.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Va.rtl(te(t.endContainer),t.endOffset,te(t.startContainer),t.startOffset)})).getOrThunk((function(){return Na(0,Va.ltr,i)})):Na(0,Va.ltr,i)}(e=t,n).match({ltr:function(t,n,o,r){var i=e.document.createRange();return i.setStart(t.dom(),n),i.setEnd(o.dom(),r),i},rtl:function(t,n,o,r){var i=e.document.createRange();return i.setStart(o.dom(),r),i.setEnd(t.dom(),n),i}});return 0<(u=0<(i=(r=a).getClientRects()).length?i[0]:r.getBoundingClientRect()).width||0<u.height?O.some(u).map(Ra):O.none()},Xa=cr("element","offset"),Ya=pt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),qa=function(t){return t.fold((function(t){return t}),(function(t,n,e){return t.translate(-n,-e)}))},Ka=function(t){return t.fold((function(t){return t}),(function(t,n,e){return t}))},Ja=function(t){return X(t,(function(t,n){return t.translate(n.left(),n.top())}),bu(0,0))},$a=function(t){var n=j(t,Ka);return Ja(n)},Qa=Ya.screen,Za=Ya.absolute,tc=function(t,n,e){var o,r,i,u=dr(t.element()),a=Fu(u),c=(o=t,r=e,i=mr(r.root).dom(),O.from(i.frameElement).map(te).filter((function(t){var n=dr(t),e=dr(o.element());return Ie(n,e)})).map(xu)).getOr(a);return Za(c,a.left(),a.top())},nc=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=Qa(bu(r,i));return O.some(Ru(c,u,a))},ec=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point()],s=(i=function(){return $a(c)},u=function(){return $a(c)},a=function(){return t=j(c,qa),Ja(t);var t},o.fold(i,u,a)),l=Vu(s.left(),s.top(),t.width(),t.height()),f=Oa(r,e,e.showAbove?[aa,ca,ia,ua,sa,la]:[ia,ua,aa,ca,la,la],e.showAbove?[ca,aa,ua,ia,sa,la]:[ua,ia,ca,aa,la,sa]);return{anchorBox:l,bubble:e.bubble.getOr(ju()),overrides:e.overrides,layouts:f,placer:O.none()}}))},oc=cr("element","offset"),rc=function(t,n){return zo(t)?oc(t,n):function(t,n){var e=hr(t);if(0===e.length)return Xa(t,n);if(n<e.length)return Xa(e[n],0);var o=e[e.length-1],r=zo(o)?function(t){return Ha.get(t)}(o).length:hr(o).length;return Xa(o,r)}(t,n)},ic=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return n=t,O.from(n.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Wa);var n}}))().map((function(t){var n=rc(t.start(),t.soffset()),e=rc(t.finish(),t.foffset());return Ma.range(n.element(),n.offset(),e.element(),e.offset())}))},uc=[In("getSelection"),Tn("root"),In("bubble"),Ca(),zn("overrides",{}),zn("showAbove",!1),nu("placement",(function(t,n,e){var o=mr(n.root).dom(),r=tc(t,0,n),i=ic(o,n).bind((function(t){return Ga(o,Ma.exactFromRange(t)).orThunk((function(){var n=Zn("\ufeff");return br(t.start(),n),Ga(o,Ma.exact(n,0,n,1)).map((function(t){return Cr(n),t}))})).bind((function(t){return nc(t.left(),t.top(),t.width(),t.height())}))})),u=ic(o,n).bind((function(t){return Po(t.start())?O.some(t.start()):gr(t.start())})).getOr(t.element());return ec(i,r,n,e,u)}))],ac=[Tn("node"),Tn("root"),In("bubble"),Ca(),zn("overrides",{}),zn("showAbove",!1),nu("placement",(function(t,n,e){var o=tc(t,0,n);return n.node.bind((function(r){var i=r.dom().getBoundingClientRect(),u=nc(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element());return ec(u,o,n,e,a)}))}))],cc=function(t){return t.x()+t.width()},sc=function(t,n){return t.x()-n.width()},lc=function(t,n){return t.y()-n.height()+t.height()},fc=function(t){return t.y()},dc=function(t,n,e){return Uu(cc(t),fc(t),e.southeast(),Gu(),"link-layout-se")},mc=function(t,n,e){return Uu(sc(t,n),fc(t),e.southwest(),Xu(),"link-layout-sw")},gc=function(t,n,e){return Uu(cc(t),lc(t,n),e.northeast(),Yu(),"link-layout-ne")},pc=function(t,n,e){return Uu(sc(t,n),lc(t,n),e.northwest(),qu(),"link-layout-nw")},hc=[Tn("item"),Ca(),zn("overrides",{}),nu("placement",(function(t,n,e){var o=ya(e,n.item.element()),r=Oa(t.element(),n,[dc,mc,gc,pc],[mc,dc,pc,gc]);return O.some({anchorBox:o,bubble:ju(),overrides:n.overrides,layouts:r,placer:O.none()})}))],vc=hn("anchor",{selection:uc,node:ac,hotspot:Ta,submenu:hc,makeshift:Ea}),bc=cr("anchorBox","origin"),yc=pt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),xc=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=Ou.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),vi(e,"max-height",r+"px")},wc=o((function(t,n){xc(t,n),bi(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Sc=o((function(t,n){xc(t,n)})),kc=fr(["bounds","origin","preference","maxHeightFunction"],[]),Cc=function(t,n,e,u){var a,c,s,l,f=function(t,n,e,u){ki(n,"max-height");var a,c={width:o(Au(a=n)),height:o(Eu(a))};return function(t,n,e,u,a){var c=e.width(),s=e.height(),l=function(t,r,i,l){var f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,T,E,B,_,A,F,M,D,I,R,V,N,H,P,z,L,j,U=t(n,e,u);return(d=c,m=s,g=a,y=(f=U).x(),x=f.y(),w=f.bubble().offset().left(),S=f.bubble().offset().top(),k=g.x(),C=g.y(),O=g.width(),T=g.height(),A=C<=(B=x+S),F=(_=k<=(E=y+w))&&A,M=E+d<=k+O&&B+m<=C+T,D=_?Math.min(d,k+O-E):Math.abs(k-(E+d)),I=A?Math.min(m,C+T-B):Math.abs(C-(B+m)),R=g.x()+g.width(),V=Math.max(g.x(),E),N=Math.min(V,R),P=o((H=A?B:B+(m-I))+I-C),z=o(C+T-H),p=f.direction(),v=h=z,b=P,L=p.fold(h,h,b,b,h,b,v,v),j=pa({x:N,y:H,width:D,height:I,maxHeight:L,direction:f.direction(),classes:{on:f.bubble().classesOn(),off:f.bubble().classesOff()},label:f.label(),candidateYforTest:B}),F&&M?yc.fit(j):yc.nofit(j,D,I)).fold(yc.fit,(function(t,n,e){return l<e||i<n?yc.nofit(t,n,e):yc.nofit(r,i,l)}))};return X(t,(function(t,n){var e=i(l,n);return t.fold(yc.fit,e)}),yc.nofit(pa({x:n.x(),y:n.y(),width:e.width(),height:e.height(),maxHeight:e.height(),direction:Gu(),classes:[],label:"none",candidateYforTest:n.y()}),-1,-1)).fold(r,r)}(u.preference(),t,c,e,u.bounds())}(t,n,e,u);(function(t,n,e){var o,r,i,u,a,c=function(t){return t+"px"},s=(o=e.origin(),r=n,o.fold((function(){return ha("absolute",O.some(r.x()),O.some(r.y()),O.none(),O.none())}),(function(t,n,e,o){return ba("absolute",r,t,n,e,o)}),(function(t,n,e,o){return ba("fixed",r,t,n,e,o)})));i=t,u={position:O.some(s.position()),left:s.left().map(c),top:s.top().map(c),right:s.right().map(c),bottom:s.bottom().map(c)},a=i.dom(),ct(u,(function(t,n){t.fold((function(){hi(a,n)}),(function(t){pi(a,n,t)}))}))})(n,f,u),a=n,c=f.classes(),mi(a,c.off),di(a,c.on),s=n,l=f,u.maxHeightFunction()(s,l.maxHeight())},Oc=function(t,n,e,o,r){var i;!function(t,n,e,o,r,i){var u,a,c,s,l,f=(u=i,a="maxHeightFunction",c=wc(),void 0===u[a]?c:u[a]),d=t.anchorBox(),m=t.origin(),g=kc({bounds:(s=m,l=r,l.fold((function(){return s.fold(Pu,Pu,Nu)}),(function(t){return s.fold(t,t,Nu)}))),origin:m,preference:o,maxHeightFunction:f});Cc(d,n,e,g)}((i=e.anchorBox,bc(i,n)),r.element(),e.bubble,e.layouts,o,e.overrides)},Tc=function(t,n,e,o,r,i){var u=i.map(Hu);return Ec(t,n,e,o,r,u)},Ec=function(n,e,r,i,u,a){var c=mn("positioning anchor.info",vc,i);vi(u.element(),"position","fixed");var s=wi(u.element(),"visibility");vi(u.element(),"visibility","hidden");var l,f,d,m=e.useFixed?wa(0,0,t.window.innerWidth,t.window.innerHeight):(f=xu((l=n).element()),d=l.element().dom().getBoundingClientRect(),xa(f.left(),f.top(),d.width,d.height)),g=c.placement,p=a.map(o).or(e.getBounds);g(n,c,m).each((function(t){t.placer.getOr(Oc)(n,m,t,p,u)})),s.fold((function(){ki(u.element(),"visibility")}),(function(t){vi(u.element(),"visibility",t)})),wi(u.element(),"left").isNone()&&wi(u.element(),"top").isNone()&&wi(u.element(),"right").isNone()&&wi(u.element(),"bottom").isNone()&&wi(u.element(),"position").is("fixed")&&ki(u.element(),"position")},Bc=Object.freeze({position:function(t,n,e,o,r){var i=O.none();Tc(t,n,e,o,r,i)},positionWithin:Tc,positionWithinBounds:Ec,getMode:function(t,n,e){return n.useFixed?"fixed":"absolute"}}),_c=[zn("useFixed",!1),In("getBounds")],Ac=su({fields:_c,name:"positioning",active:hu,apis:Bc}),Fc=function(t){Oo(t,vo());var n=t.components();U(n,Fc)},Mc=function(t){var n=t.components();U(n,Mc),Oo(t,ho())},Dc=function(t,n){Ic(t,n,wr)},Ic=function(t,n,e){t.getSystem().addToWorld(n),e(t.element(),n.element()),jo(t.element())&&Mc(n),t.syncComponents()},Rc=function(t){Fc(t),Cr(t.element()),t.getSystem().removeFromWorld(t)},Vc=function(t){var n=gr(t.element()).bind((function(n){return t.getSystem().getByDom(n).fold(O.none,O.some)}));Rc(t),n.each((function(t){t.syncComponents()}))},Nc=function(t){var n=t.components();U(n,Rc),kr(t.element()),t.syncComponents()},Hc=function(t,n){Pc(t,n,wr)},Pc=function(t,n,e){e(t,n.element());var o=hr(n.element());U(o,(function(t){n.getByDom(t).each(Mc)}))},zc=function(t){var n=hr(t.element());U(n,(function(n){t.getByDom(n).each(Fc)})),Cr(t.element())},Lc=function(t,n,e,o){var r=function(t,n,e,o){e.get().each((function(n){Nc(t)}));var r=n.getAttachPoint(t);Dc(r,t);var i=t.getSystem().build(o);return Dc(t,i),e.set(i),i}(t,n,e,o);return n.onOpen(t,r),r},jc=function(t,n,e){e.get().each((function(o){Nc(t),Vc(t),n.onClose(t,o),e.clear()}))},Uc=function(t,n,e){return e.isOpen()},Wc=function(t,n,e){var o,r,i,u=n.getAttachPoint(t);vi(t.element(),"position",Ac.getMode(u)),o=t,r="visibility",i=n.cloakVisibilityAttr,wi(o.element(),r).fold((function(){Dr(o.element(),i)}),(function(t){_r(o.element(),i,t)})),vi(o.element(),r,"hidden")},Gc=function(t,n,e){var o;o=t.element(),z(["top","left","right","bottom"],(function(t){return wi(o,t).isSome()}))||ki(t.element(),"position"),function(t,n,e){if(Mr(t.element(),e)){var o=Fr(t.element(),e);vi(t.element(),n,o)}else ki(t.element(),n)}(t,"visibility",n.cloakVisibilityAttr)},Xc=Object.freeze({cloak:Wc,decloak:Gc,open:Lc,openWhileCloaked:function(t,n,e,o,r){Wc(t,n),Lc(t,n,e,o),r(),Gc(t,n)},close:jc,isOpen:Uc,isPartOf:function(t,n,e,o){return Uc(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()}}),Yc=Object.freeze({events:function(t,n){return qo([$o(lo(),(function(e,o){jc(e,t,n)}))])}}),qc=[$i("onOpen"),$i("onClose"),Tn("isPartOf"),Tn("getAttachPoint"),zn("cloakVisibilityAttr","data-precloak-visibility")],Kc=su({fields:qc,name:"sandboxing",active:Yc,apis:Xc,state:Object.freeze({init:function(){var t=Kn(O.none()),n=o("not-implemented");return ni({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(O.none())},set:function(n){t.set(O.some(n))},get:function(n){return t.get()}})}})}),Jc=o("dismiss.popups"),$c=o("mouse.released"),Qc=Zt([zn("isExtraPart",o(!1)),Pn("fireEventInstead",[zn("event",bo())])]),Zc=function(t){var n=ts(t);return pu.config(n)},ts=function(t){var n=mn("Dismissal",Qc,t);return{channels:It(Jc(),{schema:Zt([Tn("target")]),onReceive:function(t,e){Kc.isOpen(t)&&(Kc.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return Kc.close(t)}),(function(n){return Oo(t,n.event)})))}})}},ns=function(t,n){return Yn(t,{},j(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,un(e,e,Ct(),Qt((function(t){return jt("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([qn("dump",r)]))},es=function(t){return t.dump},os=function(t,n){return f({},t.dump,au(n))},rs=ns,is=os,us="placeholder",as=pt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),cs=function(t,n,e,i){return function(t,n,e,r){return e.uiType===us?(u=e,a=r,(i=t).exists((function(t){return t!==u.owner}))?as.single(!0,o(u)):Dt(a,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+ut(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(t){return t.replace()}))):as.single(!1,o(e));var i,u,a}(t,0,e,i).fold((function(o,r){var u=r(n,e.config,e.validated),a=Dt(u,"components").getOr([]),c=Q(a,(function(e){return cs(t,n,e,i)}));return[f({},u,{components:c})]}),(function(t,o){var i=o(n,e.config,e.validated);return e.validated.preprocess.getOr(r)(i)}))},ss=as.single,ls=as.multiple,fs=o(us),ds=pt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ms=zn("factory",{sketch:r}),gs=zn("schema",[]),ps=Tn("name"),hs=un("pname","pname",Ot((function(t){return"<alloy."+Hr(t.name)+">"})),vn()),vs=qn("schema",(function(){return[In("preprocess")]})),bs=zn("defaults",o({})),ys=zn("overrides",o({})),xs=tn([ms,gs,ps,hs,bs,ys]),ws=tn([ms,gs,ps,bs,ys]),Ss=tn([ms,gs,ps,hs,bs,ys]),ks=tn([ms,vs,ps,Tn("unit"),hs,bs,ys]),Cs=function(t){return t.fold(O.some,O.none,O.some,O.some)},Os=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Ts=function(t,n){return function(e){var o=mn("Converting part type",n,e);return t(o)}},Es=Ts(ds.required,xs),Bs=Ts(ds.external,ws),_s=Ts(ds.optional,Ss),As=Ts(ds.group,ks),Fs=o("entirety"),Ms=Object.freeze({required:Es,external:Bs,optional:_s,group:As,asNamedPart:Cs,name:Os,asCommon:function(t){return t.fold(r,r,r,r)},original:Fs}),Ds=function(t,n,e,o){return bt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Is=function(t,n){var e={};return U(n,(function(n){Cs(n).each((function(n){var o=Rs(t,n.pname);e[n.name]=function(e){var r=mn("Part: "+n.name+" in "+t,tn(n.schema),e);return f({},o,{config:e,validated:r})}}))})),e},Rs=function(t,n){return{uiType:fs(),owner:t,name:n}},Vs=function(t,n,e){return{uiType:fs(),owner:t,name:n,config:e,validated:{}}},Ns=function(t){return Q(t,(function(t){return t.fold(O.none,O.some,O.none,O.none).map((function(t){return Fn(t.name,t.schema.concat([eu(Fs())]))})).toArray()}))},Hs=function(t){return j(t,Os)},Ps=function(t,n,e){return r=n,i={},u={},U(e,(function(t){t.fold((function(t){i[t.pname]=ss(!0,(function(n,e,o){return t.factory.sketch(Ds(n,t,e,o))}))}),(function(t){var n=r.parts[t.name];u[t.name]=o(t.factory.sketch(Ds(r,t,n[Fs()]),n))}),(function(t){i[t.pname]=ss(!1,(function(n,e,o){return t.factory.sketch(Ds(n,t,e,o))}))}),(function(t){i[t.pname]=ls(!0,(function(n,e,o){var r=n[t.name];return j(r,(function(e){return t.factory.sketch(bt(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:o(i),externals:o(u)};var r,i,u},zs=function(t,n,e){return function(t,n,e,r){var i,u,a,c=st(r,(function(t,n){return r=t,i=!1,{name:o(e=n),required:function(){return r.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return i},replace:function(){if(!0===i)throw new Error("Trying to use the same placeholder more than once: "+e);return i=!0,r}};var e,r,i})),s=(i=t,u=n,a=c,Q(e,(function(t){return cs(i,u,t,a)})));return ct(c,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),s}(O.some(t),n,n.components,e)},Ls=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOption()},js=function(t,n,e){return Ls(t,n,e).getOrDie("Could not find part: "+e)},Us=function(t,n,e){var r={},i=n.partUids,u=t.getSystem();return U(e,(function(t){r[t]=u.getByUid(i[t])})),st(r,o)},Ws=function(t,n){var e=t.getSystem();return st(n.partUids,(function(t,n){return o(e.getByUid(t))}))},Gs=function(t){return ut(t.partUids)},Xs=function(t,n,e){var r={},i=n.partUids,u=t.getSystem();return U(e,(function(t){r[t]=u.getByUid(i[t]).getOrDie()})),st(r,o)},Ys=function(t,n){var e=Hs(n);return Rt(j(e,(function(n){return{key:n,value:t+"-"+n}})))},qs=function(t){return un("partUids","partUids",Tt((function(n){return Ys(n.uid,t)})),vn())},Ks=Object.freeze({generate:Is,generateOne:Vs,schemas:Ns,names:Hs,substitutes:Ps,components:zs,defaultUids:Ys,defaultUidsSchema:qs,getAllParts:Ws,getAllPartNames:Gs,getPart:Ls,getPartOrDie:js,getParts:Us,getPartsOrDie:Xs}),Js=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[Fn("parts",i)]:[]).concat([Tn("uid"),zn("dom",{}),zn("components",[]),eu("originalSpec"),zn("debug.sketcher",{})]).concat(u));return mn(t+" [SpecSchema]",Zt(a.concat(n)),e)},$s=function(t,n,e,o,r){var i=Qs(r),u=Ns(e),a=qs(e),c=Js(t,n,i,u,[a]),s=Ps(0,c,e);return o(c,zs(t,c,s.internals()),i,s.externals())},Qs=function(t){return t.hasOwnProperty("uid")?t:f({},t,{uid:Gr("uid")})},Zs=Zt([Tn("name"),Tn("factory"),Tn("configFields"),zn("apis",{}),zn("extraApis",{})]),tl=Zt([Tn("name"),Tn("factory"),Tn("configFields"),Tn("partFields"),zn("apis",{}),zn("extraApis",{})]),nl=function(t){var n=mn("Sketcher for "+t.name,Zs,t),e=st(n.apis,Zr),r=st(n.extraApis,(function(t,n){return Jr(t,n)}));return f({name:o(n.name),partFields:o([]),configFields:o(n.configFields),sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=Qs(t),r(Js(e,o,i,[],[]),i);var e,o,r,i}},e,r)},el=function(t){var n=mn("Sketcher for "+t.name,tl,t),e=Is(n.name,n.partFields),r=st(n.apis,Zr),i=st(n.extraApis,(function(t,n){return Jr(t,n)}));return f({name:o(n.name),partFields:o(n.partFields),configFields:o(n.configFields),sketch:function(t){return $s(n.name,n.configFields,n.partFields,n.factory,t)},parts:o(e)},r,i)},ol=function(t){return"input"===No(t)&&"radio"!==Fr(t,"type")||"textarea"===No(t)},rl=Object.freeze({getCurrent:function(t,n,e){return n.find(t)}}),il=[Tn("find")],ul=su({fields:il,name:"composing",apis:rl}),al=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},cl=function(t,n,e){return t<=n?n:e<=t?e:t},sl=function(t,n,e,o){var r=Ua(t.element(),"."+n.highlightClass);U(r,(function(e){z(o,(function(t){return t.element()===e}))||(li(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Oo(e,Co())})))}))},ll=function(t,n,e,o){sl(t,n,0,[o]),fl(t,n,e,o)||(si(o.element(),n.highlightClass),n.onHighlight(t,o),Oo(o,ko()))},fl=function(t,n,e,o){return fi(o.element(),n.highlightClass)},dl=function(t,n,e){return Ii(t.element(),"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOption()}))},ml=function(t,n,e){var o=Ua(t.element(),"."+n.itemClass);return(0<o.length?O.some(o[o.length-1]):O.none()).bind((function(n){return t.getSystem().getByDom(n).toOption()}))},gl=function(t,n,e,o){var r=Ua(t.element(),"."+n.itemClass);return q(r,(function(t){return fi(t,n.highlightClass)})).bind((function(n){var e=al(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOption()}))},pl=function(t,n,e){var o=Ua(t.element(),"."+n.itemClass);return Hi(j(o,(function(n){return t.getSystem().getByDom(n).toOption()})))},hl=Object.freeze({dehighlightAll:function(t,n,e){return sl(t,n,0,[])},dehighlight:function(t,n,e,o){fl(t,n,e,o)&&(li(o.element(),n.highlightClass),n.onDehighlight(t,o),Oo(o,Co()))},highlight:ll,highlightFirst:function(t,n,e){dl(t,n).each((function(o){ll(t,n,e,o)}))},highlightLast:function(t,n,e){ml(t,n).each((function(o){ll(t,n,e,o)}))},highlightAt:function(t,n,e,o){(function(t,n,e,o){var r=Ua(t.element(),"."+n.itemClass);return O.from(r[o]).fold((function(){return B.error("No element found with index "+o)}),t.getSystem().getByDom)})(t,n,0,o).fold((function(t){throw new Error(t)}),(function(o){ll(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=pl(t,n);Y(r,o).each((function(o){ll(t,n,e,o)}))},isHighlighted:fl,getHighlighted:function(t,n,e){return Ii(t.element(),"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOption()}))},getFirst:dl,getLast:ml,getPrevious:function(t,n,e){return gl(t,n,0,-1)},getNext:function(t,n,e){return gl(t,n,0,1)},getCandidates:pl}),vl=[Tn("highlightClass"),Tn("itemClass"),$i("onHighlight"),$i("onDehighlight")],bl=su({fields:vl,name:"highlighting",apis:hl}),yl=function(t,n,e){var o=tt(t.slice(0,n)),r=tt(t.slice(n+1));return Y(o.concat(r),e)},xl=function(t,n,e){var o=tt(t.slice(0,n));return Y(o,e)},wl=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return Y(r.concat(o),e)},Sl=function(t,n,e){var o=t.slice(n+1);return Y(o,e)},kl=function(t){return function(n){var e=n.raw();return P(t,e.which)}},Cl=function(t){return function(n){return Z(t,(function(t){return t(n)}))}},Ol=function(t){return!0===t.raw().shiftKey},Tl=function(t){return!0===t.raw().ctrlKey},El=u(Ol),Bl=function(t,n){return{matches:t,classification:n}},_l=function(t){t.dom().focus()},Al=function(n){var e=void 0!==n?n.dom():t.document;return O.from(e.activeElement).map(te)},Fl=function(t){return Al(dr(t)).filter((function(n){return t.dom().contains(n.dom())}))},Ml=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Ie(n,t)}))}))||To(t,yo(),{prevFocus:n,newFocus:e})},Dl=function(){var t=function(t){return Fl(t.element())};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element());var r=t(n);Ml(n,o,r)}}},Il=function(){var t=function(t){return bl.getHighlighted(t).map((function(t){return t.element()}))};return{get:t,set:function(e,o){var r=t(e);e.getSystem().getByDom(o).fold(n,(function(t){bl.highlight(e,t)}));var i=t(e);Ml(e,r,i)}}};(Cu=ku||(ku={})).OnFocusMode="onFocus",Cu.OnEnterOrSpaceMode="onEnterOrSpace",Cu.OnApiMode="onApi";var Rl,Vl,Nl,Hl=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u;return(i=e(t,n,o,r),u=n.event(),Y(i,(function(t){return t.matches(u)})).map((function(t){return t.classification}))).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([zn("focusManager",Dl()),Ln("focusInside","onFocus",sn((function(t){return P(["onFocus","onEnterOrSpace","onApi"],t)?B.value(t):B.error("Invalid value for focusInside")}))),nu("handler",u),nu("state",n),nu("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==ku.OnFocusMode?O.none():r(t).map((function(e){return $o(no(),(function(o,r){e(o,t,n),r.stop()}))}));return qo(u.toArray().concat([$o(Ye(),(function(o,u){i(o,u,e,t,n).fold((function(){var e,i,a;e=o,i=u,a=kl([32].concat([13]))(i.event()),t.focusInside===ku.OnEnterOrSpaceMode&&a&&Re(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(t){u.stop()}))})),$o(qe(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))]))}};return u},Pl=function(t){var n=[In("onEscape"),In("onEnter"),zn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),zn("firstTabstop",0),zn("useTabstopAt",o(!0)),In("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return Ri(n,t)})).getOr(n);return 0<Tu(e)},r=function(t,n){var o,r,i,u;(o=t,r=n,i=Ua(o.element(),r.selector),u=W(i,(function(t){return e(r,t)})),O.from(u[r.firstTabstop])).each((function(e){n.focusManager.set(t,e)}))},u=function(t,n,o,r,i){return i(n,o,(function(t){return e(n=r,o=t)&&n.useTabstopAt(o);var n,o})).fold((function(){return r.cyclic?O.some(!0):O.none()}),(function(n){return r.focusManager.set(t,n),O.some(!0)}))},a=function(t,n,e,o){var r,a,c=Ua(t.element(),e.selector);return(r=t,a=e,a.focusManager.get(r).bind((function(t){return Ri(t,a.selector)}))).bind((function(n){return q(c,i(Ie,n)).bind((function(n){return u(t,c,n,e,o)}))}))},c=o([Bl(Cl([Ol,kl([9])]),(function(t,n,e,o){var r=e.cyclic?yl:xl;return a(t,0,e,r)})),Bl(kl([9]),(function(t,n,e,o){var r=e.cyclic?wl:Sl;return a(t,0,e,r)})),Bl(kl([27]),(function(t,n,e,o){return e.onEscape.bind((function(e){return e(t,n)}))})),Bl(Cl([El,kl([13])]),(function(t,n,e,o){return e.onEnter.bind((function(e){return e(t,n)}))}))]),s=o([]);return Hl(n,ti.init,c,s,(function(){return O.some(r)}))},zl=Pl(qn("cyclic",o(!1))),Ll=Pl(qn("cyclic",o(!0))),jl=function(t,n,e){return ol(e)&&kl([32])(n.event())?O.none():(Bo(t,e,io()),O.some(!0))},Ul=function(t,n){return O.some(!0)},Wl=[zn("execute",jl),zn("useSpace",!1),zn("useEnter",!0),zn("useControlEnter",!1),zn("useDown",!1)],Gl=function(t,n,e){return e.execute(t,n,t.element())},Xl=Hl(Wl,ti.init,(function(t,n,e,o){var r=e.useSpace&&!ol(t.element())?[32]:[],i=e.useEnter?[13]:[],u=e.useDown?[40]:[],a=r.concat(i).concat(u);return[Bl(kl(a),Gl)].concat(e.useControlEnter?[Bl(Cl([Tl,kl([13])]),Gl)]:[])}),(function(t,n,e,o){return e.useSpace&&!ol(t.element())?[Bl(kl([32]),Ul)]:[]}),(function(){return O.none()})),Yl=function(t){var n=Kn(O.none());return ni({readState:function(){return n.get().map((function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(O.some({numRows:o(t),numColumns:o(e)}))},getNumRows:function(){return n.get().map((function(t){return t.numRows()}))},getNumColumns:function(){return n.get().map((function(t){return t.numColumns()}))}})},ql=Object.freeze({flatgrid:Yl,init:function(t){return t.state(t)}}),Kl=function(t){return function(n,e,o,r){var i=t(n.element());return Zl(i,n,e,o,r)}},Jl=function(t,n){var e=Sa(t,n);return Kl(e)},$l=function(t,n){var e=Sa(n,t);return Kl(e)},Ql=function(t){return function(n,e,o,r){return Zl(t,n,e,o,r)}},Zl=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element(),e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},tf=Ql,nf=Ql,ef=Ql,of=function(t){var n;return!((n=t.dom()).offsetWidth<=0&&n.offsetHeight<=0)},rf=fr(["index","candidates"],[]),uf=function(t,n,e){var o,r=i(Ie,n),u=Ua(t,e),a=W(u,of);return q(o=a,r).map((function(t){return rf({index:t,candidates:o})}))},af=function(t,n){return q(t,(function(t){return Ie(n,t)}))},cf=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row()*e+n.column();return 0<=o&&o<t.length?O.some(t[o]):O.none()}))},sf=function(t,n,e,r,i){return cf(t,n,r,(function(n,u){var a=n===e-1?t.length-n*r:r,c=al(u,i,0,a-1);return O.some({row:o(n),column:o(c)})}))},lf=function(t,n,e,r,i){return cf(t,n,r,(function(n,u){var a=al(n,i,0,e-1),c=a===e-1?t.length-a*r:r,s=cl(u,0,c-1);return O.some({row:o(a),column:o(s)})}))},ff=[Tn("selector"),zn("execute",jl),Qi("onEscape"),zn("captureTab",!1),ou()],df=function(t,n,e){Ii(t.element(),n.selector).each((function(e){n.focusManager.set(t,e)}))},mf=function(t){return function(n,e,o,r){return uf(n,e,o.selector).bind((function(n){return t(n.candidates(),n.index(),r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},gf=function(t,n,e,o){return e.captureTab?O.some(!0):O.none()},pf=mf((function(t,n,e,o){return sf(t,n,e,o,-1)})),hf=mf((function(t,n,e,o){return sf(t,n,e,o,1)})),vf=mf((function(t,n,e,o){return lf(t,n,e,o,-1)})),bf=mf((function(t,n,e,o){return lf(t,n,e,o,1)})),yf=o([Bl(kl([37]),Jl(pf,hf)),Bl(kl([39]),$l(pf,hf)),Bl(kl([38]),tf(vf)),Bl(kl([40]),nf(bf)),Bl(Cl([Ol,kl([9])]),gf),Bl(Cl([El,kl([9])]),gf),Bl(kl([27]),(function(t,n,e,o){return e.onEscape(t,n)})),Bl(kl([32].concat([13])),(function(t,n,e,o){return(r=t,i=e,i.focusManager.get(r).bind((function(t){return Ri(t,i.selector)}))).bind((function(o){return e.execute(t,n,o)}));var r,i}))]),xf=o([Bl(kl([32]),Ul)]),wf=Hl(ff,Yl,yf,xf,(function(){return O.some(df)})),Sf=function(t,n,e,o){var r=function(t,n,e){var i,u=al(n,o,0,e.length-1);return u===t?O.none():(i=e[u],"button"===No(i)&&"disabled"===Fr(i,"disabled")?r(t,u,e):O.from(e[u]))};return uf(t,e,n).bind((function(t){var n=t.index(),e=t.candidates();return r(n,n,e)}))},kf=[Tn("selector"),zn("getInitial",O.none),zn("execute",jl),Qi("onEscape"),zn("executeOnMove",!1),zn("allowVertical",!0)],Cf=function(t,n,e){return(o=t,r=e,r.focusManager.get(o).bind((function(t){return Ri(t,r.selector)}))).bind((function(o){return e.execute(t,n,o)}));var o,r},Of=function(t,n){n.getInitial(t).orThunk((function(){return Ii(t.element(),n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Tf=function(t,n,e){return Sf(t,e.selector,n,-1)},Ef=function(t,n,e){return Sf(t,e.selector,n,1)},Bf=function(t){return function(n,e,o){return t(n,e,o).bind((function(){return o.executeOnMove?Cf(n,e,o):O.some(!0)}))}},_f=function(t,n,e,o){return e.onEscape(t,n)},Af=o([Bl(kl([32]),Ul)]),Ff=Hl(kf,ti.init,(function(t,n,e,o){var r=[37].concat(e.allowVertical?[38]:[]),i=[39].concat(e.allowVertical?[40]:[]);return[Bl(kl(r),Bf(Jl(Tf,Ef))),Bl(kl(i),Bf($l(Tf,Ef))),Bl(kl([13]),Cf),Bl(kl([32]),Cf),Bl(kl([27]),_f)]}),Af,(function(){return O.some(Of)})),Mf=fr(["rowIndex","columnIndex","cell"],[]),Df=function(t,n,e){return O.from(t[n]).bind((function(t){return O.from(t[e]).map((function(t){return Mf({rowIndex:n,columnIndex:e,cell:t})}))}))},If=function(t,n,e,o){var r=t[n].length,i=al(e,o,0,r-1);return Df(t,n,i)},Rf=function(t,n,e,o){var r=al(e,o,0,t.length-1),i=t[r].length,u=cl(n,0,i-1);return Df(t,r,u)},Vf=function(t,n,e,o){var r=t[n].length,i=cl(e+o,0,r-1);return Df(t,n,i)},Nf=function(t,n,e,o){var r=cl(e+o,0,t.length-1),i=t[r].length,u=cl(n,0,i-1);return Df(t,r,u)},Hf=[Fn("selectors",[Tn("row"),Tn("cell")]),zn("cycles",!0),zn("previousSelector",O.none),zn("execute",jl)],Pf=function(t,n){n.previousSelector(t).orThunk((function(){var e=n.selectors;return Ii(t.element(),e.cell)})).each((function(e){n.focusManager.set(t,e)}))},zf=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Ri(o,r.selectors.row).bind((function(t){var n=Ua(t,r.selectors.cell);return af(n,o).bind((function(n){var o=Ua(e,r.selectors.row);return af(o,t).bind((function(t){var e,u=(e=r,j(o,(function(t){return Ua(t,e.selectors.cell)})));return i(u,t,n).map((function(t){return t.cell()}))}))}))}))}},Lf=zf((function(t,n,e){return If(t,n,e,-1)}),(function(t,n,e){return Vf(t,n,e,-1)})),jf=zf((function(t,n,e){return If(t,n,e,1)}),(function(t,n,e){return Vf(t,n,e,1)})),Uf=zf((function(t,n,e){return Rf(t,e,n,-1)}),(function(t,n,e){return Nf(t,e,n,-1)})),Wf=zf((function(t,n,e){return Rf(t,e,n,1)}),(function(t,n,e){return Nf(t,e,n,1)})),Gf=o([Bl(kl([37]),Jl(Lf,jf)),Bl(kl([39]),$l(Lf,jf)),Bl(kl([38]),tf(Uf)),Bl(kl([40]),nf(Wf)),Bl(kl([32].concat([13])),(function(t,n,e){return Fl(t.element()).bind((function(o){return e.execute(t,n,o)}))}))]),Xf=o([Bl(kl([32]),Ul)]),Yf=Hl(Hf,ti.init,Gf,Xf,(function(){return O.some(Pf)})),qf=[Tn("selector"),zn("execute",jl),zn("moveOnTab",!1)],Kf=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},Jf=function(t,n){Ii(t.element(),n.selector).each((function(e){n.focusManager.set(t,e)}))},$f=function(t,n,e){return Sf(t,e.selector,n,-1)},Qf=function(t,n,e){return Sf(t,e.selector,n,1)},Zf=o([Bl(kl([38]),ef($f)),Bl(kl([40]),ef(Qf)),Bl(Cl([Ol,kl([9])]),(function(t,n,e){return e.moveOnTab?ef($f)(t,n,e):O.none()})),Bl(Cl([El,kl([9])]),(function(t,n,e){return e.moveOnTab?ef(Qf)(t,n,e):O.none()})),Bl(kl([13]),Kf),Bl(kl([32]),Kf)]),td=o([Bl(kl([32]),Ul)]),nd=Hl(qf,ti.init,Zf,td,(function(){return O.some(Jf)})),ed=[Qi("onSpace"),Qi("onEnter"),Qi("onShiftEnter"),Qi("onLeft"),Qi("onRight"),Qi("onTab"),Qi("onShiftTab"),Qi("onUp"),Qi("onDown"),Qi("onEscape"),zn("stopSpaceKeyup",!1),In("focusIn")],od=Hl(ed,ti.init,(function(t,n,e){return[Bl(kl([32]),e.onSpace),Bl(Cl([El,kl([13])]),e.onEnter),Bl(Cl([Ol,kl([13])]),e.onShiftEnter),Bl(Cl([Ol,kl([9])]),e.onShiftTab),Bl(Cl([El,kl([9])]),e.onTab),Bl(kl([38]),e.onUp),Bl(kl([40]),e.onDown),Bl(kl([37]),e.onLeft),Bl(kl([39]),e.onRight),Bl(kl([32]),e.onSpace),Bl(kl([27]),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Bl(kl([32]),Ul)]:[]}),(function(t){return t.focusIn})),rd=zl.schema(),id=Ll.schema(),ud=Ff.schema(),ad=wf.schema(),cd=Yf.schema(),sd=Xl.schema(),ld=nd.schema(),fd=od.schema(),dd=fu({branchKey:"mode",branches:Object.freeze({acyclic:rd,cyclic:id,flow:ud,flatgrid:ad,matrix:cd,execution:sd,menu:ld,special:fd}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element(),t.element())}),(function(o){o(t,n,e)}))},setGridSize:function(n,e,o,r,i){Vt(o,"setGridSize")?o.setGridSize(r,i):t.console.error("Layout does not support setGridSize")}},state:ql}),md=function(t,n,e,o){var r=t.getSystem().build(o);Ic(t,r,e)},gd=function(t,n,e,o){var r=pd(t);Y(r,(function(t){return Ie(o.element(),t.element())})).each(Vc)},pd=function(t,n){return t.components()},hd=function(t,n,e,o,r){var i=pd(t);return O.from(i[o]).map((function(n){return gd(t,0,0,n),r.each((function(n){md(t,0,(function(t,n){var e,r;r=n,vr(e=t,o).fold((function(){wr(e,r)}),(function(t){br(t,r)}))}),n)})),n}))},vd=su({fields:[],name:"replacing",apis:Object.freeze({append:function(t,n,e,o){md(t,0,wr,o)},prepend:function(t,n,e,o){md(t,0,xr,o)},remove:gd,replaceAt:hd,replaceBy:function(t,n,e,o,r){var i=pd(t);return q(i,o).bind((function(n){return hd(t,0,0,n,r)}))},set:function(t,e,o,r){var i,u,a,c;Nc(t),i=function(){var n=j(r,t.getSystem().build);U(n,(function(n){Dc(t,n)}))},u=t.element(),a=dr(u),c=Al(a).bind((function(t){var n=function(n){return Ie(t,n)};return n(u)?O.some(u):function(t,n){var e=function(t){for(var o=0;o<t.childNodes.length;o++){if(n(te(t.childNodes[o])))return O.some(te(t.childNodes[o]));var r=e(t.childNodes[o]);if(r.isSome())return r}return O.none()};return e(t.dom())}(u,n)})),i(),c.each((function(t){Al(a).filter((function(n){return Ie(n,t)})).fold((function(){_l(t)}),n)}))},contents:pd})}),bd=function(t,n,e){n.store.manager.onLoad(t,n,e)},yd=function(t,n,e){n.store.manager.onUnload(t,n,e)},xd=Object.freeze({onLoad:bd,onUnload:yd,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),wd=Object.freeze({events:function(t,n){var e=t.resetOnDom?[rr((function(e,o){bd(e,t,n)})),ir((function(e,o){yd(e,t,n)}))]:[ru(t,n,bd)];return qo(e)}}),Sd=function(){var t=Kn(null);return ni({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},kd=function(){var t=Kn({}),n=Kn({});return ni({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return Dt(t.get(),e).orThunk((function(){return Dt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};U(e,(function(t){i[t.value]=t,Dt(t,"meta").each((function(n){Dt(n,"text").each((function(n){u[n]=t}))}))})),t.set(f({},o,i)),n.set(f({},r,u))},clear:function(){t.set({}),n.set({})}})},Cd=Object.freeze({memory:Sd,dataset:kd,manual:function(){return ni({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),Od=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Td=[In("initialValue"),Tn("getFallbackEntry"),Tn("getDataKey"),Tn("setValue"),nu("manager",{setValue:Od,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){Od(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:kd})],Ed=[Tn("getValue"),zn("setValue",n),In("initialValue"),nu("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:n,state:ti.init})],Bd=[In("initialValue"),nu("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Sd})],_d=[Ln("store",{mode:"memory"},hn("mode",{memory:Bd,manual:Ed,dataset:Td})),$i("onSetValue"),zn("resetOnDom",!1)],Ad=su({fields:_d,name:"representing",active:wd,apis:xd,extra:{setValueFrom:function(t,n){var e=Ad.getValue(n);Ad.setValue(t,e)}},state:Cd}),Fd=function(t,n){var e,r;return{key:t,value:{config:{},me:(e=t,r=qo(n),su({fields:[Tn("enabled")],name:e,active:{events:o(r)}})),configAsRaw:o({}),initialConfig:{},state:ti}}},Md=function(t,n){n.ignore||(_l(t.element()),n.onFocus(t))},Dd=Object.freeze({focus:Md,blur:function(t,n){n.ignore||t.element().dom().blur()},isFocused:function(t){return n=t.element(),e=dr(n).dom(),n.dom()===e.activeElement;var n,e}}),Id=Object.freeze({exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return oi(e)},events:function(t){return qo([$o(no(),(function(n,e){Md(n,t),e.stop()}))].concat(t.stopMousedown?[$o(ze(),(function(t,n){n.event().prevent()}))]:[]))}}),Rd=[$i("onFocus"),zn("stopMousedown",!1),zn("ignore",!1)],Vd=su({fields:Rd,name:"focusing",active:Id,apis:Dd}),Nd=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Hd=function(t,n,e){n.toggleClass.each((function(n){e.get()?si(t.element(),n):li(t.element(),n)}))},Pd=function(t,n,e){jd(t,n,e,!e.get())},zd=function(t,n,e){e.set(!0),Hd(t,n,e),Nd(t,n,e)},Ld=function(t,n,e){e.set(!1),Hd(t,n,e),Nd(t,n,e)},jd=function(t,n,e,o){(o?zd:Ld)(t,n,e)},Ud=function(t,n,e){jd(t,n,e,n.selected)},Wd=Object.freeze({onLoad:Ud,toggle:Pd,isOn:function(t,n,e){return e.get()},on:zd,off:Ld,set:jd}),Gd=Object.freeze({exhibit:function(t,n,e){return oi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Pd,ar((function(t){r(t,e,o)}))),u=ru(t,n,Ud);return qo($([t.toggleOnExecute?[i]:[],[u]]))}}),Xd=function(t,n,e){_r(t.element(),"aria-expanded",e)},Yd=[zn("selected",!1),In("toggleClass"),zn("toggleOnExecute",!0),Ln("aria",{mode:"none"},hn("mode",{pressed:[zn("syncWithExpanded",!1),nu("update",(function(t,n,e){_r(t.element(),"aria-pressed",e),n.syncWithExpanded&&Xd(t,0,e)}))],checked:[nu("update",(function(t,n,e){_r(t.element(),"aria-checked",e)}))],expanded:[nu("update",Xd)],selected:[nu("update",(function(t,n,e){_r(t.element(),"aria-selected",e)}))],none:[nu("update",n)]}))],qd=su({fields:Yd,name:"toggling",active:Gd,apis:Wd,state:(Rl=!1,{init:function(){var t=Kn(Rl);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Rl)},readState:function(){return t.get()}}}})}),Kd="alloy.item-hover",Jd="alloy.item-focus",$d=function(t){(Fl(t.element()).isNone()||Vd.isFocused(t))&&(Vd.isFocused(t)||Vd.focus(t),To(t,Kd,{item:t}))},Qd=function(t){To(t,Jd,{item:t})},Zd=o(Kd),tm=o(Jd),nm=[Tn("data"),Tn("components"),Tn("dom"),zn("hasSubmenu",!1),In("toggling"),rs("itemBehaviours",[qd,Vd,dd,Ad]),zn("ignoreFocus",!1),zn("domModification",{}),nu("builder",(function(t){return{dom:t.dom,domModification:f({},t.domModification,{attributes:f({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes,{"aria-haspopup":t.hasSubmenu},t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:is(t.itemBehaviours,[t.toggling.fold(qd.revoke,(function(t){return qd.config(f({aria:{mode:"checked"}},t))})),Vd.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Qd(t)}}),dd.config({mode:"execution"}),Ad.config({store:{mode:"memory",initialValue:t.data}}),Fd("item-type-events",[$o(co(),Eo),er(ze()),$o(We(),$d),$o(uo(),Vd.focus)])]),components:t.components,eventOrder:t.eventOrder}})),zn("eventOrder",{})],em=[Tn("dom"),Tn("components"),nu("builder",(function(t){return{dom:t.dom,components:t.components,events:qo([(n=uo(),$o(n,(function(t,n){n.stop()})))])};var n}))],om=o([Es({name:"widget",overrides:function(t){return{behaviours:au([Ad.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),rm=[Tn("uid"),Tn("data"),Tn("components"),Tn("dom"),zn("autofocus",!1),zn("ignoreFocus",!1),rs("widgetBehaviours",[Ad,Vd,dd]),zn("domModification",{}),qs(om()),nu("builder",(function(t){var n=Ps(0,t,om()),e=zs("item-widget",t,n.internals()),o=function(n){return Ls(n,t,"widget").map((function(t){return dd.focusIn(t),t}))},r=function(n,e){return ol(e.event().target())||t.autofocus&&e.setSource(n.element()),O.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:qo([ar((function(t,n){o(t).each((function(t){n.stop()}))})),$o(We(),$d),$o(uo(),(function(n,e){t.autofocus?o(n):Vd.focus(n)}))]),behaviours:is(t.widgetBehaviours,[Ad.config({store:{mode:"memory",initialValue:t.data}}),Vd.config({ignore:t.ignoreFocus,onFocus:function(t){Qd(t)}}),dd.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:du(),onLeft:r,onRight:r,onEscape:function(n,e){return Vd.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element()),O.none()):(Vd.focus(n),O.some(!0))}})])}}))],im=hn("type",{widget:rm,item:nm,separator:em}),um=o([As({factory:{sketch:function(t){var n=mn("menu.spec item",im,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:f({},n,{uid:Gr("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),am=o([Tn("value"),Tn("items"),Tn("dom"),Tn("components"),zn("eventOrder",{}),ns("menuBehaviours",[bl,Ad,ul,dd]),Ln("movement",{mode:"menu",moveOnTab:!0},hn("mode",{grid:[ou(),nu("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[nu("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Tn("rowSelector")],menu:[zn("moveOnTab",!0),nu("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),En("markers",Xi()),zn("fakeFocus",!1),zn("focusManager",Dl()),$i("onHighlight")]),cm=o("alloy.menu-focus"),sm=el({name:"Menu",configFields:am(),partFields:um(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:os(t.menuBehaviours,[bl.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Ad.config({store:{mode:"memory",initialValue:t.value}}),ul.config({find:O.some}),dd.config(t.movement.config(t,t.movement))]),events:qo([$o(tm(),(function(t,n){var e=n.event();t.getSystem().getByDom(e.target()).each((function(e){bl.highlight(t,e),n.stop(),To(t,cm(),{menu:t,item:e})}))})),$o(Zd(),(function(t,n){var e=n.event().item();bl.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),lm=function(t,n,e,o){return Dt(e,o).bind((function(o){return Dt(t,o).bind((function(o){var r=lm(t,n,e,o);return O.some([o].concat(r))}))})).getOr([])},fm=o("collapse-item"),dm=nl({name:"TieredMenu",configFields:[tu("onExecute"),tu("onEscape"),Zi("onOpenMenu"),Zi("onOpenSubmenu"),$i("onCollapseMenu"),zn("highlightImmediately",!0),Fn("data",[Tn("primary"),Tn("menus"),Tn("expansions")]),zn("fakeFocus",!1),$i("onHighlight"),$i("onHover"),qi(),Tn("dom"),zn("navigateOnHover",!0),zn("stayInDom",!1),ns("tmenuBehaviours",[dd,bl,ul,vd]),zn("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)}},factory:function(t,n){var e,o,r=Kn(O.none()),i=function(){var t=Kn({}),n=Kn({}),e=Kn({}),o=Kn(O.none()),r=Kn({}),i=function(t){return Dt(n.get(),t)};return{setMenuBuilt:function(t,e){var o;n.set(f({},n.get(),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(O.some(i)),t.set(a),n.set(u),r.set(c);var s=function(t,n){var e={};ct(t,(function(t,n){U(t,(function(t){e[t]=n}))}));var o=n,r=lt(n,(function(t,n){return{k:t,v:n}})),i=st(r,(function(t,n){return[n].concat(lm(e,o,r,n))}));return st(e,(function(t){return Dt(i,t).getOr([t])}))}(c,a);e.set(s)},expand:function(n){return Dt(t.get(),n).map((function(t){var o=Dt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return Dt(e.get(),t)},collapse:function(t){return Dt(e.get(),t).bind((function(t){return 1<t.length?O.some(t.slice(1)):O.none()}))},lookupMenu:i,otherMenus:function(t){var n=r.get();return nt(ut(n),t)},getPrimary:function(){return o.get().bind((function(t){return i(t).bind((function(t){return"prepared"===t.type?O.some(t.menu):O.none()}))}))},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(O.none())},isClear:function(){return o.get().isNone()}}}(),u=function(t){return Ad.getValue(t).value},a=function(t,n){bl.highlight(t,n),bl.getHighlighted(n).orThunk((function(){return bl.getFirst(n)})).each((function(n){Bo(t,n.element(),uo())}))},c=function(t,n){return Hi(j(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?O.some(t.menu):O.none()}))})))},s=function(n,e,o){var r=c(e,e.otherMenus(o));U(r,(function(e){mi(e.element(),[t.markers.backgroundMenu]),t.stayInDom||vd.remove(n,e)}))},l=function(n,e){var o,i=(o=n,r.get().getOrThunk((function(){var n={},e=Ua(o.element(),"."+t.markers.item),i=W(e,(function(t){return"true"===Fr(t,"aria-haspopup")}));return U(i,(function(t){o.getSystem().getByDom(t).each((function(t){var e=u(t);n[e]=t}))})),r.set(O.some(n)),n})));ct(i,(function(t,n){var o=P(e,n);_r(t.element(),"aria-expanded",o)}))},d=function(n,e,o){return O.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return O.none();var i=r.menu,u=c(e,o.slice(1));return U(u,(function(n){si(n.element(),t.markers.backgroundMenu)})),jo(i.element())||vd.append(n,Mi(i)),mi(i.element(),[t.markers.backgroundMenu]),a(n,i),s(n,e,o),O.some(i)}))}))};(o=e||(e={}))[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent";var m=function(n,o,r){void 0===r&&(r=e.HighlightSubmenu);var a=u(o);return i.expand(a).bind((function(u){return l(n,u),O.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,o),o}(n,a,c);return jo(s.element())||vd.append(n,Mi(s)),t.onOpenSubmenu(n,o,s),r===e.HighlightSubmenu?(bl.highlightFirst(s),d(n,i,u)):(bl.dehighlightAll(s),O.some(o))}))}))}))},g=function(n,e){var o=u(e);return i.collapse(o).bind((function(o){return l(n,o),d(n,i,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},p=function(n){return function(e,o){return Ri(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOption().bind((function(t){return n(e,t).map((function(){return!0}))}))}))}},h=qo([$o(cm(),(function(t,n){var e=n.event().menu();bl.highlight(t,e);var o=u(n.event().item());i.refresh(o).each((function(n){return s(t,i,n)}))})),ar((function(n,o){var r=o.event().target();n.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&g(n,o),m(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),(function(){}))}))})),rr((function(n,e){(function(n){var e,o,r,u=(e=n,o=t.data.primary,r=t.data.menus,st(r,(function(n,r){var i=function(){return sm.sketch(f({dom:n.dom},n,{value:r,items:n.items,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Il():Dl()}))};return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),a=st(t.data.menus,(function(t,n){return Q(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}));return i.setContents(t.data.primary,u,t.data.expansions,a),i.getPrimary()})(n).each((function(e){vd.append(n,Mi(e)),t.onOpenMenu(n,e),t.highlightImmediately&&a(n,e)}))}))].concat(t.navigateOnHover?[$o(Zd(),(function(n,o){var r,a,c=o.event().item();r=n,a=u(c),i.refresh(a).bind((function(t){return l(r,t),d(r,i,t)})),m(n,c,e.HighlightParent),t.onHover(n,c)}))]:[])),v={collapseMenu:function(t){bl.getHighlighted(t).each((function(n){bl.getHighlighted(n).each((function(n){g(t,n)}))}))},highlightPrimary:function(t){i.getPrimary().each((function(n){a(t,n)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:os(t.tmenuBehaviours,[dd.config({mode:"special",onRight:p((function(t,n){return ol(n.element())?O.none():m(t,n,e.HighlightSubmenu)})),onLeft:p((function(t,n){return ol(n.element())?O.none():g(t,n)})),onEscape:p((function(n,e){return g(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){i.getPrimary().each((function(n){Bo(t,n.element(),uo())}))}}),bl.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),ul.config({find:function(t){return bl.getHighlighted(t)}}),vd.config({})]),eventOrder:t.eventOrder,apis:v,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:It(t,n),expansions:{}}},collapseItem:function(t){return{value:Hr(fm()),meta:{text:t}}}}}),mm=nl({name:"InlineView",configFields:[Tn("lazySink"),$i("onShow"),$i("onHide"),Hn("onEscape"),ns("inlineBehaviours",[Kc,pu]),Pn("fireDismissalEventInstead",[zn("event",bo())]),zn("getRelated",O.none),zn("eventOrder",O.none)],factory:function(t,n){var e=function(n,e,o,r){var i=t.lazySink(n).getOrDie();Kc.openWhileCloaked(n,o,(function(){return Ac.positionWithin(i,e,n,r)})),t.onShow(n)},r={setContent:function(t,n){Kc.open(t,n)},showAt:function(t,n,o){var r=O.none();e(t,n,o,r)},showWithin:e,showWithinBounds:function(n,e,o,r){var i=t.lazySink(n).getOrDie();Kc.openWhileCloaked(n,o,(function(){return Ac.positionWithinBounds(i,e,n,r)})),t.onShow(n)},showMenuAt:function(n,e,o){var r,i,u,a,c,s=(r=t,i=n,u=e,a=o,c=function(){return r.lazySink(i)},dm.sketch({dom:{tag:"div"},data:a.data,markers:a.menu.markers,onEscape:function(){return Kc.close(i),r.onEscape.map((function(t){return t(i)})),O.some(!0)},onExecute:function(){return O.some(!0)},onOpenMenu:function(t,n){Ac.position(c().getOrDie(),u,n)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Ac.position(o,{anchor:"submenu",item:n},e)}}));Kc.open(n,s),t.onShow(n)},hide:function(n){Kc.close(n),t.onHide(n)},getContent:function(t){return Kc.getState(t)},isOpen:Kc.isOpen};return{uid:t.uid,dom:t.dom,behaviours:os(t.inlineBehaviours,[Kc.config({isPartOf:function(n,e,o){return Ni(e,o)||(r=n,i=o,t.getRelated(r).exists((function(t){return Ni(t,i)})));var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()}}),Zc(f({isExtraPart:o(!1)},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))]),eventOrder:t.eventOrder,apis:r}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)}}}),gm=function(t){var n=function(t,n){n.stop(),Eo(t)},e=Oe.detect().deviceType.isTouch()?[$o(ao(),n)]:[$o($e(),n),$o(ze(),(function(t,n){n.cut()}))];return qo($([t.map((function(t){return $o(io(),(function(n,e){t(n),e.stop()}))})).toArray(),e]))},pm=nl({name:"Button",factory:function(t){var n=gm(t.action),e=t.dom.tag,o=function(n){return Dt(t.dom,"attributes").bind((function(t){return Dt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:is(t.buttonBehaviours,[Vd.config({}),dd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return f({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[zn("uid",void 0),Tn("dom"),zn("components",[]),rs("buttonBehaviours",[Vd,dd]),In("action"),In("role"),zn("eventOrder",{})]}),hm=function(t){var n=function(t){return void 0!==t.uid}(t)&&Vt(t,"uid")?t.uid:Gr("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).fold(O.none,O.some)},asSpec:function(){return f({},t,{uid:n})}}},vm=function(t){return O.from(t()["temporary-placeholder"]).getOr("!not found!")},bm=function(t,n){return O.from(n()[t]).getOrThunk((function(){return vm(n)}))},ym={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},xm=nl({name:"Notification",factory:function(t){var n,e,o=hm({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:au([vd.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=hm({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:au([vd.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each((function(t){vd.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])}))},updateText:function(t,n){if(t.getSystem().isConnected()){var e=o.get(t);vd.set(e,[Bi(n)])}}},c=$([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return O.from(ym[t])})).toArray()]);return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,Pi(n,(function(t){return O.from(e()[t])})).getOrThunk((function(){return vm(e)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:au([vd.config({})])}].concat(t.progress?[u.asSpec()]:[]).concat(pm.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:bm("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),apis:a}},configFields:[In("level"),Tn("progress"),Tn("icon"),Tn("onAction"),Tn("text"),Tn("iconProvider"),Tn("translationProvider")],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),wm=tinymce.util.Tools.resolve("tinymce.util.Delay"),Sm=function(n,e){var o=null;return{cancel:function(){null!==o&&(t.clearTimeout(o),o=null)},throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null!==o&&t.clearTimeout(o),o=t.setTimeout((function(){n.apply(null,r),o=null}),e)}}},km=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Cm=pt([{aborted:[]},{edge:["element"]},{success:["info"]}]),Om=pt([{abort:[]},{kontinue:[]},{finish:["info"]}]),Tm=function(n,e,o,r,i,u){var a=function(){return u.fold(Cm.aborted,Cm.edge)},c=function(){var t=i();return t?Tm(n,t,O.none(),r,i,O.some(e)):a()};if(n.isBlock(e))return a();if(e.nodeType!==t.Node.TEXT_NODE)return c();var s=e.textContent;return r(Om,e,s,o).fold(Cm.aborted,(function(){return c()}),Cm.success)},Em=function(t,n,e,o,r){var i=new km(n,r||t.getRoot());return Tm(t,n,O.some(e),o,i.prev,O.none())},Bm=function(t){return Ri(t,"[data-mce-autocompleter]")},_m=/[\u00a0 \t\r\n]/,Am=function(t,n){return t.toString().substring(n.length).replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Fm=function(t,n,e,o){return void 0===o&&(o=0),Bm(te(n.startContainer)).fold((function(){return function(t,n,e,o){return void 0===o&&(o=0),(r=n).collapsed&&3===r.startContainer.nodeType?Em(t,n.startContainer,n.startOffset,(function(t,r,i,u){var a=u.getOr(i.length);return function(t,n,e){var o;for(o=n-1;0<=o;o--){var r=t.charAt(o);if(_m.test(r))return O.none();if(r===e)break}return-1===o||n-o<1?O.none():O.some(t.substring(o+1,n))}(i,a,e).fold((function(){return i.match(_m)?t.abort():t.kontinue()}),(function(u){var c=n.cloneRange();return c.setStart(r,a-u.length-1),c.setEnd(n.endContainer,n.endOffset),i.length<o?t.abort():t.finish({text:Am(c,e),range:c,triggerChar:e})}))})).fold(O.none,O.none,O.some):O.none();var r}(t,n,e,o)}),(function(n){var o=t.createRng();return o.selectNode(n.dom()),O.some({range:o,text:Am(o,e),triggerChar:e})}))},Mm=tinymce.util.Tools.resolve("tinymce.util.Promise"),Dm=function(t,n){return{element:t,offset:n}},Im=function(n){if(n.nodeType===t.Node.TEXT_NODE)return Dm(n,n.data.length);var e=n.childNodes;return 0<e.length?Im(e[e.length-1]):Dm(n,e.length)},Rm=function(n,e){var o=n.childNodes;return 0<o.length&&e<o.length?Rm(o[e],0):0<o.length&&n.nodeType===t.Node.ELEMENT_NODE&&o.length===e?Im(o[o.length-1]):Dm(n,e)},Vm=function(t,n,e){var i=n(),u=t.selection.getRng().startContainer.nodeValue,a=W(i.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return n=t.dom,e=function(t,n,e,o){var r=o.getOr(e.length);return 0===r?t.kontinue():t.finish(/\s/.test(e.charAt(r-1)))},function(t){var i=Rm(t.startContainer,t.startOffset);return Em(n,i.element,i.offset,e).fold(o(!0),o(!0),r)};var n,e}))(e.range,u,e.text)}));if(0===a.length)return O.none();var c=Mm.all(j(a,(function(t){return t.fetch(e.text,t.maxResults).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction}}))})));return O.some({lookupData:c,context:e})},Nm=tn([qn("type",(function(){return"autocompleteitem"})),qn("active",(function(){return!1})),qn("disabled",(function(){return!1})),zn("meta",{}),Bn("value"),Nn("text"),Nn("icon")]),Hm=tn([Bn("type"),Bn("ch"),jn("minChars",1),zn("columns",1),jn("maxResults",10),Hn("matches"),An("fetch"),An("onAction")]),Pm=[Gn("disabled",!1),Nn("text"),Nn("shortcut"),un("value","value",Ot((function(){return Hr("menuitem-value")})),vn()),zn("meta",{})],zm=tn([Bn("type"),Xn("onSetup",(function(){return n})),Xn("onAction",n),Nn("icon")].concat(Pm)),Lm=tn([Bn("type"),An("getSubmenuItems"),Xn("onSetup",(function(){return n})),Nn("icon")].concat(Pm)),jm=tn([Bn("type"),Gn("active",!1),Xn("onSetup",(function(){return n})),An("onAction")].concat(Pm)),Um=tn([Bn("type"),Gn("active",!1),Nn("icon")].concat(Pm)),Wm=tn([Bn("type"),Nn("text")]),Gm=tn([Bn("type"),_n("fancytype",["inserttable","colorswatch"]),Xn("onAction",n)]),Xm=function(t,n,e){var o=Ua(t.element(),"."+e);if(0<o.length){var r=q(o,(function(t){var e=t.dom().getBoundingClientRect().top,r=o[0].dom().getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return O.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return O.none()},Ym=function(t){return function(t,n){return au([Fd(t,n)])}(Hr("unnamed-events"),t)},qm=[Tn("lazySink"),Tn("tooltipDom"),zn("exclusive",!0),zn("tooltipComponents",[]),zn("delay",300),Wn("mode","normal",["normal","follow-highlight"]),zn("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:o([la,sa,ia,aa,ua,ca]),onRtl:o([la,sa,ia,aa,ua,ca])}}})),$i("onHide"),$i("onShow")],Km=Object.freeze({init:function(){var n=Kn(O.none()),e=Kn(O.none()),r=function(){n.get().each((function(n){t.clearTimeout(n)}))},i=o("not-implemented");return ni({getTooltip:function(){return e.get()},isShowing:function(){return e.get().isSome()},setTooltip:function(t){e.set(O.some(t))},clearTooltip:function(){e.set(O.none())},clearTimer:r,resetTimer:function(e,o){r(),n.set(O.some(t.setTimeout((function(){e()}),o)))},readState:i})}}),Jm=Hr("tooltip.exclusive"),$m=Hr("tooltip.show"),Qm=Hr("tooltip.hide"),Zm=function(t,n,e){t.getSystem().broadcastOn([Jm],{})},tg=Object.freeze({hideAllExclusive:Zm,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&vd.set(t,o)}))}}),ng=su({fields:qm,name:"tooltipping",active:Object.freeze({events:function(t,n){var e=function(e){n.getTooltip().each((function(o){Vc(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return qo($([[$o($m,(function(e){n.resetTimer((function(){!function(e){if(!n.isShowing()){Zm(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:qo("normal"===t.mode?[$o(We(),(function(t){Oo(e,$m)})),$o(je(),(function(t){Oo(e,Qm)}))]:[]),behaviours:au([vd.config({})])});n.setTooltip(r),Dc(o,r),t.onShow(e,r),Ac.position(o,t.anchor(e),r)}}(e)}),t.delay)})),$o(Qm,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),$o(ro(),(function(t,n){P(n.channels(),Jm)&&e(t)})),ir((function(t){e(t)}))],"normal"===t.mode?[$o(Ge(),(function(t){Oo(t,$m)})),$o(eo(),(function(t){Oo(t,Qm)})),$o(We(),(function(t){Oo(t,$m)})),$o(je(),(function(t){Oo(t,Qm)}))]:[$o(ko(),(function(t,n){Oo(t,$m)})),$o(Co(),(function(t){Oo(t,Qm)}))]]))}}),state:Km,apis:tg}),eg=function(t){var n,e,o,r=$n(t),i=hr(r),u=(e=void 0!==(n=r).dom().attributes?n.dom().attributes:[],X(e,(function(t,n){var e;return"class"===n.name?t:f({},t,((e={})[n.name]=n.value,e))}),{})),a=(o=r,Array.prototype.slice.call(o.dom().classList,0)),c=0===i.length?{}:{innerHtml:Tr(r)};return f({tag:No(r),classes:a,attributes:u},c)},og=tinymce.util.Tools.resolve("tinymce.util.I18n"),rg="tox-menu-nav__js",ig="tox-collection__item",ug="tox-swatch",ag={normal:rg,color:ug},cg="tox-collection__item--enabled",sg="tox-collection__item-icon",lg="tox-collection__item-label",fg="tox-collection__item--active",dg=function(t){return Dt(ag,t).getOr(rg)},mg=tinymce.util.Tools.resolve("tinymce.Env"),gg=function(t){var n=mg.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=j(e,(function(t){var e=t.toLowerCase().trim();return gt(n,e)?n[e]:t}));return mg.mac?o.join(""):o.join("+")},pg=function(t){return{dom:{tag:"div",classes:[sg],innerHtml:t}}},hg=function(t){return{dom:{tag:"div",classes:[lg]},components:[Bi(og.translate(t))]}},vg=function(t,n){return{dom:{tag:"div",classes:[lg]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[Bi(og.translate(n))]}]}},bg=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:gg(t)}}},yg=function(t){return{dom:{tag:"div",classes:[sg,"tox-collection__item-checkmark"],innerHtml:bm("checkmark",t)}}},xg=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],wg=["list-bull-circle","list-bull-default","list-bull-square"],Sg=function(t,n,e,o){void 0===o&&(o=O.none());var r,u,a,c,s,l,f,d=og.isRtl()&&t.iconContent.exists((function(t){return P(wg,t)})),m=(r=t.iconContent,r.map((function(t){return og.isRtl()&&P(xg,t)?t+"-rtl":t}))).map((function(t){return e=t,r=n.icons,i=o,O.from(r()[e]).or(i).getOrThunk((function(){return vm(r)}));var e,r,i})),g=O.from(t.meta).fold((function(){return hg}),(function(t){return gt(t,"style")?i(vg,t.style):hg}));return"color"===t.presets?(u=t.ariaLabel,a=t.value,c=n,{dom:(s=ug,l=m.getOr(""),f=u.map((function(t){return' title="'+c.translate(t)+'"'})).getOr(""),eg("custom"===a?'<button class="'+s+' tox-swatches__picker-btn"'+f+">"+l+"</button>":"remove"===a?'<div class="'+s+' tox-swatch--remove"'+f+">"+l+"</div>":'<div class="'+s+'" style="background-color: '+a+'" data-mce-color="'+a+'"'+f+"></div>")),optComponents:[]}):function(t,n,e,o,r){var i=e?t.checkMark.orThunk((function(){return n.or(O.some("")).map(pg)})):O.none(),u=t.ariaLabel.map((function(t){return{attributes:{title:og.translate(t)}}})).getOr({});return{dom:yt({tag:"div",classes:[rg,ig].concat(r?["tox-collection__item-icon-rtl"]:[])},u),optComponents:[i,t.htmlContent.fold((function(){return t.textContent.map(o)}),(function(t){return O.some({dom:{tag:"div",classes:[lg],innerHtml:t}})})),t.shortcutContent.map(bg),t.caret]}}(t,m,e,g,d)},kg=["input","button","textarea","select"],Cg=function(t,n,e){n.disabled&&Ag(t,n)},Og=function(t,n){return!0===n.useNative&&P(kg,No(t.element()))},Tg=function(t){_r(t.element(),"disabled","disabled")},Eg=function(t){Dr(t.element(),"disabled")},Bg=function(t){_r(t.element(),"aria-disabled","true")},_g=function(t){_r(t.element(),"aria-disabled","false")},Ag=function(t,n,e){n.disableClass.each((function(n){si(t.element(),n)})),(Og(t,n)?Tg:Bg)(t),n.onDisabled(t)},Fg=function(t,n,e){n.disableClass.each((function(n){li(t.element(),n)})),(Og(t,n)?Eg:_g)(t),n.onEnabled(t)},Mg=function(t,n){return Og(t,n)?Mr(t.element(),"disabled"):"true"===Fr(t.element(),"aria-disabled")},Dg=Object.freeze({enable:Fg,disable:Ag,isDisabled:Mg,onLoad:Cg,set:function(t,n,e,o){(o?Ag:Fg)(t,n,e)}}),Ig=Object.freeze({exhibit:function(t,n,e){return oi({classes:n.disabled?n.disableClass.map(et).getOr([]):[]})},events:function(t,n){return qo([Ko(io(),(function(n,e){return Mg(n,t)})),ru(t,n,Cg)])}}),Rg=[zn("disabled",!1),zn("useNative",!0),In("disableClass"),$i("onDisabled"),$i("onEnabled")],Vg=su({fields:Rg,name:"disabling",active:Ig,apis:Dg}),Ng=function(t){return Vg.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Hg=function(t){return Vg.config({disabled:t})},Pg=function(t){return Vg.config({disabled:t,disableClass:"tox-tbtn--disabled"})},zg=function(t){return Vg.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Lg=function(t,n){var e=t.getApi(n);return function(t){t(e)}},jg=function(t,n){return rr((function(e){Lg(t,e)((function(e){var o=t.onSetup(e);null!=o&&n.set(o)}))}))},Ug=function(t,n){return ir((function(e){return Lg(t,e)(n.get())}))};(Nl=Vl||(Vl={}))[Nl.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Nl[Nl.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var Wg,Gg,Xg=Vl,Yg={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},qg=function(t){return Q(t,(function(t){return t.toArray()}))},Kg=function(t,e,o){var r,i,u=Kn(n);return{type:"item",dom:e.dom,components:qg(e.optComponents),data:t.data,eventOrder:Yg,hasSubmenu:t.triggersSubmenu,itemBehaviours:au([Fd("item-events",[(r=t,i=o,ar((function(t,n){Lg(r,t)(r.onAction),r.triggersSubmenu||i!==Xg.CLOSE_ON_EXECUTE||(Oo(t,lo()),n.stop())}))),jg(t,u),Ug(t,u)]),Ng(t.disabled),vd.config({})].concat(t.itemBehaviours))}},Jg=function(t){return{value:t.value,meta:yt({text:t.text.getOr("")},t.meta)}},$g=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Qg=o(Is("item-widget",om())),Zg=Hr("cell-over"),tp=Hr("cell-execute"),np=function(t,n,e){var o,r=function(e){return To(e,tp,{row:t,col:n})};return Fi({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:au([Fd("insert-table-picker-cell",[$o(We(),Vd.focus),$o(io(),r),$o(co(),r)]),qd.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Vd.config({onFocus:function(e){return To(e,Zg,{row:t,col:n})}})])})},ep=function(t){return{value:o(t)}},op=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,rp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ip=function(t){return op.test(t)||rp.test(t)},up=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},ap=function(t){var n=up(t.red())+up(t.green())+up(t.blue());return ep(n)},cp=Math.min,sp=Math.max,lp=Math.round,fp=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,dp=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,mp=function(t,n,e,r){return{red:o(t),green:o(n),blue:o(e),alpha:o(r)}},gp=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},pp=function(t){var n,e,o,r=(t.hue()||0)%360,i=t.saturation()/100,u=t.value()/100;if(i=sp(0,cp(i,1)),u=sp(0,cp(u,1)),0===i)return n=e=o=lp(255*u),mp(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=lp(255*(n+l)),e=lp(255*(e+l)),o=lp(255*(o+l)),mp(n,e,o,1)},hp=function(t){var n=function(t){var n,e=(n=t.value().replace(op,(function(t,n,e,o){return n+n+e+e+o+o})),{value:o(n)}),r=rp.exec(e.value());return null===r?["FFFFFF","FF","FF","FF"]:r}(t),e=parseInt(n[1],16),r=parseInt(n[2],16),i=parseInt(n[3],16);return mp(e,r,i,1)},vp=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return mp(r,i,u,a)},bp=function(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"},yp=o(mp(255,0,0,1)),xp=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),wp="tinymce-custom-colors",Sp="choiceitem",kp=[{type:Sp,text:"Light Green",value:"#BFEDD2"},{type:Sp,text:"Light Yellow",value:"#FBEEB8"},{type:Sp,text:"Light Red",value:"#F8CAC6"},{type:Sp,text:"Light Purple",value:"#ECCAFA"},{type:Sp,text:"Light Blue",value:"#C2E0F4"},{type:Sp,text:"Green",value:"#2DC26B"},{type:Sp,text:"Yellow",value:"#F1C40F"},{type:Sp,text:"Red",value:"#E03E2D"},{type:Sp,text:"Purple",value:"#B96AD9"},{type:Sp,text:"Blue",value:"#3598DB"},{type:Sp,text:"Dark Turquoise",value:"#169179"},{type:Sp,text:"Orange",value:"#E67E23"},{type:Sp,text:"Dark Red",value:"#BA372A"},{type:Sp,text:"Dark Purple",value:"#843FA1"},{type:Sp,text:"Dark Blue",value:"#236FA1"},{type:Sp,text:"Light Gray",value:"#ECF0F1"},{type:Sp,text:"Medium Gray",value:"#CED4D9"},{type:Sp,text:"Gray",value:"#95A5A6"},{type:Sp,text:"Dark Gray",value:"#7E8C8D"},{type:Sp,text:"Navy Blue",value:"#34495E"},{type:Sp,text:"Black",value:"#000000"},{type:Sp,text:"White",value:"#ffffff"}],Cp=function(t){void 0===t&&(t=10);var n,e=xp.getItem(wp),o=A(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)};return{add:function(n){var e,o,u;(e=r,o=n,u=H(e,o),-1===u?O.none():O.some(u)).each(i),r.unshift(n),r.length>t&&r.pop(),xp.setItem(wp,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Op=function(t){return!1!==t.getParam("custom_colors")},Tp=function(n){var e=function(t){return t.getParam("color_map")}(n);return void 0!==e?function(n){var e=[],o=t.document.createElement("canvas");o.height=1,o.width=1;for(var r=o.getContext("2d"),i=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},u=function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();r.clearRect(0,0,o.width,o.height),r.fillStyle="#FFFFFF",r.fillStyle=t,r.fillRect(0,0,1,1);var n=r.getImageData(0,0,1,1).data,e=n[0],u=n[1],a=n[2],c=n[3];return"#"+i(e,c)+i(u,c)+i(a,c)},a=0;a<n.length;a+=2)e.push({text:n[a+1],value:u(n[a]),type:"choiceitem"});return e}(e):kp},Ep=function(t){Cp.add(t)},Bp=function(t){return t.fire("ResizeContent")},_p=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),e},Ap=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},Fp=function(t){var n=Tp(t);return function(t,n){return t.getParam("color_cols",n,"number")}(t,Ap(n.length))},Mp=function(t,n,e,o){"custom"===e?Hp(t)((function(e){e.each((function(e){Ep(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},Dp=function(t,n){return t.concat(j(Cp.state(),(function(t){return{type:Sp,text:t,value:t}})).concat((e={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[e,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[e])));var e},Ip=function(t,n){return function(e){e(Dp(t,n))}},Rp=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},Vp=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return O.from(_p(t,e)).bind((function(t){return function(t){if("transparent"===t)return O.some(mp(0,0,0,0));var n=fp.exec(t);if(null!==n)return O.some(vp(n[1],n[2],n[3],"1"));var e=dp.exec(t);return null!==e?O.some(vp(e[1],e[2],e[3],e[4])):O.none()}(t).map((function(t){var e=ap(t).value();return ye(n.toLowerCase(),e)}))})).getOr(!1)},columns:Fp(t),fetch:Ip(Tp(t),Op(t)),onAction:function(n){null!==r.get()&&Mp(t,e,r.get(),(function(){}))},onItemAction:function(o,i){Mp(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){null!==r.get()&&Rp(e,n,r.get());var o=function(t){t.name===n&&Rp(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},Np=function(t,e,o,r){t.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Mp(t,o,e.value,n)}}]}})},Hp=function(t){return function(n,e){var o,r={colorpicker:e},i=(o=n,function(t){var n=t.getData();o(O.from(n.colorpicker)),t.close()});t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:i,onClose:function(){},onCancel:function(){n(O.none())}})}},Pp={register:function(t){var n;(n=t).addCommand("mceApplyTextcolor",(function(t,e){var o,r,i;r=t,i=e,(o=n).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),n.addCommand("mceRemoveTextcolor",(function(t){var e,o;o=t,(e=n).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}));var e=Kn(null),o=Kn(null);Vp(t,"forecolor","forecolor","Text color",e),Vp(t,"backcolor","hilitecolor","Background color",o),Np(t,"forecolor","forecolor","Text color"),Np(t,"backcolor","hilitecolor","Background color")},getColors:Dp,getFetch:Ip,colorPickerDialog:Hp,getCurrentColor:_p,getColorCols:Fp,calcCols:Ap},zp=function(t,n){return function(e){var o=L(e,n);return j(o,(function(n){return{dom:t,components:n}}))}},Lp=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[sm.parts().items({preprocess:function(e){return"auto"!==t&&1<t?zp({tag:"div",classes:["tox-collection__group"]},t)(e):(o=function(t,e){return"separator"===n[e].type},r=[],i=[],U(e,(function(t,n){o(0,n)?(0<i.length&&r.push(i),i=[],gt(t.dom,"innerHtml")&&i.push(t)):i.push(t)})),0<i.length&&r.push(i),j(r,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})));var o,r,i}})]}},jp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:(n=t,"color"===n?"tox-swatches":"tox-menu"),tieredMenu:"tox-tiered-menu"};var n},Up=function(t){var n=jp(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:dg(t)}},Wp=[sm.parts().items({})],Gp=function(t,n,e){var o=jp(e);return{dom:{tag:"div",classes:$([[o.tieredMenu]])},markers:Up(e)}},Xp=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},Yp=function(n){return t.console.error(gn(n)),t.console.log(n),O.none()},qp=function(t,n,e,o,i){var u,a,c,s,l,f,d;return"color"===i?{value:t,dom:(u=o,d={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[sm.parts().items({preprocess:"auto"!==u?zp({tag:"div",classes:["tox-swatches__row"]},u):r})]}]}).dom,components:d.components,items:e}:"normal"===i&&"auto"===o?{value:t,dom:(d=Lp(o,e)).dom,components:d.components,items:e}:"normal"===i&&1===o?{value:t,dom:(d=Lp(1,e)).dom,components:d.components,items:e}:"normal"===i?{value:t,dom:(d=Lp(o,e)).dom,components:d.components,items:e}:"listpreview"!==i||"auto"===o?{value:t,dom:(c=n,s=o,l=i,f=jp(l),{tag:"div",classes:$([[f.menu,"tox-menu-"+s+"-column"],c?[f.hasIcons]:[]])}),components:Wp,items:e}:{value:t,dom:(a=o,d={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[sm.parts().items({preprocess:zp({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:d.components,items:e}},Kp=function(t,n,e,o,r,i,u,a){var c=z(n,Xp),s=Jp(n,e,o,"color"!==r?"normal":"color",i,u,a);return qp(t,c,s,o,r)},Jp=function(t,n,e,o,r,i,u){return Hi(j(t,(function(t){return"choiceitem"===t.type?(a=t,fn("choicemenuitem",Um,a)).fold(Yp,(function(a){return O.some((c=a,s=1===e,l=o,f=n,d=i(t.value),m=r,g=u,p=Sg({presets:l,textContent:s?c.text:O.none(),htmlContent:O.none(),ariaLabel:c.text,iconContent:c.icon,shortcutContent:s?c.shortcut:O.none(),checkMark:s?O.some(yg(g.icons)):O.none(),caret:O.none(),value:c.value},g,!0),bt(Kg({data:Jg(c),disabled:c.disabled,getApi:function(t){return{setActive:function(n){qd.set(t,n)},isActive:function(){return qd.isOn(t)},isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},onAction:function(t){return f(c.value)},onSetup:function(t){return t.setActive(d),function(){}},triggersSubmenu:!1,itemBehaviours:[]},p,m),{toggling:{toggleClass:cg,toggleOnExecute:!1,selected:c.active}})));var c,s,l,f,d,m,g,p})):O.none();var a})))},$p=function(t,n){var e=Up(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Qp={inserttable:function(t){var n,e=Hr("size-label"),o=function(t){for(var n=[],e=0;e<10;e++){for(var o=[],r=0;r<10;r++)o.push(np(e,r,t));n.push(o)}return n}(e),r=hm({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:e}},components:[Bi("0x0")],behaviours:au([vd.config({})])});return{type:"widget",data:{value:Hr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Qg().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:(n=o,Q(n,(function(t){return j(t,Mi)}))).concat(r.asSpec()),behaviours:au([Fd("insert-table-picker",[nr(Zg,(function(t,n,e){var i,u,a=e.event().row(),c=e.event().col();!function(t,n,e){for(var o=0;o<10;o++)for(var r=0;r<10;r++)qd.set(t[o][r],o<=n&&r<=e)}(o,a,c),vd.set(r.get(t),[(i=a,u=c,Bi(u+1+"x"+(i+1)))])})),nr(tp,(function(n,e,o){t.onAction({numRows:o.event().row()+1,numColumns:o.event().col()+1}),Oo(n,lo())}))]),dd.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=Pp.getColors(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=Kp(Hr("menu-value"),e,(function(n){t.onAction({value:n})}),o,"color",Xg.CLOSE_ON_EXECUTE,(function(){return!1}),n.shared.providers),i=bt(f({},r,{markers:Up("color"),movement:$p(o,"color")}));return{type:"widget",data:{value:Hr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Qg().widget(sm.sketch(i))]}}};(Gg=Wg||(Wg={}))[Gg.ContentFocus=0]="ContentFocus",Gg[Gg.UiFocus=1]="UiFocus";var Zp=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},th=function(t){return z(t,Zp)},nh=function(e,o,r,i){var u=th(o),a=Hi(j(o,(function(e){var o=function(e){return function(e,o,r,i){void 0===i&&(i=!0);var u,a,c,s,l,d=r.shared.providers;switch(e.type){case"menuitem":return(l=e,fn("menuitem",zm,l)).fold(Yp,(function(t){return O.some(function(t,n,e,o){void 0===o&&(o=!0);var r=Sg({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:O.none(),ariaLabel:t.text,caret:O.none(),checkMark:O.none(),shortcutContent:t.shortcut},e,o);return Kg({data:Jg(t),getApi:function(t){return{isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n)}(t,o,d,i))}));case"nestedmenuitem":return(s=e,fn("nestedmenuitem",Lm,s)).fold(Yp,(function(t){return O.some(function(t,e,o,r){void 0===r&&(r=!0);var i,u=(i=o.icons,{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:bm("chevron-right",i)}}),a=Sg({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:O.none(),ariaLabel:t.text,caret:O.some(u),checkMark:O.none(),shortcutContent:t.shortcut},o,r);return Kg({data:Jg(t),getApi:function(t){return{isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},disabled:t.disabled,onAction:n,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,e)}(t,o,d,i))}));case"togglemenuitem":return(c=e,fn("togglemenuitem",jm,c)).fold(Yp,(function(t){return O.some(function(t,n,e){var o=Sg({iconContent:O.none(),textContent:t.text,htmlContent:O.none(),ariaLabel:t.text,checkMark:O.some(yg(e.icons)),caret:O.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,!0);return bt(Kg({data:Jg(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){qd.set(t,n)},isActive:function(){return qd.isOn(t)},isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n),{toggling:{toggleClass:cg,toggleOnExecute:!1,selected:t.active}})}(t,o,d))}));case"separator":return(a=e,fn("separatormenuitem",Wm,a)).fold(Yp,(function(t){return O.some(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:f({tag:"div",classes:[ig,"tox-collection__group-heading"]},n),components:[]}}(t))}));case"fancymenuitem":return(u=e,fn("fancymenuitem",Gm,u)).fold(Yp,(function(t){return function(t,n){return(e=Qp,o=t.fancytype,Object.prototype.hasOwnProperty.call(e,o)?O.some(e[o]):O.none()).map((function(e){return e(t,n)}));var e,o}(t,r)}));default:return t.console.error("Unknown item in general menu",e),O.none()}}(e,r,i,u)};return"nestedmenuitem"===e.type&&e.getSubmenuItems().length<=0?o(yt(e,{disabled:!0})):o(e)})));return qp(e,u,a,1,"normal")},eh=function(t){return dm.singleData(t.value,t)},oh=function(n,e){var o=Kn(O.none()),r=Fi(mm.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:au([Fd("dismissAutocompleter",[$o(bo(),(function(){return a()}))])]),lazySink:e.getSink})),i=function(){return o.get().isSome()},u=function(){i()&&mm.hide(r)},a=function(){if(i()){var t=o.get().map((function(t){return t.element}));Bm(t.getOr(te(n.selection.getNode()))).each(Or),u(),o.set(O.none())}},c=xt((function(){return function(t){var n,e,o=t.ui.registry.getAll().popups,r=st(o,(function(t){return(n=t,fn("Autocompleter",Hm,n)).fold((function(t){throw new Error(gn(t))}),(function(t){return t}));var n})),i=(n=ft(r,(function(t){return t.ch})),e={},U(n,(function(t){e[t]={}})),ut(e)),u=dt(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return W(u,(function(n){return n.ch===t}))}}}(n)})),s=Sm((function(s){27!==s.which&&o.get().map((function(t){return Fm(n.dom,n.selection.getRng(),t.triggerChar).bind((function(t){return Vm(n,c,t)}))})).getOrThunk((function(){return function(t,n){var e,o,r,i=n(),u=t.selection.getRng();return(e=t.dom,o=u,r=i,Pi(r.triggerChars,(function(t){return Fm(e,o,t)}))).bind((function(e){return Vm(t,n,e)}))}(n,c)})).fold(a,(function(c){!function(t){if(!i()){var e=function(t,n){return Bm(te(t.selection.getNode())).getOrThunk((function(){var e=$n('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return wr(e,te(n.extractContents())),n.insertNode(e.dom()),gr(e).each((function(t){return t.dom().normalize()})),function(t){return ja(t,La)}(e).map((function(n){var e;t.selection.setCursorLocation(n.dom(),"img"===No(e=n)?1:Pa(e).fold((function(){return hr(e).length}),(function(t){return t.length})))})),e}))}(n,t.range);o.set(O.some({triggerChar:t.triggerChar,element:e,matchLength:t.text.length}))}}(c.context),c.lookupData.then((function(i){o.get().map((function(o){var s,l,f,d=c.context;if(o.triggerChar===d.triggerChar){var m=(s=d.triggerChar,f=Pi(l=i,(function(t){return O.from(t.columns)})).getOr(1),Q(l,(function(o){return function(t,n,e,o,r,i){var u=1===o,a=!u||th(t);return Hi(j(t,(function(t){return(o=t,fn("Autocompleter.Item",Nm,o)).fold(Yp,(function(t){return O.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c,s,l=Sg({presets:o,textContent:O.none(),htmlContent:e?t.text.map((function(t){return function(t,n){var e,o=(e=og.translate(t),$g.DOM.encode(e));if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return o}(t,n)})):O.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:O.none(),checkMark:O.none(),caret:O.none(),value:t.value},u.providers,a,t.icon);return Kg({data:Jg(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(n){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(c=t.meta,s=u,mt(c,"tooltipWorker").map((function(t){return[ng.config({lazySink:s.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Sc}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){ng.setComponents(n,[_i({element:te(t)})])}))}})]})).getOr([]))},l,i)}(t,n,u,"normal",e,r,i,a))}));var o})))}(o.items,o.matchText,(function(e,r){var i=n.selection.getRng();Fm(n.dom,i,s).fold((function(){return t.console.error("Lost context. Cursor probably moved")}),(function(t){var n=t.range,i={hide:a};o.onAction(i,n,e,r)}))}),f,Xg.BUBBLE_TO_SANDBOX,e)})));0<m.length?function(t,e,o,i){t.matchLength=e.text.length;var u,a,c,s,l,f,d,m=Pi(o,(function(t){return O.from(t.columns)})).getOr(1);mm.showAt(r,{anchor:"node",root:te(n.getBody()),node:O.from(t.element)},sm.sketch((u=qp("autocompleter-value",!0,i,m,"normal"),a=m,s="normal",l=(c=Wg.ContentFocus)===Wg.ContentFocus?Il():Dl(),f=$p(a,s),d=Up(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===Wg.ContentFocus,focusManager:l,menuBehaviours:Ym("auto"!==a?[]:[rr((function(t,n){Xm(t,4,d.item).each((function(n){var e=n.numColumns,o=n.numRows;dd.setGridSize(t,o,e)}))}))])}))),mm.getContent(r).each(bl.highlightFirst)}(o,d,i,m):10<=d.text.length-o.matchLength?a():u()}}))}))}))}),50);!function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){To(t,Ye(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(bl.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Eo),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(bl.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&Bm(te(n.element)).isNone()&&t.cancelIfNecessary()}))}({onKeypress:s,cancelIfNecessary:a,isMenuOpen:function(){return mm.isOpen(r)},isActive:i,getView:function(){return mm.getContent(r)}},n)},rh=function(t,n,r,u,a){var c=function(t,n){return function(r){if(t(r)){var i,u,a,c,s,l,f,d=te(r.target),m=function(){r.stopPropagation()},g=function(){r.preventDefault()},p=e(g,m),h=(i=d,u=r.clientX,a=r.clientY,c=m,s=g,l=p,f=r,{target:o(i),x:o(u),y:o(a),stop:c,prevent:s,kill:l,raw:o(f)});n(h)}}}(r,u);return t.dom().addEventListener(n,c,a),{unbind:i(ih,t,n,c,a)}},ih=function(t,n,e,o){t.dom().removeEventListener(n,e,o)},uh=o(!0),ah=function(t,n,e){return rh(t,n,uh,e,!1)},ch=function(t,n,e){return rh(t,n,uh,e,!0)},sh=function(t,n,e){return Ri(t,n,e).isSome()};function lh(n,e){var o=null;return{cancel:function(){null!==o&&(t.clearTimeout(o),o=null)},schedule:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o=t.setTimeout((function(){n.apply(null,r),o=null}),e)}}}var fh=function(t){var n=t.raw();return void 0===n.touches||1!==n.touches.length?O.none():O.some(n.touches[0])},dh=Oe.detect().browser.isFirefox(),mh=Zt([An("triggerEvent"),zn("stopBackspace",!0)]),gh=function(t,n){var e=Dt(t,"target").map((function(t){return t()})).getOr(n);return Kn(e)},ph=pt([{stopped:[]},{resume:["element"]},{complete:[]}]),hh=function(t,n,e,r,i,u){var a,c,s,l,f=t(n,r),d=(a=e,c=i,s=Kn(!1),l=Kn(!1),{stop:function(){s.set(!0)},cut:function(){l.set(!0)},isStopped:s.get,isCut:l.get,event:o(a),setSource:c.set,getSource:c.get});return f.fold((function(){return u.logEventNoHandlers(n,r),ph.complete()}),(function(t){var e=t.descHandler();return ri(e)(d),d.isStopped()?(u.logEventStopped(n,t.element(),e.purpose()),ph.stopped()):d.isCut()?(u.logEventCut(n,t.element(),e.purpose()),ph.complete()):gr(t.element()).fold((function(){return u.logNoParent(n,t.element(),e.purpose()),ph.complete()}),(function(o){return u.logEventResponse(n,t.element(),e.purpose()),ph.resume(o)}))}))},vh=function(t,n,e,o,r,i){return hh(t,n,e,o,r,i).fold((function(){return!0}),(function(o){return vh(t,n,e,o,r,i)}),(function(){return!1}))},bh=function(t,e,r){var i,u,c=(i=e,u=Kn(!1),{stop:function(){u.set(!0)},cut:n,isStopped:u.get,isCut:o(!1),event:o(i),setSource:a("Cannot set source of a broadcasted event"),getSource:a("Cannot get source of a broadcasted event")});return U(t,(function(t){var n=t.descHandler();ri(n)(c)})),c.isStopped()},yh=function(t,n,e,o,r){var i=gh(e,o);return vh(t,n,e,o,i,r)},xh=cr("element","descHandler");function wh(){var t=function(){var t={};return{registerId:function(n,e,r){ct(r,(function(r,u){var a=void 0!==t[u]?t[u]:{};a[e]=function(t,n){return e=i.apply(void 0,[t.handler].concat(n)),r=t.purpose(),{cHandler:e,purpose:o(r)};var e,r}(r,n),t[u]=a}))},unregisterId:function(n){ct(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return Dt(t,n).map((function(t){return ft(t,(function(t,n){return function(t,n){return{id:o(t),descHandler:o(n)}}(n,t)}))})).getOr([])},find:function(n,e,o){var r=Ft(e)(t);return Yo(o,(function(t){return n=r,Wr(e=t).fold((function(){return O.none()}),(function(t){var o=Ft(t);return n.bind(o).map((function(t){return xh(e,t)}))}));var n,e}),n)}}}(),n={},e=function(e){Wr(e.element()).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(o){var r=function(t){var n=t.element();return Wr(n).fold((function(){return n=t.element(),e=Hr(Lr+"uid-"),Ur(n,e),e;var n,e}),(function(t){return t}))}(o);Vt(n,r)&&function(t,o){var r=n[o];if(r!==t)throw new Error('The tagId "'+o+'" is already used by: '+Ir(r.element())+"\nCannot use it for: "+Ir(t.element())+"\nThe conflicting element is"+(jo(r.element())?" ":" not ")+"already in the DOM");e(t)}(o,r);var i=[o];t.registerId(i,r,o.events()),n[r]=o},unregister:e,getById:function(t){return Ft(t)(n)}}}var Sh,kh,Ch=nl({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=d(n,["attributes"]);return{uid:t.uid,dom:f({tag:"div",attributes:f({role:"presentation"},e)},o),components:t.components,behaviours:es(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[zn("components",[]),ns("containerBehaviours",[]),zn("events",{}),zn("domModification",{}),zn("eventOrder",{})]}),Oh=function(e){var r=function(t){return gr(e.element()).fold((function(){return!0}),(function(n){return Ie(t,n)}))},i=wh(),u=function(t,n){return i.find(r,t,n)},a=function(n,e){var r,i,u,a,c=mn("Getting GUI events settings",mh,e),s=Oe.detect().deviceType.isTouch()?["touchstart","touchmove","touchend","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],l=function(t){var n=Kn(O.none()),e=lh((function(e){n.set(O.none()),t.triggerEvent(so(),e)}),400),r=Rt([{key:Ne(),value:function(t){return fh(t).each((function(r){e.cancel();var i={x:o(r.clientX),y:o(r.clientY),target:t.target};e.schedule(t),n.set(O.some(i))})),O.none()}},{key:He(),value:function(t){return e.cancel(),fh(t).each((function(t){n.get().each((function(e){var o,r,i,u;o=t,r=e,i=Math.abs(o.clientX-r.x()),u=Math.abs(o.clientY-r.y()),(5<i||5<u)&&n.set(O.none())}))})),O.none()}},{key:Pe(),value:function(o){return e.cancel(),n.get().filter((function(t){return Ie(t.target(),o.target())})).map((function(n){return t.triggerEvent(ao(),o)}))}}]);return{fireIfReady:function(t,n){return Dt(r,n).bind((function(n){return n(t)}))}}}(c),f=j(s.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return ah(n,t,(function(n){l.fireIfReady(n,t).each((function(t){t&&n.kill()})),c.triggerEvent(t,n)&&n.kill()}))})),d=Kn(O.none()),m=ah(n,"paste",(function(n){l.fireIfReady(n,"paste").each((function(t){t&&n.kill()})),c.triggerEvent("paste",n)&&n.kill(),d.set(O.some(t.setTimeout((function(){c.triggerEvent(oo(),n)}),0)))})),g=ah(n,"keydown",(function(t){var n;c.triggerEvent("keydown",t)?t.kill():!0!==c.stopBackspace||8!==(n=t).raw().which||P(["input","textarea"],No(n.target()))||sh(n.target(),'[contenteditable="true"]')||t.prevent()})),p=(r=n,i=function(t){c.triggerEvent("focusin",t)&&t.kill()},dh?ch(r,"focus",i):ah(r,"focusin",i)),h=Kn(O.none()),v=(u=n,a=function(n){c.triggerEvent("focusout",n)&&n.kill(),h.set(O.some(t.setTimeout((function(){c.triggerEvent(eo(),n)}),0)))},dh?ch(u,"blur",a):ah(u,"focusout",a));return{unbind:function(){U(f,(function(t){t.unbind()})),g.unbind(),p.unbind(),v.unbind(),m.unbind(),d.get().each(t.clearTimeout),h.get().each(t.clearTimeout)}}}(e.element(),{triggerEvent:function(t,n){return ji(t,n.target(),(function(e){return o=u,r=t,a=e,c=(i=n).target(),yh(o,r,i,c,a);var o,r,i,a,c}))}}),c={debugInfo:o("real"),triggerEvent:function(t,n,e){ji(t,n,(function(o){yh(u,t,e,n,o)}))},triggerFocus:function(t,e){Wr(t).fold((function(){_l(t)}),(function(r){ji(no(),t,(function(r){var i,a,c,s,l,f;i=u,a=no(),c={originator:o(e),kill:n,prevent:n,target:o(t)},l=r,f=gh(c,s=t),hh(i,a,c,s,f,l)}))}))},triggerEscape:function(t,n){c.triggerEvent("keydown",t.element(),n.event())},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:Fi,addToGui:function(t){f(t)},removeFromGui:function(t){d(t)},addToWorld:function(t){s(t)},removeFromWorld:function(t){l(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:o(!0)},s=function(t){t.connect(c),zo(t.element())||(i.register(t),U(t.components(),s),c.triggerEvent(mo(),t.element(),{target:o(t.element())}))},l=function(t){zo(t.element())||(U(t.components(),l),i.unregister(t)),t.disconnect()},f=function(t){Dc(e,t)},d=function(t){Vc(t)},m=function(t){var n=i.filter(ro());U(n,(function(n){var e=n.descHandler();ri(e)(t)}))},g=function(t){m({universal:o(!0),data:o(t)})},p=function(t,n){m({universal:o(!1),channels:o(t),data:o(n)})},h=function(t,n){var e=i.filter(t);return bh(e,n)},v=function(t){return i.getById(t).fold((function(){return B.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),B.value)},b=function(t){var n=Wr(t).getOr("not found");return v(n)};return s(e),{root:o(e),element:e.element,destroy:function(){a.unbind(),Cr(e.element())},add:f,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:l,broadcast:g,broadcastOn:p,broadcastEvent:h}},Th=tinymce.util.Tools.resolve("tinymce.EditorManager"),Eh=function(t){return O.from(t.settings.min_width).filter(R)},Bh=function(t){return O.from(t.settings.min_height).filter(R)},_h=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Ah=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=A(n),r=M(n)&&0<n.length;return!Mh(t)&&(r||o||e)},Fh=function(t){var n=ut(t.settings),e=W(n,(function(t){return/^toolbar([1-9])$/.test(t)})),o=j(e,(function(n){return t.getParam(n,!1,"string")})),r=W(o,(function(t){return"string"==typeof t}));return 0<r.length?O.some(r):O.none()},Mh=function(t){return Fh(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),(function(){return!0}))};(kh=Sh||(Sh={})).default="",kh.floating="floating",kh.sliding="sliding";var Dh,Ih,Rh=function(t){return t.getParam("toolbar_drawer","","string")},Vh=function(t){var n=t.getParam("fixed_toolbar_container","","string"),e=t.getParam("inline",!1,"boolean");return 0<n.length&&e?Ii(Uo(),n):O.none()},Nh=function(t){return t.getParam("inline",!1,"boolean")&&Vh(t).isSome()},Hh=Hr("form-component-change"),Ph=Hr("form-close"),zh=Hr("form-cancel"),Lh=Hr("form-action"),jh=Hr("form-submit"),Uh=Hr("form-block"),Wh=Hr("form-unblock"),Gh=Hr("form-tabchange"),Xh=Hr("form-resize"),Yh=o([zn("prefix","form-field"),ns("fieldBehaviours",[ul,Ad])]),qh=o([_s({schema:[Tn("dom")],name:"label"}),_s({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Tn("text")],name:"aria-descriptor"}),Es({factory:{sketch:function(t){var n=At(t,["factory"]);return t.factory.sketch(n)}},schema:[Tn("factory")],name:"field"})]),Kh=el({name:"FormField",configFields:Yh(),partFields:qh(),factory:function(t,n,e,o){var r=os(t.fieldBehaviours,[ul.config({find:function(n){return Ls(n,t,"field")}}),Ad.config({store:{mode:"manual",getValue:function(t){return ul.getCurrent(t).bind(Ad.getValue)},setValue:function(t,n){ul.getCurrent(t).each((function(t){Ad.setValue(t,n)}))}}})]),i=qo([rr((function(n,e){var o=Us(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Hr(t.prefix);o.label().each((function(t){_r(t.element(),"for",e),_r(n.element(),"id",e)})),o["aria-descriptor"]().each((function(e){var o=Hr(t.prefix);_r(e.element(),"id",o),_r(n.element(),"aria-describedby",o)}))}))}))]),u={getField:function(n){return Ls(n,t,"field")},getLabel:function(n){return Ls(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Jh=Object.freeze({getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),$h=[En("others",ln(B.value,vn()))],Qh=su({fields:$h,name:"coupling",apis:Jh,state:Object.freeze({init:function(t){var n={},e=o({});return ni({readState:e,getOrCreate:function(t,e,o){var r=ut(e.others);if(r)return Dt(n,o).getOrThunk((function(){var r=Dt(e.others,o).getOrDie("No information found for coupled component: "+o)(t),i=t.getSystem().build(r);return n[o]=i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Zh=Object.freeze({events:function(t,n){var e=t.stream.streams.setup(t,n);return qo([$o(t.event,e),ir((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[$o(t,(function(){return n.cancel()}))]})).getOr([])))}}),tv=function(t){var n=Kn(null);return ni({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},nv=Object.freeze({throttle:tv,init:function(t){return t.stream.streams.state(t)}}),ev=[En("stream",hn("mode",{throttle:[Tn("delay"),zn("stopEvent",!0),nu("streams",{setup:function(t,n){var e=t.stream,o=Sm(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:tv})]})),zn("event","input"),In("cancelEvent"),Zi("onStream")],ov=su({fields:ev,name:"streaming",active:Zh,state:nv}),rv={},iv={exports:rv};Dh=rv,Ih=iv,function(t){"object"==typeof Dh&&void 0!==Ih?Ih.exports=t():("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var s=e[u]={exports:{}};n[u][0].call(s.exports,(function(t){return r(n[u][1][t]||t)}),s,s.exports,t,n,e,o)}return e[u].exports}for(var i=!1,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n,e){var o,r,i=n.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var s,l=[],f=!1,d=-1;function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var t=c(m);f=!0;for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run();d=-1,n=l.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{return r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];l.push(new p(t,n)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){!function(e){var o=setTimeout;function r(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function u(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void c(n.promise,t)}a(n.promise,o)}else(1===t._state?a:c)(n.promise,t._value)}))):t._deferreds.push(n)}function a(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof i)return t._state=3,t._value=n,void s(t);if("function"==typeof e)return void f(function(t,n){return function(){t.apply(n,arguments)}}(e,n),t)}t._state=1,t._value=n,s(t)}catch(n){c(t,n)}}function c(t,n){t._state=2,t._value=n,s(t)}function s(t){2===t._state&&0===t._deferreds.length&&i._immediateFn((function(){t._handled||i._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)u(t,t._deferreds[n]);t._deferreds=null}function l(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function f(t,n){var e=!1;try{t((function(t){e||(e=!0,a(n,t))}),(function(t){e||(e=!0,c(n,t))}))}catch(t){if(e)return;e=!0,c(n,t)}}i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(r);return u(this,new l(t,n,e)),e},i.all=function(t){var n=Array.prototype.slice.call(t);return new i((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},i.resolve=function(t){return t&&"object"==typeof t&&t.constructor===i?t:new i((function(n){n(t)}))},i.reject=function(t){return new i((function(n,e){e(t)}))},i.race=function(t){return new i((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},i._immediateFn="function"==typeof t?function(n){t(n)}:function(t){o(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}));var uv,av,cv=iv.exports.boltExport,sv=function(n){var e=O.none(),o=[],r=function(t){i()?u(t):o.push(t)},i=function(){return e.isSome()},u=function(n){e.each((function(e){t.setTimeout((function(){n(e)}),0)}))};return n((function(t){e=O.some(t),function(t){U(t,u)}(o),o=[]})),{get:r,map:function(t){return sv((function(n){r((function(e){n(t(e))}))}))},isReady:i}},lv={nu:sv,pure:function(t){return sv((function(n){n(t)}))}},fv=function(n){t.setTimeout((function(){throw n}),0)},dv=function(t){var n=function(n){t().then(n,fv)};return{map:function(n){return dv((function(){return t().then(n)}))},bind:function(n){return dv((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return dv((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return lv.nu(n)},toCached:function(){var n=null;return dv((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},mv=function(t){return dv((function(){return new cv(t)}))},gv=function(t){return dv((function(){return cv.resolve(t)}))},pv=o("sink"),hv=o(_s({name:pv(),overrides:o({dom:{tag:"div"},behaviours:au([Ac.config({useFixed:!0})]),events:qo([er(Ye()),er(ze()),er($e())])})}));(av=uv||(uv={}))[av.HighlightFirst=0]="HighlightFirst",av[av.HighlightNone=1]="HighlightNone";var vv=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}}))},bv=function(t,n,e,o,r,i,u){var a,c,s,l,d,m,g,p,h,v,b=vv(t,e);return(c=b,l=o,d=r,m=u,g=n,p=s=e,h=(0,(a=t).fetch)(p).map(g),v=wv(s,a),h.map((function(t){return t.bind((function(t){return O.from(dm.sketch(f({},d.menu(),{uid:Gr(""),data:t,highlightImmediately:m===uv.HighlightFirst,onOpenMenu:function(t,n){var e=v().getOrDie();Ac.position(e,c,n),Kc.decloak(l)},onOpenSubmenu:function(t,n,e){var o=v().getOrDie();Ac.position(o,{anchor:"submenu",item:n},e),Kc.decloak(l)},onEscape:function(){return Vd.focus(s),Kc.close(l),O.some(!0)}})))}))}))).map((function(t){return t.fold((function(){Kc.isOpen(o)&&Kc.close(o)}),(function(t){Kc.cloak(o),Kc.open(o,t),i(o)})),o}))},yv=function(t,n,e,o,r,i,u){return Kc.close(o),gv(o)},xv=function(t,n,e,o,r,i){var u=Qh.getCoupled(e,"sandbox");return(Kc.isOpen(u)?yv:bv)(t,n,e,u,o,r,i)},wv=function(t,n){return t.getSystem().getByUid(n.uid+"-"+pv()).map((function(t){return function(){return B.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return B.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},Sv=function(t,n,e){var r=Vi(),i=wv(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:r.id(),role:"listbox"}},behaviours:is(t.sandboxBehaviours,[Ad.config({store:{mode:"memory",initialValue:n}}),Kc.config({onOpen:function(o,i){var u=vv(t,n);r.link(n.element()),t.matchWidth&&function(t,n,e){var o,r,i=ul.getCurrent(n).getOr(n),u=_u(t.element());e?vi(i.element(),"min-width",u+"px"):(o=i.element(),r=u,Bu.set(o,r))}(u.hotspot,i,t.useMinWidth),t.onOpen(u,o,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(o,i)},onClose:function(t,o){r.unlink(n.element()),void 0!==e&&void 0!==e.onClose&&e.onClose(t,o)},isPartOf:function(t,e,o){return Ni(e,o)||Ni(n,o)},getAttachPoint:function(){return i().getOrDie()}}),ul.config({find:function(t){return Kc.getState(t).bind((function(t){return ul.getCurrent(t)}))}}),Zc({isExtraPart:o(!1)})])}},kv=function(t,n,e){var o=Ad.getValue(e);Ad.setValue(n,o),Ov(n)},Cv=function(t,n){var e=t.element(),o=Oi(e),r=e.dom();"number"!==Fr(e,"type")&&n(r,o)},Ov=function(t){Cv(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},Tv=o([In("data"),zn("inputAttributes",{}),zn("inputStyles",{}),zn("tag","input"),zn("inputClasses",[]),$i("onSetValue"),zn("styles",{}),zn("eventOrder",{}),ns("inputBehaviours",[Ad,Vd]),zn("selectOnFocus",!0)]),Ev=function(t){return au([Vd.config({onFocus:!1===t.selectOnFocus?n:function(t){var n=t.element(),e=Oi(n);n.dom().setSelectionRange(0,e.length)}})])},Bv=function(t){return{tag:t.tag,attributes:f({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},_v=o("alloy.typeahead.itemexecute"),Av=function(){return[zn("sandboxClasses",[]),rs("sandboxBehaviours",[ul,pu,Kc,Ad])]},Fv=o([In("lazySink"),Tn("fetch"),zn("minChars",5),zn("responseTime",1e3),$i("onOpen"),zn("getHotspot",O.some),zn("getAnchorOverrides",o({})),zn("layouts",O.none()),zn("eventOrder",{}),Yn("model",{},[zn("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),zn("selectsOver",!0),zn("populateFromBrowse",!0)]),$i("onSetValue"),Qi("onExecute"),$i("onItemExecute"),zn("inputClasses",[]),zn("inputAttributes",{}),zn("inputStyles",{}),zn("matchWidth",!0),zn("useMinWidth",!1),zn("dismissOnBlur",!0),Ki(["openClass"]),In("initialData"),ns("typeaheadBehaviours",[Vd,Ad,ov,dd,qd,Qh]),qn("previewing",(function(){return Kn(!0)}))].concat(Tv()).concat(Av())),Mv=o([Bs({schema:[qi()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=Ad.getValue(n),r=t.getDisplayText(o),i=Ad.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?O.some((function(){var t,o;kv(0,n,e),t=n,o=r.length,Cv(t,(function(t,n){return t.setSelectionRange(o,n.length)}))})):O.none()}return O.none()})(t.model,o,e).fold((function(){return bl.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&kv(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOption().map((function(t){return To(t,_v(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&kv(t.model,n,e)}))}}}})]),Dv=el({name:"Typeahead",configFields:Fv(),partFields:Mv(),factory:function(t,e,o,r){var i=function(e,o,i){t.previewing.set(!1);var u=Qh.getCoupled(e,"sandbox");Kc.isOpen(u)?ul.getCurrent(u).each((function(t){bl.getHighlighted(t).fold((function(){i(t)}),(function(){Ao(u,t.element(),"keydown",o)}))})):bv(t,a(e),e,u,r,(function(t){ul.getCurrent(t).each(i)}),uv.HighlightFirst).get(n)},u=Ev(t),a=function(t){return function(n){return n.map((function(n){var e=dt(n.menus),o=Q(e,(function(t){return W(t.items,(function(t){return"item"===t.type}))}));return Ad.getState(t).update(j(o,(function(t){return t.data}))),n}))}},c=[Vd.config({}),Ad.config({onSetValue:t.onSetValue,store:f({mode:"dataset",getDataKey:function(t){return Oi(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Ti(n.element(),t.model.getDisplayText(e))}},t.initialData.map((function(t){return It("initialValue",t)})).getOr({}))}),ov.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(e,o){var i=Qh.getCoupled(e,"sandbox");if(Vd.isFocused(e)&&Oi(e.element()).length>=t.minChars){var u=ul.getCurrent(i).bind((function(t){return bl.getHighlighted(t).map(Ad.getValue)}));t.previewing.set(!0),bv(t,a(e),e,i,r,(function(n){ul.getCurrent(i).each((function(n){u.fold((function(){t.model.selectsOver&&bl.highlightFirst(n)}),(function(t){bl.highlightBy(n,(function(n){return Ad.getValue(n).value===t.value})),bl.getHighlighted(n).orThunk((function(){return bl.highlightFirst(n),O.none()}))}))}))}),uv.HighlightFirst).get(n)}},cancelEvent:fo()}),dd.config({mode:"special",onDown:function(t,n){return i(t,n,bl.highlightFirst),O.some(!0)},onEscape:function(t){var n=Qh.getCoupled(t,"sandbox");return Kc.isOpen(n)?(Kc.close(n),O.some(!0)):O.none()},onUp:function(t,n){return i(t,n,bl.highlightLast),O.some(!0)},onEnter:function(n){var e=Qh.getCoupled(n,"sandbox"),o=Kc.isOpen(e);if(o&&!t.previewing.get())return ul.getCurrent(e).bind((function(t){return bl.getHighlighted(t)})).map((function(t){return To(n,_v(),{item:t}),!0}));var r=Ad.getValue(n);return Oo(n,fo()),t.onExecute(e,n,r),o&&Kc.close(e),O.some(!0)}}),qd.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Qh.config({others:{sandbox:function(n){return Sv(t,n,{onOpen:function(){return qd.on(n)},onClose:function(){return qd.off(n)}})}}}),Fd("typeaheadevents",[ar((function(e){var o=n;xv(t,a(e),e,r,o,uv.HighlightFirst).get(n)})),$o(_v(),(function(n,e){var o=Qh.getCoupled(n,"sandbox");kv(t.model,n,e.event().item()),Oo(n,fo()),t.onItemExecute(n,o,e.event().item(),Ad.getValue(n)),Kc.close(o),Ov(n)}))].concat(t.dismissOnBlur?[$o(eo(),(function(t){var n=Qh.getCoupled(t,"sandbox");Fl(n.element()).isNone()&&Kc.close(n)}))]:[]))];return{uid:t.uid,dom:Bv(bt(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:f({},u,os(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}}}),Iv=function(t,n,e,o){var r=Vv(t,n,e,o);return Kh.sketch(r)},Rv=function(t,n){return Iv(t,n,[],[])},Vv=function(t,n,e,o){return{dom:Nv(e),components:t.toArray().concat([n]),fieldBehaviours:au(o)}},Nv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Hv=function(t,n){return Kh.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Pv=function(t){return"separator"===t.type},zv={type:"separator"},Lv=function(t,n){var e=function(t,n){var e=X(t,(function(t,e){return A(e)?""===e?t:"|"===e?0<t.length&&!Pv(t[t.length-1])?t.concat([zv]):t:gt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return 0<e.length&&Pv(e[e.length-1])&&e.pop(),e}(A(t)?t.split(" "):t,n);return G(e,(function(t,e){var o=function(t){if(Pv(t))return t;var n=Dt(t,"value").getOrThunk((function(){return Hr("generated-menu-item")}));return bt({value:n},t)}(e),r=function(t,n){return gt(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=Lv(r,o),{item:e,menus:bt(i.menus,It(e.value,i.items)),expansions:bt(i.expansions,It(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i}(o,n);return{menus:bt(t.menus,r.menus),items:[r.item].concat(t.items),expansions:bt(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},jv=function(t,n,e){var o=Hr("primary-menu"),r=Lv(t,e.shared.providers.menuItems());if(0===r.items.length)return O.none();var i=nh(o,r.items,n,e),u=st(r.menus,(function(t,o){return nh(o,t,n,e)})),a=bt(u,It(o,i));return O.from(dm.tieredData(o,a,r.expansions))},Uv=nl({name:"Input",configFields:Tv(),factory:function(t,n){return{uid:t.uid,dom:Bv(t),components:[],behaviours:(e=t,f({},Ev(e),os(e.inputBehaviours,[Ad.config({store:{mode:"manual",initialValue:e.data.getOr(void 0),getValue:function(t){return Oi(t.element())},setValue:function(t,n){Oi(t.element())!==n&&Ti(t.element(),n)}},onSetValue:e.onSetValue})]))),eventOrder:t.eventOrder};var e}}),Wv=["input","textarea"],Gv=function(t){var n=No(t);return P(Wv,n)},Xv=function(t,n){var e=n.getRoot(t).getOr(t.element());li(e,n.invalidClass),n.notify.each((function(n){Gv(t.element())&&_r(t.element(),"aria-invalid",!1),n.getContainer(t).each((function(t){Er(t,n.validHtml)})),n.onValid(t)}))},Yv=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element());si(r,n.invalidClass),n.notify.each((function(n){Gv(t.element())&&_r(t.element(),"aria-invalid",!0),n.getContainer(t).each((function(t){Er(t,o)})),n.onInvalid(t,o)}))},qv=function(t,n,e){return n.validator.fold((function(){return gv(B.value(!0))}),(function(n){return n.validate(t)}))},Kv=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),qv(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Yv(t,n,0,e),B.error(e)}),(function(e){return Xv(t,n),B.value(e)})):B.error("No longer in system")}))},Jv=Object.freeze({markValid:Xv,markInvalid:Yv,query:qv,run:Kv,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element());return fi(e,n.invalidClass)}}),$v=Object.freeze({events:function(t,e){return t.validator.map((function(e){return qo([$o(e.onEvent,(function(n){Kv(n,t).get(r)}))].concat(e.validateOnLoad?[rr((function(e){Kv(e,t).get(n)}))]:[]))})).getOr({})}}),Qv=[Tn("invalidClass"),zn("getRoot",O.none),Pn("notify",[zn("aria","alert"),zn("getContainer",O.none),zn("validHtml",""),$i("onValid"),$i("onInvalid"),$i("onValidate")]),Pn("validator",[Tn("validate"),zn("onEvent","input"),zn("validateOnLoad",!0)])],Zv=su({fields:Qv,name:"invalidating",active:$v,apis:Jv,extra:{validation:function(t){return function(n){var e=Ad.getValue(n);return gv(t(e))}}}}),tb=Object.freeze({exhibit:function(t,n){return oi({attributes:Rt([{key:n.tabAttr,value:"true"}])})}}),nb=[zn("tabAttr","data-alloy-tabstop")],eb=su({fields:nb,name:"tabstopping",active:tb}),ob=o([Tn("dom"),Tn("fetch"),$i("onOpen"),Qi("onExecute"),zn("getHotspot",O.some),zn("getAnchorOverrides",o({})),zn("layouts",O.none()),ns("dropdownBehaviours",[qd,Qh,dd,Vd]),Tn("toggleClass"),zn("eventOrder",{}),In("lazySink"),zn("matchWidth",!1),zn("useMinWidth",!1),In("role")].concat(Av())),rb=o([Bs({schema:[qi()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),hv()]),ib=el({name:"Dropdown",configFields:ob(),partFields:rb(),factory:function(t,e,o,r){var i,u=function(t){Kc.getState(t).each((function(t){dm.highlightPrimary(t)}))},a={expand:function(e){qd.isOn(e)||xv(t,(function(t){return t}),e,r,n,uv.HighlightNone).get(n)},open:function(e){qd.isOn(e)||xv(t,(function(t){return t}),e,r,n,uv.HighlightFirst).get(n)},isOpen:qd.isOn,close:function(e){qd.isOn(e)&&xv(t,(function(t){return t}),e,r,n,uv.HighlightFirst).get(n)}},c=function(t,n){return Eo(t),O.some(!0)};return{uid:t.uid,dom:t.dom,components:e,behaviours:os(t.dropdownBehaviours,[qd.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Qh.config({others:{sandbox:function(n){return Sv(t,n,{onOpen:function(){qd.on(n)},onClose:function(){qd.off(n)}})}}}),dd.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t,n){if(ib.isOpen(t)){var e=Qh.getCoupled(t,"sandbox");u(e)}else ib.open(t);return O.some(!0)},onEscape:function(t,n){return ib.isOpen(t)?(ib.close(t),O.some(!0)):O.none()}}),Vd.config({})]),events:gm(O.some((function(e){xv(t,(function(t){return t}),e,r,u,uv.HighlightFirst).get(n)}))),eventOrder:f({},t.eventOrder,(i={},i[io()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:a,domModification:{attributes:f({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}})),"button"===t.dom.tag?{type:Dt(t.dom,"attributes").bind((function(t){return Dt(t,"type")})).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)}}}),ub=su({fields:[],name:"unselecting",active:Object.freeze({events:function(t){return qo([Ko(Ze(),o(!0))])},exhibit:function(t,n){return oi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),ab=Hr("color-input-change"),cb=Hr("color-swatch-change"),sb=Hr("color-picker-cancel"),lb=function(t,n,e){return{hue:o(t),saturation:o(n),value:o(e)}},fb=o(Hr("rgb-hex-update")),db=o(Hr("slider-update")),mb=o(Hr("palette-update")),gb=Oe.detect().deviceType.isTouch(),pb=_s({schema:[Tn("dom")],name:"label"}),hb=function(t){return _s({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){var e=qo([Qo(Ne(),t,[n])]),o=qo([Qo(ze(),t,[n]),Qo(Le(),(function(n,e){e.mouseIsDown.get()&&t(n,e)}),[n])]);return{events:gb?e:o}}))}})},vb=hb("top-left"),bb=hb("top"),yb=hb("top-right"),xb=hb("right"),wb=hb("bottom-right"),Sb=hb("bottom"),kb=hb("bottom-left"),Cb=[pb,hb("left"),xb,bb,Sb,vb,yb,kb,wb,Es({name:"thumb",defaults:o({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:qo([tr(Ne(),t,"spectrum"),tr(He(),t,"spectrum"),tr(Pe(),t,"spectrum"),tr(ze(),t,"spectrum"),tr(Le(),t,"spectrum"),tr(Ue(),t,"spectrum")])}}}),Es({schema:[qn("mouseIsDown",(function(){return Kn(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))},o=qo([$o(Ne(),e),$o(He(),e)]),r=qo([$o(ze(),e),$o(Le(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))]);return{behaviours:au(gb?[]:[dd.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Vd.config({})]),events:gb?o:r}}})],Ob=Oe.detect().deviceType.isTouch(),Tb=o("slider.change.value"),Eb=function(t){var n=t.event().raw();if(Ob){var e=n;return void 0!==e.touches&&1===e.touches.length?O.some(e.touches[0]).map((function(t){return bu(t.clientX,t.clientY)})):O.none()}var o=n;return void 0!==o.clientX?O.some(o).map((function(t){return bu(t.clientX,t.clientY)})):O.none()},Bb=function(t){return t.model.minX},_b=function(t){return t.model.minY},Ab=function(t){return t.model.minX-1},Fb=function(t){return t.model.minY-1},Mb=function(t){return t.model.maxX},Db=function(t){return t.model.maxY},Ib=function(t){return t.model.maxX+1},Rb=function(t){return t.model.maxY+1},Vb=function(t,n,e){return n(t)-e(t)},Nb=function(t){return Vb(t,Mb,Bb)},Hb=function(t){return Vb(t,Db,_b)},Pb=function(t){return Nb(t)/2},zb=function(t){return Hb(t)/2},Lb=function(t){return t.stepSize},jb=function(t){return t.snapToGrid},Ub=function(t){return t.snapStart},Wb=function(t){return t.rounded},Gb=function(t,n){return void 0!==t[n+"-edge"]},Xb=function(t){return Gb(t,"left")},Yb=function(t){return Gb(t,"right")},qb=function(t){return Gb(t,"top")},Kb=function(t){return Gb(t,"bottom")},Jb=function(t){return t.model.value.get()},$b=function(t){return{x:o(t)}},Qb=function(t){return{y:o(t)}},Zb=function(t,n){return{x:o(t),y:o(n)}},ty=function(t,n){To(t,Tb(),{value:n})},ny=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},ey=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},oy=function(t,n,e){return Math.max(n,Math.min(e,t))},ry=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=oy(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold((function(){var t=h-v,n=Math.round(t/y)*y;return oy(v+n,v-1,b+1)}),(function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)}))):c?Math.round(C):C},iy=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},uy="left",ay=function(t){return t.element().dom().getBoundingClientRect()},cy=function(t,n){return t[n]},sy=function(t){var n=ay(t);return cy(n,uy)},ly=function(t){var n=ay(t);return cy(n,"right")},fy=function(t){var n=ay(t);return cy(n,"top")},dy=function(t){var n=ay(t);return cy(n,"bottom")},my=function(t){var n=ay(t);return cy(n,"width")},gy=function(t){var n=ay(t);return cy(n,"height")},py=function(t,n,e){return(t+n)/2-e},hy=function(t,n){var e=ay(t),o=ay(n),r=cy(e,uy),i=cy(e,"right"),u=cy(o,uy);return py(r,i,u)},vy=function(t,n){var e=ay(t),o=ay(n),r=cy(e,"top"),i=cy(e,"bottom"),u=cy(o,"top");return py(r,i,u)},by=function(t,n){To(t,Tb(),{value:n})},yy=function(t){return{x:o(t)}},xy=function(t,n,e){var o={min:Bb(n),max:Mb(n),range:Nb(n),value:e,step:Lb(n),snap:jb(n),snapStart:Ub(n),rounded:Wb(n),hasMinEdge:Xb(n),hasMaxEdge:Yb(n),minBound:sy(t),maxBound:ly(t),screenRange:my(t)};return ry(o)},wy=function(t){return function(n,e){return(o=t,r=n,i=e,u=(0<o?ey:ny)(Jb(i).x(),Bb(i),Mb(i),Lb(i)),by(r,yy(u)),O.some(u)).map((function(){return!0}));var o,r,i,u}},Sy=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=my(u=n),d=s.bind((function(t){return O.some(hy(t,u))})).getOr(0),m=l.bind((function(t){return O.some(hy(t,u))})).getOr(f),g={min:Bb(a),max:Mb(a),range:Nb(a),value:c,hasMinEdge:Xb(a),hasMaxEdge:Yb(a),minBound:sy(u),minOffset:0,maxBound:ly(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},iy(g));return sy(n)-sy(t)+p},ky=wy(-1),Cy=wy(1),Oy=O.none,Ty=O.none,Ey={"top-left":O.none(),top:O.none(),"top-right":O.none(),right:O.some((function(t,n){ty(t,$b(Ib(n)))})),"bottom-right":O.none(),bottom:O.none(),"bottom-left":O.none(),left:O.some((function(t,n){ty(t,$b(Ab(n)))}))},By=Object.freeze({setValueFrom:function(t,n,e){var o=xy(t,n,e),r=yy(o);return by(t,r),o},setToMin:function(t,n){var e=Bb(n);by(t,yy(e))},setToMax:function(t,n){var e=Mb(n);by(t,yy(e))},findValueOfOffset:xy,getValueFromEvent:function(t){return Eb(t).map((function(t){return t.left()}))},findPositionOfValue:Sy,setPositionFromValue:function(t,n,e,o){var r=Jb(e),i=Sy(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),u=_u(n.element())/2;vi(n.element(),"left",i-u+"px")},onLeft:ky,onRight:Cy,onUp:Oy,onDown:Ty,edgeActions:Ey}),_y=function(t,n){To(t,Tb(),{value:n})},Ay=function(t){return{y:o(t)}},Fy=function(t,n,e){var o={min:_b(n),max:Db(n),range:Hb(n),value:e,step:Lb(n),snap:jb(n),snapStart:Ub(n),rounded:Wb(n),hasMinEdge:qb(n),hasMaxEdge:Kb(n),minBound:fy(t),maxBound:dy(t),screenRange:gy(t)};return ry(o)},My=function(t){return function(n,e){return(o=t,r=n,i=e,u=(0<o?ey:ny)(Jb(i).y(),_b(i),Db(i),Lb(i)),_y(r,Ay(u)),O.some(u)).map((function(){return!0}));var o,r,i,u}},Dy=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=gy(u=n),d=s.bind((function(t){return O.some(vy(t,u))})).getOr(0),m=l.bind((function(t){return O.some(vy(t,u))})).getOr(f),g={min:_b(a),max:Db(a),range:Hb(a),value:c,hasMinEdge:qb(a),hasMaxEdge:Kb(a),minBound:fy(u),minOffset:0,maxBound:dy(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},iy(g));return fy(n)-fy(t)+p},Iy=O.none,Ry=O.none,Vy=My(-1),Ny=My(1),Hy={"top-left":O.none(),top:O.some((function(t,n){ty(t,Qb(Fb(n)))})),"top-right":O.none(),right:O.none(),"bottom-right":O.none(),bottom:O.some((function(t,n){ty(t,Qb(Rb(n)))})),"bottom-left":O.none(),left:O.none()},Py=Object.freeze({setValueFrom:function(t,n,e){var o=Fy(t,n,e),r=Ay(o);return _y(t,r),o},setToMin:function(t,n){var e=_b(n);_y(t,Ay(e))},setToMax:function(t,n){var e=Db(n);_y(t,Ay(e))},findValueOfOffset:Fy,getValueFromEvent:function(t){return Eb(t).map((function(t){return t.top()}))},findPositionOfValue:Dy,setPositionFromValue:function(t,n,e,o){var r=Jb(e),i=Dy(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),u=Tu(n.element())/2;vi(n.element(),"top",i-u+"px")},onLeft:Iy,onRight:Ry,onUp:Vy,onDown:Ny,edgeActions:Hy}),zy=function(t,n){To(t,Tb(),{value:n})},Ly=function(t,n){return{x:o(t),y:o(n)}},jy=function(t,n){return function(e,o){return(r=t,i=n,u=e,a=o,c=0<r?ey:ny,s=i?Jb(a).x():c(Jb(a).x(),Bb(a),Mb(a),Lb(a)),l=i?c(Jb(a).y(),_b(a),Db(a),Lb(a)):Jb(a).y(),zy(u,Ly(s,l)),O.some(s)).map((function(){return!0}));var r,i,u,a,c,s,l}},Uy=jy(-1,!1),Wy=jy(1,!1),Gy=jy(-1,!0),Xy=jy(1,!0),Yy={"top-left":O.some((function(t,n){ty(t,Zb(Ab(n),Fb(n)))})),top:O.some((function(t,n){ty(t,Zb(Pb(n),Fb(n)))})),"top-right":O.some((function(t,n){ty(t,Zb(Ib(n),Fb(n)))})),right:O.some((function(t,n){ty(t,Zb(Ib(n),zb(n)))})),"bottom-right":O.some((function(t,n){ty(t,Zb(Ib(n),Rb(n)))})),bottom:O.some((function(t,n){ty(t,Zb(Pb(n),Rb(n)))})),"bottom-left":O.some((function(t,n){ty(t,Zb(Ab(n),Rb(n)))})),left:O.some((function(t,n){ty(t,Zb(Ab(n),zb(n)))}))},qy=Object.freeze({setValueFrom:function(t,n,e){var o=xy(t,n,e.left()),r=Fy(t,n,e.top()),i=Ly(o,r);return zy(t,i),i},setToMin:function(t,n){var e=Bb(n),o=_b(n);zy(t,Ly(e,o))},setToMax:function(t,n){var e=Mb(n),o=Db(n);zy(t,Ly(e,o))},getValueFromEvent:function(t){return Eb(t)},setPositionFromValue:function(t,n,e,o){var r=Jb(e),i=Sy(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),u=Dy(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),a=_u(n.element())/2,c=Tu(n.element())/2;vi(n.element(),"left",i-a+"px"),vi(n.element(),"top",u-c+"px")},onLeft:Uy,onRight:Wy,onUp:Gy,onDown:Xy,edgeActions:Yy}),Ky=Oe.detect().deviceType.isTouch(),Jy=[zn("stepSize",1),zn("onChange",n),zn("onChoose",n),zn("onInit",n),zn("onDragStart",n),zn("onDragEnd",n),zn("snapToGrid",!1),zn("rounded",!0),In("snapStart"),En("model",hn("mode",{x:[zn("minX",0),zn("maxX",100),qn("value",(function(t){return Kn(t.mode.minX)})),Tn("getInitialValue"),nu("manager",By)],y:[zn("minY",0),zn("maxY",100),qn("value",(function(t){return Kn(t.mode.minY)})),Tn("getInitialValue"),nu("manager",Py)],xy:[zn("minX",0),zn("maxX",100),zn("minY",0),zn("maxY",100),qn("value",(function(t){return Kn({x:o(t.mode.minX),y:o(t.mode.minY)})})),Tn("getInitialValue"),nu("manager",qy)]})),ns("sliderBehaviours",[dd,Ad])].concat(Ky?[]:[qn("mouseIsDown",(function(){return Kn(!1)}))]),$y=Oe.detect().deviceType.isTouch(),Qy=el({name:"Slider",configFields:Jy,partFields:Cb,factory:function(t,n,e,r){var i=function(n){return js(n,t,"thumb")},u=function(n){return js(n,t,"spectrum")},a=function(n){return Ls(n,t,"left-edge")},c=function(n){return Ls(n,t,"right-edge")},s=function(n){return Ls(n,t,"top-edge")},l=function(n){return Ls(n,t,"bottom-edge")},f=t.model,d=f.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:l,getSpectrum:u})},g=function(n,e){f.value.set(e);var o=i(n);return m(n,o),t.onChange(n,o,e),O.some(!0)},p=[$o(Ne(),(function(n,e){t.onDragStart(n,i(n))})),$o(Pe(),(function(n,e){t.onDragEnd(n,i(n))}))],h=[$o(ze(),(function(n,e){e.stop(),t.onDragStart(n,i(n)),t.mouseIsDown.set(!0)})),$o(Ue(),(function(n,e){t.onDragEnd(n,i(n))}))],v=$y?p:h;return{uid:t.uid,dom:t.dom,components:n,behaviours:os(t.sliderBehaviours,$([$y?[]:[dd.config({mode:"special",focusIn:function(n){return Ls(n,t,"spectrum").map(dd.focusIn).map(o(!0))}})],[Ad.config({store:{mode:"manual",getValue:function(t){return f.value.get()}}}),pu.config({channels:{"mouse.released":{onReceive:function(n,e){var o=t.mouseIsDown.get();t.mouseIsDown.set(!1),o&&Ls(n,t,"thumb").each((function(e){var o=f.value.get();t.onChoose(n,e,o)}))}}}})]])),events:qo([$o(Tb(),(function(t,n){g(t,n.event().value())})),rr((function(n,e){var o=f.getInitialValue();f.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,f.value.get())}))].concat(v)),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Zy=function(t,n){var e=Qy.parts().spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=Qy.parts().thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return Qy.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:o({y:o(0)})},components:[e,r],sliderBehaviours:au([Vd.config({})]),onChange:function(t,n,e){To(t,db(),{value:e})}})},tx=[ns("formBehaviours",[Ad])],nx=function(t){return"<alloy.field."+t+">"},ex=function(t,n,e){return{uid:t.uid,dom:t.dom,components:n,behaviours:os(t.formBehaviours,[Ad.config({store:{mode:"manual",getValue:function(n){var e=Ws(n,t);return st(e,(function(t,n){return t().bind((function(t){return ul.getCurrent(t).fold((function(){return B.error("missing current")}),B.value)})).map(Ad.getValue)}))},setValue:function(n,e){ct(e,(function(e,o){Ls(n,t,o).each((function(t){ul.getCurrent(t).each((function(t){Ad.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Ls(n,t,e).bind(ul.getCurrent)}}}},ox={getField:Zr((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),Vs("form",nx(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=j(r,(function(t){return Es({name:t,pname:nx(t)})}));return $s("form",tx,i,ex,o)}},rx=Hr("valid-input"),ix=Hr("invalid-input"),ux=Hr("validating-input"),ax="colorcustom.rgb.",cx=function(t,e){return nl({name:"ColourPicker",configFields:[Tn("dom"),zn("onValidHex",n),zn("onInvalidHex",n)],factory:function(r){var i,u,a=function(t,e,r,i){var u=function(o,r,i,u,a){var c,s,l=t(ax+"range"),d=[Kh.parts().label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Kh.parts().field({data:a,factory:Uv,inputAttributes:f({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:au([(c=r,s=o,Zv.config({invalidClass:e("invalid"),notify:{onValidate:function(t){To(t,ux,{type:c})},onValid:function(t){To(t,rx,{type:c,value:Ad.getValue(t)})},onInvalid:function(t){To(t,ix,{type:c,value:Ad.getValue(t)})}},validator:{validate:function(n){var e=Ad.getValue(n),o=s(e)?B.value(!0):B.error(t("aria.input.invalid"));return gv(o)},validateOnLoad:!1}})),eb.config({})]),onSetValue:function(t){Zv.isInvalid(t)&&Zv.run(t).get(n)}})],m="hex"!==r?[Kh.parts()["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},a=function(t,n){var e=n.red(),o=n.green(),r=n.blue();Ad.setValue(t,{red:e,green:o,blue:r})},c=hm({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(t,n){c.getOpt(t).each((function(t){vi(t.element(),"background-color","#"+n.value())}))};return nl({factory:function(){var n={red:o(Kn(O.some(255))),green:o(Kn(O.some(255))),blue:o(Kn(O.some(255))),hex:o(Kn(O.some("ffffff")))},l=function(t){return n[t]().get()},f=function(t,e){n[t]().set(e)},d=function(t){var n=t.red(),e=t.green(),o=t.blue();f("red",O.some(n)),f("green",O.some(e)),f("blue",O.some(o))},m=function(t,n){var e=n.event();"hex"!==e.type()?f(e.type(),O.none()):i(t)},g=function(t,n){var e=n.event();"hex"===e.type()?function(t,n){r(t);var e=ep(n);f("hex",O.some(n));var o=hp(e);a(t,o),d(o),To(t,fb(),{hex:e}),s(t,e)}(t,e.value()):function(t,n,e){var o=parseInt(e,10);f(n,O.some(o)),l("red").bind((function(t){return l("green").bind((function(n){return l("blue").map((function(e){return mp(t,n,e,1)}))}))})).each((function(n){var e,o,r=(e=t,o=ap(n),ox.getField(e,"hex").each((function(t){Vd.isFocused(t)||Ad.setValue(e,{hex:o.value()})})),o);s(t,r)}))}(t,e.type(),e.value())},p=function(n){return{label:t(ax+n+".label"),description:t(ax+n+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex");return bt(ox.sketch((function(n){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[n.field("red",Kh.sketch(u(gp,"red",h.label,h.description,255))),n.field("green",Kh.sketch(u(gp,"green",v.label,v.description,255))),n.field("blue",Kh.sketch(u(gp,"blue",b.label,b.description,255))),n.field("hex",Kh.sketch(u(ip,"hex",y.label,y.description,"ffffff"))),c.asSpec()],formBehaviours:au([Zv.config({invalidClass:e("form-invalid")}),Fd("rgb-form-events",[$o(rx,g),$o(ix,m),$o(ux,m)])])}})),{apis:{updateHex:function(t,n){var e,o;Ad.setValue(t,{hex:n.value()}),e=t,o=hp(n),a(e,o),d(o),s(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})}(t,e,r.onValidHex,r.onInvalidHex),c=function(t,n){var e=Qy.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=Qy.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return nl({factory:function(t){var u=o({x:o(0),y:o(0)}),a=au([ul.config({find:O.some}),Vd.config({})]);return Qy.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,r],onChange:function(t,n,e){To(t,mb(),{value:e})},onInit:function(t,n,e,o){i(e.element().dom(),bp(yp()))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element().dom(),i(r,bp(o))}},extraApis:{}})}(0,e),s={paletteRgba:o(Kn(yp()))},l=hm(c.sketch({})),d=hm(a.sketch({})),m=function(t,n){d.getOpt(t).each((function(t){a.updateHex(t,n)}))},g=function(t,n,e){U(e,(function(e){e(t,n)}))};return{uid:r.uid,dom:r.dom,components:[l.asSpec(),Zy(0,e),d.asSpec()],behaviours:au([Fd("colour-picker-events",[$o(mb(),(u=[m],function(t,n){var e,o,r,i,a,c,l,f,d,m=n.event().value(),p=(i=r=0,a=(e=s.paletteRgba().get()).red()/255,c=e.green()/255,l=e.blue()/255,(f=Math.min(a,Math.min(c,l)))===(d=Math.max(a,Math.max(c,l)))?lb(0,0,100*(i=f)):(r=60*((r=a===f?3:l===f?1:5)-(a===f?c-l:l===f?a-c:l-a)/(d-f)),o=(d-f)/d,i=d,lb(Math.round(r),Math.round(100*o),Math.round(100*i)))),h=lb(p.hue(),m.x(),100-m.y()),v=pp(h),b=ap(v);g(t,b,u)})),$o(db(),(i=[function(t,n){l.getOpt(t).each((function(t){var e=hp(n);s.paletteRgba().set(e),c.setRgba(t,e)}))},m],function(t,n){var e,o,r,u=(e=n.event().value().y(),o=lb((100-e)/100*360,100,100),r=pp(o),ap(r));g(t,u,i)}))]),ul.config({find:function(t){return d.getOpt(t)}}),dd.config({mode:"acyclic"})])}}})},sx=function(){return ul.config({find:O.some})},lx=function(t){return ul.config({find:t.getOpt})},fx=function(t){return ul.config({find:function(n){return vr(n.element(),t).bind((function(t){return n.getSystem().getByDom(t).toOption()}))}})},dx={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},mx=function(t){return dx[t]},gx=tinymce.util.Tools.resolve("tinymce.Resource"),px=tn([zn("preprocess",r),zn("postprocess",r)]),hx=function(t,n,e){return Ad.config(bt({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},vx=function(t,n){var e=mn("RepresentingConfigs.memento processors",px,n);return Ad.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Ad.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);Ad.setValue(i,r)}}})},bx=hx,yx=function(t){return function(t,n,e){return hx(t,(function(t){return n(t.element())}),(function(t,n){return e(t.element(),n)}))}(t,Tr,Er)},xx=function(t){return Ad.config({store:{mode:"memory",initialValue:t}})},wx=Hr("alloy-fake-before-tabstop"),Sx=Hr("alloy-fake-after-tabstop"),kx=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:au([Vd.config({ignore:!0}),eb.config({})])}},Cx=function(t,n){To(t,Ye(),{raw:{which:9,shiftKey:n}})},Ox=function(t){return sh(t,["."+wx,"."+Sx].join(","),o(!1))},Tx=function(t,n){var e=n.element();fi(e,wx)?Cx(t,!0):fi(e,Sx)&&Cx(t,!1)},Ex=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[kx([wx]),t,kx([Sx])],behaviours:au([fx(1)])}},Bx=!(Oe.detect().browser.isIE()||Oe.detect().browser.isEdge());function _x(n,e){return Mx(t.document.createElement("canvas"),n,e)}function Ax(t){var n=_x(t.width,t.height);return Fx(n).drawImage(t,0,0),n}function Fx(t){return t.getContext("2d")}function Mx(t,n,e){return t.width=n,t.height=e,t}function Dx(t){return t.naturalWidth||t.width}function Ix(t){return t.naturalHeight||t.height}var Rx=window.Promise?window.Promise:function(){var n=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(t,o(u,this),o(a,this))},e=n.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(n){t.setTimeout(n,1)};function o(t,n){return function(){return t.apply(n,arguments)}}var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var n=this;null!==this._state?e((function(){var e=n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(n){return void t.reject(n)}t.resolve(o)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void l(o(n,t),o(u,this),o(a,this))}this._state=!0,this._value=t,c.call(this)}catch(t){a.call(this,t)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];i.call(this,e)}this._deferreds=[]}function s(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function l(t,n,e){var o=!1;try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(t){if(o)return;o=!0,e(t)}}return n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(t,n){if(0===o.length)return t([]);var e=o.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}o[i]=u,0==--e&&t(o)}catch(t){n(t)}}for(var i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)}))},n}();function Vx(n,e,o){return e=e||"image/png",t.HTMLCanvasElement.prototype.toBlob?new Rx((function(t,r){n.toBlob((function(n){n?t(n):r()}),e,o)})):function(n){return new Rx((function(e,o){(function(n){var e=n.split(","),o=/data:([^;]+)/.exec(e[0]);if(!o)return O.none();for(var r=o[1],i=e[1],u=t.atob(i),a=u.length,c=Math.ceil(a/1024),s=new Array(c),l=0;l<c;++l){for(var f=1024*l,d=Math.min(f+1024,a),m=new Array(d-f),g=f,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[l]=new Uint8Array(m)}return O.some(new t.Blob(s,{type:r}))})(n).fold((function(){o("uri is not base64: "+n)}),e)}))}(n.toDataURL(e,o))}function Nx(t,n,e){var r=n.type;function i(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))}return{getType:o(r),toBlob:function(){return Rx.resolve(n)},toDataURL:function(){return e},toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return Vx(t,n,e)}))},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(Ax)}}}function Hx(t,n){return Vx(t,n).then((function(n){return Nx(Rx.resolve(t),n,t.toDataURL())}))}function Px(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o}var zx=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function Lx(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r}function jx(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Fx(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],T=n[19],E=0;E<u.length;E+=4)e=u[E],o=u[E+1],r=u[E+2],i=u[E+3],u[E]=e*a+o*c+r*s+i*l+f,u[E+1]=e*d+o*m+r*g+i*p+h,u[E+2]=e*v+o*b+r*y+i*x+w,u[E+3]=e*S+o*k+r*C+i*O+T;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),Hx(t,n)}(e,t.getType(),n)}))}function Ux(t){return function(n,e){return jx(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}}var Wx=function(t){return function(n){return jx(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),Gx=Ux((function(t,n){return Lx(t,[1,0,0,0,n=Px(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),Xx=Ux((function(t,n){var e;return n=Px(n,-1,1),Lx(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?zx[n]:zx[Math.floor(n)]*(1-e)+zx[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Yx=function(t){return function(n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Fx(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),Hx(t,n)}(e,t.getType(),n)}))}(n,t)}}([0,-1,0,-1,5,-1,0,-1,0]),qx=function(t){return function(n,e){return n.toCanvas().then((function(o){return function(n,e,o){for(var r=Fx(n),i=new Array(256),u=0;u<i.length;u++)i[u]=t(u,o);var a=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(r.getImageData(0,0,n.width,n.height),i);return r.putImageData(a,0,0),Hx(n,e)}(o,n.getType(),e)}))}}((function(t,n){return 255*Math.pow(t/255,1-n)}));function Kx(t,n,e){var o=Dx(t),r=Ix(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=function(t,n,e){return new Rx((function(o){var r=Dx(t),i=Ix(t),u=Math.floor(r*n),a=Math.floor(i*e),c=_x(u,a);Fx(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))}(t,i,u);return a?c.then((function(t){return Kx(t,n,e)})):c}var Jx=function(t){return Wx(t)},$x=function(t){return Yx(t)},Qx=function(t,n){return qx(t,n)},Zx=function(t,n){return Gx(t,n)},tw=function(t,n){return Xx(t,n)},nw=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=_x(t.width,t.height),r=Fx(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),Hx(o,n)}(e,t.getType(),n)}))}(t,n)},ew=function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return Kx(o,n,e).then((function(n){return Hx(n,t.getType())}))}))}(t,n,e)},ow=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=_x(t.width,t.height),r=Fx(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||Mx(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),Hx(o,n)}(e,t.getType(),n)}))}(t,n)},rw=function(t,n){return f({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},iw=function(t,n){return rw(bm(t,n),{})},uw=function(t,n){return rw(bm(t,n),{behaviours:au([vd.config({})])})},aw=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:au([vd.config({})])}},cw=Hr("toolbar.button.execute"),sw={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},lw=Hr("update-menu-text"),fw=Hr("update-menu-icon"),dw=function(t,e,o){var r=Kn(n),i=t.text.map((function(t){return hm(aw(t,e,o.providers))})),u=t.icon.map((function(t){return hm(uw(t,o.providers.icons))})),a=function(t,n){var e=Ad.getValue(t);return Vd.focus(e),To(e,"keydown",{raw:n.event().raw()}),ib.close(e),O.some(!0)},c=t.role.fold((function(){return{}}),(function(t){return{role:t}})),s=t.tooltip.fold((function(){return{}}),(function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}}));return hm(ib.sketch(f({},c,{dom:{tag:"button",classes:[e,e+"--select"].concat(j(t.classes,(function(t){return e+"--"+t}))),attributes:f({},s)},components:qg([u.map((function(t){return t.asSpec()})),i.map((function(t){return t.asSpec()})),O.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:bm("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:au(t.dropdownBehaviours.concat([Hg(t.disabled),ub.config({}),vd.config({}),Fd("dropdown-events",[jg(t,r),Ug(t,r)]),Fd("menubutton-update-display-text",[$o(lw,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){vd.set(t,[Bi(o.providers.translate(n.event().text()))])}))})),$o(fw,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){vd.set(t,[uw(n.event().icon(),o.providers.icons)])}))}))])])),eventOrder:bt(sw,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:au([dd.config({mode:"special",onLeft:a,onRight:a})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:Gp(0,t.columns,t.presets)},fetch:function(){return mv(t.fetch)}}))).asSpec()},mw=function(t){return{isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)},setActive:function(n){var e=t.element();n?(si(e,"tox-tbtn--enabled"),_r(e,"aria-pressed",!0)):(li(e,"tox-tbtn--enabled"),Dr(e,"aria-pressed"))},isActive:function(){return fi(t.element(),"tox-tbtn--enabled")}}},gw=function(t,n,e,o){return dw({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n){t.fetch((function(t){n(jv(t,Xg.CLOSE_ON_EXECUTE,e))}))},onSetup:t.onSetup,getApi:mw,columns:1,presets:"normal",classes:[],dropdownBehaviours:[eb.config({})]},n,e.shared)},pw=function(t,n,e,o,r){void 0===e&&(e=[]);var i=n.fold((function(){return{}}),(function(t){return{action:t}})),u=f({buttonBehaviours:au([Hg(t.disabled),eb.config({}),Fd("button press",[Jo("click"),Jo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=bt(u,{dom:o});return bt(a,{components:r})},hw=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return iw(t,e.icons)})),u=qg([i]);return pw(t,n,o,r,u)},vw=function(t,n,e,o){void 0===o&&(o=[]);var r=hw(t,O.some(n),e,o);return pm.sketch(r)},bw=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return iw(t,e.icons)})):O.none(),a=u.isSome()?qg([u]):[],c=u.isSome()?{}:{innerHtml:i},s=(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"]).concat(u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),l=f({tag:"button",classes:s},c,{attributes:{title:i}});return pw(t,n,o,l,a)},yw=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=bw(t,O.some(n),e,o,r);return pm.sketch(i)},xw=function(n,e){return function(o){"custom"===e?To(o,Lh,{name:n,value:{}}):"submit"===e?Oo(o,jh):"cancel"===e?Oo(o,zh):t.console.error("Unknown button type: ",e)}},ww=function(n,e,o){if("menu"===e)return gw(n,"tox-tbtn",o,O.none());if("custom"===(u=e)||"cancel"===u||"submit"===u){var r=xw(n.name,e),i=f({},n,{borderless:!1});return yw(i,r,o.shared.providers,[])}var u;t.console.error("Unknown footer button type: ",e)},Sw=o([zn("field1Name","field1"),zn("field2Name","field2"),Zi("onLockedChange"),Ki(["lockClass"]),zn("locked",!1),rs("coupledFieldBehaviours",[ul,Ad])]),kw=function(t,n){return Es({factory:Kh,name:t,overrides:function(t){return{fieldBehaviours:au([Fd("coupled-input-behaviour",[$o(Ke(),(function(e){var o,r,i;(o=e,r=t,i=n,Ls(o,r,i).bind(ul.getCurrent)).each((function(n){Ls(e,t,"lock").each((function(o){qd.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},Cw=o([kw("field1","field2"),kw("field2","field1"),Es({factory:pm,schema:[Tn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:au([qd.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),Ow=el({name:"FormCoupledInputs",configFields:Sw(),partFields:Cw(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:is(t.coupledFieldBehaviours,[ul.config({find:O.some}),Ad.config({store:{mode:"manual",getValue:function(n){var e,o=Xs(n,t,["field1","field2"]);return(e={})[t.field1Name]=Ad.getValue(o.field1()),e[t.field2Name]=Ad.getValue(o.field2()),e},setValue:function(n,e){var o=Xs(n,t,["field1","field2"]);Vt(e,t.field1Name)&&Ad.setValue(o.field1(),e[t.field1Name]),Vt(e,t.field2Name)&&Ad.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Ls(n,t,"field1")},getField2:function(n){return Ls(n,t,"field2")},getLock:function(n){return Ls(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),Tw=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return B.error(t);var e=parseFloat(n[1]),o=n[2];return B.value({value:e,unit:o})},Ew=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?O.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?O.some(t.value):O.some(t.value/e[t.unit]*e[n]):O.none()},Bw=function(t){return O.none()},_w=function(t,n){var e=Bw,o=Hr("ratio-event"),r=Ow.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:bm("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:bm("unlock",n.icons)}}],buttonBehaviours:au([Hg(t.disabled),eb.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(n){return Kh.parts().field({factory:Uv,inputClasses:["tox-textfield"],inputBehaviours:au([Vg.config({disabled:t.disabled}),eb.config({}),Fd("size-input-events",[$o(Ge(),(function(t,e){To(t,o,{isField1:n})})),$o(Je(),(function(n,e){To(n,Hh,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=Ow.parts().field1(i([Kh.parts().label(a("Width")),u(!0)])),s=Ow.parts().field2(i([Kh.parts().label(a("Height")),u(!1)]));return Ow.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){Tw(Ad.getValue(t)).each((function(t){e(t).each((function(t){var e,o,r,i;Ad.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))}))}))},coupledFieldBehaviours:au([Vg.config({disabled:t.disabled,onDisabled:function(t){Ow.getField1(t).bind(Kh.getField).each(Vg.disable),Ow.getField2(t).bind(Kh.getField).each(Vg.disable),Ow.getLock(t).each(Vg.disable)},onEnabled:function(t){Ow.getField1(t).bind(Kh.getField).each(Vg.enable),Ow.getField2(t).bind(Kh.getField).each(Vg.enable),Ow.getLock(t).each(Vg.enable)}}),Fd("size-input-events2",[$o(o,(function(t,n){var o=n.event().isField1(),r=o?Ow.getField1(t):Ow.getField2(t),i=o?Ow.getField2(t):Ow.getField1(t),u=r.map(Ad.getValue).getOr(""),a=i.map(Ad.getValue).getOr("");e=function(t,n){return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return O.none();n.push(o.getOrDie())}return O.some(function(t,n){return Ew(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return Ew(t,o).map((function(t){return{value:t*e,unit:o}}))};var e,o})).getOr(Bw)}.apply(null,n))}([Tw(t).toOption(),Tw(n).toOption()]).getOr(Bw)}(u,a)}))])])})},Aw={undo:o(Hr("undo")),redo:o(Hr("redo")),zoom:o(Hr("zoom")),back:o(Hr("back")),apply:o(Hr("apply")),swap:o(Hr("swap")),transform:o(Hr("transform")),tempTransform:o(Hr("temp-transform")),transformApply:o(Hr("transform-apply"))},Fw=o("save-state"),Mw=o("disable"),Dw=o("enable"),Iw={formActionEvent:Lh,saveState:Fw,disable:Mw,enable:Dw},Rw=function(t,e){var r=function(t,n,o,r){return hm(yw({name:t,text:t,disabled:o,primary:r,icon:O.none(),borderless:!1},n,e))},i=function(t,n,o,r){return hm(vw({name:t,icon:O.some(t),tooltip:O.some(n),disabled:r,primary:!1,borderless:!1},o,e))},u=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Vg)&&Vg.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Vg)&&Vg.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=O.none(),l=n,f=function(t,n,e){To(t,n,e)},d=function(t){return Oo(t,Iw.disable())},m=function(t){return Oo(t,Iw.enable())},g=function(t,n){d(t),f(t,Aw.transform(),{transform:n}),m(t)},p=function(t){return function(){Z.getOpt(t).each((function(t){vd.set(t,[$])}))}},h=function(t,n){d(t),f(t,Aw.transformApply(),{transform:n,swap:p(t)}),m(t)},v=function(){return r("Back",(function(t){return f(t,Aw.back(),{swap:p(t)})}),!1,!1)},b=function(){return hm({dom:{tag:"div",classes:["tox-spacer"]},behaviours:au([Vg.config({})])})},y=function(){return r("Apply",(function(t){return f(t,Aw.apply(),{swap:p(t)})}),!0,!0)},x=[v(),b(),r("Apply",(function(n){var e=function(n){var e=t.getRect();return function(t,n,e,o,r){return t.toCanvas().then((function(i){return function(t,n,e,o,r,i){var u=_x(r,i);return Fx(u).drawImage(t,-e,-o),Hx(u,n)}(i,t.getType(),n,e,o,r)}))}(n,e.x,e.y,e.w,e.h)};h(n,e),t.hideCrop()}),!1,!0)],w=Ch.sketch({dom:c,components:x.map((function(t){return t.asSpec()})),containerBehaviours:au([Fd("image-tools-crop-buttons-events",[$o(Iw.disable(),(function(t,n){u(x,t)})),$o(Iw.enable(),(function(t,n){a(x,t)}))])])}),S=hm(_w({name:"size",label:s,constrain:!0,disabled:!1},e)),k=[v(),b(),S,b(),r("Apply",(function(t){S.getOpt(t).each((function(n){var e,o,r=Ad.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return ew(t,e,o)});h(t,a)}))}),!1,!0)],C=Ch.sketch({dom:c,components:k.map((function(t){return t.asSpec()})),containerBehaviours:au([Fd("image-tools-resize-buttons-events",[$o(Iw.disable(),(function(t,n){u(k,t)})),$o(Iw.enable(),(function(t,n){a(k,t)}))])])}),T=function(t,n){return function(e){return t(e,n)}},E=T(nw,"h"),B=T(nw,"v"),_=T(ow,-90),A=T(ow,90),F=function(t,n){var e,o;o=n,d(e=t),f(e,Aw.tempTransform(),{transform:o}),m(e)},M=[v(),b(),i("flip-horizontally","Flip horizontally",(function(t){F(t,E)}),!1),i("flip-vertically","Flip vertically",(function(t){F(t,B)}),!1),i("rotate-left","Rotate counterclockwise",(function(t){F(t,_)}),!1),i("rotate-right","Rotate clockwise",(function(t){F(t,A)}),!1),b(),y()],D=Ch.sketch({dom:c,components:M.map((function(t){return t.asSpec()})),containerBehaviours:au([Fd("image-tools-fliprotate-buttons-events",[$o(Iw.disable(),(function(t,n){u(M,t)})),$o(Iw.enable(),(function(t,n){a(M,t)}))])])}),I=function(t,n,r,i,u){var a=Qy.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}}),c=Qy.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=Qy.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return hm(Qy.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:o({x:o(i)})},components:[a,c,s],sliderBehaviours:au([Vd.config({})]),onChoose:n}))},R=function(t,n,e,o,r){var i=function(t,n,e,o,r){return[v(),(i=t,u=n,a=e,c=o,s=r,I(i,(function(t,n,e){var o=T(u,e.x()/100);g(t,o)}),a,c,s)),y()];var i,u,a,c,s}(t,n,e,o,r);return Ch.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:au([Fd("image-tools-filter-panel-buttons-events",[$o(Iw.disable(),(function(t,n){u(i,t)})),$o(Iw.enable(),(function(t,n){a(i,t)}))])])})},V=[v(),b(),y()],N=Ch.sketch({dom:c,components:V.map((function(t){return t.asSpec()}))}),H=R("Brightness",Zx,-100,0,100),P=R("Contrast",tw,-100,0,100),z=R("Gamma",Qx,-100,0,100),L=function(t){return I(t,(function(t,n,e){var o=j.getOpt(t),r=W.getOpt(t),i=U.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=function(t,n,e){return function(o){return function(t,n,e,o){return jx(t,function(t,n,e,o){return Lx([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[n=Px(n,0,2),0,0,0,0,0,e=Px(e,0,2),0,0,0,0,0,o=Px(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])}(0,n,e,o))}(o,t,n,e)}}(Ad.getValue(n).x()/100,Ad.getValue(o).x()/100,Ad.getValue(e).x()/100);g(t,r)}))}))}))}),0,100,200)},j=L("R"),U=L("G"),W=L("B"),G=[v(),j,U,W,y()],X=Ch.sketch({dom:c,components:G.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){f(o,Aw.swap(),{transform:n,swap:function(){Z.getOpt(o).each((function(n){vd.set(n,[t]),e(n)}))}})}},q=O.some($x),K=O.some(Jx),J=[i("crop","Crop",Y(w,s,(function(n){t.showCrop()})),!1),i("resize","Resize",Y(C,s,(function(n){S.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;Ad.setValue(n,{width:o,height:r})}))})),!1),i("orientation","Orientation",Y(D,s,l),!1),i("brightness","Brightness",Y(H,s,l),!1),i("sharpen","Sharpen",Y(N,q,l),!1),i("contrast","Contrast",Y(P,s,l),!1),i("color-levels","Color levels",Y(X,s,l),!1),i("gamma","Gamma",Y(z,s,l),!1),i("invert","Invert",Y(N,K,l),!1)],$=Ch.sketch({dom:c,components:J.map((function(t){return t.asSpec()}))}),Q=Ch.sketch({dom:{tag:"div"},components:[$],containerBehaviours:au([vd.config({})])}),Z=hm(Q);return{memContainer:Z,getApplyButton:function(t){return Z.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},Vw=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Nw=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Hw=tinymce.util.Tools.resolve("tinymce.util.Observable"),Pw=tinymce.util.Tools.resolve("tinymce.util.Tools"),zw=tinymce.util.Tools.resolve("tinymce.util.VK");function Lw(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function jw(n,e){var o,r,i,u,a,c,s,l=e.document||t.document;e=e||{};var f=l.getElementById(e.handle||n);i=function(n){var i,d,m=function(t){var n,e,o,r,i,u,a,c=Math.max;return n=t.documentElement,e=t.body,o=c(n.scrollWidth,e.scrollWidth),r=c(n.clientWidth,e.clientWidth),i=c(n.offsetWidth,e.offsetWidth),u=c(n.scrollHeight,e.scrollHeight),a=c(n.clientHeight,e.clientHeight),{width:o<i?r:o,height:u<c(n.offsetHeight,e.offsetHeight)?a:u}}(l);Lw(n),n.preventDefault(),r=n.button,i=f,c=n.screenX,s=n.screenY,d=t.window.getComputedStyle?t.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,o=Vw("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(l.body),Vw(l).on("mousemove touchmove",a).on("mouseup touchend",u),e.start(n)},a=function(t){if(Lw(t),t.button!==r)return u(t);t.deltaX=t.screenX-c,t.deltaY=t.screenY-s,t.preventDefault(),e.drag(t)},u=function(t){Lw(t),Vw(l).off("mousemove touchmove",a).off("mouseup touchend",u),o.remove(),e.stop&&e.stop(t)},this.destroy=function(){Vw(f).off()},Vw(f).on("mousedown touchstart",i)}var Uw,Ww,Gw,Xw=0,Yw=function(t,n,e,o,r){return vw({name:t,icon:O.some(n),disabled:e,tooltip:O.some(t),primary:!1,borderless:!1},o,r)},qw=function(t,n){n?Vg.enable(t):Vg.disable(t)},Kw=function(e,o){var r,i,u,a=function(n){var e=Kn(n),o=Kn(O.none()),r=function(){var t=[],n=-1;function e(){return 0<n}function o(){return-1!==n&&n<t.length-1}return{data:t,add:function(e){var o;return o=t.splice(++n),t.push(e),{state:e,removed:o}},undo:function(){if(e())return t[--n]},redo:function(){if(o())return t[++n]},canUndo:e,canRedo:o}}();r.add(n);var i=function(t){e.set(t)},u=function(n){return{blob:n,url:t.URL.createObjectURL(n)}},a=function(n){t.URL.revokeObjectURL(n.url)},c=function(){o.get().each(a),o.set(O.none())},s=function(t){var n,e=u(t);return i(e),n=r.add(e).removed,Pw.each(n,a),e.url};return{getBlobState:function(){return e.get()},setBlobState:i,addBlobState:s,getTempState:function(){return o.get().fold((function(){return e.get()}),(function(t){return t}))},updateTempState:function(t){var n=u(t);return c(),o.set(O.some(n)),n.url},addTempState:function(t){var n=u(t);return o.set(O.some(n)),n.url},applyTempState:function(t){return o.get().fold((function(){}),(function(n){s(n.blob),t()}))},destroyTempState:c,undo:function(){var t=r.undo();return i(t),t.url},redo:function(){var t=r.redo();return i(t),t.url},getHistoryStates:function(){return{undoEnabled:r.canUndo(),redoEnabled:r.canRedo()}}}}(e.currentState),c=function(t){var n=a.getHistoryStates();v.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),To(t,Iw.formActionEvent,{name:Iw.saveState(),value:n.undoEnabled})},s=function(t){return t.toBlob()},l=function(t){To(t,Iw.formActionEvent,{name:Iw.disable(),value:{}})},f=function(t){b.getApplyButton(t).each((function(t){Vg.enable(t)})),To(t,Iw.formActionEvent,{name:Iw.enable(),value:{}})},d=function(t,n){return l(t),h.updateSrc(t,n)},m=function(n,e,o,r,i){return l(n),(u=e,function(n){return function(n){return new Rx((function(e){var o=new t.FileReader;o.onloadend=function(){e(o.result)},o.readAsDataURL(n)}))}(n).then((function(e){return Nx(function(n){return function(n){return new Rx((function(e,o){var r=t.URL.createObjectURL(n),i=new t.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),e(i)}function c(){u(),o("Unable to load data of type "+n.type+": "+r)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=r,i.complete&&a()}))}(n).then((function(n){!function(n){t.URL.revokeObjectURL(n.src)}(n);var e=_x(Dx(n),Ix(n));return Fx(e).drawImage(n,0,0),e}))}(n),n,e)}))}(u)).then(o).then(s).then(r).then((function(t){return d(n,t).then((function(t){return c(n),i(),f(n),t}))})).catch((function(e){return t.console.log(e),f(n),e}));var u},g=function(t,n,e){var o=a.getBlobState().blob;m(t,o,n,(function(t){return a.updateTempState(t)}),e)},p=function(t){var n=a.getBlobState().url;return a.destroyTempState(),c(t),n},h=function(t){var n=hm({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Kn(1),o=Kn(O.none()),r=Kn({x:0,y:0,w:1,h:1}),i=Kn({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=_u(t.element()),c=Tu(t.element()),s=i.dom().naturalWidth*u,l=i.dom().naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};bi(i,m),n.getOpt(t).each((function(t){bi(t.element(),m)})),o.get().each((function(t){var n=r.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=Qn("img");return _r(a,"src",n),(o=a.dom(),new Mm((function(t){var n=function(){o.removeEventListener("load",n),t(o)};o.complete?t(o):o.addEventListener("load",n)}))).then((function(){return s.getOpt(t).map((function(t){var n=_i({element:a});vd.replaceAt(t,1,O.some(n));var o=i.get(),c={x:0,y:0,w:a.dom().naturalWidth,h:a.dom().naturalHeight};i.set(c);var l,f,d=Nw.inflate(c,-20,-20);return r.set(d),o.w===c.w&&o.h===c.h||(l=t,f=a,s.getOpt(l).each((function(t){var n=_u(t.element()),o=Tu(t.element()),r=f.dom().naturalWidth,i=f.dom().naturalHeight,u=Math.min(n/r,o/i);1<=u?e.set(1):e.set(u)}))),u(t,a),a}))}))},c=Ch.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:au([Fd("image-panel-crop-events",[rr((function(t){s.getOpt(t).each((function(t){var n=function(t,n,e,o){var r,i,u,a,c="tox-",s="tox-crid-"+Xw++;function l(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}function f(n,o,i,u){var a,c,s,f,d;a=o.x,c=o.y,s=o.w,f=o.h,a+=i*n.deltaX,c+=u*n.deltaY,(s+=i*n.deltaW)<20&&(s=20),(f+=u*n.deltaH)<20&&(f=20),d=t=Nw.clamp({x:a,y:c,w:s,h:f},e,"move"===n.name),d=l(e,d),r.fire("updateRect",{rect:d}),g(d)}function d(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),Vw("#"+s+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}Pw.each(i,(function(n){Vw("#"+s+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function m(n){d(t=n)}function g(t){m(function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}}(e,t))}return i=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],a=["top","right","bottom","left"],Vw('<div id="'+s+'" class="'+c+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),Pw.each(a,(function(t){Vw("#"+s,o).append('<div id="'+s+"-"+t+'"class="'+c+'croprect-block" style="display: none" data-mce-bogus="all">')})),Pw.each(i,(function(t){Vw("#"+s,o).append('<div id="'+s+"-"+t.name+'" class="'+c+"croprect-handle "+c+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),u=Pw.map(i,(function(n){var e;return new jw(s,{document:o.ownerDocument,handle:s+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),d(t),Vw(o).on("focusin focusout",(function(t){Vw(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),Vw(o).on("keydown",(function(n){var e;function o(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)}switch(Pw.each(i,(function(t){if(n.target.id===s+"-"+t.name)return e=t,!1})),n.keyCode){case zw.LEFT:o(n,0,t,-10,0);break;case zw.RIGHT:o(n,0,t,10,0);break;case zw.UP:o(n,0,t,0,-10);break;case zw.DOWN:o(n,0,t,0,10);break;case zw.ENTER:case zw.SPACEBAR:n.preventDefault()}})),r=Pw.extend({toggleVisibility:function(t){var n;n=Pw.map(i,(function(t){return"#"+s+"-"+t.name})).concat(Pw.map(a,(function(t){return"#"+s+"-"+t}))).join(","),t?Vw(n,o).show():Vw(n,o).hide()},setClampRect:function(n){e=n,d(t)},setRect:m,getInnerRect:function(){return l(e,t)},setInnerRect:g,setViewPortRect:function(e){n=e,d(t)},destroy:function(){Pw.each(u,(function(t){t.destroy()})),u=[]}},Hw)}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t.element().dom());n.toggleVisibility(!1),n.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(O.some(n))}))}))])])}],containerBehaviours:au([vd.config({}),Fd("image-panel-events",[rr((function(n){a(n,t)}))])])}),s=hm(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=0<n?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element();u(t,n)}))},showCrop:function(){o.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}}(e.currentState.url),v=(i=hm(Yw("Undo","undo",!0,(function(t){To(t,Aw.undo(),{direction:1})}),r=o)),u=hm(Yw("Redo","redo",!0,(function(t){To(t,Aw.redo(),{direction:1})}),r)),{container:Ch.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[i.asSpec(),u.asSpec(),Yw("Zoom in","zoom-in",!1,(function(t){To(t,Aw.zoom(),{direction:1})}),r),Yw("Zoom out","zoom-out",!1,(function(t){To(t,Aw.zoom(),{direction:-1})}),r)]}),updateButtonUndoStates:function(t,n,e){i.getOpt(t).each((function(t){qw(t,n)})),u.getOpt(t).each((function(t){qw(t,e)}))}}),b=Rw(h,o);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[b.memContainer.asSpec(),h.memContainer.asSpec(),v.container],behaviours:au([Ad.config({store:{mode:"manual",getValue:function(){return a.getBlobState()}}}),Fd("image-tools-events",[$o(Aw.undo(),(function(t,n){var e=a.undo();d(t,e).then((function(n){f(t),c(t)}))})),$o(Aw.redo(),(function(t,n){var e=a.redo();d(t,e).then((function(n){f(t),c(t)}))})),$o(Aw.zoom(),(function(t,n){var e=n.event().direction();h.zoom(t,e)})),$o(Aw.back(),(function(t,n){var e,o;o=p(e=t),d(e,o).then((function(t){f(e)})),n.event().swap()(),h.hideCrop()})),$o(Aw.apply(),(function(t,n){a.applyTempState((function(){p(t),n.event().swap()()}))})),$o(Aw.transform(),(function(t,e){return g(t,e.event().transform(),n)})),$o(Aw.tempTransform(),(function(t,e){return o=t,r=e.event().transform(),i=a.getTempState().blob,void m(o,i,r,(function(t){return a.addTempState(t)}),n);var o,r,i})),$o(Aw.transformApply(),(function(t,n){return e=t,o=n.event().transform(),r=n.event().swap(),i=a.getBlobState().blob,void m(e,i,o,(function(t){var n=a.addBlobState(t);return p(e),n}),r);var e,o,r,i})),$o(Aw.swap(),(function(t,n){var e;e=t,v.updateButtonUndoStates(e,!1,!1);var o=n.event().transform(),r=n.event().swap();o.fold((function(){r()}),(function(n){g(t,n,r)}))}))]),sx()])}},Jw=nl({name:"HtmlSelect",configFields:[Tn("options"),ns("selectBehaviours",[Vd,Ad]),zn("selectClasses",[]),zn("selectAttributes",{}),In("data")],factory:function(t,n){var e=j(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return It("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:os(t.selectBehaviours,[Vd.config({}),Ad.config({store:f({mode:"manual",getValue:function(t){return Oi(t.element())},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Ti(n.element(),e)}},o)})])}}}),$w=function(t,n){var e=t.label.map((function(t){return Hv(t,n)})),o=[Vg.config({disabled:t.disabled}),dd.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Oo(t,jh),O.some(!0)}}),Fd("textfield-change",[$o(Ke(),(function(n,e){To(n,Hh,{name:t.name})})),$o(oo(),(function(n,e){To(n,Hh,{name:t.name})}))]),eb.config({})],r=t.validation.map((function(t){return Zv.config({getRoot:function(t){return gr(t.element())},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Ad.getValue(n),o=t.validator(e);return gv(!0===o?B.value(e):B.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=Kh.parts().field({tag:!0===t.multiline?"textarea":"input",inputAttributes:t.placeholder.fold((function(){}),(function(t){return{placeholder:n.translate(t)}})),inputClasses:[t.classname],inputBehaviours:au($([o,r])),selectOnFocus:!1,factory:Uv}),u=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),a=[Vg.config({disabled:t.disabled,onDisabled:function(t){Kh.getField(t).each(Vg.disable)},onEnabled:function(t){Kh.getField(t).each(Vg.enable)}})];return Iv(e,i,u,a)},Qw=function(n){return f({},n,{toCached:function(){return Qw(n.toCached())},bindFuture:function(t){return Qw(n.bind((function(n){return n.fold((function(t){return gv(B.error(t))}),(function(n){return t(n)}))})))},bindResult:function(t){return Qw(n.map((function(n){return n.bind(t)})))},mapResult:function(t){return Qw(n.map((function(n){return n.map(t)})))},mapError:function(t){return Qw(n.map((function(n){return n.mapError(t)})))},foldResult:function(t,e){return n.map((function(n){return n.fold(t,e)}))},withTimeout:function(e,o){return Qw(mv((function(r){var i=!1,u=t.setTimeout((function(){i=!0,r(B.error(o()))}),e);n.get((function(n){i||(t.clearTimeout(u),r(n))}))})))}})},Zw={type:"separator"},tS=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},nS=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}},eS=function(t,n){return o=t,e=W(n,(function(t){return t.type===o})),j(e,tS);var e,o},oS=function(t,n){var e=t.toLowerCase();return W(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return ye(n.toLowerCase(),e)||ye(t.value.toLowerCase(),e)}))},rS=Hr("aria-invalid"),iS=function(t,e,o){var r,i,u,a,c,s=e.shared.providers,l=function(n){var e=Ad.getValue(n);o.addToHistory(e.value,t.filetype)},d=Kh.parts().field({factory:Dv,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":rS},minChars:0,responseTime:0,fetch:function(n){var r=function(t,n,e){var o=Ad.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i,u,a,c,s,l=oS(r,(o=e.getHistory(t),j(o,(function(t){return nS(t,t)}))));return"file"===t?(i=[l,oS(r,(s=n,eS("header",s.targets))),oS(r,$([(c=n,O.from(c.anchorTop).map((function(t){return nS("<top>",t)})).toArray()),(a=n,eS("anchor",a.targets)),(u=n,O.from(u.anchorBottom).map((function(t){return nS("<bottom>",t)})).toArray())]))],X(i,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(Zw,n)}),[])):l}))}(t.filetype,n,o),i=jv(r,Xg.BUBBLE_TO_SANDBOX,e);return gv(i)},getHotspot:function(t){return b.getOpt(t)},onSetValue:function(t,e){t.hasConfigured(Zv)&&Zv.run(t).get(n)},typeaheadBehaviours:au($([o.getValidationHandler().map((function(n){return Zv.config({getRoot:function(t){return gr(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){g.getOpt(t).each((function(t){_r(t.element(),"title",s.translate(n))}))}},validator:{validate:function(e){var o=Ad.getValue(e);return function(t){return Qw(mv(t))}((function(e){n({type:t.filetype,url:o.value},(function(t){e(("invalid"===t.status?B.error:B.value)(t.message))}))}))},validateOnLoad:!1}})})).toArray(),[Vg.config({disabled:t.disabled}),eb.config({}),Fd("urlinput-events",$(["file"===t.filetype?[$o(Ke(),(function(n){To(n,Hh,{name:t.name})}))]:[],[$o(Je(),(function(n){To(n,Hh,{name:t.name}),l(n)})),$o(oo(),(function(n){To(n,Hh,{name:t.name}),l(n)}))]]))]])),eventOrder:(r={},r[Ke()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"dog"},lazySink:e.shared.getSink,parts:{menu:Gp(0,0,"normal")},onExecute:function(t,n,e){To(n,jh,{})},onItemExecute:function(n,e,o,r){l(n),To(n,Hh,{name:t.name})}}),m=t.label.map((function(t){return Hv(t,s)})),g=hm((i="invalid",u=O.some(rS),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:bm(a,s.icons),attributes:f({title:s.translate(c),"aria-live":"polite"},u.fold((function(){return{}}),(function(t){return{id:t}})))}})),p=hm({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=o.getUrlPicker(t.filetype),v=Hr("browser.url.event"),b=hm({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,p.asSpec()],behaviours:au([Vg.config({disabled:t.disabled})])}),y=hm(yw({name:t.name,icon:O.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Oo(t,v)}),s,[],["tox-browse-url"]));return Kh.sketch({dom:Nv([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:$([[b.asSpec()],h.map((function(){return y.asSpec()})).toArray()])}]),fieldBehaviours:au([Vg.config({disabled:t.disabled,onDisabled:function(t){Kh.getField(t).each(Vg.disable),y.getOpt(t).each(Vg.disable)},onEnabled:function(t){Kh.getField(t).each(Vg.enable),y.getOpt(t).each(Vg.enable)}}),Fd("url-input-events",[$o(v,(function(n){ul.getCurrent(n).each((function(e){var o=Ad.getValue(e);h.each((function(r){r(o).get((function(o){Ad.setValue(e,o),To(n,Hh,{name:t.name})}))}))}))}))])])})},uS=function(t){return function(n,e,o){return Dt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},aS={bar:uS((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:j(e.items,o.interpreter)};var e,o})),collection:uS((function(t,n){return function(t,n){var e,o=t.label.map((function(t){return Hv(t,n)})),i=function(t){return function(n,e){Ri(e.event().target(),"[data-collection-item-value]").each((function(e){t(n,e,Fr(e,"data-collection-item-value"))}))}},u=[$o(We(),i((function(t,n){_l(n)}))),$o(co(),i((function(n,e,o){To(n,Lh,{name:t.name,value:o})}))),$o(Ge(),i((function(t,n,e){Ii(t.element(),"."+fg).each((function(t){li(t,fg)})),si(n,fg)}))),$o(Xe(),i((function(t,n,e){Ii(t.element(),"."+fg).each((function(t){li(t,fg)}))}))),ar(i((function(n,e,o){To(n,Lh,{name:t.name,value:o})})))],a=Kh.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:r},behaviours:au([vd.config({}),Ad.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){var o,r,i,u;o=n,r=j(e,(function(n){var e,o=og.translate(n.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+n.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+('"'===(e=n.value)?"&quot;":e)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i=1<t.columns&&"auto"!==t.columns?L(r,t.columns):[r],u=j(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"})),Er(o.element(),u.join("")),"auto"===t.columns&&Xm(n,5,"tox-collection__item").each((function(t){var e=t.numRows,o=t.numColumns;dd.setGridSize(n,e,o)})),Oo(n,Xh)}}),eb.config({}),dd.config((e=t.columns,1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+ig}})),Fd("collection-events",u)])});return Iv(o,a,["tox-form__group--collection"],[])}(t,n.shared.providers)})),alloy:uS(r),alertbanner:uS((function(t,n){return e=t,o=n.shared.providers,Ch.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:bm(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){To(t,Lh,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o})),input:uS((function(t,n){return e=t,o=n.shared.providers,$w({name:e.name,multiline:!1,label:e.label,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:O.none(),maximized:e.maximized},o);var e,o})),textarea:uS((function(t,n){return e=t,o=n.shared.providers,$w({name:e.name,multiline:!0,label:e.label,placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:O.none(),maximized:e.maximized},o);var e,o})),listbox:uS((function(t,n){return e=t,o=n.shared.providers,r=Hv(e.label,o),i=Kh.parts().field({factory:Jw,dom:{classes:["mce-select-field"]},selectBehaviours:au([eb.config({})]),options:e.values,data:e.initialValue.getOr(void 0)}),Rv(O.some(r),i);var e,o,r,i})),label:uS((function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=j(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:au([sx(),vd.config({}),yx(O.none()),dd.config({mode:"acyclic"})])};var e,o,r,i})),iframe:(Uw=function(t,n){return function(t,n){var e,o,r=Bx&&t.sandboxed,i=f({},t.label.map((function(t){return{title:t}})).getOr({}),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=Kn(""),{getValue:function(t){return o.get()},setValue:function(t,n){if(e)_r(t.element(),"srcdoc",n);else{_r(t.element(),"src","javascript:''");var r=t.element().dom().contentWindow.document;r.open(),r.write(n),r.close()}o.set(n)}}),a=t.label.map((function(t){return Hv(t,n)})),c=Kh.parts().field({factory:{sketch:function(t){return Ex({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:au([eb.config({}),Vd.config({}),bx(O.none(),u.getValue,u.setValue)])})}}});return Iv(a,c,["tox-form__group--stretched"],[])}(t,n.shared.providers)},function(t,n,e){var o=bt(n,{source:"dynamic"});return uS(Uw)(t,o,e)}),autocomplete:uS((function(t,n){return o=n,r=Hv((e=t).label.getOr("?"),o.shared.providers),i=Kh.parts().field({factory:Dv,dismissOnBlur:!1,inputClasses:["tox-textfield"],minChars:1,fetch:function(t){var n=Ad.getValue(t),r=e.getItems(n),i=jv(r,Xg.BUBBLE_TO_SANDBOX,o);return gv(i)},markers:{openClass:"dog"},lazySink:o.shared.getSink,parts:{menu:Gp(0,0,"normal")}}),Rv(O.some(r),i);var e,o,r,i})),button:uS((function(t,n){return e=t,o=n.shared.providers,r=xw(e.name,"custom"),Rv(O.none(),Kh.parts().field(f({factory:pm},bw(e,O.some(r),o,[xx(""),sx()]))));var e,o,r})),checkbox:uS((function(t,n){return e=t,o=n.shared.providers,i=Ad.config({store:{mode:"manual",getValue:function(t){return t.element().dom().checked},setValue:function(t,n){t.element().dom().checked=n}}}),u=function(t){return t.element().dom().click(),O.some(!0)},a=Kh.parts().field({factory:{sketch:r},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:au([sx(),Vg.config({disabled:e.disabled}),eb.config({}),Vd.config({}),i,dd.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),Fd("checkbox-events",[$o(Je(),(function(t,n){To(t,Hh,{name:e.name})}))])])}),c=Kh.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:au([ub.config({})])}),l=hm({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:bm("checked"===t?"selected":"unselected",o.icons)}}})("checked"),s("unchecked")]}),Kh.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:au([Vg.config({disabled:e.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(t){Kh.getField(t).each(Vg.disable)},onEnabled:function(t){Kh.getField(t).each(Vg.enable)}})])});var e,o,i,u,a,c,s,l})),colorinput:uS((function(t,n){return function(t,n,e){var o,r,i=Kh.parts().field({factory:Uv,inputClasses:["tox-textfield"],onSetValue:function(t){return Zv.run(t).get((function(){}))},inputBehaviours:au([eb.config({}),Zv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return gr(t.element())},notify:{onValid:function(t){var n=Ad.getValue(t);To(t,ab,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Ad.getValue(t);if(0===n.length)return gv(B.value(!0));var e=Qn("span");vi(e,"background-color",n);var o=wi(e,"background-color").fold((function(){return B.error("blah")}),(function(t){return B.value(n)}));return gv(o)}}})]),selectOnFocus:!1}),u=t.label.map((function(t){return Hv(t,n.providers)})),a=function(t,n){To(t,cb,{value:n})},c=hm((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:O.some({onRtl:function(){return[ia]},onLtr:function(){return[ua]}}),components:[],fetch:Pp.getFetch(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){c.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Oo(t,sb)}),(function(n){a(t,n),Ep(n)}))}),"#ffffff"):a(t,"remove"===n?"":n)}))}},r=n,ib.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:au([ub.config({}),eb.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:r.getSink,fetch:function(t){return mv((function(t){return o.fetch(t)})).map((function(n){return O.from(eh(bt(Kp(Hr("menu-value"),n,(function(n){o.onItemAction(t,n)}),o.columns,o.presets,Xg.CLOSE_ON_EXECUTE,(function(){return!1}),r.providers),{movement:$p(o.columns,o.presets)})))}))},parts:{menu:Gp(0,0,o.presets)}})));return Kh.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,c.asSpec()]}]),fieldBehaviours:au([Fd("form-field-events",[$o(ab,(function(t,n){c.getOpt(t).each((function(t){vi(t.element(),"background-color",n.event().color())}))})),$o(cb,(function(t,n){Kh.getField(t).each((function(e){Ad.setValue(e,n.event().value()),ul.getCurrent(t).each(Vd.focus)}))})),$o(sb,(function(t,n){Kh.getField(t).each((function(n){ul.getCurrent(t).each(Vd.focus)}))}))])])})}(t,n.shared,n.colorinput)})),colorpicker:uS((function(n){var e=function(t){return"tox-"+t},o=cx(mx,e),r=hm(o.sketch({dom:{tag:"div",classes:[e("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){To(t,Lh,{name:"hex-valid",value:!0})},onInvalidHex:function(t){To(t,Lh,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[r.asSpec()],behaviours:au([Ad.config({store:{mode:"manual",getValue:function(t){var n=r.get(t);return ul.getCurrent(n).bind((function(t){return Ad.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(n,e){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(e),i=r.get(n);ul.getCurrent(i).fold((function(){t.console.log("Can not find form")}),(function(t){Ad.setValue(t,{hex:O.from(o[1]).getOr("")}),ox.getField(t,"hex").each((function(t){Oo(t,Ke())}))}))}}}),sx()])}})),dropzone:uS((function(t,n){return function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){U(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Vg.isDisabled(t)){var e=n.event().raw();u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event().raw().target.files;u(t,e)},u=function(n,e){var o,r;Ad.setValue(n,(o=e,r=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),W(it(o),(function(t){return r.test(t.name)})))),To(n,Hh,{name:t.name})},a=hm({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:au([Fd("input-file-events",[er(co())])])}),c=t.label.map((function(t){return Hv(t,n)})),s=Kh.parts().field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:au([xx([]),sx(),Vg.config({}),qd.config({toggleClass:"dragenter",toggleOnExecute:!1}),Fd("dropzone-events",[$o("dragenter",o([e,qd.toggle])),$o("dragleave",o([e,qd.toggle])),$o("dragover",e),$o("drop",o([e,r])),$o(Je(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},pm.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element().dom().click()},buttonBehaviours:au([eb.config({})])})]}]}}}});return Iv(c,s,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),grid:uS((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:j(e.items,o.interpreter)};var e,o})),selectbox:uS((function(t,n){return e=t,o=n.shared.providers,r=j(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return Hv(t,o)})),u=Kh.parts().field({dom:{},selectAttributes:{size:e.size},options:r,factory:Jw,selectBehaviours:au([Vg.config({disabled:e.disabled}),eb.config({}),Fd("selectbox-change",[$o(Je(),(function(t,n){To(t,Hh,{name:e.name})}))])])}),a=1<e.size?O.none():O.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:bm("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:$([[u],a.toArray()])},Kh.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:$([i.toArray(),[c]]),fieldBehaviours:au([Vg.config({disabled:e.disabled,onDisabled:function(t){Kh.getField(t).each(Vg.disable)},onEnabled:function(t){Kh.getField(t).each(Vg.enable)}})])});var e,o,r,i,u,a,c})),sizeinput:uS((function(t,n){return _w(t,n.shared.providers)})),urlinput:uS((function(t,n){return iS(t,n,n.urlinput)})),customeditor:uS((function(t){var n=Kn(O.none()),e=hm({dom:{tag:t.tag}}),o=Kn(O.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:au([Fd("editor-foo-events",[rr((function(r){e.getOpt(r).each((function(e){var r;(r=t,Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element().dom()):gx.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element().dom(),t.settings)}))).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(O.none()),n.set(O.some(t))}))}))}))]),Ad.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(O.some(e))}),(function(t){return t.setValue(e)}))}}}),sx()]),components:[e.asSpec()]}})),htmlpanel:uS((function(t){return"presentation"===t.presets?Ch.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Ch.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:au([eb.config({}),Vd.config({})])})})),imagetools:uS((function(t,n){return Kw(t,n.shared.providers)})),table:uS((function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:j(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:j(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:j(r,c)})],behaviours:au([eb.config({}),Vd.config({})])};var e,o,r,i,u,a,c})),panel:uS((function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:j(e.items,o.shared.interpreter)};var e,o}))},cS={field:function(t,n){return n}},sS=function(t,n,e){var o=bt(e,{shared:{interpreter:function(n){return lS(t,n,o)}}});return lS(t,n,o)},lS=function(n,e,o){return Dt(aS,e.type).fold((function(){return t.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e}),(function(t){return t(n,e,o)}))},fS=function(t){return t.x()},dS=function(t,n){return t.x()+t.width()/2-n.width()/2},mS=function(t,n){return t.x()+t.width()-n.width()},gS=function(t){return t.y()},pS=function(t,n){return t.y()+t.height()-n.height()},hS=function(t,n,e){return Uu(fS(t),pS(t,n),e.innerSoutheast(),Gu(),"layout-se")},vS=function(t,n,e){return Uu(mS(t,n),pS(t,n),e.innerSouthwest(),Xu(),"layout-sw")},bS=function(t,n,e){return Uu(fS(t),gS(t),e.innerNortheast(),Yu(),"layout-ne")},yS=function(t,n,e){return Uu(mS(t,n),gS(t),e.innerNorthwest(),qu(),"layout-nw")},xS=function(t,n,e){return Uu(dS(t,n),gS(t),e.innerNorth(),Ju(),"layout-n")},wS=function(t,n,e){return Uu(dS(t,n),pS(t,n),e.innerSouth(),Ku(),"layout-s")},SS={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},kS=function(t,n,e){var o,r,i,u,a,c,s,l,f,d,m=Nh(t),g=function(){return te(t.getBody())};return{toolbar:(l=g,f=n,d=m,d?function(){return{anchor:"node",root:l(),node:O.from(l()),bubble:Lu(-12,-12,SS),layouts:{onRtl:function(){return[bS]},onLtr:function(){return[yS]}}}}:function(){return{anchor:"hotspot",hotspot:f(),bubble:Lu(-12,12,SS),layouts:{onRtl:function(){return[ia]},onLtr:function(){return[ua]}}}}),toolbarOverflow:(s=e,function(){return{anchor:"hotspot",hotspot:s(),layouts:{onRtl:function(){return[ia]},onLtr:function(){return[ua]}}}}),banner:(u=g,a=n,c=e,c?function(){return{anchor:"node",root:u(),node:O.from(u()),layouts:{onRtl:function(){return[xS]},onLtr:function(){return[xS]}}}}:function(){return{anchor:"hotspot",hotspot:a(),layouts:{onRtl:function(){return[la]},onLtr:function(){return[la]}}}}),cursor:(r=t,i=g,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return O.some(Ma.range(te(t.startContainer),t.startOffset,te(t.endContainer),t.endOffset))}}}),node:(o=g,function(t){return{anchor:"node",root:o(),node:t}})}},CS=function(t){return{colorPicker:(r=t,function(t,n){Pp.colorPickerDialog(r)(t,n)}),hasCustomColors:(o=t,function(){return Op(o)}),getColors:(e=t,function(){return Tp(e)}),getColorCols:(n=t,function(){return Pp.getColorCols(n)})};var n,e,o,r},OS=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],TS=function(t){return X(t,(function(t,n){if(gt(n,"items")){var e=TS(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(gt(n,"inline")||gt(n,"block")||gt(n,"selector")){var o="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return f({},t,{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},ES=function(t){return(n=t,O.from(n.getParam("style_formats")).filter(M)).map((function(n){var e,o,r,i=(e=t,o=TS(n),r=function(t){U(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))},e.formatter?r(o.customFormats):e.on("init",(function(){r(o.customFormats)})),o.formats);return t.getParam("style_formats_merge",!1,"boolean")?OS.concat(i):i})).getOr(OS);var n},BS=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return bt(t,o)},_S=function(t,n,e,r){var i=function(n){return j(n,(function(n){var u,a,c,s,l,f,d=ut(n);if(Vt(n,"items")){var m=i(n.items);return bt((l=n,f={type:"submenu",isSelected:o(!1),getStylePreview:function(){return O.none()}},bt(l,f)),{getStyleItems:function(){return m}})}return Vt(n,"format")?BS(n,e,r):1===d.length&&P(d,"title")?bt(n,{type:"separator"}):(c={type:"formatter",format:a=Hr((u=n).title),isSelected:e(a),getStylePreview:r(a)},s=bt(u,c),t.formatter.register(a,s),s)}))};return i(n)},AS=Pw.trim,FS=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},MS=FS("true"),DS=FS("false"),IS=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},RS=function(t){return t.innerText||t.textContent},VS=function(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&HS(t);var n},NS=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},HS=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return MS(t)}return!1}(t)&&!DS(t)},PS=function(t){return NS(t)&&HS(t)},zS=function(t){var n,e,o=(n=t).id?n.id:Hr("h");return IS("header",RS(t),"#"+o,NS(e=t)?parseInt(e.nodeName.substr(1),10):0,(function(){t.id=o}))},LS=function(t){var e=t.id||t.name,o=RS(t);return IS("anchor",o||"#"+e,"#"+e,0,n)},jS=function(t){return 0<AS(t.title).length},US=function(t){var n,e=function(t){return j(Ua(te(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom()}))}(t);return W((n=e,j(W(n,PS),zS)).concat(j(W(e,VS),LS)),jS)},WS="tinymce-url-history",GS=function(t){return A(t)&&/^https?/.test(t)},XS=function(t){return F(t)&&function(t,n){for(var e=ut(t),o=0,r=e.length;o<r;o++){var i=t[e[o]];if(n(i))return O.some(i)}return O.none()}(t,(function(t){return!(M(n=t)&&n.length<=5&&Z(n,GS));var n})).isNone()},YS=function(){var n,e=t.localStorage.getItem(WS);if(null===e)return{};try{n=JSON.parse(e)}catch(n){if(n instanceof SyntaxError)return t.console.log("Local storage "+WS+" was not valid JSON",n),{};throw n}return XS(n)?n:(t.console.log("Local storage "+WS+" was not valid format",n),{})},qS=function(t){var n=YS();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},KS=function(n,e){if(GS(n)){var o=YS(),r=Object.prototype.hasOwnProperty.call(o,e)?o[e]:[],i=W(r,(function(t){return t!==n}));o[e]=[n].concat(i).slice(0,5),function(n){if(!XS(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));t.localStorage.setItem(WS,JSON.stringify(n))}(o)}},JS=Object.prototype.hasOwnProperty,$S=function(t){return!!t},QS=function(t){return st(Pw.makeMap(t,/[, ]/),$S)},ZS=function(t,n,e){var o,r,i=(o=t,r=n,JS.call(o,r)?O.some(o[r]):O.none()).getOr(e);return A(i)?O.some(i):O.none()},tk=function(t){return O.some(t.file_picker_callback).filter(I)},nk=function(t){return{getHistory:qS,addToHistory:KS,getLinkInformation:function(){return!1===(n=t).settings.typeahead_urls?O.none():O.some({targets:US(n.getBody()),anchorTop:ZS(n.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:ZS(n.settings,"anchor_bottom","#bottom").getOrUndefined()});var n},getValidationHandler:function(){return n=t.settings.filepicker_validator_handler,I(n)?O.some(n):O.none();var n},getUrlPicker:function(n){return o=n,function(t,n){var e,o,r,i,u=(e=t,o=O.some(e.file_picker_types).filter($S),r=O.some(e.file_browser_callback_types).filter($S),i=o.or(r).map(QS),tk(e).fold((function(){return!1}),(function(t){return i.fold((function(){return!0}),(function(t){return 0<ut(t).length&&t}))})));return D(u)?u?tk(t):O.none():u[n]?tk(t):O.none()}((e=t).settings,o).map((function(t){return function(n){return mv((function(r){var i=Pw.extend({filetype:o},O.from(n.meta).getOr({}));t.call(e,(function(t,n){if(!A(t))throw new Error("Expected value to be string");if(void 0!==n&&!F(n))throw new Error("Expected meta to be a object");r({value:t,meta:n})}),n.value,i)}))}}));var e,o}}},ek=o([Tn("dom"),zn("shell",!0),ns("toolbarBehaviours",[vd])]),ok=o([_s({name:"groups",overrides:function(t){return{behaviours:au([vd.config({})])}}})]),rk=el({name:"Toolbar",configFields:ek(),partFields:ok(),factory:function(n,e,o,r){var i=function(t){return n.shell?O.some(t):Ls(t,n,"groups")},u=n.shell?{behaviours:[vd.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:os(n.toolbarBehaviours,u.behaviours),apis:{setGroups:function(n,e){i(n).fold((function(){throw t.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){vd.set(t,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),ik=cr("within","extra","withinWidth"),uk=function(t,n,e){var r,i=(r=function(t,n){var r=e(t);return O.some({element:o(t),start:o(n),finish:o(n+r),width:o(r)})},X(t,(function(t,n){return r(n,t.len).fold(o(t),(function(n){return{len:n.finish(),list:t.list.concat([n])}}))}),{len:0,list:[]}).list),u=W(i,(function(t){return t.finish()<=n})),a=G(u,(function(t,n){return t+n.width()}),0),c=i.slice(u.length);return{within:o(u),extra:o(c),withinWidth:o(a)}},ak=function(t){return j(t,(function(t){return t.element()}))},ck=function(t,n){var e=j(n,(function(t){return Mi(t)}));rk.setGroups(t,e)},sk=function(t,n,e,o){var r=js(t,n,"primary"),i=Ls(t,n,"overflow-button"),u=Qh.getCoupled(t,"overflowGroup");vi(r.element(),"visibility","hidden");var a,c=(a=i,e.bind((function(t){return Fl(t.element()).bind((function(n){return t.getSystem().getByDom(n).toOption()}))})).orThunk((function(){return a.filter(Vd.isFocused)})));e.each((function(t){rk.setGroups(t,[])}));var s=n.builtGroups.get();ck(r,s.concat([u]));var l=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m,g,p,h=(r=t,i=n,u=e,a=uk(i,r,u),0===a.extra().length?O.some(a):O.none()).getOrThunk((function(){return uk(n,t-e(o),e)})),v=h.within(),b=h.extra(),y=h.withinWidth();return 1===b.length&&b[0].width()<=e(o)?(m=b,g=y,p=ak(v.concat(m)),ik(p,[],g)):1<=b.length?(s=b,l=o,f=y,d=ak(v).concat([l]),ik(d,ak(s),f)):(c=y,ik(ak(v),[],c))}(_u(r.element()),s,(function(t){return _u(t.element())}),u);0===l.extra().length?(vd.remove(r,u),e.each((function(t){rk.setGroups(t,[])}))):(ck(r,l.within()),e.each((function(t){ck(t,l.extra())}))),ki(r.element(),"visibility"),Ci(r.element()),e.each((function(t){i.each((function(n){return qd.set(n,o(t))})),c.each(Vd.focus)}))},lk=o([Tn("items"),Ki(["itemSelector"]),ns("tgroupBehaviours",[dd])]),fk=o([As({name:"items",unit:"item"})]),dk=el({name:"ToolbarGroup",configFields:lk(),partFields:fk(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:os(t.tgroupBehaviours,[dd.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),mk=o([ns("splitToolbarBehaviours",[]),qn("builtGroups",(function(){return Kn([])}))]),gk=function(t,n,e,o,r){var i="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:os(t.splitToolbarBehaviours,[Qh.config({others:f({},r.coupling,{overflowGroup:function(t){return dk.sketch(f({},o["overflow-group"](),{items:[pm.sketch(f({},o["overflow-button"](),{action:function(n){Oo(t,i)}}))]}))}})}),Fd("toolbar-toggle-events",[$o(i,(function(n){r.toggleToolbar(n,t,o)}))])]),apis:{setGroups:function(n,e){var o;o=j(e,n.getSystem().build),t.builtGroups.set(o),r.refresh(n,t)},refresh:function(n){r.refresh(n,t)},getMoreButton:function(n){return Ls(n,t,"overflow-button")},getOverflow:function(t){return n=t,r.getOverflow(n);var n},toggle:function(n){r.toggleToolbar(n,t,o)}},domModification:{attributes:{role:"group"}}}},pk=o([Ki(["overflowToggledClass"]),Tn("getAnchor"),Tn("lazySink")].concat(mk())),hk=o([Es({factory:rk,schema:ek(),name:"primary"}),Bs({factory:rk,schema:ek(),name:"overflow",overrides:function(t){return{toolbarBehaviours:au([dd.config({mode:"cyclic",onEscape:function(n){return Ls(n,t,"overflow-button").each(Vd.focus),O.none()}})])}}}),Bs({name:"overflow-button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:au([qd.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Bs({name:"overflow-group"})]),vk=function(t,n,e){var o=Qh.getCoupled(t,"sandbox");Kc.isOpen(o)?Kc.close(o):Kc.open(o,e.overflow())},bk=function(t){return t.getSystem().isConnected()},yk=function(t,n){var e=Kc.getState(Qh.getCoupled(t,"sandbox"));sk(t,n,e,bk),e.each((function(e){var o=n.lazySink(t).getOrDie(),r=n.getAnchor(t);Ac.position(o,r,e)}))},xk=el({name:"SplitFloatingToolbar",configFields:pk(),partFields:hk(),factory:function(t,n,e,o){return gk(t,n,0,o,{refresh:yk,toggleToolbar:vk,getOverflow:function(t){return Kc.getState(Qh.getCoupled(t,"sandbox"))},coupling:{sandbox:function(n){return e=n,o=t,{dom:{tag:"div",attributes:{id:(r=Vi()).id()}},behaviours:au([dd.config({mode:"special",onEscape:function(t){return Kc.close(t),O.some(!0)}}),Kc.config({onOpen:function(t,n){yk(e,o),Ls(e,o,"overflow-button").each((function(t){qd.on(t),r.link(t.element())})),dd.focusIn(n)},onClose:function(){Ls(e,o,"overflow-button").each((function(t){qd.off(t),Vd.focus(t),r.unlink(t.element())}))},isPartOf:function(t,n,o){return Ni(n,o)||Ni(e,o)},getAttachPoint:function(){return o.lazySink(e).getOrDie()}})])};var e,o,r}}})},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),wk=function(t,n){return n.getAnimationRoot.fold((function(){return t.element()}),(function(n){return n(t)}))},Sk=function(t){return t.dimension.property},kk=function(t,n){return t.dimension.getDimension(n)},Ck=function(t,n){var e=wk(t,n);mi(e,[n.shrinkingClass,n.growingClass])},Ok=function(t,n){li(t.element(),n.openClass),si(t.element(),n.closedClass),vi(t.element(),Sk(n),"0px"),Ci(t.element())},Tk=function(t,n){li(t.element(),n.closedClass),si(t.element(),n.openClass),ki(t.element(),Sk(n))},Ek=function(t,n,e,o){e.setCollapsed(),vi(t.element(),Sk(n),kk(n,t.element())),Ci(t.element()),Ck(t,n),Ok(t,n),n.onStartShrink(t),n.onShrunk(t)},Bk=function(t,n,e,o){var r=o.getOrThunk((function(){return kk(n,t.element())}));e.setCollapsed(),vi(t.element(),Sk(n),r),Ci(t.element());var i=wk(t,n);li(i,n.growingClass),si(i,n.shrinkingClass),Ok(t,n),n.onStartShrink(t)},_k=function(t,n,e){var o=kk(n,t.element());("0px"===o?Ek:Bk)(t,n,e,O.some(o))},Ak=function(t,n,e){var o=wk(t,n),r=fi(o,n.shrinkingClass),i=kk(n,t.element());Tk(t,n);var u=kk(n,t.element());(r?function(){vi(t.element(),Sk(n),i),Ci(t.element())}:function(){Ok(t,n)})(),li(o,n.shrinkingClass),si(o,n.growingClass),Tk(t,n),vi(t.element(),Sk(n),u),e.setExpanded(),n.onStartGrow(t)},Fk=function(t,n,e){var o=wk(t,n);return!0===fi(o,n.growingClass)},Mk=function(t,n,e){var o=wk(t,n);return!0===fi(o,n.shrinkingClass)},Dk=Object.freeze({refresh:function(t,n,e){if(e.isExpanded()){ki(t.element(),Sk(n));var o=kk(n,t.element());vi(t.element(),Sk(n),o)}},grow:function(t,n,e){e.isExpanded()||Ak(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&_k(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&Ek(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:Fk,isShrinking:Mk,isTransitioning:function(t,n,e){return!0===Fk(t,n)||!0===Mk(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?_k:Ak)(t,n,e)},disableTransitions:Ck}),Ik=Object.freeze({exhibit:function(t,n){var e=n.expanded;return oi(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:It(n.dimension.property,"0px")})},events:function(t,n){return qo([or(Qe(),(function(e,o){o.event().raw().propertyName===t.dimension.property&&(Ck(e,t),n.isExpanded()&&ki(e.element(),t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),Rk=[Tn("closedClass"),Tn("openClass"),Tn("shrinkingClass"),Tn("growingClass"),In("getAnimationRoot"),$i("onShrunk"),$i("onStartShrink"),$i("onGrown"),$i("onStartGrow"),zn("expanded",!1),En("dimension",hn("property",{width:[nu("property","width"),nu("getDimension",(function(t){return _u(t)+"px"}))],height:[nu("property","height"),nu("getDimension",(function(t){return Tu(t)+"px"}))]}))],Vk=su({fields:Rk,name:"sliding",active:Ik,apis:Dk,state:Object.freeze({init:function(t){var n=Kn(t.expanded);return ni({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:i(n.set,!1),setExpanded:i(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),Nk=o([Ki(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"])].concat(mk())),Hk=o([Es({factory:rk,schema:ek(),name:"primary"}),Es({factory:rk,schema:ek(),name:"overflow",overrides:function(t){return{toolbarBehaviours:au([Vk.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Ls(n,t,"overflow-button").each((function(t){qd.off(t),Vd.focus(t)}))},onGrown:function(t){dd.focusIn(t)},onStartGrow:function(n){Ls(n,t,"overflow-button").each(qd.on)}}),dd.config({mode:"acyclic",onEscape:function(n){return Ls(n,t,"overflow-button").each(Vd.focus),O.some(!0)}})])}}}),Bs({name:"overflow-button",overrides:function(t){return{buttonBehaviours:au([qd.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Bs({name:"overflow-group"})]),Pk=function(t,n){Ls(t,n,"overflow").each((function(e){Lk(t,n),Vk.toggleGrow(e)}))},zk=function(t){return Vk.hasGrown(t)},Lk=function(t,n){var e=Ls(t,n,"overflow");sk(t,n,e,zk),e.each(Vk.refresh)},jk=el({name:"SplitSlidingToolbar",configFields:Nk(),partFields:Hk(),factory:function(t,n,e,o){return gk(t,n,0,o,{refresh:Lk,toggleToolbar:Pk,getOverflow:function(n){return Ls(n,t,"overflow")},coupling:{}})},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),Uk="silver.readonly",Wk=tn([En("readonly",wn)]),Gk=function(t,n){var e,o,r,i=t.outerContainer;o=n,r=(e=t).outerContainer.element(),o&&(e.mothership.broadcastOn([Jc()],{target:r}),e.uiMothership.broadcastOn([Jc()],{target:r})),e.mothership.broadcastOn([Uk],{readonly:o}),e.uiMothership.broadcastOn([Uk],{readonly:o}),De("*",i.element()).forEach((function(t){i.getSystem().getByDom(t).each((function(t){t.hasConfigured(Vg)&&Vg.set(t,n)}))}))},Xk=function(t,n){t.on("init",(function(){t.readonly&&Gk(n,!0)})),t.on("SwitchMode",(function(){return Gk(n,t.readonly)})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},Yk=function(t){var n;return pu.config({channels:(n={},n[Uk]={schema:Wk,onReceive:function(n,e){t(n).each((function(t){var n,o;n=t,o=e.readonly,De("*",n.element()).forEach((function(t){n.getSystem().getByDom(t).each((function(t){t.hasConfigured(Vg)&&Vg.set(t,o)}))}))}))}},n)})},qk=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:f({tag:"div",classes:["tox-toolbar__group"]},n),components:[dk.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:au([eb.config({}),Vd.config({})])}},Kk=function(t){return dk.sketch(qk(t))},Jk=function(t,n,e){var o=rr((function(n){var e=j(t.initGroups,Kk);rk.setGroups(n,e)}));return au([dd.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Fd("toolbar-events",[o]),Yk(e)])},$k=function(t,n){var e=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":qk({title:O.none(),items:[]}),"overflow-button":hw({name:"more",icon:O.some("more-drawer"),disabled:!1,tooltip:O.some("More..."),primary:!1,borderless:!1},O.none(),t.backstage.shared.providers)},splitToolbarBehaviours:Jk(t,e,n)}},Qk=function(t){var n=$k(t,xk.getOverflow),e=xk.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return xk.sketch(f({},n,{lazySink:t.getSink,getAnchor:function(){return t.backstage.shared.anchors.toolbarOverflow()},parts:f({},n.parts,{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"]}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},Zk=function(t){var n=jk.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=jk.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=$k(t,jk.getOverflow);return jk.sketch(f({},o,{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"}}))},tC=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return rk.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"]},components:[rk.parts().groups({})],toolbarBehaviours:Jk(t,n,o(O.none()))})},nC=[Gn("disabled",!1),Nn("tooltip"),Nn("icon"),Nn("text"),Xn("onSetup",(function(){return n}))],eC=tn([Bn("type"),An("onAction")].concat(nC)),oC=function(t){return fn("toolbarbutton",eC,t)},rC=[Nn("text"),Nn("tooltip"),Nn("icon"),An("fetch"),Xn("onSetup",(function(){return n}))],iC=tn([Bn("type")].concat(rC)),uC=function(t){return fn("menubutton",iC,t)},aC=tn([Bn("type"),Nn("tooltip"),Nn("icon"),Nn("text"),Hn("select"),An("fetch"),Xn("onSetup",(function(){return n})),Wn("presets","normal",["normal","color","listpreview"]),zn("columns",1),An("onAction"),An("onItemAction")]),cC=[Gn("active",!1)].concat(nC),sC=tn(cC.concat([Bn("type"),An("onAction")])),lC=function(t){return fn("ToggleButton",sC,t)},fC=[Xn("predicate",(function(){return!1})),Wn("scope","node",["node","editor"]),Wn("position","selection",["node","selection","line"])],dC=nC.concat([zn("type","contextformbutton"),zn("primary",!1),An("onAction"),qn("original",r)]),mC=cC.concat([zn("type","contextformbutton"),zn("primary",!1),An("onAction"),qn("original",r)]),gC=nC.concat([zn("type","contextformbutton")]),pC=cC.concat([zn("type","contextformtogglebutton")]),hC=hn("type",{contextformbutton:dC,contextformtogglebutton:mC}),vC=tn([zn("type","contextform"),Xn("initValue",(function(){return""})),Nn("label"),Dn("commands",hC),Rn("launch",hn("type",{contextformbutton:gC,contextformtogglebutton:pC}))].concat(fC)),bC=tn([zn("type","contexttoolbar"),Bn("items")].concat(fC)),yC=Object.freeze({getState:function(t,n,e){return e}}),xC=Object.freeze({events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get());Nc(e),U(r,(function(t){Dc(e,e.getSystem().build(t))}))}))};return qo([$o(ro(),(function(n,o){var r=t.channel;P(o.channels(),r)&&e(n,o.data())})),rr((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),wC=Object.freeze({init:function(t){var n=Kn(O.none());return{readState:function(){return n.get().getOr("none")},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(O.none())}}}}),SC=[Tn("channel"),In("renderComponents"),In("updateState"),In("initialData")],kC=su({fields:SC,name:"reflecting",active:xC,apis:yC,state:wC}),CC=o([Tn("toggleClass"),Tn("fetch"),Zi("onExecute"),zn("getHotspot",O.some),zn("getAnchorOverrides",o({})),zn("layouts",O.none()),Zi("onItemExecute"),In("lazySink"),Tn("dom"),$i("onOpen"),ns("splitDropdownBehaviours",[Qh,dd,Vd]),zn("matchWidth",!1),zn("useMinWidth",!1),zn("eventOrder",{}),In("role")].concat(Av())),OC=Es({factory:pm,schema:[Tn("dom")],name:"arrow",defaults:function(t){return{buttonBehaviours:au([Vd.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Eo)},buttonBehaviours:au([qd.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),TC=Es({factory:pm,schema:[Tn("dom")],name:"button",defaults:function(t){return{buttonBehaviours:au([Vd.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),EC=o([OC,TC,_s({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Tn("text")],name:"aria-descriptor"}),Bs({schema:[qi()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),hv()]),BC=el({name:"SplitDropdown",configFields:CC(),partFields:EC(),factory:function(t,e,o,r){var i=function(t){ul.getCurrent(t).each((function(t){bl.highlightFirst(t),dd.focusIn(t)}))},u=function(e){xv(t,(function(t){return t}),e,r,i,uv.HighlightFirst).get(n)},a=function(n){var e=js(n,t,"button");return Eo(e),O.some(!0)},c=yt(qo([rr((function(n,e){Ls(n,t,"aria-descriptor").each((function(t){var e=Hr("aria");_r(t.element(),"id",e),_r(n.element(),"aria-describedby",e)}))}))]),gm(O.some(u)));return{uid:t.uid,dom:t.dom,components:e,eventOrder:f({},t.eventOrder,{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:c,behaviours:os(t.splitDropdownBehaviours,[Qh.config({others:{sandbox:function(n){var e=js(n,t,"arrow");return Sv(t,n,{onOpen:function(){qd.on(e),qd.on(n)},onClose:function(){qd.off(e),qd.off(n)}})}}}),dd.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),O.some(!0)}}),Vd.config({}),qd.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}}}),_C=function(t){return{isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},AC=function(t){return{setActive:function(n){qd.set(t,n)},isActive:function(){return qd.isOn(t)},isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)}}},FC=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},MC=Hr("focus-button"),DC=["checklist","ordered-list"],IC=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],RC=function(t,n,e,o,r,i){var u,a=function(t){return og.isRtl()&&P(DC,t)?t+"-rtl":t},c=og.isRtl()&&t.exists((function(t){return P(IC,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:FC(e,i)},components:qg([t.map((function(t){return iw(a(t),i.icons)})),n.map((function(t){return aw(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[ze()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:au([Fd("common-button-display-events",[$o(ze(),(function(t,n){n.event().prevent(),Oo(t,MC)}))])].concat(o.map((function(e){return kC.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return qg([t.icon.map((function(t){return iw(a(t),i.icons)})),t.text.map((function(t){return aw(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},VC=function(t,e,o){var r,i=Kn(n),u=RC(t.icon,t.text,t.tooltip,O.none(),O.none(),o);return pm.sketch({dom:u.dom,components:u.components,eventOrder:sw,buttonBehaviours:au([Fd("toolbar-button-events",[(r={onAction:t.onAction,getApi:e.getApi},ar((function(t,n){Lg(r,t)((function(n){To(t,cw,{buttonApi:n}),r.onAction(n)}))}))),jg(e,i),Ug(e,i)]),zg(t.disabled)].concat(e.toolbarButtonBehaviours))})},NC=function(t,n,e){return VC(t,{toolbarButtonBehaviours:[].concat(0<e.length?[Fd("toolbarButtonWith",e)]:[]),getApi:_C,onSetup:t.onSetup},n)},HC=function(t,n,e){return bt(VC(t,{toolbarButtonBehaviours:[vd.config({}),qd.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[Fd("toolbarToggleButtonWith",e)]:[]),getApi:AC,onSetup:t.onSetup},n))},PC=function(t,n){return $o(cw,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Oo(r,lo())},getValue:function(){return Ad.getValue(r)}});n.onAction(u,o.event().buttonApi())}))},zC=function(t,n){var e,o,r,i,a=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),c=hm(Uv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:au([dd.config({mode:"special",onEnter:function(t){return s.findPrimary(t).map((function(t){return Eo(t),!0}))},onLeft:function(t,n){return n.cut(),O.none()},onRight:function(t,n){return n.cut(),O.none()}})])})),s=(e=c,o=t.commands,r=n.shared.providers,i=j(o,(function(t){return hm(function(t,n,e){var o,r,i,u,a,c,s,l,m,g,p,h,v={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(s=t,m=v,(g=(l=n).original).primary,p=d(g,["primary"]),h=dn(lC(f({},p,{type:"togglebutton",onAction:function(){}}))),HC(h,m.backstage.shared.providers,[PC(s,l)])):(o=t,i=v,(u=(r=n).original).primary,a=d(u,["primary"]),c=dn(oC(f({},a,{type:"button",onAction:function(){}}))),NC(c,i.backstage.shared.providers,[PC(o,r)]))}(e,t,r))})),{asSpecs:function(){return j(i,(function(t){return t.asSpec()}))},findPrimary:function(t){return Pi(o,(function(n,e){return n.primary?O.from(i[e]).bind((function(n){return n.getOpt(t)})).filter(u(Vg.isDisabled)):O.none()}))}});return tC({uid:Hr("context-toolbar"),initGroups:[{title:O.none(),items:[c.asSpec()]},{title:O.none(),items:s.asSpecs()}],onEscape:O.none,cyclicKeying:!0,backstage:n,getSink:function(){return B.error("")}})},LC=Hr("forward-slide"),jC=Hr("backward-slide"),UC=Hr("change-slide-event"),WC="tox-pop--resizing",GC=function(n,e,o){var r=Math.max(e.left(),o.x()),i=o.right()-r,u=t.window.innerWidth-(r-e.left());return{x:r,width:Math.min(i,u)}},XC=function(t,n){return Pi(n,(function(n){return n.predicate(t.dom())?O.some({toolbarApi:n,elem:t}):O.none()}))},YC=function(t,n){return function(e){var o=Kn(O.none()),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive).unbind;o.set(O.some(r))};return t.initialized?r():t.on("init",r),function(){return o.get().each((function(t){return t()}))}}},qC=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},KC=function(t,n,e,o){var r,i,u,a,c,s="basic"===e.type?function(){return j(e.data,(function(t){return BS(t,o.isSelectedFor,o.getPreviewFor)}))}:e.getData;return{items:(r=n,i=o,u=function(t,n,e,o){var u=r.shared.providers.translate(t.title);if("separator"===t.type)return O.some({type:"separator",text:u});if("submenu"!==t.type)return O.some(f({type:"togglemenuitem",text:u,active:t.isSelected(o),disabled:e,onAction:i.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))));var c=Q(t.getStyleItems(),(function(t){return a(t,n,o)}));return 0===n&&c.length<=0?O.none():O.some({type:"nestedmenuitem",text:u,disabled:c.length<=0,getSubmenuItems:function(){return Q(t.getStyleItems(),(function(t){return a(t,n,o)}))}})},a=function(t,n,e){var o="formatter"===t.type&&i.isInvalid(t);return 0===n?o?[]:u(t,n,!1,e).toArray():u(t,n,o,e).toArray()},c=function(t){var n=i.getCurrentValue(),e=i.shouldHide?0:1;return Q(t,(function(t){return a(t,e,n)}))},{validateItems:c,getFetch:function(t,n){return function(e){var o=n(),r=c(o);e(jv(r,Xg.CLOSE_ON_EXECUTE,t))}}}),getStyleItems:s}},JC=function(t,e,o,r){var i=KC(0,e,o,r),u=i.items,a=i.getStyleItems;return dw({text:r.icon.isSome()?O.none():O.some(""),icon:r.icon,tooltip:O.from(r.tooltip),role:O.none(),fetch:u.getFetch(e,a),onSetup:function(e){return r.setInitialValue.each((function(t){return t(e.getComponent())})),r.nodeChangeHandler.map((function(n){var o=n(e.getComponent());return t.on("NodeChange",o),function(){t.off("NodeChange",o)}})).getOr(n)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};(Gw=Ww||(Ww={}))[Gw.SemiColon=0]="SemiColon",Gw[Gw.Space=1]="Space";var $C,QC,ZC=function(t,n,e,o){var r,i;return{type:"basic",data:(i=Dt(t.settings,n).getOr(e),r=o===Ww.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),j(r,(function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}},tO=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],nO=function(t){var n=function(n){var e=Y(tO,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));To(n,fw,{icon:"align-"+e})},e=O.some((function(t){return function(){return n(t)}})),r=O.some((function(t){return n(t)})),i={type:"basic",data:tO};return{tooltip:"Align",icon:O.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:o(O.none()),getPreviewFor:function(t){return function(){return O.none()}},onAction:qC(t),setInitialValue:r,nodeChangeHandler:e,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},eO=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],oO=function(t){var n=t.split(/\s*,\s*/);return j(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},rO=function(t){var n=function(){var n=function(t){return t?oO(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:Y(o,(function(t){var e=t.format;return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()})).orThunk((function(){return 0===(t=r).indexOf("-apple-system")&&(n=oO(t.toLowerCase()),Z(eO,(function(t){return-1<n.indexOf(t.toLowerCase())})))?O.from({title:"System Font",format:r}):O.none();var t,n})),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}));To(t,lw,{text:i})},o=O.some((function(t){return function(){return e(t)}})),r=O.some((function(t){return e(t)})),i=ZC(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Ww.SemiColon);return{tooltip:"Fonts",icon:O.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return O.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},iO={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},uO=function(t){var n=function(){var n=O.none(),e=u.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):t;var e,o,r}(o,t),i=mt(iO,r).getOr("");n=Y(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&0<=i;i--)r(i);return{matchOpt:n,px:o}},e=function(t){var e=n(),o=e.matchOpt,r=e.px,i=o.fold((function(){return r}),(function(t){return t.title}));To(t,lw,{text:i})},r=O.some((function(t){return function(){return e(t)}})),i=O.some((function(t){return e(t)})),u=ZC(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",Ww.Space);return{tooltip:"Font sizes",icon:O.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:function(){return o(O.none())},getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},setInitialValue:i,nodeChangeHandler:r,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}},aO=function(t,n,e){var o=n();return Pi(e,(function(n){return Y(o,(function(e){return t.formatter.matchNode(n,e.format)}))})).orThunk((function(){return t.formatter.match("p")?O.some({title:"Paragraph",format:"p"}):O.none()}))},cO=function(t){var n=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(n,(function(){return!0}),t.getBody())},sO=function(t){var n=function(n,e){var o=aO(t,(function(){return i.data}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}));To(e,lw,{text:o})},e=O.some((function(t){return function(e){return n(e.parents,t)}})),r=O.some((function(e){var o=cO(t);n(o,e)})),i=ZC(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Ww.SemiColon);return{tooltip:"Blocks",icon:O.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:o(O.none()),getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return O.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)})}},onAction:qC(t),setInitialValue:r,nodeChangeHandler:e,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},lO=function(t){var n=function(n,e){var o=function(t){var n=t.items;return void 0!==n&&0<n.length?Q(n,o):[{title:t.title,format:t.format}]},r=Q(ES(t),o),i=aO(t,(function(){return r}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}));To(e,lw,{text:i})},e=O.some((function(t){return function(e){return n(e.parents,t)}})),r=O.some((function(e){var o=cO(t);n(o,e)}));return{tooltip:"Formats",icon:O.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:o(O.none()),getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?O.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):O.none()}},onAction:qC(t),setInitialValue:r,nodeChangeHandler:e,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)}}},fO=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],dO=function(t,n){return function(e,o){var r=t(e).mapError((function(t){return gn(t)})).getOrDie();return n(r,o)}},mO={button:dO(oC,(function(t,n){return e=t,o=n.backstage.shared.providers,NC(e,o,[]);var e,o})),togglebutton:dO(lC,(function(t,n){return e=t,o=n.backstage.shared.providers,HC(e,o,[]);var e,o})),menubutton:dO(uC,(function(t,n){return gw(t,"tox-tbtn",n.backstage,O.none())})),splitbutton:dO((function(t){return fn("SplitButton",aC,t)}),(function(t,e){return function(t,e){var o,r,i,u,a=Hr("channel-update-split-dropdown-display"),c=function(t){return{isDisabled:function(){return Vg.isDisabled(t)},setDisabled:function(n){return Vg.set(t,n)},setIconFill:function(n,e){Ii(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){_r(t,"fill",e)}))},setIconStroke:function(n,e){Ii(t.element(),'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){_r(t,"stroke",e)}))},setActive:function(n){_r(t.element(),"aria-pressed",n),Ii(t.element(),"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return qd.set(t,n)}))}))},isActive:function(){return Ii(t.element(),"span").exists((function(n){return t.getSystem().getByDom(n).exists(qd.isOn)}))}}},s=Kn(n),l={getApi:c,onSetup:t.onSetup};return BC.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:yt({"aria-pressed":!1},FC(t.tooltip,e.providers))},onExecute:function(n){t.onAction(c(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:au([Pg(!1),Fd("split-dropdown-events",[$o(MC,Vd.focus),jg(l,s),Ug(l,s)])]),eventOrder:(o={},o[ho()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(r=c,i=t,u=e.providers,function(t){return mv((function(t){return i.fetch(t)})).map((function(n){return O.from(eh(bt(Kp(Hr("menu-value"),n,(function(n){i.onItemAction(r(t),n)}),i.columns,i.presets,Xg.CLOSE_ON_EXECUTE,i.select.getOr((function(){return!1})),u),{movement:$p(i.columns,i.presets),menuBehaviours:Ym("auto"!==i.columns?[]:[rr((function(t,n){Xm(t,4,dg(i.presets)).each((function(n){var e=n.numRows,o=n.numColumns;dd.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:Gp(0,t.columns,t.presets)},components:[BC.parts().button(RC(t.icon,t.text,O.none(),O.some(a),O.some([qd.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),BC.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:bm("chevron-down",e.providers.icons)}}),BC.parts()["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(t,e.backstage.shared)})),styleSelectButton:function(t,n){return e=t,r=(o=n.backstage).styleselect,JC(e,o,r,lO(e));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,r=uO(e),JC(e,o,r.dataset,r);var e,o,r},fontSelectButton:function(t,n){return e=t,o=n.backstage,r=rO(e),JC(e,o,r.dataset,r);var e,o,r},formatButton:function(t,n){return e=t,o=n.backstage,r=sO(e),JC(e,o,r.dataset,r);var e,o,r},alignMenuButton:function(t,n){return e=t,o=n.backstage,r=nO(e),JC(e,o,r.dataset,r);var e,o,r}},gO={styleselect:mO.styleSelectButton,fontsizeselect:mO.fontsizeSelectButton,fontselect:mO.fontSelectButton,formatselect:mO.formatButton,align:mO.alignMenuButton},pO=function(n,e,o,r){var i=function(n){var e,o,r,i=n.toolbar,u=n.buttons;return!1===i?[]:void 0===i||!0===i?(o=u,r=j(fO,(function(t){var n=W(t.items,(function(t){return gt(o,t)||gt(gO,t)}));return{name:t.name,items:n}})),W(r,(function(t){return 0<t.items.length}))):A(i)?(e=i.split("|"),j(e,(function(t){return{items:t.trim().split(" ")}}))):V(i,(function(t){return gt(t,"name")&&gt(t,"items")}))?i:(t.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(e),u=j(i,(function(i){var u=Q(i.items,(function(i){return 0===i.trim().length?[]:function(n,e,o,r,i){return mt(e,o.toLowerCase()).orThunk((function(){return i.bind((function(t){return Pi(t,(function(t){return mt(e,t+o.toLowerCase())}))}))})).fold((function(){return mt(gO,o.toLowerCase()).map((function(t){return t(n,r)})).orThunk((function(){return O.none()}))}),(function(n){return o=r,mt(mO,(e=n).type).fold((function(){return t.console.error("skipping button defined by",e),O.none()}),(function(t){return O.some(t(e,o))}));var e,o}))}(n,e.buttons,i,o,r).toArray()}));return{title:O.from(n.translate(i.name)),items:u}}));return W(u,(function(t){return 0<t.items.length}))},hO=function(n,e,r,i){var u,a,c=Fi((u={sink:r,onEscape:function(){return n.focus(),O.some(!0)}},a=Kn([]),mm.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){a.set([]),mm.getContent(t).each((function(t){ki(t.element(),"visibility")})),li(t.element(),WC),ki(t.element(),"width")},inlineBehaviours:au([Fd("context-toolbar-events",[or(Qe(),(function(t,n){mm.getContent(t).each((function(t){})),li(t.element(),WC),ki(t.element(),"width")})),$o(UC,(function(t,n){ki(t.element(),"width");var e=_u(t.element());mm.setContent(t,n.event().contents()),si(t.element(),WC);var o=_u(t.element());vi(t.element(),"width",e+"px"),mm.getContent(t).each((function(e){n.event().focus().bind((function(n){return _l(n),Fl(t.element())})).orThunk((function(){return dd.focusIn(e),Al()}))})),wm.setTimeout((function(){vi(t.element(),"width",o+"px")}),0)})),$o(LC,(function(t,n){mm.getContent(t).each((function(t){a.set(a.get().concat([{bar:t,focus:Al()}]))})),To(t,UC,{contents:n.event().forwardContents(),focus:O.none()})})),$o(jC,(function(t,n){rt(a.get()).each((function(n){a.set(a.get().slice(0,a.get().length-1)),To(t,UC,{contents:Mi(n.bar),focus:n.focus})}))}))]),dd.config({mode:"special",onEscape:function(t){return rt(a.get()).fold((function(){return u.onEscape()}),(function(n){return Oo(t,jC),O.some(!0)}))}})]),lazySink:function(){return B.value(u.sink)}}))),s=_h(n)||Ah(n)||Mh(n),l=function(){var e,o,r,i,u,a,c,l,f,d,m,g,p,h,v,b=Fu(),y=Hu(te(n.getContentAreaContainer()));return n.inline&&!s?O.some((h=(p=GC(0,g=b,y)).x,v=p.width,Nu(h,g.top(),v,t.window.innerHeight))):n.inline?O.some(function(n,e,o){var r=GC(0,e,o),i=r.x,u=r.width,a=Hu(te(n.getContainer())),c=t.window.innerHeight,s=e.top();if(a.y()>=o.bottom()){var l=Math.min(c+s,a.y());return Nu(i,s,u,l-s)}var f=Math.max(s,a.bottom());return Nu(i,f,u,c-(f-s))}(n,b,y)):O.some((e=n,u=(i=GC(0,o=b,r=y)).x,a=i.width,c=Hu(te(e.getContainer())),l=Math.max(o.top(),r.y()),f=c.bottom()-l,d=t.window.innerHeight-(l-o.top()),m=Math.min(f,d),Nu(u,l,a,m)))},d=function(){var t,e=p.get().map((function(t){return t.getBoundingClientRect()})).getOr(n.selection.getRng().getBoundingClientRect()),o=mr(te(n.getBody())).dom().innerHeight,r=e.bottom<(t="fixed"===yi(te(n.getContainer()),"position"),s&&t?n.getContainer().getBoundingClientRect().bottom:0),i=e.top>o;return r||i},m=function(){g.get().each((function(t){var n=c.element();ki(n,"display"),d()?vi(n,"display","none"):Ac.positionWithinBounds(r,t,c,l())}))};n.on("init",(function(){if(n.on("ScrollWindow",m),!n.inline){var t=mr(te(n.getBody())),e=ah(t,"scroll",m);n.on("remove",(function(){e.unbind()}))}}));var g=Kn(O.none()),p=Kn(O.none()),h=Kn(null),v=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:au([dd.config({mode:"acyclic"}),Fd("pop-dialog-wrap-events",[rr((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return dd.focusIn(t)}))})),ir((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},b=xt((function(){return function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=dn(fn("ContextForm",vC,a));(e[t]=c).launch.map((function(e){i["form:"+t]=f({},a.launch,{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=ut(t);return U(c,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&function(t,n){var e;(e=n,fn("ContextToolbar",bC,e)).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))}(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}}(e,(function(t){var n=y(t);To(c,LC,{forwardContents:v(n)})}))})),y=function(t){var e,o,r=n.ui.registry.getAll().buttons,u=b();return"contexttoolbar"===t.type?(e=yt(r,u.formNavigators),o=pO(n,{buttons:e,toolbar:t.items},i,O.some(["form:"])),tC({uid:Hr("context-toolbar"),initGroups:o,onEscape:O.none,cyclicKeying:!0,backstage:i.backstage,getSink:function(){return B.error("")}})):zC(t,i.backstage)};n.on("contexttoolbar-show",(function(t){var e=b();Dt(e.lookupTable,t.toolbarKey).each((function(e){C(e,t.target===n?O.none():O.some(t)),mm.getContent(c).each(dd.focusIn)}))}));var x={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},w={maxHeightFunction:Sc()},S={bubble:Lu(12,0,x),layouts:{onLtr:function(){return[fa]},onRtl:function(){return[da]}},overrides:w},k={bubble:Lu(0,12,x),layouts:{onLtr:function(){return[sa,la,aa,ia,ca,ua,xS,wS,bS,hS,yS,vS]},onRtl:function(){return[sa,la,ca,ua,aa,ia,xS,wS,yS,vS,bS,hS]}},overrides:w},C=function(t,n){E();var e,o,r,u=y(t),a=(o=n.map(te),r="node"===(e=t.position)?i.backstage.shared.anchors.node(o):i.backstage.shared.anchors.cursor(),bt(r,"line"===e?S:k));g.set(O.some(a)),p.set(n);var s=c.element();ki(s,"display"),mm.showWithinBounds(c,a,v(u),l()),d()&&vi(s,"display","none")},T=function(){(function(t,n){var e=function(t){return t.dom()===n.getBody()},r=te(n.selection.getNode());return XC(r,t.inNodeScope).orThunk((function(){return XC(r,t.inEditorScope).orThunk((function(){return function(t,n,e){for(var r=t.dom(),i=I(e)?e:o(!1);r.parentNode;){r=r.parentNode;var u=te(r),a=n(u);if(a.isSome())return a;if(i(u))break}return O.none()}(r,(function(n){return XC(n,t.inNodeScope)}),e)}))}))})(b(),n).fold((function(){g.set(O.none()),mm.hide(c)}),(function(t){C(t.toolbarApi,O.some(t.elem.dom()))}))},E=function(){var t=h.get();null!==t&&(wm.clearTimeout(t),h.set(null))},_=function(t){E(),h.set(t)};n.on("init",(function(){n.on("click keyup SetContent ObjectResized ResizeEditor",(function(t){_(wm.setEditorTimeout(n,T,0))})),n.on("focusout",(function(t){wm.setEditorTimeout(n,(function(){Fl(r.element()).isNone()&&Fl(c.element()).isNone()&&(g.set(O.none()),mm.hide(c))}),0)})),n.on("SwitchMode",(function(){n.readonly&&(g.set(O.none()),mm.hide(c))})),n.on("NodeChange",(function(t){Fl(c.element()).fold((function(){_(wm.setEditorTimeout(n,T,0))}),(function(t){}))}))}))},vO=o([zn("shell",!1),Tn("makeItem"),zn("setupItem",n),rs("listBehaviours",[vd])]),bO=_s({name:"items",overrides:function(t){return{behaviours:au([vd.config({})])}}}),yO=o([bO]),xO=el({name:o("CustomList")(),configFields:vO(),partFields:yO(),factory:function(n,e,o,r){var i=n.shell?{behaviours:[vd.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:os(n.listBehaviours,i.behaviours),apis:{setItems:function(e,o){(function(t){return n.shell?O.some(t):Ls(t,n,"items")})(e).fold((function(){throw t.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(t){var r=vd.contents(t),i=o.length,u=i-r.length,a=0<u?function(t){for(var e=[],o=0;o<t;o++)e.push(n.makeItem());return e}(u):[],c=r.slice(i);U(c,(function(n){return vd.remove(t,n)})),U(a,(function(n){return vd.append(t,n)}));var s=vd.contents(t);U(s,(function(t,r){n.setupItem(e,t,o[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),wO=Ks,SO=Ms,kO=nl({factory:function(t,n){var e={focus:dd.focusIn,setMenus:function(t,e){var o=j(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=uC(e).mapError((function(t){return gn(t)})).getOrDie();return gw(o,"tox-mbtn",n.backstage,O.some("menuitem"))}));vd.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:au([vd.config({}),Fd("menubar-events",[rr((function(n){t.onSetup(n)})),$o(We(),(function(t,n){Ii(t.element(),".tox-mbtn--active").each((function(e){Ri(n.event().target(),".tox-mbtn").each((function(n){Ie(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){ib.expand(t),ib.close(e),Vd.focus(t)}))}))}))}))})),$o(yo(),(function(t,n){n.event().prevFocus().bind((function(n){return t.getSystem().getByDom(n).toOption()})).each((function(e){n.event().newFocus().bind((function(n){return t.getSystem().getByDom(n).toOption()})).each((function(t){ib.isOpen(e)&&(ib.expand(t),ib.close(e))}))}))}))]),dd.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),O.some(!0)}}),eb.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Tn("dom"),Tn("uid"),Tn("onEscape"),Tn("backstage"),zn("onSetup",n)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),CO="container",OO=[ns("slotBehaviours",[])],TO=function(t){return"<alloy.field."+t+">"},EO=function(t,n,e){var o,r=function(n){return Gs(t)},i=function(n,e){return void 0===e&&(e=void 0),function(o,r){return Ls(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},u=function(t,n){return"true"!==Fr(t.element(),"aria-hidden")},a=i(u,!1),c=i((function(t,n){if(u(t)){var e=t.element();vi(e,"display","none"),_r(e,"aria-hidden","true"),To(t,xo(),{name:n,visible:!1})}})),s=(o=c,function(t,n){U(n,(function(n){return o(t,n)}))}),l=i((function(t,n){if(!u(t)){var e=t.element();ki(e,"display"),Dr(e,"aria-hidden"),To(t,xo(),{name:n,visible:!0})}})),f={getSlotNames:r,getSlot:function(n,e){return Ls(n,t,e)},isShowing:a,hideSlot:c,hideAllSlots:function(t){return s(t,r())},showSlot:l};return{uid:t.uid,dom:t.dom,components:n,behaviours:es(t.slotBehaviours),apis:f}},BO=st({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Zr),_O=f({},BO,{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),Vs(CO,TO(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=j(r,(function(t){return Es({name:t,pname:TO(t)})}));return $s(CO,OO,i,EO,o)}}),AO=tn([Nn("icon"),Nn("tooltip"),Xn("onShow",n),Xn("onHide",n),Xn("onSetup",(function(){return n}))]),FO=function(t){return{element:function(){return t.element().dom()}}},MO=function(t,e){var o=j(ut(e),(function(t){var n=e[t],o=dn(fn("sidebar",AO,n));return{name:t,getApi:FO,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return j(o,(function(e){var r=Kn(n);return t.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Ym([jg(e,r),Ug(e,r),$o(xo(),(function(t,n){var e=n.event();Y(o,(function(t){return t.name===e.name()})).each((function(n){(e.visible()?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},DO=function(t){return ul.getCurrent(t).bind((function(t){return Vk.isGrowing(t)||Vk.hasGrown(t)?ul.getCurrent(t).bind((function(t){return Y(_O.getSlotNames(t),(function(n){return _O.isShowing(t,n)}))})):O.none()}))},IO=Hr("FixSizeEvent"),RO=Hr("AutoSizeEvent"),VO=SO.optional({factory:kO,name:"menubar",schema:[Tn("backstage")]}),NO=SO.optional({factory:{sketch:function(t){return xO.sketch({uid:t.uid,dom:t.dom,listBehaviours:au([dd.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return tC({uid:Hr("multiple-toolbar-item"),backstage:t.backstage,cyclicKeying:!1,getSink:t.getSink,initGroups:[],onEscape:function(){return O.none()}})},setupItem:function(t,n,e,o){rk.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Tn("dom"),Tn("onEscape")]}),HO=SO.optional({factory:{sketch:function(t){var n;return((n=t).split===Sh.sliding?Zk:n.split===Sh.floating?Qk:tC)({uid:t.uid,onEscape:function(){return t.onEscape(),O.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton}})}},name:"toolbar",schema:[Tn("dom"),Tn("onEscape"),Tn("getSink")]}),PO=SO.optional({name:"socket",schema:[Tn("dom")]}),zO=SO.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:au([eb.config({}),Vd.config({}),Vk.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){ul.getCurrent(t).each(_O.hideAllSlots),Oo(t,RO)},onGrown:function(t){Oo(t,RO)},onStartGrow:function(t){To(t,IO,{width:wi(t.element(),"width").getOr("")})},onStartShrink:function(t){To(t,IO,{width:_u(t.element())+"px"})}}),vd.config({}),ul.config({find:function(t){var n=vd.contents(t);return ot(n)}})])}],behaviours:au([fx(0),Fd("sidebar-sliding-events",[$o(IO,(function(t,n){vi(t.element(),"width",n.event().width())})),$o(RO,(function(t,n){ki(t.element(),"width")}))])])}}},name:"sidebar",schema:[Tn("dom")]}),LO=SO.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:au([vd.config({})]),components:[]}}},name:"throbber",schema:[Tn("dom")]}),jO=el({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return wO.getPart(n,t,"socket")},setSidebar:function(n,e){wO.getPart(n,t,"sidebar").each((function(t){return function(t,n){ul.getCurrent(t).each((function(t){return vd.set(t,[(e=n,_O.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:MO(t,e),slotBehaviours:Ym([rr((function(t){return _O.hideAllSlots(t)}))])}})))]);var e}))}(t,e)}))},toggleSidebar:function(n,e){wO.getPart(n,t,"sidebar").each((function(t){return n=t,o=e,void ul.getCurrent(n).each((function(t){ul.getCurrent(t).each((function(n){Vk.hasGrown(t)?_O.isShowing(n,o)?Vk.shrink(t):(_O.hideAllSlots(n),_O.showSlot(n,o)):(_O.hideAllSlots(n),_O.showSlot(n,o),Vk.grow(t))}))}));var n,o}))},whichSidebar:function(n){return wO.getPart(n,t,"sidebar").bind(DO).getOrNull()},getToolbar:function(n){return wO.getPart(n,t,"toolbar")},setToolbar:function(n,e){wO.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){wO.getPart(n,t,"multiple-toolbar").each((function(t){xO.setItems(t,e)}))},refreshToolbar:function(n){wO.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},getMoreButton:function(n){return wO.getPart(n,t,"toolbar").bind((function(t){return t.getApis().getMoreButton(t)}))},getThrobber:function(n){return wO.getPart(n,t,"throbber")},focusToolbar:function(n){wO.getPart(n,t,"toolbar").orThunk((function(){return wO.getPart(n,t,"multiple-toolbar")})).each((function(t){dd.focusIn(t)}))},setMenubar:function(n,e){wO.getPart(n,t,"menubar").each((function(t){kO.setMenus(t,e)}))},focusMenubar:function(n){wO.getPart(n,t,"menubar").each((function(t){kO.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Tn("dom"),Tn("behaviours")],partFields:[VO,HO,NO,PO,zO,LO],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=j(e,(function(t){return Kk(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=j(e,(function(t){return j(t,Kk)}));t.setToolbars(n,o)},getMoreButton:function(t,n){return t.getMoreButton(n)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),UO={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable tableprops deletetable row column cell"},help:{title:"Help",items:"help"}},WO=function(t){return"string"==typeof t?t.split(" "):t},GO=function(t,n){var e=yt(UO,n.menus),o=0<ut(n.menus).length,r=void 0===n.menubar||!0===n.menubar?WO("file edit view insert format tools table help"):WO(!1===n.menubar?"":n.menubar),i=W(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||UO.hasOwnProperty(t)})),u=j(i,(function(o){var r,i,u,a,c=e[o];return r={title:c.title,items:WO(c.items)},i=n,a=(u=t,u.getParam("removed_menuitems","")).split(/[ ,]/),{text:r.title,getItems:function(){return Q(r.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||z(a,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]}))}}}));return W(u,(function(t){return 0<t.getItems().length&&z(t.getItems(),(function(t){return"separator"!==t.type}))}))},XO=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)};return function(){t.initialized?n():t.on("init",n)}},YO=function(t,n){var e,o=function(t){var n=t.settings,e=n.skin,o=n.skin_url;if(!1!==e){var r=e||"oxide";o=o?t.documentBaseURI.toAbsolute(o):Th.baseURL+"/skins/ui/"+r}return o}(n);o&&(e=o+"/skin.min.css",n.contentCSS.push(o+(t?"/content.inline":"/content")+".min.css")),0==(!1===n.getParam("skin"))&&e?$g.DOM.styleSheetLoader.load(e,XO(n)):XO(n)()},qO=i(YO,!1),KO=i(YO,!0),JO=function(t,n,e,o){var r=n.outerContainer,i=e.toolbar,u=e.buttons;if(V(i,A)){var a=i.map((function(n){return pO(t,{toolbar:n,buttons:u},{backstage:o},O.none())}));jO.setToolbars(r,a)}else jO.setToolbar(r,pO(t,e,{backstage:o},O.none()))},$O=$g.DOM,QO=Oe.detect().deviceType.isTouch(),ZO={render:function(t,n,e,o,r){var i,u,a=Kn(0);qO(t),i=te(r.targetNode),u=n.mothership,Pc(i,u,yr),Hc(Uo(),n.uiMothership),t.on("init",(function(){JO(t,n,e,o),a.set(t.getWin().innerWidth),jO.setMenubar(n.outerContainer,GO(t,e)),jO.setSidebar(n.outerContainer,e.sidebar),function(t){var n=t.getWin(),e=t.getDoc().documentElement,o=Kn(bu(n.innerWidth,n.innerHeight)),r=Kn(bu(e.offsetWidth,e.offsetHeight)),i=function(){var e=t.getDoc().documentElement,i=o.get(),u=r.get();i.left()!==n.innerWidth||i.top()!==n.innerHeight?(o.set(bu(n.innerWidth,n.innerHeight)),Bp(t)):u.left()===e.offsetWidth&&u.top()===e.offsetHeight||(r.set(bu(e.offsetWidth,e.offsetHeight)),Bp(t))};$O.bind(n,"resize",i);var u=ch(te(t.getBody()),"load",i);t.on("remove",(function(){u.unbind(),$O.unbind(n,"resize",i)}))}(t)}));var c=jO.getSocket(n.outerContainer).getOrDie("Could not find expected socket element");!0===QO&&bi(c.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),Xk(t,n),t.addCommand("ToggleSidebar",(function(e,o){jO.toggleSidebar(n.outerContainer,o),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return jO.whichSidebar(n.outerContainer)}));var s=Rh(t);return s!==Sh.sliding&&s!==Sh.floating||t.on("ResizeContent",(function(){var e=t.getWin().innerWidth;e!==a.get()&&jO.refreshToolbar(n.outerContainer),a.set(e)})),{iframeContainer:c.element().dom(),editorContainer:n.outerContainer.element().dom()}},getBehaviours:function(t){return[]}},tT=function(t,n){return pr(t).orThunk((function(){var n=Qn("span");br(t,n);var e=pr(n);return Cr(n),e})).map((function(t){return xu(t).translate(-n.left(),-n.top())})).getOrThunk((function(){return bu(0,0)}))},nT=pt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),eT=function(t){return function(n){return n.translate(-t.left(),-t.top())}},oT=function(t){return function(n){return n.translate(t.left(),t.top())}},rT=function(t){return function(n,e){return X(t,(function(t,n){return n(t)}),bu(n,e))}},iT=function(t,n,e){return t.fold(rT([oT(e),eT(n)]),rT([eT(n)]),rT([]))},uT=function(t,n,e){return t.fold(rT([oT(e)]),rT([]),rT([oT(n)]))},aT=function(t,n,e){return t.fold(rT([]),rT([eT(e)]),rT([oT(n),eT(e)]))},cT=function(t,n,e){return t.fold((function(t,n){return{position:"absolute",left:t+"px",top:n+"px"}}),(function(t,n){return{position:"absolute",left:t-e.left()+"px",top:n-e.top()+"px"}}),(function(t,n){return{position:"fixed",left:t+"px",top:n+"px"}}))},sT=nT.offset,lT=nT.absolute,fT=nT.fixed,dT=function(t,n){si(t.element(),n.transitionClass),li(t.element(),n.fadeOutClass),si(t.element(),n.fadeInClass)},mT=function(t,n){si(t.element(),n.transitionClass),li(t.element(),n.fadeInClass),si(t.element(),n.fadeOutClass)},gT=function(t,n){return t.y()>=n.y()&&t.bottom()<=n.bottom()},pT=function(t,n){return Mr(t,n)?O.some(parseInt(Fr(t,n),10)):O.none()},hT=function(t,n,e){var o=n.lazyViewport(t);n.contextual.each((function(n){n.lazyContext(t).each((function(e){var r,i,u=Hu(e);(i=o,(r=u).y()<i.bottom()&&r.bottom()>i.y()?dT:mT)(t,n)}))}));var r,i,u,a,c,s=dr(t.element()),l=Fu(s),f=tT(t.element(),l);(r=t,i=n,u=o,a=l,c=f,wi(r.element(),"position").is("fixed")?function(t,n,e){return(o=t,r=n,i=o.element(),pT(i,r.leftAttr).bind((function(t){return pT(i,r.topAttr).map((function(n){var e=_u(o.element()),r=Tu(o.element());return Nu(t,n,e,r)}))}))).bind((function(o){return gT(o,e)?(r=n,i=t.element(),Dr(i,r.leftAttr),Dr(i,r.topAttr),O.some(lT(o.x(),o.y()))):O.none();var r,i}));var o,r,i}(r,i,u):function(t,n,e,o,r){var i=xu(t.element()),u=Nu(i.left(),i.top(),_u(t.element()),Tu(t.element()));if(gT(u,e))return O.none();a=t,c=n,s=i.left(),l=i.top(),f=a.element(),_r(f,c.leftAttr,s),_r(f,c.topAttr,l);var a,c,s,l,f,d=lT(i.left(),i.top()),m=iT(d,o,r),g=lT(e.x(),e.y()),p=iT(g,o,r),h=u.y()<=e.y()?p.top():p.top()+e.height()-u.height();return O.some(fT(m.left(),h))}(r,i,u,a,c)).each((function(n){var e=cT(n,0,f);bi(t.element(),e)}))},vT=Object.freeze({refresh:hT}),bT=Object.freeze({events:function(t,n){return qo([$o(Qe(),(function(n,e){t.contextual.each((function(t){Ie(n.element(),e.event().target())&&(li(n.element(),t.transitionClass),e.stop())}))})),$o(go(),(function(n,e){hT(n,t)}))])}}),yT=[Pn("contextual",[Tn("fadeInClass"),Tn("fadeOutClass"),Tn("transitionClass"),Tn("lazyContext")]),zn("lazyViewport",(function(n){var e=Fu();return Nu(e.left(),e.top(),t.window.innerWidth,t.window.innerHeight)})),Tn("leftAttr"),Tn("topAttr")],xT=su({fields:yT,name:"docking",active:bT,apis:vT}),wT={render:function(t,n,e,o,r){var i,u=$g.DOM,a=Nh(t),c=Rh(t),s=c===Sh.sliding||c===Sh.floating;KO(t);var l=function(){var e=jO.getToolbar(n.outerContainer);s&&jO.refreshToolbar(n.outerContainer),a||function(n){var e=wi(i.element(),"position").is("fixed"),o=function(n){void 0===n&&(n=0);var e=xu(te(t.getBody()));return{top:Math.round(e.top()-Tu(i.element()))+n,left:Math.round(e.left())}}(s?n.fold((function(){return 0}),(function(t){return 1<t.components().length?Tu(t.components()[1].element()):0})):0);e?Ar(i.element(),lt(o,(function(t,n){return{k:"data-dock-"+n,v:t}}))):bi(i.element(),st(o,(function(t){return t+"px"}))),xT.refresh(i)}(e)},f=function(){vi(n.outerContainer.element(),"display","flex"),u.addClass(t.getBody(),"mce-edit-focus"),ki(n.uiMothership.element(),"display"),l()},d=function(){n.outerContainer&&(vi(n.outerContainer.element(),"display","none"),u.removeClass(t.getBody(),"mce-edit-focus")),vi(n.uiMothership.element(),"display","none")},m=function(){if(i)f();else{i=n.outerContainer;var r=Vh(t).getOr(Uo());Hc(r,n.mothership),Hc(r,n.uiMothership),JO(t,n,e,o),jO.setMenubar(n.outerContainer,GO(t,e)),a||vi(i.element(),"position","absolute"),l(),f(),t.on("NodeChange ResizeWindow",l),t.on("activate",f),t.on("deactivate",d),t.nodeChanged()}};return t.on("focus",m),t.on("blur hide",d),t.on("init",(function(){t.hasFocus()&&m()})),Xk(t,n),{editorContainer:n.outerContainer.element().dom()}},getBehaviours:function(t){return Nh(t)?[]:[xT.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",contextual:{lazyContext:function(n){return O.from(t).map((function(t){return te(t.getBody())}))},fadeInClass:"tox-toolbar-dock-fadein",fadeOutClass:"tox-toolbar-dock-fadeout",transitionClass:"tox-toolbar-dock-transition"}}),Vd.config({})]}},ST=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},kT=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.readonly||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},CT=function(t,n){(function(t){Pw.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:YC(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return t.execCommand("JustifyNone")},icon:"align-none"})})(t),function(t){var n;(function(t){var n,e;!function(t){Pw.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:YC(t,n.name),onAction:ST(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:YC(t,e),onAction:ST(t,e)})}}(t),n=t,Pw.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})})),e=t,Pw.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:YC(e,t.name)})}))})(t),n=t,Pw.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:ST(n,"code")})}(t),function(t,n){var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w;o=n,r=nO(e=t),i=KC(0,o,r.dataset,r),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return i.items.validateItems(i.getStyleItems())}}),a=n,c=rO(u=t),s=KC(0,a,c.dataset,c),u.ui.registry.addNestedMenuItem("fontformats",{text:a.shared.providers.translate("Fonts"),getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}}),l=t,d=(f=n).styleselect,m=KC(0,f,d,lO(l)),l.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return m.items.validateItems(m.getStyleItems())}}),p=n,h=sO(g=t),v=KC(0,p,h.dataset,h),g.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return v.items.validateItems(v.getStyleItems())}}),y=n,x=uO(b=t),w=KC(0,y,x.dataset,x),b.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return w.items.validateItems(w.getStyleItems())}})}(t,n),function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return kT(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return kT(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return kT(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return kT(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})}(t),Pp.register(t),function(t){var n,e;(n=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}}),(e=t).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,e)},onAction:function(){e.execCommand("mceToggleVisualAid")}})}(t),function(t){var n;(n=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})}(t)},OT=function(t,n){return{anchor:"makeshift",x:t,y:n}},TT=function(t){return{anchor:"selection",root:te(t.selection.getNode())}},ET=function(t){return"string"==typeof t?t.split(/[ ,]/):t},BT=function(t){return t.settings.contextmenu_never_use_native||!1},_T=function(t){return A(t)?"|"===t:"separator"===t.type},AT={type:"separator"},FT=function(t){if(A(t))return t;switch(t.type){case"separator":return AT;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems();return A(n)?n:j(n,FT)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:(n=t.onAction,function(){return n()})}}var n},MT=function(t,n){if(0===n.length)return t;var e=rt(t).filter((function(t){return!_T(t)})).fold((function(){return[]}),(function(t){return[AT]}));return t.concat(e).concat(n).concat([AT])},DT=function(t,n,e){var o=Fi(mm.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},fireDismissalEventInstead:{},inlineBehaviours:au([Fd("dismissContextMenu",[$o(bo(),(function(n,e){Kc.close(n),t.focus()}))])])}));t.on("init",(function(){t.on("contextmenu",(function(n){if(BT(t)&&n.preventDefault(),r=t,!(n.ctrlKey&&!BT(r)||function(t){return!1===t.getParam("contextmenu")}(t))){var r,i,u,a,c,s=2!==n.button||n.target===t.getBody(),l=s?(i=t,{anchor:"node",node:O.some(te(i.selection.getNode())),root:te(i.getBody())}):function(t,n){return"contextmenu"===n.type?t.inline?OT((o=n).pageX,o.pageY):function(t,n){var e,o,r,i=$g.DOM.getPos(t);return e=n,o=i.x,r=i.y,OT(e.x+o,e.y+r)}(t.getContentAreaContainer(),OT((e=n).clientX,e.clientY)):TT(t);var e,o}(t,n),f=t.ui.registry.getAll(),d=function(t){return e=(n=t).ui.registry.getAll().contextMenus,mt(n.settings,"contextmenu").map(ET).getOrThunk((function(){return W(ET("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return gt(e,t)}))}));var n,e}(t),m=s?t.selection.getStart(!0):n.target,g=(u=f.contextMenus,a=m,0<(c=X(d,(function(t,n){if(gt(u,n)){var e=u[n].update(a);if(A(e))return MT(t,e.split(" "));if(0<e.length){var o=j(e,FT);return MT(t,o)}return t}return t.concat([n])}),[])).length&&_T(c[c.length-1])&&c.pop(),c);jv(g,Xg.CLOSE_ON_EXECUTE,e).map((function(t){n.preventDefault(),mm.showMenuAt(o,l,{menu:{markers:Up("normal")},data:t})}))}}))}))},IT=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?O.some(parseInt(t,10)):O.none()},RT=function(t){return R(t)?t+"px":t},VT="data-initial-z-index",NT=function(t,n){var e,o;e=n,o=t.element(),Dr(o,e.leftAttr),Dr(o,e.topAttr)},HT=function(t,n,e,r,i){var u=n.getSnapPoints(t);return Pi(u,(function(t){var n,u,a,c,s,l,f,d,m,g,p,h,v,b=t.sensor();return n=e,u=b,a=t.range().left(),c=t.range().top(),f=uT(n,s=r,l=i),d=uT(u,s,l),Math.abs(f.left()-d.left())<=a&&Math.abs(f.top()-d.top())<=c?O.some({output:o((m=t.output(),g=e,p=r,h=i,v=function(t,n){return function(e,o){var r=t(g,p,h);return n(e.getOr(r.left()),o.getOr(r.top()))}},m.fold(v(aT,nT.offset),v(uT,nT.absolute),v(iT,nT.fixed)))),extra:t.extra}):O.none()}))},PT=function(t,n,e,o){var r,i=n.getTarget(t.element());if(n.repositionTarget){var u=dr(t.element()),a=Fu(u),c=tT(i,a),s=wi(r=i,"left").bind((function(t){return wi(r,"top").bind((function(n){return wi(r,"position").map((function(e){return("fixed"===e?fT:sT)(parseInt(t,10),parseInt(n,10))}))}))})).getOrThunk((function(){var t=xu(r);return lT(t.left(),t.top())})),l=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold((function(){var t,n,u,a=(t=e,n=i.left(),u=i.top(),t.fold((function(t,e){return nT.offset(t+n,e+u)}),(function(t,e){return nT.absolute(t+n,e+u)}),(function(t,e){return nT.fixed(t+n,e+u)}))),c=iT(a,o,r);return fT(c.left(),c.top())}),(function(n){var u=function(t,n,e,o,r,i){var u,a,c,s=function(t,n,e,o){return(r=t,i=n,u=r.element(),a=parseInt(Fr(u,i.leftAttr),10),c=parseInt(Fr(u,i.topAttr),10),isNaN(a)||isNaN(c)?O.none():O.some(bu(a,c))).fold((function(){return e}),(function(t){return fT(t.left()+o.left(),t.top()+o.top())}));var r,i,u,a,c}(t,n,e,o),l=HT(t,n,s,r,i),f=iT(s,r,i);return u=n,a=f,c=t.element(),_r(c,u.leftAttr,a.left()+"px"),_r(c,u.topAttr,a.top()+"px"),l.fold((function(){return{coord:fT(f.left(),f.top()),extra:O.none()}}),(function(t){return{coord:t.output(),extra:t.extra()}}))}(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}));return a=h,c=o,s=r,f=(l=u).bounds,d=uT(a,c,s),m=cl(d.left(),f.x(),f.width()-l.width),g=cl(d.top(),f.y(),f.height()-l.height),p=lT(m,g),a.fold((function(){var t=aT(p,c,s);return sT(t.left(),t.top())}),(function(){return p}),(function(){var t=iT(p,c,s);return fT(t.left(),t.top())}))}(t,n.snaps,s,a,c,o,e),f=cT(l,0,c);bi(i,f)}n.onDrag(t,i,o)},zT=function(t,n){return{bounds:t.getBounds(),height:Eu(n.element()),width:Au(n.element())}},LT=Pn("snaps",[Tn("getSnapPoints"),$i("onSensor"),Tn("leftAttr"),Tn("topAttr"),zn("lazyViewport",(function(){var n=Fu();return{x:n.left,y:n.top,width:o(t.window.innerWidth),height:o(t.window.innerHeight),bottom:o(n.top()+t.window.innerHeight),right:o(n.left()+t.window.innerWidth)}}))]),jT=Object.freeze({getData:function(t){return O.from(bu(t.x(),t.y()))},getDelta:function(t,n){return bu(n.left()-t.left(),n.top()-t.top())}}),UT=[zn("useFixed",!1),Tn("blockerClass"),zn("getTarget",r),zn("onDrag",n),zn("repositionTarget",!0),$i("onDrop"),Xn("getBounds",Pu),LT,nu("dragger",{handlers:function(t,n){var e=function(e){n.setStartData(zT(t,e))};return qo([$o(go(),e),$o(ze(),(function(o,r){if(0===r.event().raw().button){r.stop();var i,u={drop:function(){c()},delayDrop:function(){s.schedule()},forceDrop:function(){c()},move:function(e){s.cancel();var r=n.update(jT,e),i=n.getStartData().getOrThunk((function(){return zT(t,o)}));r.each((function(n){PT(o,t,i,n)}))}},a=o.getSystem().build(Ch.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t.blockerClass]},events:(i=u,qo([$o(ze(),i.forceDrop),$o(Ue(),i.drop),$o(Le(),(function(t,n){i.move(n.event())})),$o(je(),i.delayDrop)]))})),c=function(){(function(t){gr(t.element()).each((function(t){var n=Fr(t,VT);Mr(t,VT)?vi(t,"z-index",n):ki(t,"z-index"),Dr(t,VT)})),t.getSystem().removeFromGui(t)})(a),t.snaps.each((function(t){NT(o,t)}));var e=t.getTarget(o.element());n.reset(),t.onDrop(o,e)},s=lh(c,200);e(o),function(t,n){var e;t.getSystem().addToGui(n),gr((e=n).element()).each((function(t){wi(t,"z-index").each((function(n){_r(t,VT,n)})),vi(t,"z-index",yi(e.element(),"z-index"))}))}(o,a)}}))])}})],WT=Object.freeze({getData:function(t){var n,e=t.raw().touches;return 1===e.length?(n=e[0],O.some(bu(n.clientX,n.clientY))):O.none()},getDelta:function(t,n){return bu(n.left()-t.left(),n.top()-t.top())}}),GT=UT,XT=[zn("useFixed",!1),zn("getTarget",r),zn("onDrag",n),zn("repositionTarget",!0),zn("onDrop",n),Xn("getBounds",Pu),LT,nu("dragger",{handlers:function(t,n){var e=function(e){n.setStartData(zT(t,e))};return qo([$o(go(),e),$o(Ne(),(function(t,n){e(t),n.stop()})),$o(He(),(function(e,o){o.stop();var r=n.update(WT,o.event()),i=n.getStartData().getOrThunk((function(){return zT(t,e)}));r.each((function(n){PT(e,t,i,n)}))})),$o(Pe(),(function(e,o){t.snaps.each((function(t){NT(e,t)}));var r=t.getTarget(e.element());n.reset(),t.onDrop(e,r)}))])}})],YT=Object.freeze({mouse:GT,touch:XT}),qT=Object.freeze({init:function(){var t=O.none(),n=O.none(),e=o({});return ni({readState:e,reset:function(){t=O.none(),n=O.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=O.some(r),i;var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=O.some(t)}})}}),KT=fu({branchKey:"mode",branches:YT,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:fr(["sensor","range","output"],["extra"])},state:qT});(QC=$C||($C={}))[QC.None=0]="None",QC[QC.Both=1]="Both",QC[QC.Vertical=2]="Vertical";var JT,$T,QT=function(t,n,e,o){var r=t+n,i=e.filter((function(t){return r<t})),u=o.filter((function(t){return t<r}));return i.or(u).getOr(r)},ZT=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},tE=function(n){var e=n.getParam("inline",!1,"boolean"),o=e?wT:ZO,r=O.none(),i=Oe.detect().browser.isIE()?["tox-platform-ie"]:[],u=og.isRtl()?{attributes:{dir:"rtl"}}:{},a=Fi({dom:f({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(i)},u),behaviours:au([Ac.config({useFixed:!1})])}),c=hm({dom:{tag:"div",classes:["tox-anchorbar"]}}),s=function(){return r.bind((function(t){return jO.getMoreButton(t)})).getOrDie("Could not find more button element")},l=function(){return r.bind((function(t){return jO.getThrobber(t)})).getOrDie("Could not find throbber element")},d=function(t,n,e,o){var r,i,u={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:og.translate},interpreter:function(t){return lS(cS,t,u)},anchors:kS(n,e,o),getSink:function(){return B.value(t)}},urlinput:nk(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?O.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styleAttr:t.formatter.getCssText(n)}):O.none()}},o=function(t){var n=t.items;return void 0!==n&&0<n.length?Q(n,o):[t.format]},r=Kn([]),i=Kn([]),u=Kn([]),a=Kn([]),c=Kn(!1);return t.on("init",(function(){var u=ES(t),a=_S(t,u,n,e);r.set(a),i.set(Q(a,o))})),t.on("addStyleModifications",(function(r){var i=_S(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(Q(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}}(n),colorinput:CS(n),dialog:(r=n,{isDraggableModal:(i=r,function(){return i.getParam("draggable_modal",!1,"boolean")})})};return u}(a,n,(function(){return r.bind((function(t){return c.getOpt(t)})).getOrDie("Could not find a anchor bar element")}),s),m=function(){return B.value(a)},g=jO.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:d,onEscape:function(){n.focus()}}),p=function(t){return Rh(t)},h=jO.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:m,backstage:d,onEscape:function(){n.focus()},split:p(n),lazyToolbar:function(){return r.bind((function(t){return jO.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyMoreButton:s}),v=jO.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){}}),b=jO.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),y=jO.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),x=jO.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:d}),w=n.getParam("statusbar",!0,"boolean")&&!e?O.some(function(t,n){var e,o,r,i,u;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(i=function(){var e,o,r,i,u,a=[];return t.getParam("elementpath",!0,"boolean")&&a.push(function(t,n){return n.delimiter||(n.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:au([dd.config({mode:"flow",selector:"div[role=button]"}),eb.config({}),vd.config({}),Fd("elementPathEvents",[rr((function(e,o){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return dd.focusIn(e)})),t.on("NodeChange",(function(o){var r,i,u=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o];if(1===r.nodeType&&!ZT(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(o.parents);0<u.length&&vd.set(e,(r=j(u||[],(function(n,e){return pm.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":e,"tab-index":-1,"aria-level":e+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()}})})),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},X(r.slice(1),(function(t,n){var e=t;return e.push(i),e.push(n),e}),[r[0]])))}))}))])]),components:[]}}(t,{})),ye(t.settings.plugins,"wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return vd.set(t,[Bi(o.translate(["{0} "+e,n[e]]))])},pm.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:au([eb.config({}),vd.config({}),Ad.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Fd("wordcount-events",[$o(co(),(function(t){var n=Ad.getValue(t),e="words"===n.mode?"characters":"words";Ad.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)})),rr((function(t){e.on("wordCountUpdate",(function(n){var e=Ad.getValue(t).mode;Ad.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)}))}))])]),eventOrder:(r={},r[co()]=["wordcount-events","alloy.base.behaviour"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=og.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!ye((e=t).settings.plugins,"autoresize"),u=!1===(r=e.getParam("resize",o))?$C.None:"both"===r?$C.Both:$C.Vertical,u!==$C.None&&i.push(function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},innerHtml:bm("resize-handle",n.icons)},behaviours:au([KT.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){var i,u,a,c,s;u=r,a=e,c=te((i=t).getContainer()),s=function(t,n,e,o,r){var i,u,a={};return a.height=QT(o,n.top(),Bh(t),(i=t,O.from(i.getParam("max_height")).filter(R))),e===$C.Both&&(a.width=QT(r,n.left(),Eh(t),(u=t,O.from(u.getParam("max_width")).filter(R)))),a}(i,u,a,Tu(c),_u(c)),ct(s,(function(t,n){return vi(c,n,RT(t))})),function(t){t.fire("ResizeEditor")}(i)},blockerClass:"tox-blocker"})])}}(u)),i)}}(n,d.shared.providers)):O.none(),S={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[b,y]},k=Mh(n),C=Ah(n),T=_h(n),E=p(n)!==Sh.default,_=$([T?[g]:[],k?(E&&t.console.warn("Toolbar drawer cannot be applied when multiple toolbars are active"),[v]):C?[h]:[],Nh(n)?[]:[c.asSpec()],e?[]:[S]]),A=$([[{dom:{tag:"div",classes:["tox-editor-container"]},components:_}],e?[]:w.toArray(),[x]]),F=e&&!T&&!C&&!k,M=f({role:"application"},og.isRtl()?{dir:"rtl"}:{},F?{"aria-hidden":"true"}:{}),D=Fi(jO.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(i),styles:f({visibility:"hidden"},F?{opacity:"0",border:"0"}:{}),attributes:M},components:A,behaviours:au(o.getBehaviours(n).concat([dd.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})]))}));r=O.some(D),n.shortcuts.add("alt+F9","focus menubar",(function(){jO.focusMenubar(D)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){jO.focusToolbar(D)}));var I=Oh(D),V=Oh(a);return function(n,e,o){var r=ah(te(t.document),"mousedown",(function(t){U([e,o],(function(n){n.broadcastOn([Jc()],{target:t.target()})}))})),i=ah(te(t.document),"touchstart",(function(t){U([e,o],(function(n){n.broadcastOn([Jc()],{target:t.target()})}))})),u=ah(te(t.document),"mouseup",(function(t){0===t.raw().button&&U([e,o],(function(n){n.broadcastOn([$c()],{target:t.target()})}))})),a=function(t){U([e,o],(function(n){n.broadcastOn([Jc()],{target:te(t.target)})}))};n.on("mousedown",a),n.on("touchstart",a);var c=function(t){0===t.button&&U([e,o],(function(n){n.broadcastOn([$c()],{target:te(t.target)})}))};n.on("mouseup",c);var s=function(t){U([e,o],(function(n){n.broadcastEvent(go(),t)}))};n.on("ScrollWindow",s);var l=function(t){U([e,o],(function(n){n.broadcastEvent(po(),t)}))};n.on("ResizeWindow",l),n.on("remove",(function(){n.off("mousedown",a),n.off("touchstart",a),n.off("mouseup",c),n.off("ResizeWindow",l),n.off("ScrollWindow",s),r.unbind(),i.unbind(),u.unbind()})),n.on("detach",(function(){zc(e),zc(o),e.destroy(),o.destroy()}))}(n,I,V),{mothership:I,uiMothership:V,backstage:d,renderUI:function(){var t,e,r,i,u,c,s,f;CT(n,d),DT(n,m,d),e=(t=n).ui.registry.getAll().sidebars,U(ut(e),(function(n){var o=e[n],r=function(){return O.from(t.queryCommandValue("ToggleSidebar")).is(n)};t.ui.registry.addToggleButton(n,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){t.execCommand("ToggleSidebar",!1,n),e.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})})),r=n,i=l,u=d.shared,c=Kn(!1),s=Kn(O.none()),f=function(t){t!==c.get()&&(function(t,n,e){var o,r=t.element();!0===n?(vd.set(t,[(o=e,{dom:{tag:"div",attributes:{"aria-label":o.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:eg('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:au([dd.config({mode:"special",onTab:function(){return O.some(!0)},onShiftTab:function(){return O.some(!0)}}),Vd.config({})])})]),ki(r,"display"),Dr(r,"aria-hidden")):(vd.set(t,[]),vi(r,"display","none"),_r(r,"aria-hidden","true"))}(i(),t,u.providers),c.set(t))},r.on("ProgressState",(function(t){if(s.get().each(wm.clearTimeout),R(t.time)){var n=wm.setEditorTimeout(r,(function(){return f(t.state)}),t.time);s.set(O.some(n))}else f(t.state),s.set(O.none())}));var g=n.ui.registry.getAll(),p=g.buttons,h=g.menuItems,v=g.contextToolbars,b=g.sidebars,y=Fh(n),x={menuItems:h,menus:n.settings.menu?st(n.settings.menu,(function(t){return yt(t,{items:t.items})})):{},menubar:n.settings.menubar,toolbar:y.getOrThunk((function(){return n.getParam("toolbar",!0)})),buttons:p,sidebar:b};hO(n,v,a,{backstage:d});var w=n.getElement(),S=function(t){var e,o=$g.DOM,r=n.getParam("width",o.getStyle(t,"width")),i=(e=n).getParam("height",Math.max(e.getElement().offsetHeight,200)),u=Eh(n),a=Bh(n),c=IT(r).bind((function(t){return RT(u.map((function(n){return Math.max(t,n)})))})).getOr(RT(r)),s=IT(i).bind((function(t){return a.map((function(n){return Math.max(t,n)}))})).getOr(i),l=RT(c);if(Si("div","width",l)&&vi(D.element(),"width",l),!n.inline){var f=RT(s);Si("div","height",f)?vi(D.element(),"height",f):vi(D.element(),"height","200px")}return s}(w),k={mothership:I,uiMothership:V,outerContainer:D},C={targetNode:w,height:S};return o.render(n,k,x,d,C)},getUi:function(){return{channels:{broadcastAll:V.broadcast,broadcastOn:V.broadcastOn,register:function(){}}}}}},nE=o([Tn("lazySink"),In("dragBlockClass"),Xn("getBounds",Pu),zn("useTabstopAt",o(!0)),zn("eventOrder",{}),ns("modalBehaviours",[dd]),Qi("onExecute"),tu("onEscape")]),eE={sketch:r},oE=o([_s({name:"draghandle",overrides:function(t,n){return{behaviours:au([KT.config({mode:"mouse",getTarget:function(t){return Di(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Es({schema:[Tn("dom")],name:"title"}),Es({factory:eE,schema:[Tn("dom")],name:"close"}),Es({factory:eE,schema:[Tn("dom")],name:"body"}),_s({factory:eE,schema:[Tn("dom")],name:"footer"}),Bs({factory:{sketch:function(t,n){return f({},t,{dom:n.dom,components:n.components})}},schema:[zn("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),zn("components",[])],name:"blocker"})]),rE=el({name:"ModalDialog",configFields:nE(),partFields:oE(),factory:function(t,n,e,o){var i=Hr("alloy.dialog.busy"),u=Hr("alloy.dialog.idle"),a=au([dd.config({mode:"special",onTab:function(){return O.some(!0)},onShiftTab:function(){return O.some(!0)}}),Vd.config({})]),c=Hr("modal-events"),s=f({},t.eventOrder,{"alloy.system.attached":[c].concat(t.eventOrder["alloy.system.attached"]||[])});return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){var e=t.lazySink(n).getOrDie(),r=Kn(O.none()),c=o.blocker(),s=e.getSystem().build(f({},c,{components:c.components.concat([Mi(n)]),behaviours:au([Fd("dialog-blocker-events",[$o(u,(function(t,e){Mr(n.element(),"aria-busy")&&(Dr(n.element(),"aria-busy"),r.get().each((function(t){return vd.remove(n,t)})))})),$o(i,(function(t,e){_r(n.element(),"aria-busy","true");var o=e.event().getBusySpec();r.get().each((function(t){vd.remove(n,t)}));var i=o(n,a),u=t.getSystem().build(i);r.set(O.some(u)),vd.append(n,Mi(u)),u.hasConfigured(dd)&&dd.focusIn(u)}))])])}));Dc(e,s),dd.focusIn(n)},hide:function(t){gr(t.element()).each((function(n){t.getSystem().getByDom(n).each((function(t){Vc(t)}))}))},getBody:function(n){return js(n,t,"body")},getFooter:function(n){return js(n,t,"footer")},setIdle:function(t){Oo(t,u)},setBusy:function(t,n){To(t,i,{getBusySpec:n})}},eventOrder:s,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:os(t.modalBehaviours,[vd.config({}),dd.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),Fd(c,[rr((function(n){var e,o,i;(function(t,n){var e=O.from(Fr(t,"id")).fold((function(){var t=Hr("dialog-label");return _r(n,"id",t),t}),r);_r(t,"aria-labelledby",e)})(n.element(),js(n,t,"title").element()),e=n.element(),o=js(n,t,"body").element(),i=O.from(Fr(e,"id")).fold((function(){var t=Hr("dialog-describe");return _r(o,"id",t),t}),r),_r(e,"aria-describedby",i)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),iE=[Bn("type"),Bn("text"),_n("level",["info","warn","error","success"]),Bn("icon"),zn("url","")],uE=tn(iE),aE=[Bn("type"),Bn("text"),Gn("disabled",!1),Gn("primary",!1),un("name","name",Ot((function(){return Hr("button-name")})),xn),Nn("icon"),Gn("borderless",!1)],cE=tn(aE),sE=[Bn("type"),Bn("name"),Bn("label"),Gn("disabled",!1)],lE=tn(sE),fE=wn,dE=[Bn("type"),Bn("name")],mE=dE.concat([Nn("label")]),gE=tn(mE),pE=xn,hE=tn(mE),vE=xn,bE=tn(mE),yE=nn(cn),xE=function(t){return[Bn("type"),En("columns",yn),t]},wE=mE.concat([Gn("sandboxed",!0)]),SE=tn(wE),kE=xn,CE=mE.concat([Nn("placeholder"),Gn("maximized",!1),Gn("disabled",!1)]),OE=tn(CE),TE=xn,EE=mE.concat([Mn("items",[Bn("text"),Bn("value")]),jn("size",1),Gn("disabled",!1)]),BE=tn(EE),_E=xn,AE=mE.concat([Gn("constrain",!0),Gn("disabled",!1)]),FE=tn(AE),ME=tn([Bn("width"),Bn("height")]),DE=mE.concat([Nn("placeholder"),Gn("maximized",!1),Gn("disabled",!1)]),IE=tn(DE),RE=xn,VE=mE.concat([Wn("filetype","file",["image","media","file"]),zn("disabled",!1)]),NE=tn(VE),HE=tn([Bn("value"),zn("meta",{})]),PE=dE.concat([Un("tag","textarea"),Bn("scriptId"),Bn("scriptUrl"),Ln("settings",void 0,Cn)]),zE=dE.concat([Un("tag","textarea"),An("init")]),LE=sn((function(t){return fn("customeditor.old",Zt(zE),t).orThunk((function(){return fn("customeditor.new",Zt(PE),t)}))})),jE=xn,UE=[Bn("type"),Bn("html"),Wn("presets","presentation",["presentation","document"])],WE=tn(UE),GE=mE.concat([En("currentState",tn([Tn("blob"),Bn("url")]))]),XE=tn(GE),YE=mE.concat([zn("columns","auto")]),qE=tn(YE),KE=(JT=[Bn("value"),Bn("text"),Bn("icon")],on(JT)),JE=[Bn("type"),Dn("header",xn),Dn("cells",nn(xn))],$E=tn(JE),QE=function(t){return un("items","items",kt(),nn(sn((function(n){return fn("Checking item of "+t,ZE,n).fold((function(t){return B.error(gn(t))}),(function(t){return B.value(t)}))}))))},ZE=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()},toDsl:function(){return t().toDsl()}}}((function(){return pn("type",{alertbanner:uE,bar:tn((n=QE("bar"),[Bn("type"),n])),button:cE,checkbox:lE,colorinput:gE,colorpicker:hE,dropzone:bE,grid:tn(xE(QE("grid"))),iframe:SE,input:OE,selectbox:BE,sizeinput:FE,textarea:IE,urlinput:NE,customeditor:LE,htmlpanel:WE,imagetools:XE,collection:qE,label:tn((t=QE("label"),[Bn("type"),Bn("label"),t])),table:$E,panel:nB});var t,n})),tB=[Bn("type"),zn("classes",[]),Dn("items",ZE)],nB=tn(tB),eB=[un("name","name",Ot((function(){return Hr("tab-name")})),xn),Bn("title"),Dn("items",ZE)],oB=[Bn("type"),Mn("tabs",eB)],rB=tn(oB),iB=[un("name","name",Ot((function(){return Hr("button-name")})),xn),Nn("icon"),Wn("align","end",["start","end"]),Gn("primary",!1),Gn("disabled",!1)],uB=iB.concat([Bn("text")]),aB=[_n("type",["submit","cancel","custom"])].concat(uB),cB=[_n("type",["menu"])].concat(iB,rC),sB=hn("type",{submit:aB,cancel:aB,custom:aB,menu:cB}),lB=tn([Bn("title"),En("body",pn("type",{panel:nB,tabpanel:rB})),Un("size","normal"),Dn("buttons",sB),zn("initialData",{}),Xn("onAction",n),Xn("onChange",n),Xn("onSubmit",n),Xn("onClose",n),Xn("onCancel",n),zn("onTabChange",n)]),fB=function(t){return F(t)?[t].concat(Q(dt(t),fB)):M(t)?Q(t,fB):[]},dB=function(t){return A(t.type)&&A(t.name)},mB={checkbox:fE,colorinput:pE,colorpicker:vE,dropzone:yE,input:TE,iframe:kE,sizeinput:ME,selectbox:_E,size:ME,textarea:RE,urlinput:HE,customeditor:jE,collection:KE},gB=function(t){var n=Q(W(fB(t),dB),(function(t){return(n=t,O.from(mB[n.type])).fold((function(){return[]}),(function(n){return[En(t.name,n)]}));var n}));return tn(n)},pB=tn([_n("type",["cancel","custom"])].concat(uB)),hB=tn([Bn("title"),Bn("url"),Vn("height"),Vn("width"),($T=pB,Rn("buttons",nn($T))),Xn("onAction",n),Xn("onCancel",n),Xn("onClose",n),Xn("onMessage",n)]),vB=function(t){return{internalDialog:dn(fn("dialog",lB,t)),dataValidator:gB(t),initialData:t.initialData}},bB={open:function(t,n){var e=vB(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(dn(fn("dialog",hB,n)))},redial:function(t){return vB(t)}},yB=function(t){var n=[],e={};return ct(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?B.error(n):B.value(e)},xB=nl({name:"TabButton",configFields:[zn("uid",void 0),Tn("value"),un("dom","dom",Tt((function(t){return{attributes:{role:"tab",id:Hr("aria"),"aria-selected":"false"}}})),vn()),In("action"),zn("domModification",{}),ns("tabButtonBehaviours",[Vd,dd,Ad]),Tn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:gm(t.action),behaviours:os(t.tabButtonBehaviours,[Vd.config({}),dd.config({mode:"execution",useSpace:!0,useEnter:!0}),Ad.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),wB=o([Tn("tabs"),Tn("dom"),zn("clickToDismiss",!1),ns("tabbarBehaviours",[bl,dd]),Ki(["tabClass","selectedClass"])]),SB=As({factory:xB,name:"tabs",unit:"tab",overrides:function(t,e){var o=function(t,n){bl.dehighlight(t,n),To(t,So(),{tabbar:t,button:n})},r=function(t,n){bl.highlight(t,n),To(t,wo(),{tabbar:t,button:n})};return{action:function(e){var i=e.getSystem().getByUid(t.uid).getOrDie(),u=bl.isHighlighted(i,e);(u&&t.clickToDismiss?o:u?n:r)(i,e)},domModification:{classes:[t.markers.tabClass]}}}}),kB=o([SB]),CB=el({name:"Tabbar",configFields:wB(),partFields:kB(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:os(t.tabbarBehaviours,[bl.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){_r(n.element(),"aria-selected","true")},onDehighlight:function(t,n){_r(n.element(),"aria-selected","false")}}),dd.config({mode:"flow",getInitial:function(t){return bl.getHighlighted(t).map((function(t){return t.element()}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),OB=nl({name:"Tabview",configFields:[ns("tabviewBehaviours",[vd])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:os(t.tabviewBehaviours,[vd.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),TB=o([zn("selectFirst",!0),$i("onChangeTab"),$i("onDismissTab"),zn("tabs",[]),ns("tabSectionBehaviours",[])]),EB=Es({factory:CB,schema:[Tn("dom"),Fn("markers",[Tn("tabClass"),Tn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),BB=Es({factory:OB,name:"tabview"}),_B=o([EB,BB]),AB=el({name:"TabSection",configFields:TB(),partFields:_B(),factory:function(t,n,e,o){var r=function(n,e){Ls(n,t,"tabbar").each((function(t){e(t).each(Eo)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:es(t.tabSectionBehaviours),events:qo($([t.selectFirst?[rr((function(t,n){r(t,bl.getFirst)}))]:[],[$o(wo(),(function(n,e){var o,r,i=e.event().button();o=i,r=Ad.getValue(o),Ls(o,t,"tabview").each((function(n){Y(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();_r(n.element(),"aria-labelledby",Fr(o.element(),"id")),vd.set(n,r),t.onChangeTab(n,o,r)}))}))})),$o(So(),(function(n,e){var o=e.event().button();t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Ls(n,t,"tabview").map((function(t){return vd.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=bl.getCandidates(t);return Y(e,(function(t){return Ad.getValue(t)===n})).filter((function(n){return!bl.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),FB=function(n,e,o){Di(n,'[role="dialog"]').each((function(r){o.get().map((function(o){return vi(e,"height","0"),Math.min(o,(u=n,a=Di(i=r,".tox-dialog-wrap").getOr(i),("fixed"===yi(a,"position")?Math.max(t.document.documentElement.clientHeight,t.window.innerHeight):Math.max(t.document.documentElement.offsetHeight,t.document.documentElement.scrollHeight))-(i.dom().getBoundingClientRect().height-u.dom().getBoundingClientRect().height)));var i,u,a})).each((function(t){vi(e,"height",t+"px")}))}))},MB=function(t){var n;return{smartTabHeight:(n=Kn(O.none()),{extraEvents:[rr((function(e){Ii(e.element(),'[role="tabpanel"]').each((function(o){var r;vi(o,"visibility","hidden"),e.getSystem().getByDom(o).toOption().each((function(e){var r,i,u,a=(i=o,u=e,j(r=t,(function(t,n){vd.set(u,r[n].view());var e=i.dom().getBoundingClientRect();return vd.set(u,[]),e.height}))),c=function(t){return ot((n=t,e=function(t,n){return n<t?-1:t<n?1:0},(o=N.call(n,0)).sort(e),o));var n,e,o}(a);n.set(c)})),FB(e.element(),o,n),ki(o,"visibility"),r=e,ot(t).each((function(t){return AB.showTab(r,t.value)})),wm.requestAnimationFrame((function(){FB(e.element(),o,n)}))}))})),$o(po(),(function(t){Ii(t.element(),'[role="tabpanel"]').each((function(e){FB(t.element(),e,n)}))})),$o(Xh,(function(t,e){Ii(t.element(),'[role="tabpanel"]').each((function(e){var o=Al();vi(e,"visibility","hidden");var r=wi(e,"height").map((function(t){return parseInt(t,10)}));ki(e,"height");var i=e.dom().getBoundingClientRect().height;r.forall((function(t){return t<i}))?(n.set(O.from(i)),FB(t.element(),e,n)):r.each((function(t){vi(e,"height",t+"px")})),ki(e,"visibility"),o.each(_l)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},DB="send-data-to-section",IB="send-data-to-view",RB=Hr("update-dialog"),VB=Hr("update-title"),NB=Hr("update-body"),HB=Hr("update-footer"),PB=Hr("body-send-message"),zB=function(n,e,o,r){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:f({},e.map((function(t){return{id:t}})).getOr({}),r?{"aria-live":"polite"}:{})},components:[],behaviours:au([fx(0),kC.config({channel:NB,updateState:function(t,n){return O.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(n){return"tabpanel"===n.body.type?[(a=n.body,c=o,s=Kn({}),l=function(t){var n=Ad.getValue(t),e=yB(n).getOr({}),o=s.get(),r=bt(o,e);s.set(r)},f=function(t){var n=s.get();Ad.setValue(t,n)},d=Kn(null),m=j(a.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:c.shared.providers.translate(t.title)},view:function(){return[ox.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:j(t.items,(function(t){return sS(n,t,c)})),formBehaviours:au([dd.config({mode:"acyclic",useTabstopAt:u(Ox)}),Fd("TabView.form.events",[rr(f),ir(l)]),pu.config({channels:Rt([{key:DB,value:{onReceive:l}},{key:IB,value:{onReceive:f}}])})])}}))]}}})),g=MB(m).smartTabHeight,AB.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Ad.getValue(n);To(t,Gh,{name:o,oldName:d.get()}),d.set(o)},tabs:m,components:[AB.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[CB.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:au([eb.config({})])}),AB.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:g.selectFirst,tabSectionBehaviours:au([Fd("tabpanel",g.extraEvents),dd.config({mode:"acyclic"}),ul.config({find:function(t){return ot(AB.getViewItems(t))}}),Ad.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([DB],{}),s.get()},setValue:function(t,n){s.set(n),t.getSystem().broadcastOn([IB],{})}}})])}))]:[(e=n.body,r=o,i=hm(ox.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:j(e.items,(function(n){return sS(t,n,r)}))}}))),{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[i.asSpec()]}],behaviours:au([dd.config({mode:"acyclic",useTabstopAt:u(Ox)}),lx(i),vx(i,{postprocess:function(n){return yB(n).fold((function(n){return t.console.error(n),{}}),(function(t){return t}))}})])})];var e,r,i,a,c,s,l,f,d,m,g},initialData:n})])}},LB=function(t,n){return[nr(Ge(),Tx),t(Ph,(function(t,e){n.onClose(),e.onClose()})),t(zh,(function(t,n,e,o){n.onCancel(t),Oo(o,Ph)})),$o(Wh,(function(t,e){return n.onUnblock()})),$o(Uh,(function(t,e){return n.onBlock(e.event())}))]},jB=function(t,n){var e=function(n,e){return $o(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event(),n)}))}))},o=function(t,n){kC.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return LB(e,n).concat([e(jh,(function(t,n){return n.onSubmit(t)})),e(Hh,(function(t,n,e){n.onChange(t,{name:e.name()})})),e(Lh,(function(t,n,e){n.onAction(t,{name:e.name(),value:e.value()})})),e(Gh,(function(t,n,e){n.onTabChange(t,{newTabName:e.name(),oldTabName:e.oldName()})})),ir((function(n){var e=t();Ad.setValue(n,e.getData())}))])},UB=function(t,n){var e=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u)?e:o).push(u)}return{pass:e,fail:o}}(n.map((function(t){return t.footerButtons})).getOr([]),(function(t){return"start"===t.align})),o=function(t,n){return Ch.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:j(n,(function(t){return t.memento.asSpec()}))})};return[o("start",e.pass),o("end",e.fail)]},WB=function(t,n){return{dom:eg('<div class="tox-dialog__footer"></div>'),components:[],behaviours:au([kC.config({channel:HB,initialData:t,updateState:function(t,e){var o=j(e.buttons,(function(t){var e,o,r=hm((o=n,ww(e=t,e.type,o)));return{name:t.name,align:t.align,memento:r}}));return O.some({lookupByName:function(t,n){return e=t,r=n,Y(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}));var e,r},footerButtons:o})},renderComponents:UB})])}},GB=function(t,n){return rE.parts().footer(WB(t,n))},XB=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=ul.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return ox.getField(e,n).fold((function(){var o=t.getFooter();return kC.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return O.some(t)}))}return O.none()},YB=function(t,n){var e=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},o={getData:function(){var n=t.getRoot(),e=n.getSystem().isConnected()?t.getFormWrapper():n;return Ad.getValue(e)},setData:function(n){e((function(e){var r,i,u=o.getData(),a=yt(u,n),c=(r=a,i=t.getRoot(),kC.getState(i).get().map((function(t){return dn(fn("data",t.dataValidator,r))})).getOr(r)),s=t.getFormWrapper();Ad.setValue(s,c)}))},disable:function(n){XB(t,n).each(Vg.disable)},enable:function(n){XB(t,n).each(Vg.enable)},focus:function(n){XB(t,n).each(Vd.focus)},block:function(t){if(!A(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e((function(n){To(n,Uh,{message:t})}))},unblock:function(){e((function(t){Oo(t,Wh)}))},showTab:function(n){e((function(e){var o=t.getBody();kC.getState(o).get().exists((function(t){return t.isTabPanel()}))&&ul.getCurrent(o).each((function(t){AB.showTab(t,n)}))}))},redial:function(t){e((function(e){var r=n(t);e.getSystem().broadcastOn([RB],r),e.getSystem().broadcastOn([VB],r.internalDialog),e.getSystem().broadcastOn([NB],r.internalDialog),e.getSystem().broadcastOn([HB],r.internalDialog),o.setData(r.initialData)}))},close:function(){e((function(t){Oo(t,Ph)}))}};return o},qB=function(t){return pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){Oo(t,zh)}})},KB=function(t,n,e){var o=function(t){return[Bi(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:f({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:au([kC.config({channel:VB,renderComponents:o})])}},JB=function(){return{dom:eg('<div class="tox-dialog__draghandle"></div>')}},$B=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=rE.parts().title(KB(e,O.none(),o)),i=rE.parts().draghandle(JB()),u=rE.parts().close(qB(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),Ch.sketch({dom:eg('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},QB=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){rE.setBusy(t(),(function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:eg('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){rE.setIdle(t())}}},ZB=function(t,n,e,o){var r;return Fi(rE.sketch({lazySink:o.shared.getSink,onEscape:function(t){return Oo(t,zh),O.some(!0)},useTabstopAt:function(t){return!Ox(t)},modalBehaviours:au([kC.config({channel:RB,updateState:function(t,n){return O.some(n)},initialData:n}),xx({}),Vd.config({}),Fd("execute-on-form",e.concat([or(Ge(),(function(t,n){dd.focusIn(t)}))])),Fd("scroll-lock",[rr((function(){si(Uo(),"tox-dialog__disable-scroll")})),ir((function(){li(Uo(),"tox-dialog__disable-scroll")}))])].concat(t.extraBehaviours)),eventOrder:(r={},r[io()]=["execute-on-form"],r[ro()]=["reflecting","receiving"],r[ho()]=["scroll-lock","reflecting","messages","execute-on-form","alloy.base.behaviour"],r[vo()]=["alloy.base.behaviour","execute-on-form","messages","reflecting","scroll-lock"],r),dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses),styles:f({position:"relative"},t.extraStyles)},components:[t.header,t.body].concat(t.footer.toArray()),dragBlockClass:"tox-dialog-wrap",parts:{blocker:{dom:eg('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}}}))},t_=tinymce.util.Tools.resolve("tinymce.util.URI"),n_=["insertContent","setContent","execCommand","close","block","unblock"],e_=function(t){return F(t)&&-1!==n_.indexOf(t.mceAction)},o_=function(n,e,o,r){var i,a,c,s,l=$B(n.title,r),d=(a={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Ex({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:au([eb.config({}),Vd.config({})])})]}],behaviours:au([dd.config({mode:"acyclic",useTabstopAt:u(Ox)})])},rE.parts().body(a)),m=n.buttons.bind((function(t){return 0===t.length?O.none():O.some(GB({buttons:t},r))})),g=function(t,n){var e=function(t,n){return $o(t,(function(t,e){o(t,(function(o,r){n(S,o,e.event(),t)}))}))},o=function(t,n){kC.getState(t).get().each((function(e){n(e,t)}))};return LB(e,n).concat([e(Lh,(function(t,n,e){n.onAction(t,{name:e.name()})}))])}(0,QB((function(){return w}),e)),p=f({},n.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}})),n.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),h=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],v=new t_(n.url,{base_uri:new t_(t.window.location.href)}),b=v.protocol+"://"+v.host+(v.port?":"+v.port:""),y=Kn(O.none()),x=[Fd("messages",[rr((function(){var e=ah(te(t.window),"message",(function(t){if(v.isSameOrigin(new t_(t.raw().origin))){var e=t.raw().data;e_(e)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!D(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(o,S,e):!e_(r=e)&&F(r)&&gt(r,"mceAction")&&n.onMessage(S,e)}var r}));y.set(O.some(e))})),ir((function(){y.get().each((function(t){return t.unbind()}))}))]),pu.config({channels:(i={},i[PB]={onReceive:function(t,n){Ii(t.element(),"iframe").each((function(t){t.dom().contentWindow.postMessage(n,b)}))}},i)})],w=ZB({header:l,body:d,footer:m,extraClasses:h,extraBehaviours:x,extraStyles:p},n,g,r),S=(c=w,s=function(t){c.getSystem().isConnected()&&t(c)},{block:function(t){if(!A(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");s((function(n){To(n,Uh,{message:t})}))},unblock:function(){s((function(t){Oo(t,Wh)}))},close:function(){s((function(t){Oo(t,Ph)}))},sendMessage:function(t){s((function(n){n.getSystem().broadcastOn([PB],t)}))}});return{dialog:w,instanceApi:S}},r_={dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]}},i_={dom:{tag:"div",classes:["tox-dialog__header"]}},u_=function(t,n){return rE.parts().close(pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:au([eb.config({})])}))},a_=function(){return rE.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},c_=function(t,n){return rE.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:eg("<p>"+n.translate(t)+"</p>")}]}]})},s_=function(t){return rE.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},l_=function(t,n){return[Ch.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Ch.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},f_=function(t){return rE.sketch({lazySink:t.lazySink,onEscape:function(){return t.onCancel(),O.some(!0)},dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses)},components:[bt(t.headerOverride.getOr(i_),{components:[t.partSpecs.title,t.partSpecs.close]}),t.partSpecs.body,t.partSpecs.footer],parts:{blocker:{dom:eg('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}},modalBehaviours:au([Fd("basic-dialog-events",[$o(zh,(function(n,e){t.onCancel()})),$o(jh,(function(n,e){t.onSubmit()}))])])})},d_=function(t){var e,o,r,i,u=(o=(e=t).backstage.shared,{open:function(t,r){var i=function(){rE.hide(a),r()},u=hm(ww({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:O.none()},"cancel",e.backstage)),a=Fi(f_({lazySink:function(){return o.getSink()},headerOverride:O.some(r_),partSpecs:{title:a_(),close:u_((function(){i()}),o.providers),body:c_(t,o.providers),footer:s_(l_([],[u.asSpec()]))},onCancel:function(){return i()},onSubmit:n,extraClasses:["tox-alert-dialog"]}));rE.show(a);var c=u.get(a);Vd.focus(c)}}),a=(i=(r=t).backstage.shared,{open:function(t,n){var e=function(t){rE.hide(a),n(t)},o=hm(ww({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:O.none()},"submit",r.backstage)),u=ww({name:"no",text:"No",primary:!0,align:"end",disabled:!1,icon:O.none()},"cancel",r.backstage),a=Fi(f_({lazySink:function(){return i.getSink()},headerOverride:O.some(r_),partSpecs:{title:a_(),close:u_((function(){e(!1)}),i.providers),body:c_(t,i.providers),footer:s_(l_([],[u,o.asSpec()]))},onCancel:function(){return e(!1)},onSubmit:function(){return e(!0)},extraClasses:["tox-confirm-dialog"]}));rE.show(a);var c=o.get(a);Vd.focus(c)}}),c=function(n,e,o,r){return bB.open((function(n,i,u){var a=dn(fn("data",u,i)),c=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m,g=Hr("dialog-label"),p=Hr("dialog-content"),h=hm((u={title:t.internalDialog.title,draggable:!0},a=g,c=e.shared.providers,Ch.sketch({dom:eg('<div class="tox-dialog__header"></div>'),components:[KB(u,O.some(a),c),JB(),qB(c)],containerBehaviours:au([KT.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Ri(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),v=hm((s={body:t.internalDialog.body},l=p,f=e,d=o,zB(s,O.some(l),f,d))),b=hm((m={buttons:t.internalDialog.buttons},WB(m,e))),y=jB((function(){return w}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}}),x=Fi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=g,r["aria-describedby"]=""+p,r)},eventOrder:(i={},i[ro()]=[kC.name(),pu.name()],i[io()]=["execute-on-form"],i[ho()]=["reflecting","execute-on-form"],i),behaviours:au([dd.config({mode:"cyclic",onEscape:function(t){return Oo(t,Ph),O.some(!0)},useTabstopAt:function(t){return!Ox(t)&&("button"!==No(t)||"disabled"!==Fr(t,"disabled"))}}),kC.config({channel:RB,updateState:function(t,n){return O.some(n)},initialData:t}),Fd("execute-on-form",y),xx({})]),components:[h.asSpec(),v.asSpec(),b.asSpec()]}),w=YB({getRoot:function(){return x},getFooter:function(){return b.get(x)},getBody:function(){return v.get(x)},getFormWrapper:function(){var t=v.get(x);return ul.getCurrent(t).getOr(t)}},n.redial);return{dialog:x,instanceApi:w}}({dataValidator:u,initialData:a,internalDialog:n},{redial:bB.redial,closeWindow:function(){mm.hide(s),o(c.instanceApi)}},t.backstage,r),s=Fi(mm.sketch({lazySink:t.backstage.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:au([Fd("window-manager-inline-events",[$o(bo(),(function(t,n){Oo(c.dialog,zh)}))])])}));return mm.showAt(s,e,Mi(c.dialog)),c.instanceApi.setData(a),dd.focusIn(c.dialog),c.instanceApi}),n)};return{open:function(n,e,o){return void 0!==e&&"toolbar"===e.inline?c(n,t.backstage.shared.anchors.toolbar(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(n,t.backstage.shared.anchors.cursor(),o,e.ariaAttrs):function(n,e){return bB.open((function(n,o,r){var i=o,u=function(t,n,e){var o,r,i,u=$B(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=zB(o,O.none(),r,!1),rE.parts().body(i)),c=GB({buttons:t.internalDialog.buttons},e),s=jB((function(){return m}),QB((function(){return d}),n)),l="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:u,body:a,footer:O.some(c),extraClasses:l,extraBehaviours:[],extraStyles:{}},d=ZB(f,t,s,e),m=YB({getRoot:function(){return d},getBody:function(){return rE.getBody(d)},getFooter:function(){return rE.getFooter(d)},getFormWrapper:function(){var t=rE.getBody(d);return ul.getCurrent(t).getOr(t)}},n.redial);return{dialog:d,instanceApi:m}}({dataValidator:r,initialData:i,internalDialog:n},{redial:bB.redial,closeWindow:function(){rE.hide(u.dialog),e(u.instanceApi)}},t.backstage);return rE.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),n)}(n,o)},openUrl:function(n,e){return function(n,e){return bB.openUrl((function(n){var o=o_(n,{closeWindow:function(){rE.hide(o.dialog),e(o.instanceApi)}},t.editor,t.backstage);return rE.show(o.dialog),o.instanceApi}),n)}(n,e)},alert:function(t,n){u.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){a.open(t,(function(t){n(t)}))}}};l.add("silver",(function(t){var n=tE(t),e=n.uiMothership,r=n.backstage,i=n.renderUI,u=n.getUi;oh(t,r.shared);var a=d_({editor:t,backstage:r});return{renderUI:i,getWindowManagerImpl:o(a),getNotificationManagerImpl:function(){return function(t,n,e){var o=n.backstage;return{open:function(t,r){var i=function(){r(),mm.hide(a)},u=Fi(xm.sketch({text:t.text,level:P(["success","error","warning","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:O.from(t.icon),onAction:i,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),a=Fi(mm.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}}));return e.add(a),t.timeout&&wm.setTimeout((function(){i()}),t.timeout),{close:i,moveTo:function(t,n){mm.showAt(a,{anchor:"makeshift",x:t,y:n},Mi(u))},moveRel:function(t,e){mm.showAt(a,n.backstage.shared.anchors.banner(),Mi(u))},text:function(t){xm.updateText(u,t)},settings:t,getEl:function(){},progressBar:{value:function(t){xm.updateProgress(u,t)}}}},close:function(t){t.close()},reposition:function(n){U(n,(function(t){t.moveTo(0,0)})),function(n){if(0<n.length){var e=n.slice(0,1)[0],o=(r=t).inline?r.getElement():r.getContentAreaContainer();e.moveRel(o,"tc-tc"),U(n,(function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")}))}var r}(n)},getArgs:function(t){return t.settings}}}(t,{backstage:r},e)},ui:u()}}))}(window);